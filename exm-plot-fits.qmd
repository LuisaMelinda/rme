#### Example: PLOS Medicine title length data

(Adapted from @dobson4e, ยง6.7.1)

```{r}
#| fig-cap: "Number of authors versus title length in *PLOS Medicine* articles"
#| label: fig-plos
data(PLOS, package = "dobson")
fig1 = 
  PLOS |> 
  ggplot(
    aes(x = authors,
        y = nchar)
  ) +
  geom_point() +
  theme(legend.position = "bottom") +
  labs(col = "") +
  guides(col=guide_legend(ncol=3))
fig1
```

---

##### Linear fit

::: {.column width=40%}

```{r}
#| fig-cap: "Number of authors versus title length in *PLOS Medicine*, with linear model fit"
#| label: fig-plos-lm
lm_PLOS_linear = lm(nchar ~ authors, data = PLOS)
fig2 = fig1 +
  geom_smooth(
    method = "lm", 
              fullrange = TRUE,
              aes(col = "lm(y ~ x)"))
fig2
```

:::

::: {.column width=10%}
:::

::: {.column width=40%}

```{r}
#| fig-cap: "Residuals versus fitted plot for linear fit to `PLOS` data"
#| label: fig-plos-lm-resid

library(ggfortify)
autoplot(lm_PLOS_linear, which = 1, ncol = 1)
```

:::

---

##### Quadratic fit {.smaller}

::: {.column width=40%}

```{r}
#| fig-cap: "Number of authors versus title length in *PLOS Medicine*, with quadratic model fit"
#| label: fig-plos-lm-quad
lm_PLOS_quad = lm(nchar ~ authors + I(authors^2), data = PLOS)
fig3 = 
  fig2 + 
geom_smooth(
    method = "lm",
    fullrange = TRUE,
    formula = y ~ x + I(x ^ 2),
    aes(col = "lm(y ~ x + I(x^2))")
  )
fig3
```

:::

::: {.column width=20%}
:::

::: {.column width=40%}

```{r}
#| fig-cap: "Residuals versus fitted plot for quadratic fit to `PLOS` data"
#| label: fig-plos-lm-quad-resid

autoplot(lm_PLOS_quad, which = 1, ncol = 1)
```
:::

---

##### Linear versus quadratic fits

::: {.column width=40%}

```{r}
#| fig-cap: "Residuals versus fitted plot for linear fit to `PLOS` data"
#| label: fig-plos-lm-resid2

library(ggfortify)
autoplot(lm_PLOS_linear, which = 1, ncol = 1)
```

:::

::: {.column width=20%}
:::

::: {.column width=40%}

```{r}
#| fig-cap: "Residuals versus fitted plot for quadratic fit to `PLOS` data"
#| label: fig-plos-lm-quad-resid2

autoplot(lm_PLOS_quad, which = 1, ncol = 1)
```
:::

---

##### Cubic fit

```{r}
lm_PLOS_cub = lm(nchar ~ authors + I(authors^2) + I(authors^3), data = PLOS)
```

::: {.column width=40%}

```{r}
fig3 = 
  fig2 + 
geom_smooth(
    method = "lm",
    fullrange = TRUE,
    formula = y ~ x + I(x ^ 2) + I(x ^ 3),
    aes(col = "lm(y ~ x + I(x^2) + I(x ^ 3))")
  )
fig3
```

:::

::: {.column width=20%}
:::

::: {.column width=40%}

```{r}
#| fig-cap: "Residuals versus fitted plot for quadratic fit to `PLOS` data"
#| label: fig-plos-lm-cub

autoplot(lm_PLOS_cub, which = 1, ncol = 1)

```
:::

---

##### Logarithmic fit

```{r}
lm_PLOS_log = lm(nchar ~ log(authors), data = PLOS)
```

::: {.column width=40%}
```{r}
fig4 = fig3 + 
  geom_smooth(
    method = "lm",
    fullrange = TRUE,
    formula = y ~ log(x),
    aes(col = "lm(y ~ log(x))")
  )
fig4
```

:::

::: {.column width=20%}
:::

::: {.column width=40%}
```{r}
autoplot(lm_PLOS_log, which = 1, ncol = 1)
```
:::

---

```{r}
#| fig-cap: "Number of authors versus title length in *PLOS Medicine*"
#| label: fig-plos-multifit

fig_all = fig3 +
  xlim(0, 40)
fig_all
```

