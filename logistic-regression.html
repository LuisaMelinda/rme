<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ezra Morrison">

<title>Regression Models for Epidemiology - 3&nbsp; Logistic Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./count-regression.html" rel="next">
<link href="./Linear-models-overview.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./logistic-regression.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic Regression</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Regression Models for Epidemiology</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-to-GLMs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Overview of Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Linear-models-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Models for Count Outcomes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-to-survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Survival Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./proportional-hazards-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Proportional Hazards Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./coxph-model-building.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Building Cox Proportional Hazards models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parametric-survival-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parametric survival models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link active" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  <li><a href="#configuring-r" id="toc-configuring-r" class="nav-link" data-scroll-target="#configuring-r">Configuring R</a></li>
  <li><a href="#introduction-to-logistic-regression" id="toc-introduction-to-logistic-regression" class="nav-link" data-scroll-target="#introduction-to-logistic-regression"><span class="header-section-number">4</span> Introduction to logistic regression</a>
  <ul class="collapse">
  <li><a href="#binary-outcomes-models---one-group-no-covariates" id="toc-binary-outcomes-models---one-group-no-covariates" class="nav-link" data-scroll-target="#binary-outcomes-models---one-group-no-covariates"><span class="header-section-number">4.1</span> Binary outcomes models - one group, no covariates</a></li>
  <li><a href="#binary-outcomes---general" id="toc-binary-outcomes---general" class="nav-link" data-scroll-target="#binary-outcomes---general"><span class="header-section-number">4.2</span> Binary outcomes - general</a></li>
  <li><a href="#modeling-pi_i-as-a-function-of-x_i" id="toc-modeling-pi_i-as-a-function-of-x_i" class="nav-link" data-scroll-target="#modeling-pi_i-as-a-function-of-x_i"><span class="header-section-number">4.3</span> Modeling <span class="math inline">\(\pi_i\)</span> as a function of <span class="math inline">\(X_i\)</span></a>
  <ul class="collapse">
  <li><a href="#expit-function" id="toc-expit-function" class="nav-link" data-scroll-target="#expit-function"><span class="header-section-number">4.3.1</span> expit function</a></li>
  <li><a href="#odds-function" id="toc-odds-function" class="nav-link" data-scroll-target="#odds-function"><span class="header-section-number">4.3.2</span> odds function</a></li>
  <li><a href="#logit-function" id="toc-logit-function" class="nav-link" data-scroll-target="#logit-function"><span class="header-section-number">4.3.3</span> logit function</a></li>
  </ul></li>
  <li><a href="#sec-expit-logit-diagram" id="toc-sec-expit-logit-diagram" class="nav-link" data-scroll-target="#sec-expit-logit-diagram"><span class="header-section-number">4.4</span> Diagram of expit and logit</a></li>
  <li><a href="#meet-the-beetles" id="toc-meet-the-beetles" class="nav-link" data-scroll-target="#meet-the-beetles"><span class="header-section-number">4.5</span> Meet the beetles</a></li>
  <li><a href="#why-dont-we-use-linear-regression" id="toc-why-dont-we-use-linear-regression" class="nav-link" data-scroll-target="#why-dont-we-use-linear-regression"><span class="header-section-number">4.6</span> Why don’t we use linear regression?</a></li>
  <li><a href="#zoom-out" id="toc-zoom-out" class="nav-link" data-scroll-target="#zoom-out"><span class="header-section-number">4.7</span> Zoom out</a></li>
  <li><a href="#log-transformation-of-dose" id="toc-log-transformation-of-dose" class="nav-link" data-scroll-target="#log-transformation-of-dose"><span class="header-section-number">4.8</span> log transformation of dose?</a></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="header-section-number">4.9</span> Logistic regression</a></li>
  <li><a href="#three-parts-to-regression-models" id="toc-three-parts-to-regression-models" class="nav-link" data-scroll-target="#three-parts-to-regression-models"><span class="header-section-number">4.10</span> Three parts to regression models</a></li>
  <li><a href="#logistic-regression-in-r" id="toc-logistic-regression-in-r" class="nav-link" data-scroll-target="#logistic-regression-in-r"><span class="header-section-number">4.11</span> Logistic regression in R</a></li>
  <li><a href="#individual-observations" id="toc-individual-observations" class="nav-link" data-scroll-target="#individual-observations"><span class="header-section-number">4.12</span> Individual observations</a></li>
  </ul></li>
  <li><a href="#multiple-logistic-regression" id="toc-multiple-logistic-regression" class="nav-link" data-scroll-target="#multiple-logistic-regression"><span class="header-section-number">5</span> Multiple logistic regression</a>
  <ul class="collapse">
  <li><a href="#coronary-heart-disease-wcgs-study-data" id="toc-coronary-heart-disease-wcgs-study-data" class="nav-link" data-scroll-target="#coronary-heart-disease-wcgs-study-data"><span class="header-section-number">5.1</span> Coronary heart disease (WCGS) study data</a>
  <ul class="collapse">
  <li><a href="#summary-of-study" id="toc-summary-of-study" class="nav-link" data-scroll-target="#summary-of-study"><span class="header-section-number">5.1.1</span> Summary of study</a></li>
  <li><a href="#study-design" id="toc-study-design" class="nav-link" data-scroll-target="#study-design"><span class="header-section-number">5.1.2</span> Study design</a></li>
  </ul></li>
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data"><span class="header-section-number">5.2</span> Load the data</a></li>
  <li><a href="#now-lets-do-some-data-cleaning" id="toc-now-lets-do-some-data-cleaning" class="nav-link" data-scroll-target="#now-lets-do-some-data-cleaning"><span class="header-section-number">5.3</span> Now let’s do some data cleaning</a></li>
  <li><a href="#whats-in-the-data" id="toc-whats-in-the-data" class="nav-link" data-scroll-target="#whats-in-the-data"><span class="header-section-number">5.4</span> What’s in the data</a></li>
  <li><a href="#data-by-age-and-personality-type" id="toc-data-by-age-and-personality-type" class="nav-link" data-scroll-target="#data-by-age-and-personality-type"><span class="header-section-number">5.5</span> Data by age and personality type</a></li>
  <li><a href="#graphical-exploration" id="toc-graphical-exploration" class="nav-link" data-scroll-target="#graphical-exploration"><span class="header-section-number">5.6</span> Graphical exploration</a>
  <ul class="collapse">
  <li><a href="#probability-scale" id="toc-probability-scale" class="nav-link" data-scroll-target="#probability-scale"><span class="header-section-number">5.6.1</span> Probability scale</a></li>
  <li><a href="#odds-scale" id="toc-odds-scale" class="nav-link" data-scroll-target="#odds-scale"><span class="header-section-number">5.6.2</span> Odds scale</a></li>
  <li><a href="#log-odds-logit-scale" id="toc-log-odds-logit-scale" class="nav-link" data-scroll-target="#log-odds-logit-scale"><span class="header-section-number">5.6.3</span> Log-odds (logit) scale</a></li>
  </ul></li>
  <li><a href="#logistic-regression-models-for-chd-data" id="toc-logistic-regression-models-for-chd-data" class="nav-link" data-scroll-target="#logistic-regression-models-for-chd-data"><span class="header-section-number">5.7</span> Logistic regression models for CHD data</a></li>
  <li><a href="#models-superimposed-on-data" id="toc-models-superimposed-on-data" class="nav-link" data-scroll-target="#models-superimposed-on-data"><span class="header-section-number">5.8</span> Models superimposed on data</a>
  <ul class="collapse">
  <li><a href="#probability-scale-1" id="toc-probability-scale-1" class="nav-link" data-scroll-target="#probability-scale-1"><span class="header-section-number">5.8.1</span> probability scale</a></li>
  <li><a href="#odds-scale-1" id="toc-odds-scale-1" class="nav-link" data-scroll-target="#odds-scale-1"><span class="header-section-number">5.8.2</span> odds scale</a></li>
  <li><a href="#log-odds-logit-scale-1" id="toc-log-odds-logit-scale-1" class="nav-link" data-scroll-target="#log-odds-logit-scale-1"><span class="header-section-number">5.8.3</span> log-odds (logit) scale</a></li>
  </ul></li>
  <li><a href="#reference-group-and-contrast-parametrization" id="toc-reference-group-and-contrast-parametrization" class="nav-link" data-scroll-target="#reference-group-and-contrast-parametrization"><span class="header-section-number">5.9</span> reference-group and contrast parametrization</a></li>
  </ul></li>
  <li><a href="#fitting-logistic-regression-models" id="toc-fitting-logistic-regression-models" class="nav-link" data-scroll-target="#fitting-logistic-regression-models"><span class="header-section-number">6</span> Fitting logistic regression models</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">6.1</span> </a></li>
  </ul></li>
  <li><a href="#sec-gof" id="toc-sec-gof" class="nav-link" data-scroll-target="#sec-gof"><span class="header-section-number">7</span> Model comparisons for logistic models</a>
  <ul class="collapse">
  <li><a href="#deviance-test" id="toc-deviance-test" class="nav-link" data-scroll-target="#deviance-test"><span class="header-section-number">7.1</span> Deviance test</a></li>
  <li><a href="#hosmer-lemeshow-test" id="toc-hosmer-lemeshow-test" class="nav-link" data-scroll-target="#hosmer-lemeshow-test"><span class="header-section-number">7.2</span> Hosmer-Lemeshow test</a></li>
  <li><a href="#comparing-models" id="toc-comparing-models" class="nav-link" data-scroll-target="#comparing-models"><span class="header-section-number">7.3</span> Comparing models</a></li>
  </ul></li>
  <li><a href="#residual-based-diagnostics" id="toc-residual-based-diagnostics" class="nav-link" data-scroll-target="#residual-based-diagnostics"><span class="header-section-number">8</span> Residual-based diagnostics</a>
  <ul class="collapse">
  <li><a href="#logistic-regression-residuals-only-work-for-grouped-data" id="toc-logistic-regression-residuals-only-work-for-grouped-data" class="nav-link" data-scroll-target="#logistic-regression-residuals-only-work-for-grouped-data"><span class="header-section-number">8.1</span> Logistic regression residuals only work for grouped data</a></li>
  <li><a href="#response-residuals" id="toc-response-residuals" class="nav-link" data-scroll-target="#response-residuals"><span class="header-section-number">8.2</span> (Response) residuals</a></li>
  <li><a href="#pearson-residuals" id="toc-pearson-residuals" class="nav-link" data-scroll-target="#pearson-residuals"><span class="header-section-number">8.3</span> Pearson residuals</a>
  <ul class="collapse">
  <li><a href="#pearson-residuals-plot-for-beetles-data" id="toc-pearson-residuals-plot-for-beetles-data" class="nav-link" data-scroll-target="#pearson-residuals-plot-for-beetles-data"><span class="header-section-number">8.3.1</span> Pearson residuals plot for <code>beetles</code> data</a></li>
  <li><a href="#pearson-residuals-with-individual-ungrouped-data" id="toc-pearson-residuals-with-individual-ungrouped-data" class="nav-link" data-scroll-target="#pearson-residuals-with-individual-ungrouped-data"><span class="header-section-number">8.3.2</span> Pearson residuals with individual (ungrouped) data</a></li>
  <li><a href="#residuals-plot-by-hand-optional-section" id="toc-residuals-plot-by-hand-optional-section" class="nav-link" data-scroll-target="#residuals-plot-by-hand-optional-section"><span class="header-section-number">8.3.3</span> Residuals plot by hand (<em>optional section</em>)</a></li>
  </ul></li>
  <li><a href="#pearson-chi-squared-goodness-of-fit-test" id="toc-pearson-chi-squared-goodness-of-fit-test" class="nav-link" data-scroll-target="#pearson-chi-squared-goodness-of-fit-test"><span class="header-section-number">8.4</span> Pearson chi-squared goodness of fit test</a>
  <ul class="collapse">
  <li><a href="#standardized-pearson-residuals" id="toc-standardized-pearson-residuals" class="nav-link" data-scroll-target="#standardized-pearson-residuals"><span class="header-section-number">8.4.1</span> Standardized Pearson residuals</a></li>
  </ul></li>
  <li><a href="#deviance-residuals" id="toc-deviance-residuals" class="nav-link" data-scroll-target="#deviance-residuals"><span class="header-section-number">8.5</span> Deviance residuals</a>
  <ul class="collapse">
  <li><a href="#standardized-deviance-residuals" id="toc-standardized-deviance-residuals" class="nav-link" data-scroll-target="#standardized-deviance-residuals"><span class="header-section-number">8.5.1</span> Standardized deviance residuals</a></li>
  </ul></li>
  <li><a href="#diagnostic-plots" id="toc-diagnostic-plots" class="nav-link" data-scroll-target="#diagnostic-plots"><span class="header-section-number">8.6</span> Diagnostic plots</a>
  <ul class="collapse">
  <li><a href="#beetles" id="toc-beetles" class="nav-link" data-scroll-target="#beetles"><span class="header-section-number">8.6.1</span> Beetles</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-OR-RR" id="toc-sec-OR-RR" class="nav-link" data-scroll-target="#sec-OR-RR"><span class="header-section-number">9</span> Odds Ratios vs Probability (Risk) Ratios</a>
  <ul class="collapse">
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">9.1</span> </a>
  <ul class="collapse">
  <li><a href="#case-1-rare-events" id="toc-case-1-rare-events" class="nav-link" data-scroll-target="#case-1-rare-events"><span class="header-section-number">9.1.1</span> Case 1: rare events</a></li>
  <li><a href="#case-2-frequent-events" id="toc-case-2-frequent-events" class="nav-link" data-scroll-target="#case-2-frequent-events"><span class="header-section-number">9.1.2</span> Case 2: frequent events</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logistic Regression</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ezra Morrison </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Last modified: 2023-07-07: 16:41:34 (PM)</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="hidden">
<p><span class="math display">\[\def\eqdef{\stackrel{\text{def}}{=}}\]</span></p>
</div>
<section id="acknowledgements" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>This content is adapted from:</p>
<ul>
<li>Dobson &amp; Barnett 2018, “An Introduction to Generalized Linear Models”, 4th edition, Chapter 7</li>
<li>Vittinghoff et al 2012, “Regression Methods in Biostatistics”, 2nd edition, Chapter 5</li>
</ul>
</section>
<section id="configuring-r" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="configuring-r">Configuring R</h2>
<p>Functions from these packages will be used throughout this document:</p>
<div class="cell" data-hash="logistic-regression_cache/html/packages_51e4581a5df176bedc6f4b4b79dad5f0">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander) <span class="co"># format tables for markdown</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># graphics</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co"># help with graphics</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># manipulate data</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co"># import Stata files</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># format R output for markdown</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># Tools to help to create tidy data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># interactive graphics</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dobson) <span class="co"># datasets from Dobson and Barnett 2018</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co"># format model output tables for markdown</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted) <span class="co"># check for conflicting function definitions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here are some R settings I use in this document:</p>
<div class="cell" data-hash="logistic-regression_cache/html/options_5a859f14e7fb4b394a1cd4edd3dbdfd2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># delete any data that's already loaded into R</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">panderOptions</span>(<span class="st">"table.emphasize.rownames"</span>, <span class="cn">FALSE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">'digits'</span> <span class="ot">=</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="introduction-to-logistic-regression" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Introduction to logistic regression</h1>
<section id="binary-outcomes-models---one-group-no-covariates" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="binary-outcomes-models---one-group-no-covariates"><span class="header-section-number">4.1</span> Binary outcomes models - one group, no covariates</h2>
<p><span class="math display">\[
\begin{aligned}
p(Y=1) &amp;= \pi\\
p(Y=0) &amp;= 1-\pi\\
p(Y=y) &amp;= \pi^y (1-\pi)^{1-y}\\
\mathbf y  &amp;= (y_1, ..., y_n)\\
\mathcal L(\pi;\mathbf y) &amp;= \pi^{\sum y_i} (1-\pi)^{n - \sum y_i}\\
\ell(\pi, \mathbf y) &amp;= \left({\sum y_i}\right) \log \pi + \left(n - \sum y_i\right) \log (1-\pi)\\
&amp;= \left({\sum y_i}\right) \left(\log \pi - \log (1-\pi)\right) + n \cdot \log (1-\pi)\\
&amp;= \left({\sum y_i}\right) \log \left( \frac{\pi}{ 1-\pi}\right) + n \cdot \log (1-\pi)
\end{aligned}
\]</span></p>
</section>
<section id="binary-outcomes---general" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="binary-outcomes---general"><span class="header-section-number">4.2</span> Binary outcomes - general</h2>
<p><span class="math display">\[
\begin{aligned}
p(Y_i=1) &amp;= \pi_i\\
p(Y_i=0) &amp;= 1-\pi_i\\
p(Y_i=y) &amp;= (\pi_i)^y (1-\pi_i)^{1-y}\\
\mathbf y  &amp;= (y_1, ..., y_n)\\
\mathcal L(\pi;\mathbf y) &amp;= \prod_{i=1}^n
(\pi_i)^{y_i} (1-\pi_i)^{1 - y_i}\\
\ell(\pi, \mathbf y) &amp;=
\sum_{i=1}^n
y_i \log \pi_i + (1 - y_i) \log (1-\pi_i)
\end{aligned}
\]</span></p>
</section>
<section id="modeling-pi_i-as-a-function-of-x_i" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="modeling-pi_i-as-a-function-of-x_i"><span class="header-section-number">4.3</span> Modeling <span class="math inline">\(\pi_i\)</span> as a function of <span class="math inline">\(X_i\)</span></h2>
<p>If there are only a few distinct <span class="math inline">\(X_i\)</span> values, we can model each one separately.</p>
<p>Otherwise, we need regression.</p>
<p><span class="math display">\[
\begin{aligned}
\pi(x) &amp;\equiv \text{E}(Y=1|X=x)\\
&amp;= f(x^\top\beta)
\end{aligned}
\]</span></p>
<section id="expit-function" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="expit-function"><span class="header-section-number">4.3.1</span> expit function</h3>
<p>Typically, we use</p>
<p><span class="math display">\[
\begin{aligned}
f(\eta) &amp;= \text{expit}(\eta)\\
&amp;\eqdef \frac{\exp(\eta)}{1+\exp(\eta)}\\
&amp;= (1 + \exp\{-\eta\})^{-1}
\end{aligned}
\]</span></p>
<p>This function is called the “expit”, “inverse-logit”, or “logistic” function.</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-1_274946cd6715f2ce32bbec25e6033d40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>expit <span class="ot">=</span> <span class="cf">function</span>(eta) <span class="fu">exp</span>(eta)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(eta))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>expit_plot <span class="ot">=</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> expit) <span class="sc">+</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">expit</span>(eta))) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(eta)) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-2_5ce0c78cc893584a2930099708eb7cd5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expit_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The inverse of the <code>expit</code> function is the <code>logit</code> function:</p>
<p><span class="math display">\[g(p) = f^{-1}(p) = \text{logit}(p) = \log \left\{\frac{p}{1-p}\right\}\]</span></p>
</section>
<section id="odds-function" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="odds-function"><span class="header-section-number">4.3.2</span> odds function</h3>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-4_d638f97316db2e7ef26d7da0d48f7330">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">=</span> <span class="cf">function</span>(p) p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>odds_plot <span class="ot">=</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> odds) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, .<span class="dv">99</span>) <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"odds(p)"</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"p"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-5_9f5cbeb96b6f339b798da24a3b2f0ebb">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(odds_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="logit-function" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="logit-function"><span class="header-section-number">4.3.3</span> logit function</h3>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-7_9839d8204fa2f916e548ae108ff935c0">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">=</span> <span class="cf">function</span>(p) <span class="fu">log</span>(<span class="fu">odds</span>(p))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>logit_plot <span class="ot">=</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> logit) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(.<span class="dv">01</span>, .<span class="dv">99</span>) <span class="sc">+</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"logit(p)"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"p"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-8_d6e6636fd533e4f0fd62e669cfa1361f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(logit_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="sec-expit-logit-diagram" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-expit-logit-diagram"><span class="header-section-number">4.4</span> Diagram of expit and logit</h2>
<p><span class="math display">\[
\underbrace{\pi}_{\atop{\Pr(Y=1)} }
\overbrace{
\underbrace{
\underset{
\xleftarrow[\frac{\omega}{1+\omega}]{}
}
{
\xrightarrow{\frac{\pi}{1-\pi}}
}
\underbrace{\omega}_{\text{odds}(Y=1)}
\underset{
\xleftarrow[\exp\{\eta\}]{}
}
{
\xrightarrow{\log\{\omega\}}
}
}_{\text{expit}(\eta)}
}^{\text{logit}(\pi)}
\underbrace{\eta}_{\atop{\text{log-odds}(Y=1)}}
\]</span></p>
</section>
<section id="meet-the-beetles" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="meet-the-beetles"><span class="header-section-number">4.5</span> Meet the beetles</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-10_90e363753ccfb8461e5c69974db96d21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmx)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(BeetleMortality, <span class="at">package =</span> <span class="st">"glmx"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>beetles <span class="ot">=</span> BeetleMortality <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct =</span> died<span class="sc">/</span>n,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">survived =</span> n <span class="sc">-</span> died</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">=</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  beetles <span class="sc">|&gt;</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> pct)) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n)) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Dose (log mg/L)"</span>) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mortality rate (%)"</span>) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Mortality rates of adult flour beetles after five hours’ exposure to gaseous carbon disulphide (Bliss 1935)</p>
</section>
<section id="why-dont-we-use-linear-regression" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="why-dont-we-use-linear-regression"><span class="header-section-number">4.6</span> Why don’t we use linear regression?</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-11_6c579720cf7a7dd1ad9aeaadea6d3596">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="ot">=</span> beetles <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">formula =</span> <span class="fu">cbind</span>(died, survived) <span class="sc">~</span> dose, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">=</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  beetles  <span class="sc">|&gt;</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">everything</span>(),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">c</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> died), </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> survived))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> outcome <span class="sc">~</span> dose, </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">=</span> </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  beetles  <span class="sc">|&gt;</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">everything</span>(),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">c</span>(</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> died), </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> survived))</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> outcome <span class="sc">~</span> <span class="fu">log</span>(dose), </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>range1 <span class="ot">=</span> <span class="fu">range</span>(beetles<span class="sc">$</span>dose) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, .<span class="dv">2</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">predict</span>(beetles_glm_grouped, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> x), <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>f.linear <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">predict</span>(lm1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> x))</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>f.linearlog <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">predict</span>(lm2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> x))</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">=</span> </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="sc">+</span> </span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> f.linear, </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Straight line"</span>)) <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Model"</span>, <span class="at">size =</span> <span class="st">""</span>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>plot2 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="zoom-out" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="zoom-out"><span class="header-section-number">4.7</span> Zoom out</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-12_f8c815dcb4fcae9bc762a3dd4d0923d1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(plot2 <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">2</span>))) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="log-transformation-of-dose" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="log-transformation-of-dose"><span class="header-section-number">4.8</span> log transformation of dose?</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-13_e25109a867ed6550af58426597537cb7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">=</span> plot2 <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> f.linearlog, <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Log-transform dose"</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>(plot3 <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">2</span>))) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="logistic-regression" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">4.9</span> Logistic regression</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-14_e46997ef20c906e7bd9dc4f6b215430c">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">=</span> plot3 <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> f, <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Logistic regression"</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plot4 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="three-parts-to-regression-models" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="three-parts-to-regression-models"><span class="header-section-number">4.10</span> Three parts to regression models</h2>
<ul>
<li><p>What distribution does the outcome have for a specific subpopulation defined by covariates? (outcome model)</p></li>
<li><p>How does the combination of covariates relate to the mean? (link function)</p></li>
<li><p>How do the covariates combine? (linear predictor, interactions)</p></li>
</ul>
</section>
<section id="logistic-regression-in-r" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="logistic-regression-in-r"><span class="header-section-number">4.11</span> Logistic regression in R</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-15_5fba08cda7ab9801cb1ee6f9470d10bd">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="ot">=</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  beetles <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">cbind</span>(died, survived) <span class="sc">~</span> dose, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="sc">|&gt;</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Odds</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-60.72</td>
<td style="text-align: center;">5.18</td>
<td style="text-align: center;">(-71.44, -51.08)</td>
<td style="text-align: center;">-11.72</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dose</td>
<td style="text-align: center;">34.27</td>
<td style="text-align: center;">2.91</td>
<td style="text-align: center;">(28.85, 40.30)</td>
<td style="text-align: center;">11.77</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Fitted values:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-16_0692601afe747a4f3295195d3791b787">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted.values</span>(beetles_glm_grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     1      2      3      4      5      6      7      8 
0.0586 0.1640 0.3621 0.6053 0.7952 0.9032 0.9552 0.9790 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(beetles_glm_grouped, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     1      2      3      4      5      6      7      8 
0.0586 0.1640 0.3621 0.6053 0.7952 0.9032 0.9552 0.9790 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(beetles_glm_grouped, <span class="at">type =</span> <span class="st">"link"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      1       2       3       4       5       6       7       8 
-2.7766 -1.6286 -0.5662  0.4277  1.3564  2.2337  3.0596  3.8444 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fit_y <span class="ot">=</span> beetles<span class="sc">$</span>n <span class="sc">*</span> <span class="fu">fitted.values</span>(beetles_glm_grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="individual-observations" class="level2" data-number="4.12">
<h2 data-number="4.12" class="anchored" data-anchor-id="individual-observations"><span class="header-section-number">4.12</span> Individual observations</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-17_505464e1741b47596f74c7d3596b1977">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>beetles_long <span class="ot">=</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  beetles  <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">everything</span>(),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">c</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> died), </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> survived))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>beetles_long <span class="sc">|&gt;</span> <span class="fu">tibble</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 481 × 6
    dose  died     n   pct survived outcome
   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;    &lt;int&gt;   &lt;dbl&gt;
 1  1.69     6    59 0.102       53       1
 2  1.69     6    59 0.102       53       1
 3  1.69     6    59 0.102       53       1
 4  1.69     6    59 0.102       53       1
 5  1.69     6    59 0.102       53       1
 6  1.69     6    59 0.102       53       1
 7  1.69     6    59 0.102       53       0
 8  1.69     6    59 0.102       53       0
 9  1.69     6    59 0.102       53       0
10  1.69     6    59 0.102       53       0
# ℹ 471 more rows</code></pre>
</div>
</div>
<p>Here’s the model with individual data</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-18_5c93036985153591b4e1abe59a8242cc">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>beetles_glm_ungrouped <span class="ot">=</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  beetles_long <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> outcome <span class="sc">~</span> dose, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>beetles_glm_ungrouped <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Odds</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-60.72</td>
<td style="text-align: center;">5.18</td>
<td style="text-align: center;">(-71.44, -51.08)</td>
<td style="text-align: center;">-11.72</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dose</td>
<td style="text-align: center;">34.27</td>
<td style="text-align: center;">2.91</td>
<td style="text-align: center;">(28.85, 40.30)</td>
<td style="text-align: center;">11.77</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here’s the previous version again:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-19_c7bbff0b22bddcb322767696006c539e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Odds</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-60.72</td>
<td style="text-align: center;">5.18</td>
<td style="text-align: center;">(-71.44, -51.08)</td>
<td style="text-align: center;">-11.72</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dose</td>
<td style="text-align: center;">34.27</td>
<td style="text-align: center;">2.91</td>
<td style="text-align: center;">(28.85, 40.30)</td>
<td style="text-align: center;">11.77</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>They seem the same! But not quite:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-20_eae0915eff70398ffb36722039396f24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(beetles_glm_grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -18.72 (df=2)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(beetles_glm_ungrouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -186.2 (df=2)</code></pre>
</div>
</div>
<p>The difference is due to the binomial coefficient <span class="math inline">\(\left(n\atop x \right)\)</span> which isn’t included in the individual-observations (Bernoulli) version of the model.</p>
</section>
</section>
<section id="multiple-logistic-regression" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Multiple logistic regression</h1>
<section id="coronary-heart-disease-wcgs-study-data" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="coronary-heart-disease-wcgs-study-data"><span class="header-section-number">5.1</span> Coronary heart disease (WCGS) study data</h2>
<p>Let’s use the data from the following study to explore multiple logistic regression:</p>
<section id="summary-of-study" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="summary-of-study"><span class="header-section-number">5.1.1</span> Summary of study</h3>
<p><em>From Vittinghoff et al 2012:</em></p>
<p>“The <strong>Western Collaborative Group Study (WCGS)</strong> was a large epidemiological study designed to investigate the association between the”type A” behavior pattern and coronary heart disease (CHD) (Rosenman et al.&nbsp;1964).”</p>
<p><em>From Wikipedia, “Type A and Type B personality theory”:</em></p>
<p>“The hypothesis describes Type A individuals as outgoing, ambitious, rigidly organized, highly status-conscious, impatient, anxious, proactive, and concerned with time management….</p>
<p>The hypothesis describes Type B individuals as a contrast to those of Type A. Type B personalities, by definition, are noted to live at lower stress levels. They typically work steadily and may enjoy achievement, although they have a greater tendency to disregard physical or mental stress when they do not achieve.”</p>
</section>
<section id="study-design" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="study-design"><span class="header-section-number">5.1.2</span> Study design</h3>
<p><em>from <code>?faraway::wcgs</code>:</em></p>
<p>3154 healthy young men aged 39-59 from the San Francisco area were assessed for their personality type. All were free from coronary heart disease at the start of the research. Eight and a half years later change in CHD status was recorded.</p>
<p><em>Details (from <code>faraway::wcgs</code>)</em></p>
<p>The WCGS began in 1960 with 3,524 male volunteers who were employed by 11 California companies. Subjects were 39 to 59 years old and free of heart disease as determined by electrocardiogram. After the initial screening, the study population dropped to 3,154 and the number of companies to 10 because of various exclusions. The cohort comprised both blue- and white-collar employees.</p>
<p>At baseline the following information was collected:</p>
<ul>
<li>socio-demographic including:</li>
<li>age</li>
<li>education</li>
<li>marital status</li>
<li>income</li>
<li>occupation</li>
<li>physical and physiological including:</li>
<li>height</li>
<li>weight</li>
<li>blood pressure</li>
<li>electrocardiogram</li>
<li>corneal arcus;</li>
<li>biochemical including:</li>
<li>cholesterol and lipoprotein fractions;</li>
<li>medical and family history and use of medications;</li>
<li>behavioral data including</li>
<li>Type A interview,</li>
<li>smoking,</li>
<li>exercise</li>
<li>alcohol use.</li>
</ul>
<p>Later surveys added data on: * anthropometry * triglycerides * Jenkins Activity Survey * caffeine use.</p>
<p>Average follow-up continued for 8.5 years with repeat examinations.</p>
<p>Reference: Coronary Heart Disease in the Western Collaborative Group Study Final Follow-up Experience of 8 1/2 Years Ray H. Rosenman, MD; Richard J. Brand, PhD; C. David Jenkins, PhD; Meyer Friedman, MD; Reuben Straus, MD; Moses Wurm, MD JAMA. 1975;233(8):872-877. doi:10.1001/jama.1975.03260080034016.</p>
</section>
</section>
<section id="load-the-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="load-the-data"><span class="header-section-number">5.2</span> Load the data</h2>
<p>Here, I load the data:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-21_44b7a0c1a48aec21dba29e7fb2cbc2d9">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load the data directly from a UCSF website:</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(haven)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># url = paste0( </span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     # I'm breaking up the url into two chunks for readability</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     "https://regression.ucsf.edu/sites/g/files/",</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     "tkssra6706/f/wysiwyg/home/data/wcgs.dta")</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># wcgs = haven::read_dta(url)</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># I presaved the data in my project's `data` folder</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># provides the `here()` function</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs) <span class="co"># provides the `path()` function</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">here</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">path</span>(<span class="st">'data/wcgs.rda'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="now-lets-do-some-data-cleaning" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="now-lets-do-some-data-cleaning"><span class="header-section-number">5.3</span> Now let’s do some data cleaning</h2>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-22_69676200614a8daef5bfb28ec851d3bf">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arsenal) <span class="co"># provides `set_labels()`</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>wcgs <span class="ot">=</span> wcgs <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> age <span class="sc">|&gt;</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Age (years)"</span>),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">arcus =</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>      arcus <span class="sc">|&gt;</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.logical</span>() <span class="sc">|&gt;</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Arcus Senilis"</span>),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">time169 =</span> </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>      time169 <span class="sc">|&gt;</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>() <span class="sc">|&gt;</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Observation (follow up) time (days)"</span>),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">dibpat =</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>      dibpat <span class="sc">|&gt;</span> </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_factor</span>() <span class="sc">|&gt;</span> </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">relevel</span>(<span class="at">ref =</span> <span class="st">"Type A"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Behavioral Pattern"</span>),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">typchd69 =</span> typchd69 <span class="sc">|&gt;</span> </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labelled</span>(</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Type of CHD Event"</span>,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">"None"</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">"infdeath"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">"silent"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">"angina"</span> <span class="ot">=</span> <span class="dv">3</span>)),</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># turn stata-style labelled variables in to R-style factors:</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">where</span>(is.labelled), </span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>      haven<span class="sc">::</span>as_factor)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="whats-in-the-data" class="level2 smaller" data-number="5.4">
<h2 class="smaller anchored" data-number="5.4" data-anchor-id="whats-in-the-data"><span class="header-section-number">5.4</span> What’s in the data</h2>
<p>Here’s a table of the data:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-23_cea71cda8f2dceecb283c1856912a481">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>wcgs <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(id, uni, t1)) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tableby</span>(chd69 <span class="sc">~</span> ., <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pfootnote =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Baseline characteristics by CHD status at end of follow-up"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-sm table-striped small">
<caption>Baseline characteristics by CHD status at end of follow-up</caption>
<colgroup>
<col style="width: 36%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">No (N=2897)</th>
<th style="text-align: center;">Yes (N=257)</th>
<th style="text-align: center;">Total (N=3154)</th>
<th style="text-align: right;">p value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Age (years)</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">46.082 (5.457)</td>
<td style="text-align: center;">48.490 (5.801)</td>
<td style="text-align: center;">46.279 (5.524)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">39.000 - 59.000</td>
<td style="text-align: center;">39.000 - 59.000</td>
<td style="text-align: center;">39.000 - 59.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Arcus Senilis</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>2</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;N-Miss</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;FALSE</td>
<td style="text-align: center;">2058 (71.0%)</td>
<td style="text-align: center;">153 (60.0%)</td>
<td style="text-align: center;">2211 (70.1%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;TRUE</td>
<td style="text-align: center;">839 (29.0%)</td>
<td style="text-align: center;">102 (40.0%)</td>
<td style="text-align: center;">941 (29.9%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Behavioral Pattern</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>2</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;A1</td>
<td style="text-align: center;">234 (8.1%)</td>
<td style="text-align: center;">30 (11.7%)</td>
<td style="text-align: center;">264 (8.4%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;A2</td>
<td style="text-align: center;">1177 (40.6%)</td>
<td style="text-align: center;">148 (57.6%)</td>
<td style="text-align: center;">1325 (42.0%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;B3</td>
<td style="text-align: center;">1155 (39.9%)</td>
<td style="text-align: center;">61 (23.7%)</td>
<td style="text-align: center;">1216 (38.6%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;B4</td>
<td style="text-align: center;">331 (11.4%)</td>
<td style="text-align: center;">18 (7.0%)</td>
<td style="text-align: center;">349 (11.1%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Body Mass Index (kg/m2)</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">24.471 (2.561)</td>
<td style="text-align: center;">25.055 (2.579)</td>
<td style="text-align: center;">24.518 (2.567)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">11.191 - 37.653</td>
<td style="text-align: center;">19.225 - 38.947</td>
<td style="text-align: center;">11.191 - 38.947</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total Cholesterol</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;N-Miss</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">12</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">224.261 (42.217)</td>
<td style="text-align: center;">250.070 (49.396)</td>
<td style="text-align: center;">226.372 (43.420)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">103.000 - 400.000</td>
<td style="text-align: center;">155.000 - 645.000</td>
<td style="text-align: center;">103.000 - 645.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Diastolic Blood Pressure</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">81.723 (9.621)</td>
<td style="text-align: center;">85.315 (10.311)</td>
<td style="text-align: center;">82.016 (9.727)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">58.000 - 150.000</td>
<td style="text-align: center;">64.000 - 122.000</td>
<td style="text-align: center;">58.000 - 150.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Behavioral Pattern</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>2</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Type A</td>
<td style="text-align: center;">1411 (48.7%)</td>
<td style="text-align: center;">178 (69.3%)</td>
<td style="text-align: center;">1589 (50.4%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Type B</td>
<td style="text-align: center;">1486 (51.3%)</td>
<td style="text-align: center;">79 (30.7%)</td>
<td style="text-align: center;">1565 (49.6%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Height (inches)</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">0.290<sup>1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">69.764 (2.539)</td>
<td style="text-align: center;">69.938 (2.410)</td>
<td style="text-align: center;">69.778 (2.529)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">60.000 - 78.000</td>
<td style="text-align: center;">63.000 - 77.000</td>
<td style="text-align: center;">60.000 - 78.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Ln of Systolic Blood Pressure</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">4.846 (0.110)</td>
<td style="text-align: center;">4.900 (0.125)</td>
<td style="text-align: center;">4.850 (0.112)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">4.585 - 5.438</td>
<td style="text-align: center;">4.605 - 5.298</td>
<td style="text-align: center;">4.585 - 5.438</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Ln of Weight</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">5.126 (0.123)</td>
<td style="text-align: center;">5.155 (0.118)</td>
<td style="text-align: center;">5.128 (0.123)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">4.357 - 5.670</td>
<td style="text-align: center;">4.868 - 5.768</td>
<td style="text-align: center;">4.357 - 5.768</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Cigarettes per day</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">11.151 (14.329)</td>
<td style="text-align: center;">16.665 (15.657)</td>
<td style="text-align: center;">11.601 (14.518)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">0.000 - 99.000</td>
<td style="text-align: center;">0.000 - 60.000</td>
<td style="text-align: center;">0.000 - 99.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Systolic Blood Pressure</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">128.034 (14.746)</td>
<td style="text-align: center;">135.385 (17.473)</td>
<td style="text-align: center;">128.633 (15.118)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">98.000 - 230.000</td>
<td style="text-align: center;">100.000 - 200.000</td>
<td style="text-align: center;">98.000 - 230.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Current smoking</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>2</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;No</td>
<td style="text-align: center;">1554 (53.6%)</td>
<td style="text-align: center;">98 (38.1%)</td>
<td style="text-align: center;">1652 (52.4%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Yes</td>
<td style="text-align: center;">1343 (46.4%)</td>
<td style="text-align: center;">159 (61.9%)</td>
<td style="text-align: center;">1502 (47.6%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Observation (follow up) time (days)</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">2775.158 (562.205)</td>
<td style="text-align: center;">1654.700 (859.297)</td>
<td style="text-align: center;">2683.859 (666.524)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">238.000 - 3430.000</td>
<td style="text-align: center;">18.000 - 3229.000</td>
<td style="text-align: center;">18.000 - 3430.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Type of CHD Event</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;None</td>
<td style="text-align: center;">0 (0.0%)</td>
<td style="text-align: center;">0 (0.0%)</td>
<td style="text-align: center;">0 (0.0%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;infdeath</td>
<td style="text-align: center;">2897 (100.0%)</td>
<td style="text-align: center;">0 (0.0%)</td>
<td style="text-align: center;">2897 (91.9%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;silent</td>
<td style="text-align: center;">0 (0.0%)</td>
<td style="text-align: center;">135 (52.5%)</td>
<td style="text-align: center;">135 (4.3%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;angina</td>
<td style="text-align: center;">0 (0.0%)</td>
<td style="text-align: center;">71 (27.6%)</td>
<td style="text-align: center;">71 (2.3%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;4</td>
<td style="text-align: center;">0 (0.0%)</td>
<td style="text-align: center;">51 (19.8%)</td>
<td style="text-align: center;">51 (1.6%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Weight (lbs)</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>1</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Mean (SD)</td>
<td style="text-align: center;">169.554 (21.010)</td>
<td style="text-align: center;">174.463 (21.573)</td>
<td style="text-align: center;">169.954 (21.096)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;Range</td>
<td style="text-align: center;">78.000 - 290.000</td>
<td style="text-align: center;">130.000 - 320.000</td>
<td style="text-align: center;">78.000 - 320.000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Weight Category</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>2</sup></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;&lt; 140</td>
<td style="text-align: center;">217 (7.5%)</td>
<td style="text-align: center;">15 (5.8%)</td>
<td style="text-align: center;">232 (7.4%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;140-170</td>
<td style="text-align: center;">1440 (49.7%)</td>
<td style="text-align: center;">98 (38.1%)</td>
<td style="text-align: center;">1538 (48.8%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;170-200</td>
<td style="text-align: center;">1049 (36.2%)</td>
<td style="text-align: center;">122 (47.5%)</td>
<td style="text-align: center;">1171 (37.1%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;&gt; 200</td>
<td style="text-align: center;">191 (6.6%)</td>
<td style="text-align: center;">22 (8.6%)</td>
<td style="text-align: center;">213 (6.8%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>RECODE of age (Age)</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;">&lt; 0.001<sup>2</sup></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;35-40</td>
<td style="text-align: center;">512 (17.7%)</td>
<td style="text-align: center;">31 (12.1%)</td>
<td style="text-align: center;">543 (17.2%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;41-45</td>
<td style="text-align: center;">1036 (35.8%)</td>
<td style="text-align: center;">55 (21.4%)</td>
<td style="text-align: center;">1091 (34.6%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;46-50</td>
<td style="text-align: center;">680 (23.5%)</td>
<td style="text-align: center;">70 (27.2%)</td>
<td style="text-align: center;">750 (23.8%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;51-55</td>
<td style="text-align: center;">463 (16.0%)</td>
<td style="text-align: center;">65 (25.3%)</td>
<td style="text-align: center;">528 (16.7%)</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&nbsp;&nbsp;&nbsp;56-60</td>
<td style="text-align: center;">206 (7.1%)</td>
<td style="text-align: center;">36 (14.0%)</td>
<td style="text-align: center;">242 (7.7%)</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<ol type="1">
<li>Linear Model ANOVA</li>
<li>Pearson’s Chi-squared test</li>
</ol>
</div>
</section>
<section id="data-by-age-and-personality-type" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="data-by-age-and-personality-type"><span class="header-section-number">5.5</span> Data by age and personality type</h2>
<p>For now, we will look at the interaction between age and personality type (<code>dibpat</code>). To make it easier to visualize the data, we summarize the event rates for each combination of age:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-24_8125403aa0a03601feea4e4894a9a8bd">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>chd_grouped_data <span class="ot">=</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(age, dibpat),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labelled</span>(<span class="at">label =</span> <span class="st">"CHD Event by 1969"</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">odds(chd)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">logit(chd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">log</span>(<span class="st">`</span><span class="at">odds(chd)</span><span class="st">`</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>chd_grouped_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 42 × 6
     age dibpat     n `p(chd)`  `odds(chd)` `logit(chd)`
   &lt;dbl&gt; &lt;fct&gt;  &lt;int&gt; &lt;dbl+lbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
 1    50 Type A    76 0.105          0.118         -2.14
 2    51 Type A    67 0.164          0.196         -1.63
 3    59 Type A    30 0.233          0.304         -1.19
 4    44 Type A   113 0.0796         0.0865        -2.45
 5    47 Type A    72 0.0972         0.108         -2.23
 6    40 Type A   133 0.0677         0.0726        -2.62
 7    41 Type A   108 0.0648         0.0693        -2.67
 8    43 Type A    97 0.0722         0.0778        -2.55
 9    54 Type A    53 0.132          0.152         -1.88
10    48 Type A    80 0.15           0.176         -1.73
# ℹ 32 more rows</code></pre>
</div>
</div>
</section>
<section id="graphical-exploration" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="graphical-exploration"><span class="header-section-number">5.6</span> Graphical exploration</h2>
<section id="probability-scale" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="probability-scale"><span class="header-section-number">5.6.1</span> Probability scale</h3>
<div class="cell" data-hash="logistic-regression_cache/html/graphical exploration_b621e3c24ed78f8879c4334069d3d0dd">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>chd_plot_probs <span class="ot">=</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  chd_grouped_data <span class="sc">|&gt;</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age, </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span>, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> dibpat)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"P(CHD Event by 1969)"</span>) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  ggeasy<span class="sc">::</span><span class="fu">easy_labs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-25_69fe9f7441f7190db4d7115f67c5dade">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_probs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e6d0ac24894dc6f9f487" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e6d0ac24894dc6f9f487">{"x":{"data":[{"x":[50,51,59,44,47,40,41,43,54,48,39,49,55,56,42,45,46,57,53,52,58],"y":[0.10526315789473684,0.16417910447761194,0.23333333333333334,0.079646017699115043,0.097222222222222224,0.067669172932330823,0.064814814814814811,0.072164948453608241,0.13207547169811321,0.14999999999999999,0.0859375,0.23880597014925373,0.16363636363636364,0.24489795918367346,0.039603960396039604,0.090909090909090912,0.065934065934065936,0.12903225806451613,0.11290322580645161,0.20000000000000001,0.14705882352941177],"text":["age: 50<br />p(chd): 0.105263<br />dibpat: Type A<br />n:  76","age: 51<br />p(chd): 0.164179<br />dibpat: Type A<br />n:  67","age: 59<br />p(chd): 0.233333<br />dibpat: Type A<br />n:  30","age: 44<br />p(chd): 0.079646<br />dibpat: Type A<br />n: 113","age: 47<br />p(chd): 0.097222<br />dibpat: Type A<br />n:  72","age: 40<br />p(chd): 0.067669<br />dibpat: Type A<br />n: 133","age: 41<br />p(chd): 0.064815<br />dibpat: Type A<br />n: 108","age: 43<br />p(chd): 0.072165<br />dibpat: Type A<br />n:  97","age: 54<br />p(chd): 0.132075<br />dibpat: Type A<br />n:  53","age: 48<br />p(chd): 0.150000<br />dibpat: Type A<br />n:  80","age: 39<br />p(chd): 0.085938<br />dibpat: Type A<br />n: 128","age: 49<br />p(chd): 0.238806<br />dibpat: Type A<br />n:  67","age: 55<br />p(chd): 0.163636<br />dibpat: Type A<br />n:  55","age: 56<br />p(chd): 0.244898<br />dibpat: Type A<br />n:  49","age: 42<br />p(chd): 0.039604<br />dibpat: Type A<br />n: 101","age: 45<br />p(chd): 0.090909<br />dibpat: Type A<br />n:  77","age: 46<br />p(chd): 0.065934<br />dibpat: Type A<br />n:  91","age: 57<br />p(chd): 0.129032<br />dibpat: Type A<br />n:  31","age: 53<br />p(chd): 0.112903<br />dibpat: Type A<br />n:  62","age: 52<br />p(chd): 0.200000<br />dibpat: Type A<br />n:  65","age: 58<br />p(chd): 0.147059<br />dibpat: Type A<br />n:  34"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.69999999999999996,"size":[11.507808770054302,10.893987081881484,7.4072043526108828,13.637611848597116,11.241235656543804,14.615949458394798,13.377458191723871,12.778686124337518,9.8163466467363971,11.765488567001361,14.379833505125502,10.893987081881484,9.9817695786372642,9.4710951773162115,13.000921034406357,11.573027489273997,12.434641120809431,7.5441456810618819,10.52889648301692,10.750245809698832,7.9279346825975772],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[45,41,47,39,49,51,42,50,44,56,40,58,48,43,53,54,46,52,55,57,59],"y":[0.045871559633027525,0.040000000000000001,0.013333333333333334,0.057971014492753624,0.074626865671641784,0.10714285714285714,0.0082644628099173556,0.050847457627118647,0.032786885245901641,0,0.020833333333333332,0.045454545454545456,0.083333333333333329,0.050847457627118647,0.11627906976744186,0.07407407407407407,0.063291139240506333,0.041666666666666664,0.040000000000000001,0.09375,0.23529411764705882],"text":["age: 45<br />p(chd): 0.045872<br />dibpat: Type B<br />n: 109","age: 41<br />p(chd): 0.040000<br />dibpat: Type B<br />n: 125","age: 47<br />p(chd): 0.013333<br />dibpat: Type B<br />n:  75","age: 39<br />p(chd): 0.057971<br />dibpat: Type B<br />n: 138","age: 49<br />p(chd): 0.074627<br />dibpat: Type B<br />n:  67","age: 51<br />p(chd): 0.107143<br />dibpat: Type B<br />n:  56","age: 42<br />p(chd): 0.008264<br />dibpat: Type B<br />n: 121","age: 50<br />p(chd): 0.050847<br />dibpat: Type B<br />n:  59","age: 44<br />p(chd): 0.032787<br />dibpat: Type B<br />n: 122","age: 56<br />p(chd): 0.000000<br />dibpat: Type B<br />n:  27","age: 40<br />p(chd): 0.020833<br />dibpat: Type B<br />n: 144","age: 58<br />p(chd): 0.045455<br />dibpat: Type B<br />n:  22","age: 48<br />p(chd): 0.083333<br />dibpat: Type B<br />n:  84","age: 43<br />p(chd): 0.050847<br />dibpat: Type B<br />n: 118","age: 53<br />p(chd): 0.116279<br />dibpat: Type B<br />n:  43","age: 54<br />p(chd): 0.074074<br />dibpat: Type B<br />n:  54","age: 46<br />p(chd): 0.063291<br />dibpat: Type B<br />n:  79","age: 52<br />p(chd): 0.041667<br />dibpat: Type B<br />n:  48","age: 55<br />p(chd): 0.040000<br />dibpat: Type B<br />n:  25","age: 57<br />p(chd): 0.093750<br />dibpat: Type B<br />n:  32","age: 59<br />p(chd): 0.235294<br />dibpat: Type B<br />n:  17"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.69999999999999996,"size":[13.430049986134389,14.235604935020691,11.442034967876614,14.847029219804128,10.893987081881484,10.062848078932257,14.040147001760529,10.300037417465363,14.089358888134319,6.9612105822972117,15.118110236220474,6.0293172003757194,12.015109867829196,13.89107438878934,8.9098372804078227,9.8996170505112442,11.701854397452983,9.3814585892624311,6.6253113681856641,7.6762775241645578,3.7795275590551185],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.0859375,0.067669172932330823,0.064814814814814811,0.039603960396039604,0.072164948453608241,0.079646017699115043,0.090909090909090912,0.065934065934065936,0.097222222222222224,0.14999999999999999,0.23880597014925373,0.10526315789473684,0.16417910447761194,0.20000000000000001,0.11290322580645161,0.13207547169811321,0.16363636363636364,0.24489795918367346,0.12903225806451613,0.14705882352941177,0.23333333333333334],"text":["age: 39<br />p(chd): 0.085938<br />dibpat: Type A","age: 40<br />p(chd): 0.067669<br />dibpat: Type A","age: 41<br />p(chd): 0.064815<br />dibpat: Type A","age: 42<br />p(chd): 0.039604<br />dibpat: Type A","age: 43<br />p(chd): 0.072165<br />dibpat: Type A","age: 44<br />p(chd): 0.079646<br />dibpat: Type A","age: 45<br />p(chd): 0.090909<br />dibpat: Type A","age: 46<br />p(chd): 0.065934<br />dibpat: Type A","age: 47<br />p(chd): 0.097222<br />dibpat: Type A","age: 48<br />p(chd): 0.150000<br />dibpat: Type A","age: 49<br />p(chd): 0.238806<br />dibpat: Type A","age: 50<br />p(chd): 0.105263<br />dibpat: Type A","age: 51<br />p(chd): 0.164179<br />dibpat: Type A","age: 52<br />p(chd): 0.200000<br />dibpat: Type A","age: 53<br />p(chd): 0.112903<br />dibpat: Type A","age: 54<br />p(chd): 0.132075<br />dibpat: Type A","age: 55<br />p(chd): 0.163636<br />dibpat: Type A","age: 56<br />p(chd): 0.244898<br />dibpat: Type A","age: 57<br />p(chd): 0.129032<br />dibpat: Type A","age: 58<br />p(chd): 0.147059<br />dibpat: Type A","age: 59<br />p(chd): 0.233333<br />dibpat: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.057971014492753624,0.020833333333333332,0.040000000000000001,0.0082644628099173556,0.050847457627118647,0.032786885245901641,0.045871559633027525,0.063291139240506333,0.013333333333333334,0.083333333333333329,0.074626865671641784,0.050847457627118647,0.10714285714285714,0.041666666666666664,0.11627906976744186,0.07407407407407407,0.040000000000000001,0,0.09375,0.045454545454545456,0.23529411764705882],"text":["age: 39<br />p(chd): 0.057971<br />dibpat: Type B","age: 40<br />p(chd): 0.020833<br />dibpat: Type B","age: 41<br />p(chd): 0.040000<br />dibpat: Type B","age: 42<br />p(chd): 0.008264<br />dibpat: Type B","age: 43<br />p(chd): 0.050847<br />dibpat: Type B","age: 44<br />p(chd): 0.032787<br />dibpat: Type B","age: 45<br />p(chd): 0.045872<br />dibpat: Type B","age: 46<br />p(chd): 0.063291<br />dibpat: Type B","age: 47<br />p(chd): 0.013333<br />dibpat: Type B","age: 48<br />p(chd): 0.083333<br />dibpat: Type B","age: 49<br />p(chd): 0.074627<br />dibpat: Type B","age: 50<br />p(chd): 0.050847<br />dibpat: Type B","age: 51<br />p(chd): 0.107143<br />dibpat: Type B","age: 52<br />p(chd): 0.041667<br />dibpat: Type B","age: 53<br />p(chd): 0.116279<br />dibpat: Type B","age: 54<br />p(chd): 0.074074<br />dibpat: Type B","age: 55<br />p(chd): 0.040000<br />dibpat: Type B","age: 56<br />p(chd): 0.000000<br />dibpat: Type B","age: 57<br />p(chd): 0.093750<br />dibpat: Type B","age: 58<br />p(chd): 0.045455<br />dibpat: Type B","age: 59<br />p(chd): 0.235294<br />dibpat: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[38,60],"tickmode":"array","ticktext":["40","45","50","55","60"],"tickvals":[40,45,50,55,60],"categoryorder":"array","categoryarray":["40","45","50","55","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Age (years)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.012244897959183675,0.25714285714285712],"tickmode":"array","ticktext":["0%","5%","10%","15%","20%","25%"],"tickvals":[1.7347234759768071e-18,0.050000000000000003,0.10000000000000001,0.15000000000000002,0.20000000000000001,0.24999999999999997],"categoryorder":"array","categoryarray":["0%","5%","10%","15%","20%","25%"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"P(CHD Event by 1969)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Behavioral Pattern<br />n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142eca84d67":{"x":{},"y":{},"colour":{},"size":{},"type":"scatter"},"142e7d71abae":{"x":{},"y":{},"colour":{}}},"cur_data":"142eca84d67","visdat":{"142eca84d67":["function (y) ","x"],"142e7d71abae":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="odds-scale" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="odds-scale"><span class="header-section-number">5.6.2</span> Odds scale</h3>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-27_d97dffdeda34b0b8d6a7aaa2f7a4dd27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>chd_plot_odds <span class="ot">=</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  chd_grouped_data <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">odds(chd)</span><span class="st">`</span>, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> dibpat)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"odds(CHD Event by 1969)"</span>) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  ggeasy<span class="sc">::</span><span class="fu">easy_labs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-28_30fb99ab757b865dde547a5235359a1c">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_odds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5e7eba765600a30857e5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5e7eba765600a30857e5">{"x":{"data":[{"x":[50,51,59,44,47,40,41,43,54,48,39,49,55,56,42,45,46,57,53,52,58],"y":[0.11764705882352941,0.19642857142857142,0.30434782608695654,0.086538461538461536,0.1076923076923077,0.072580645161290328,0.069306930693069299,0.077777777777777765,0.15217391304347824,0.17647058823529413,0.094017094017094016,0.31372549019607843,0.19565217391304346,0.32432432432432434,0.041237113402061855,0.10000000000000001,0.070588235294117646,0.14814814814814814,0.12727272727272726,0.25,0.17241379310344829],"text":["age: 50<br />odds(chd): 0.117647<br />dibpat: Type A<br />n:  76","age: 51<br />odds(chd): 0.196429<br />dibpat: Type A<br />n:  67","age: 59<br />odds(chd): 0.304348<br />dibpat: Type A<br />n:  30","age: 44<br />odds(chd): 0.086538<br />dibpat: Type A<br />n: 113","age: 47<br />odds(chd): 0.107692<br />dibpat: Type A<br />n:  72","age: 40<br />odds(chd): 0.072581<br />dibpat: Type A<br />n: 133","age: 41<br />odds(chd): 0.069307<br />dibpat: Type A<br />n: 108","age: 43<br />odds(chd): 0.077778<br />dibpat: Type A<br />n:  97","age: 54<br />odds(chd): 0.152174<br />dibpat: Type A<br />n:  53","age: 48<br />odds(chd): 0.176471<br />dibpat: Type A<br />n:  80","age: 39<br />odds(chd): 0.094017<br />dibpat: Type A<br />n: 128","age: 49<br />odds(chd): 0.313725<br />dibpat: Type A<br />n:  67","age: 55<br />odds(chd): 0.195652<br />dibpat: Type A<br />n:  55","age: 56<br />odds(chd): 0.324324<br />dibpat: Type A<br />n:  49","age: 42<br />odds(chd): 0.041237<br />dibpat: Type A<br />n: 101","age: 45<br />odds(chd): 0.100000<br />dibpat: Type A<br />n:  77","age: 46<br />odds(chd): 0.070588<br />dibpat: Type A<br />n:  91","age: 57<br />odds(chd): 0.148148<br />dibpat: Type A<br />n:  31","age: 53<br />odds(chd): 0.127273<br />dibpat: Type A<br />n:  62","age: 52<br />odds(chd): 0.250000<br />dibpat: Type A<br />n:  65","age: 58<br />odds(chd): 0.172414<br />dibpat: Type A<br />n:  34"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.69999999999999996,"size":[11.507808770054302,10.893987081881484,7.4072043526108828,13.637611848597116,11.241235656543804,14.615949458394798,13.377458191723871,12.778686124337518,9.8163466467363971,11.765488567001361,14.379833505125502,10.893987081881484,9.9817695786372642,9.4710951773162115,13.000921034406357,11.573027489273997,12.434641120809431,7.5441456810618819,10.52889648301692,10.750245809698832,7.9279346825975772],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[45,41,47,39,49,51,42,50,44,56,40,58,48,43,53,54,46,52,55,57,59],"y":[0.04807692307692308,0.041666666666666671,0.013513513513513514,0.061538461538461542,0.080645161290322578,0.11999999999999998,0.0083333333333333332,0.053571428571428575,0.033898305084745763,0,0.021276595744680851,0.047619047619047616,0.090909090909090912,0.053571428571428575,0.13157894736842105,0.080000000000000002,0.067567567567567571,0.043478260869565216,0.041666666666666671,0.10344827586206896,0.30769230769230771],"text":["age: 45<br />odds(chd): 0.048077<br />dibpat: Type B<br />n: 109","age: 41<br />odds(chd): 0.041667<br />dibpat: Type B<br />n: 125","age: 47<br />odds(chd): 0.013514<br />dibpat: Type B<br />n:  75","age: 39<br />odds(chd): 0.061538<br />dibpat: Type B<br />n: 138","age: 49<br />odds(chd): 0.080645<br />dibpat: Type B<br />n:  67","age: 51<br />odds(chd): 0.120000<br />dibpat: Type B<br />n:  56","age: 42<br />odds(chd): 0.008333<br />dibpat: Type B<br />n: 121","age: 50<br />odds(chd): 0.053571<br />dibpat: Type B<br />n:  59","age: 44<br />odds(chd): 0.033898<br />dibpat: Type B<br />n: 122","age: 56<br />odds(chd): 0.000000<br />dibpat: Type B<br />n:  27","age: 40<br />odds(chd): 0.021277<br />dibpat: Type B<br />n: 144","age: 58<br />odds(chd): 0.047619<br />dibpat: Type B<br />n:  22","age: 48<br />odds(chd): 0.090909<br />dibpat: Type B<br />n:  84","age: 43<br />odds(chd): 0.053571<br />dibpat: Type B<br />n: 118","age: 53<br />odds(chd): 0.131579<br />dibpat: Type B<br />n:  43","age: 54<br />odds(chd): 0.080000<br />dibpat: Type B<br />n:  54","age: 46<br />odds(chd): 0.067568<br />dibpat: Type B<br />n:  79","age: 52<br />odds(chd): 0.043478<br />dibpat: Type B<br />n:  48","age: 55<br />odds(chd): 0.041667<br />dibpat: Type B<br />n:  25","age: 57<br />odds(chd): 0.103448<br />dibpat: Type B<br />n:  32","age: 59<br />odds(chd): 0.307692<br />dibpat: Type B<br />n:  17"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.69999999999999996,"size":[13.430049986134389,14.235604935020691,11.442034967876614,14.847029219804128,10.893987081881484,10.062848078932257,14.040147001760529,10.300037417465363,14.089358888134319,6.9612105822972117,15.118110236220474,6.0293172003757194,12.015109867829196,13.89107438878934,8.9098372804078227,9.8996170505112442,11.701854397452983,9.3814585892624311,6.6253113681856641,7.6762775241645578,3.7795275590551185],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.094017094017094016,0.072580645161290328,0.069306930693069299,0.041237113402061855,0.077777777777777765,0.086538461538461536,0.10000000000000001,0.070588235294117646,0.1076923076923077,0.17647058823529413,0.31372549019607843,0.11764705882352941,0.19642857142857142,0.25,0.12727272727272726,0.15217391304347824,0.19565217391304346,0.32432432432432434,0.14814814814814814,0.17241379310344829,0.30434782608695654],"text":["age: 39<br />odds(chd): 0.094017<br />dibpat: Type A","age: 40<br />odds(chd): 0.072581<br />dibpat: Type A","age: 41<br />odds(chd): 0.069307<br />dibpat: Type A","age: 42<br />odds(chd): 0.041237<br />dibpat: Type A","age: 43<br />odds(chd): 0.077778<br />dibpat: Type A","age: 44<br />odds(chd): 0.086538<br />dibpat: Type A","age: 45<br />odds(chd): 0.100000<br />dibpat: Type A","age: 46<br />odds(chd): 0.070588<br />dibpat: Type A","age: 47<br />odds(chd): 0.107692<br />dibpat: Type A","age: 48<br />odds(chd): 0.176471<br />dibpat: Type A","age: 49<br />odds(chd): 0.313725<br />dibpat: Type A","age: 50<br />odds(chd): 0.117647<br />dibpat: Type A","age: 51<br />odds(chd): 0.196429<br />dibpat: Type A","age: 52<br />odds(chd): 0.250000<br />dibpat: Type A","age: 53<br />odds(chd): 0.127273<br />dibpat: Type A","age: 54<br />odds(chd): 0.152174<br />dibpat: Type A","age: 55<br />odds(chd): 0.195652<br />dibpat: Type A","age: 56<br />odds(chd): 0.324324<br />dibpat: Type A","age: 57<br />odds(chd): 0.148148<br />dibpat: Type A","age: 58<br />odds(chd): 0.172414<br />dibpat: Type A","age: 59<br />odds(chd): 0.304348<br />dibpat: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.061538461538461542,0.021276595744680851,0.041666666666666671,0.0083333333333333332,0.053571428571428575,0.033898305084745763,0.04807692307692308,0.067567567567567571,0.013513513513513514,0.090909090909090912,0.080645161290322578,0.053571428571428575,0.11999999999999998,0.043478260869565216,0.13157894736842105,0.080000000000000002,0.041666666666666671,0,0.10344827586206896,0.047619047619047616,0.30769230769230771],"text":["age: 39<br />odds(chd): 0.061538<br />dibpat: Type B","age: 40<br />odds(chd): 0.021277<br />dibpat: Type B","age: 41<br />odds(chd): 0.041667<br />dibpat: Type B","age: 42<br />odds(chd): 0.008333<br />dibpat: Type B","age: 43<br />odds(chd): 0.053571<br />dibpat: Type B","age: 44<br />odds(chd): 0.033898<br />dibpat: Type B","age: 45<br />odds(chd): 0.048077<br />dibpat: Type B","age: 46<br />odds(chd): 0.067568<br />dibpat: Type B","age: 47<br />odds(chd): 0.013514<br />dibpat: Type B","age: 48<br />odds(chd): 0.090909<br />dibpat: Type B","age: 49<br />odds(chd): 0.080645<br />dibpat: Type B","age: 50<br />odds(chd): 0.053571<br />dibpat: Type B","age: 51<br />odds(chd): 0.120000<br />dibpat: Type B","age: 52<br />odds(chd): 0.043478<br />dibpat: Type B","age: 53<br />odds(chd): 0.131579<br />dibpat: Type B","age: 54<br />odds(chd): 0.080000<br />dibpat: Type B","age: 55<br />odds(chd): 0.041667<br />dibpat: Type B","age: 56<br />odds(chd): 0.000000<br />dibpat: Type B","age: 57<br />odds(chd): 0.103448<br />dibpat: Type B","age: 58<br />odds(chd): 0.047619<br />dibpat: Type B","age: 59<br />odds(chd): 0.307692<br />dibpat: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[38,60],"tickmode":"array","ticktext":["40","45","50","55","60"],"tickvals":[40,45,50,55,60],"categoryorder":"array","categoryarray":["40","45","50","55","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Age (years)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.016216216216216217,0.34054054054054056],"tickmode":"array","ticktext":["0.0","0.1","0.2","0.3"],"tickvals":[0,0.10000000000000001,0.20000000000000001,0.30000000000000004],"categoryorder":"array","categoryarray":["0.0","0.1","0.2","0.3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"odds(CHD Event by 1969)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Behavioral Pattern<br />n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e5970254a":{"x":{},"y":{},"colour":{},"size":{},"type":"scatter"},"142e51a04b25":{"x":{},"y":{},"colour":{}}},"cur_data":"142e5970254a","visdat":{"142e5970254a":["function (y) ","x"],"142e51a04b25":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="log-odds-logit-scale" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="log-odds-logit-scale"><span class="header-section-number">5.6.3</span> Log-odds (logit) scale</h3>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-30_5fa5f07db86f3e69cb0040e0998c46a3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>chd_plot_logit <span class="ot">=</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  chd_grouped_data <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">logit(chd)</span><span class="st">`</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> dibpat)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"log{odds(CHD Event by 1969)}"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  ggeasy<span class="sc">::</span><span class="fu">easy_labs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-31_5d918c7436c6c1c8ad66e7fed775abe5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-208f7e38cc1367f6ef01" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-208f7e38cc1367f6ef01">{"x":{"data":[{"x":[50,51,59,44,47,40,41,43,54,48,39,49,55,56,42,45,46,57,53,52,58],"y":[-2.1400661634962708,-1.6274564179367788,-1.1895840668738362,-2.4471663218051534,-2.2284771208403238,-2.6230569882688175,-2.6692103677859462,-2.553899521274952,-1.8827312474337818,-1.7346010553881064,-2.3642786619993856,-1.1592369104845446,-1.6314168191528757,-1.126011262856224,-3.188416617383492,-2.3025850929940455,-2.6508917872622613,-1.9095425048844386,-2.0614230361771577,-1.3862943611198906,-1.7578579175523736],"text":["age: 50<br />logit(chd): -2.140<br />dibpat: Type A<br />n:  76","age: 51<br />logit(chd): -1.627<br />dibpat: Type A<br />n:  67","age: 59<br />logit(chd): -1.190<br />dibpat: Type A<br />n:  30","age: 44<br />logit(chd): -2.447<br />dibpat: Type A<br />n: 113","age: 47<br />logit(chd): -2.228<br />dibpat: Type A<br />n:  72","age: 40<br />logit(chd): -2.623<br />dibpat: Type A<br />n: 133","age: 41<br />logit(chd): -2.669<br />dibpat: Type A<br />n: 108","age: 43<br />logit(chd): -2.554<br />dibpat: Type A<br />n:  97","age: 54<br />logit(chd): -1.883<br />dibpat: Type A<br />n:  53","age: 48<br />logit(chd): -1.735<br />dibpat: Type A<br />n:  80","age: 39<br />logit(chd): -2.364<br />dibpat: Type A<br />n: 128","age: 49<br />logit(chd): -1.159<br />dibpat: Type A<br />n:  67","age: 55<br />logit(chd): -1.631<br />dibpat: Type A<br />n:  55","age: 56<br />logit(chd): -1.126<br />dibpat: Type A<br />n:  49","age: 42<br />logit(chd): -3.188<br />dibpat: Type A<br />n: 101","age: 45<br />logit(chd): -2.303<br />dibpat: Type A<br />n:  77","age: 46<br />logit(chd): -2.651<br />dibpat: Type A<br />n:  91","age: 57<br />logit(chd): -1.910<br />dibpat: Type A<br />n:  31","age: 53<br />logit(chd): -2.061<br />dibpat: Type A<br />n:  62","age: 52<br />logit(chd): -1.386<br />dibpat: Type A<br />n:  65","age: 58<br />logit(chd): -1.758<br />dibpat: Type A<br />n:  34"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.69999999999999996,"size":[11.507808770054302,10.893987081881484,7.4072043526108828,13.637611848597116,11.241235656543804,14.615949458394798,13.377458191723871,12.778686124337518,9.8163466467363971,11.765488567001361,14.379833505125502,10.893987081881484,9.9817695786372642,9.4710951773162115,13.000921034406357,11.573027489273997,12.434641120809431,7.5441456810618819,10.52889648301692,10.750245809698832,7.9279346825975772],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[45,41,47,39,49,51,42,50,44,56,40,58,48,43,53,54,46,52,55,57,59],"y":[-3.0349529867072724,-3.1780538303479453,-4.3040650932041693,-2.7880929087757464,-2.5176964726109912,-2.120263536200091,-4.7874917427820458,-2.9267394020670396,-3.3843902633457743,null,-3.8501476017100584,-3.044522437723423,-2.3978952727983707,-2.9267394020670396,-2.0281482472922856,-2.5257286443082556,-2.6946271807700692,-3.1354942159291497,-3.1780538303479453,-2.2686835413183641,-1.1786549963416462],"text":["age: 45<br />logit(chd): -3.035<br />dibpat: Type B<br />n: 109","age: 41<br />logit(chd): -3.178<br />dibpat: Type B<br />n: 125","age: 47<br />logit(chd): -4.304<br />dibpat: Type B<br />n:  75","age: 39<br />logit(chd): -2.788<br />dibpat: Type B<br />n: 138","age: 49<br />logit(chd): -2.518<br />dibpat: Type B<br />n:  67","age: 51<br />logit(chd): -2.120<br />dibpat: Type B<br />n:  56","age: 42<br />logit(chd): -4.787<br />dibpat: Type B<br />n: 121","age: 50<br />logit(chd): -2.927<br />dibpat: Type B<br />n:  59","age: 44<br />logit(chd): -3.384<br />dibpat: Type B<br />n: 122","age: 56<br />logit(chd):   -Inf<br />dibpat: Type B<br />n:  27","age: 40<br />logit(chd): -3.850<br />dibpat: Type B<br />n: 144","age: 58<br />logit(chd): -3.045<br />dibpat: Type B<br />n:  22","age: 48<br />logit(chd): -2.398<br />dibpat: Type B<br />n:  84","age: 43<br />logit(chd): -2.927<br />dibpat: Type B<br />n: 118","age: 53<br />logit(chd): -2.028<br />dibpat: Type B<br />n:  43","age: 54<br />logit(chd): -2.526<br />dibpat: Type B<br />n:  54","age: 46<br />logit(chd): -2.695<br />dibpat: Type B<br />n:  79","age: 52<br />logit(chd): -3.135<br />dibpat: Type B<br />n:  48","age: 55<br />logit(chd): -3.178<br />dibpat: Type B<br />n:  25","age: 57<br />logit(chd): -2.269<br />dibpat: Type B<br />n:  32","age: 59<br />logit(chd): -1.179<br />dibpat: Type B<br />n:  17"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.69999999999999996,"size":[13.430049986134389,14.235604935020691,11.442034967876614,14.847029219804128,10.893987081881484,10.062848078932257,14.040147001760529,10.300037417465363,14.089358888134319,6.9612105822972117,15.118110236220474,6.0293172003757194,12.015109867829196,13.89107438878934,8.9098372804078227,9.8996170505112442,11.701854397452983,9.3814585892624311,6.6253113681856641,7.6762775241645578,3.7795275590551185],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[-2.3642786619993856,-2.6230569882688175,-2.6692103677859462,-3.188416617383492,-2.553899521274952,-2.4471663218051534,-2.3025850929940455,-2.6508917872622613,-2.2284771208403238,-1.7346010553881064,-1.1592369104845446,-2.1400661634962708,-1.6274564179367788,-1.3862943611198906,-2.0614230361771577,-1.8827312474337818,-1.6314168191528757,-1.126011262856224,-1.9095425048844386,-1.7578579175523736,-1.1895840668738362],"text":["age: 39<br />logit(chd): -2.364<br />dibpat: Type A","age: 40<br />logit(chd): -2.623<br />dibpat: Type A","age: 41<br />logit(chd): -2.669<br />dibpat: Type A","age: 42<br />logit(chd): -3.188<br />dibpat: Type A","age: 43<br />logit(chd): -2.554<br />dibpat: Type A","age: 44<br />logit(chd): -2.447<br />dibpat: Type A","age: 45<br />logit(chd): -2.303<br />dibpat: Type A","age: 46<br />logit(chd): -2.651<br />dibpat: Type A","age: 47<br />logit(chd): -2.228<br />dibpat: Type A","age: 48<br />logit(chd): -1.735<br />dibpat: Type A","age: 49<br />logit(chd): -1.159<br />dibpat: Type A","age: 50<br />logit(chd): -2.140<br />dibpat: Type A","age: 51<br />logit(chd): -1.627<br />dibpat: Type A","age: 52<br />logit(chd): -1.386<br />dibpat: Type A","age: 53<br />logit(chd): -2.061<br />dibpat: Type A","age: 54<br />logit(chd): -1.883<br />dibpat: Type A","age: 55<br />logit(chd): -1.631<br />dibpat: Type A","age: 56<br />logit(chd): -1.126<br />dibpat: Type A","age: 57<br />logit(chd): -1.910<br />dibpat: Type A","age: 58<br />logit(chd): -1.758<br />dibpat: Type A","age: 59<br />logit(chd): -1.190<br />dibpat: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[-2.7880929087757464,-3.8501476017100584,-3.1780538303479453,-4.7874917427820458,-2.9267394020670396,-3.3843902633457743,-3.0349529867072724,-2.6946271807700692,-4.3040650932041693,-2.3978952727983707,-2.5176964726109912,-2.9267394020670396,-2.120263536200091,-3.1354942159291497,-2.0281482472922856,-2.5257286443082556,-3.1780538303479453,null,-2.2686835413183641,-3.044522437723423,-1.1786549963416462],"text":["age: 39<br />logit(chd): -2.788<br />dibpat: Type B","age: 40<br />logit(chd): -3.850<br />dibpat: Type B","age: 41<br />logit(chd): -3.178<br />dibpat: Type B","age: 42<br />logit(chd): -4.787<br />dibpat: Type B","age: 43<br />logit(chd): -2.927<br />dibpat: Type B","age: 44<br />logit(chd): -3.384<br />dibpat: Type B","age: 45<br />logit(chd): -3.035<br />dibpat: Type B","age: 46<br />logit(chd): -2.695<br />dibpat: Type B","age: 47<br />logit(chd): -4.304<br />dibpat: Type B","age: 48<br />logit(chd): -2.398<br />dibpat: Type B","age: 49<br />logit(chd): -2.518<br />dibpat: Type B","age: 50<br />logit(chd): -2.927<br />dibpat: Type B","age: 51<br />logit(chd): -2.120<br />dibpat: Type B","age: 52<br />logit(chd): -3.135<br />dibpat: Type B","age: 53<br />logit(chd): -2.028<br />dibpat: Type B","age: 54<br />logit(chd): -2.526<br />dibpat: Type B","age: 55<br />logit(chd): -3.178<br />dibpat: Type B","age: 56<br />logit(chd):   -Inf<br />dibpat: Type B","age: 57<br />logit(chd): -2.269<br />dibpat: Type B","age: 58<br />logit(chd): -3.045<br />dibpat: Type B","age: 59<br />logit(chd): -1.179<br />dibpat: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[38,60],"tickmode":"array","ticktext":["40","45","50","55","60"],"tickvals":[40,45,50,55,60],"categoryorder":"array","categoryarray":["40","45","50","55","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Age (years)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.9705657667783365,-0.94293723885993286],"tickmode":"array","ticktext":["-4","-3","-2","-1"],"tickvals":[-4,-3,-2,-1],"categoryorder":"array","categoryarray":["-4","-3","-2","-1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"log{odds(CHD Event by 1969)}","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Behavioral Pattern<br />n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e227dfc18":{"x":{},"y":{},"colour":{},"size":{},"type":"scatter"},"142e7d319d58":{"x":{},"y":{},"colour":{}}},"cur_data":"142e227dfc18","visdat":{"142e227dfc18":["function (y) ","x"],"142e7d319d58":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="logistic-regression-models-for-chd-data" class="level2 smaller" data-number="5.7">
<h2 class="smaller anchored" data-number="5.7" data-anchor-id="logistic-regression-models-for-chd-data"><span class="header-section-number">5.7</span> Logistic regression models for CHD data</h2>
<p>Here, we fit stratified models for CHD by personality type.</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-33_054cb201cb6ac4449bf8b20ba7de565f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"formula"</span> <span class="ot">=</span> chd69 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> dibpat <span class="sc">+</span> dibpat<span class="sc">:</span>age <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span> <span class="ot">=</span> wcgs,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Odds</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A)</td>
<td style="text-align: center;">-5.50</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">(-6.83, -4.19)</td>
<td style="text-align: center;">-8.18</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B)</td>
<td style="text-align: center;">-5.80</td>
<td style="text-align: center;">0.98</td>
<td style="text-align: center;">(-7.73, -3.90)</td>
<td style="text-align: center;">-5.95</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A) × age</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.05, 0.10)</td>
<td style="text-align: center;">5.24</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B) × age</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(0.02, 0.10)</td>
<td style="text-align: center;">3.01</td>
<td style="text-align: center;">0.003</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can get the corresponding odds ratios (<span class="math inline">\(e^{\beta}\)</span>s) by passing <code>exponentiate = TRUE</code> to <code>parameters()</code>:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-34_f6e1455c70ee16dcbbf137c200fe8f9a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 23%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Odds Ratio</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A)</td>
<td style="text-align: center;">4.09e-03</td>
<td style="text-align: center;">2.75e-03</td>
<td style="text-align: center;">(1.08e-03, 0.02)</td>
<td style="text-align: center;">-8.18</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B)</td>
<td style="text-align: center;">3.02e-03</td>
<td style="text-align: center;">2.94e-03</td>
<td style="text-align: center;">(4.40e-04, 0.02)</td>
<td style="text-align: center;">-5.95</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A) × age</td>
<td style="text-align: center;">1.07</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(1.05, 1.10)</td>
<td style="text-align: center;">5.24</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B) × age</td>
<td style="text-align: center;">1.06</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(1.02, 1.11)</td>
<td style="text-align: center;">3.01</td>
<td style="text-align: center;">0.003</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="models-superimposed-on-data" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="models-superimposed-on-data"><span class="header-section-number">5.8</span> Models superimposed on data</h2>
<p>We can graph our fitted models on each scale (probability, odds, log-odds).</p>
<section id="probability-scale-1" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="probability-scale-1"><span class="header-section-number">5.8.1</span> probability scale</h3>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-35_97a698e7d02aef844c1ddcbd59273c88">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>curve_type_A <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type A"</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>curve_type_B <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type B"</span>))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>chd_plot_probs_2 <span class="ot">=</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  chd_plot_probs <span class="sc">+</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_A,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type A"</span>)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_B,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type B"</span>)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-36_ee14230de4c63c4d5f92659894c1d239">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_probs_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f6e49f74d7333787cd52" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f6e49f74d7333787cd52">{"x":{"data":[{"x":[50,51,59,44,47,40,41,43,54,48,39,49,55,56,42,45,46,57,53,52,58],"y":[0.10526315789473684,0.16417910447761194,0.23333333333333334,0.079646017699115043,0.097222222222222224,0.067669172932330823,0.064814814814814811,0.072164948453608241,0.13207547169811321,0.14999999999999999,0.0859375,0.23880597014925373,0.16363636363636364,0.24489795918367346,0.039603960396039604,0.090909090909090912,0.065934065934065936,0.12903225806451613,0.11290322580645161,0.20000000000000001,0.14705882352941177],"text":["age: 50<br />p(chd): 0.105263<br />dibpat: Type A<br />n:  76","age: 51<br />p(chd): 0.164179<br />dibpat: Type A<br />n:  67","age: 59<br />p(chd): 0.233333<br />dibpat: Type A<br />n:  30","age: 44<br />p(chd): 0.079646<br />dibpat: Type A<br />n: 113","age: 47<br />p(chd): 0.097222<br />dibpat: Type A<br />n:  72","age: 40<br />p(chd): 0.067669<br />dibpat: Type A<br />n: 133","age: 41<br />p(chd): 0.064815<br />dibpat: Type A<br />n: 108","age: 43<br />p(chd): 0.072165<br />dibpat: Type A<br />n:  97","age: 54<br />p(chd): 0.132075<br />dibpat: Type A<br />n:  53","age: 48<br />p(chd): 0.150000<br />dibpat: Type A<br />n:  80","age: 39<br />p(chd): 0.085938<br />dibpat: Type A<br />n: 128","age: 49<br />p(chd): 0.238806<br />dibpat: Type A<br />n:  67","age: 55<br />p(chd): 0.163636<br />dibpat: Type A<br />n:  55","age: 56<br />p(chd): 0.244898<br />dibpat: Type A<br />n:  49","age: 42<br />p(chd): 0.039604<br />dibpat: Type A<br />n: 101","age: 45<br />p(chd): 0.090909<br />dibpat: Type A<br />n:  77","age: 46<br />p(chd): 0.065934<br />dibpat: Type A<br />n:  91","age: 57<br />p(chd): 0.129032<br />dibpat: Type A<br />n:  31","age: 53<br />p(chd): 0.112903<br />dibpat: Type A<br />n:  62","age: 52<br />p(chd): 0.200000<br />dibpat: Type A<br />n:  65","age: 58<br />p(chd): 0.147059<br />dibpat: Type A<br />n:  34"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.69999999999999996,"size":[11.507808770054302,10.893987081881484,7.4072043526108828,13.637611848597116,11.241235656543804,14.615949458394798,13.377458191723871,12.778686124337518,9.8163466467363971,11.765488567001361,14.379833505125502,10.893987081881484,9.9817695786372642,9.4710951773162115,13.000921034406357,11.573027489273997,12.434641120809431,7.5441456810618819,10.52889648301692,10.750245809698832,7.9279346825975772],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[45,41,47,39,49,51,42,50,44,56,40,58,48,43,53,54,46,52,55,57,59],"y":[0.045871559633027525,0.040000000000000001,0.013333333333333334,0.057971014492753624,0.074626865671641784,0.10714285714285714,0.0082644628099173556,0.050847457627118647,0.032786885245901641,0,0.020833333333333332,0.045454545454545456,0.083333333333333329,0.050847457627118647,0.11627906976744186,0.07407407407407407,0.063291139240506333,0.041666666666666664,0.040000000000000001,0.09375,0.23529411764705882],"text":["age: 45<br />p(chd): 0.045872<br />dibpat: Type B<br />n: 109","age: 41<br />p(chd): 0.040000<br />dibpat: Type B<br />n: 125","age: 47<br />p(chd): 0.013333<br />dibpat: Type B<br />n:  75","age: 39<br />p(chd): 0.057971<br />dibpat: Type B<br />n: 138","age: 49<br />p(chd): 0.074627<br />dibpat: Type B<br />n:  67","age: 51<br />p(chd): 0.107143<br />dibpat: Type B<br />n:  56","age: 42<br />p(chd): 0.008264<br />dibpat: Type B<br />n: 121","age: 50<br />p(chd): 0.050847<br />dibpat: Type B<br />n:  59","age: 44<br />p(chd): 0.032787<br />dibpat: Type B<br />n: 122","age: 56<br />p(chd): 0.000000<br />dibpat: Type B<br />n:  27","age: 40<br />p(chd): 0.020833<br />dibpat: Type B<br />n: 144","age: 58<br />p(chd): 0.045455<br />dibpat: Type B<br />n:  22","age: 48<br />p(chd): 0.083333<br />dibpat: Type B<br />n:  84","age: 43<br />p(chd): 0.050847<br />dibpat: Type B<br />n: 118","age: 53<br />p(chd): 0.116279<br />dibpat: Type B<br />n:  43","age: 54<br />p(chd): 0.074074<br />dibpat: Type B<br />n:  54","age: 46<br />p(chd): 0.063291<br />dibpat: Type B<br />n:  79","age: 52<br />p(chd): 0.041667<br />dibpat: Type B<br />n:  48","age: 55<br />p(chd): 0.040000<br />dibpat: Type B<br />n:  25","age: 57<br />p(chd): 0.093750<br />dibpat: Type B<br />n:  32","age: 59<br />p(chd): 0.235294<br />dibpat: Type B<br />n:  17"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.69999999999999996,"size":[13.430049986134389,14.235604935020691,11.442034967876614,14.847029219804128,10.893987081881484,10.062848078932257,14.040147001760529,10.300037417465363,14.089358888134319,6.9612105822972117,15.118110236220474,6.0293172003757194,12.015109867829196,13.89107438878934,8.9098372804078227,9.8996170505112442,11.701854397452983,9.3814585892624311,6.6253113681856641,7.6762775241645578,3.7795275590551185],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.0859375,0.067669172932330823,0.064814814814814811,0.039603960396039604,0.072164948453608241,0.079646017699115043,0.090909090909090912,0.065934065934065936,0.097222222222222224,0.14999999999999999,0.23880597014925373,0.10526315789473684,0.16417910447761194,0.20000000000000001,0.11290322580645161,0.13207547169811321,0.16363636363636364,0.24489795918367346,0.12903225806451613,0.14705882352941177,0.23333333333333334],"text":["age: 39<br />p(chd): 0.085938<br />dibpat: Type A","age: 40<br />p(chd): 0.067669<br />dibpat: Type A","age: 41<br />p(chd): 0.064815<br />dibpat: Type A","age: 42<br />p(chd): 0.039604<br />dibpat: Type A","age: 43<br />p(chd): 0.072165<br />dibpat: Type A","age: 44<br />p(chd): 0.079646<br />dibpat: Type A","age: 45<br />p(chd): 0.090909<br />dibpat: Type A","age: 46<br />p(chd): 0.065934<br />dibpat: Type A","age: 47<br />p(chd): 0.097222<br />dibpat: Type A","age: 48<br />p(chd): 0.150000<br />dibpat: Type A","age: 49<br />p(chd): 0.238806<br />dibpat: Type A","age: 50<br />p(chd): 0.105263<br />dibpat: Type A","age: 51<br />p(chd): 0.164179<br />dibpat: Type A","age: 52<br />p(chd): 0.200000<br />dibpat: Type A","age: 53<br />p(chd): 0.112903<br />dibpat: Type A","age: 54<br />p(chd): 0.132075<br />dibpat: Type A","age: 55<br />p(chd): 0.163636<br />dibpat: Type A","age: 56<br />p(chd): 0.244898<br />dibpat: Type A","age: 57<br />p(chd): 0.129032<br />dibpat: Type A","age: 58<br />p(chd): 0.147059<br />dibpat: Type A","age: 59<br />p(chd): 0.233333<br />dibpat: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.057971014492753624,0.020833333333333332,0.040000000000000001,0.0082644628099173556,0.050847457627118647,0.032786885245901641,0.045871559633027525,0.063291139240506333,0.013333333333333334,0.083333333333333329,0.074626865671641784,0.050847457627118647,0.10714285714285714,0.041666666666666664,0.11627906976744186,0.07407407407407407,0.040000000000000001,0,0.09375,0.045454545454545456,0.23529411764705882],"text":["age: 39<br />p(chd): 0.057971<br />dibpat: Type B","age: 40<br />p(chd): 0.020833<br />dibpat: Type B","age: 41<br />p(chd): 0.040000<br />dibpat: Type B","age: 42<br />p(chd): 0.008264<br />dibpat: Type B","age: 43<br />p(chd): 0.050847<br />dibpat: Type B","age: 44<br />p(chd): 0.032787<br />dibpat: Type B","age: 45<br />p(chd): 0.045872<br />dibpat: Type B","age: 46<br />p(chd): 0.063291<br />dibpat: Type B","age: 47<br />p(chd): 0.013333<br />dibpat: Type B","age: 48<br />p(chd): 0.083333<br />dibpat: Type B","age: 49<br />p(chd): 0.074627<br />dibpat: Type B","age: 50<br />p(chd): 0.050847<br />dibpat: Type B","age: 51<br />p(chd): 0.107143<br />dibpat: Type B","age: 52<br />p(chd): 0.041667<br />dibpat: Type B","age: 53<br />p(chd): 0.116279<br />dibpat: Type B","age: 54<br />p(chd): 0.074074<br />dibpat: Type B","age: 55<br />p(chd): 0.040000<br />dibpat: Type B","age: 56<br />p(chd): 0.000000<br />dibpat: Type B","age: 57<br />p(chd): 0.093750<br />dibpat: Type B","age: 58<br />p(chd): 0.045455<br />dibpat: Type B","age: 59<br />p(chd): 0.235294<br />dibpat: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,39.200000000000003,39.399999999999999,39.600000000000001,39.799999999999997,40,40.200000000000003,40.399999999999999,40.600000000000001,40.799999999999997,41,41.200000000000003,41.399999999999999,41.600000000000001,41.799999999999997,42,42.200000000000003,42.399999999999999,42.600000000000001,42.799999999999997,43,43.200000000000003,43.399999999999999,43.600000000000001,43.799999999999997,44,44.200000000000003,44.399999999999999,44.600000000000001,44.799999999999997,45,45.200000000000003,45.399999999999999,45.600000000000001,45.799999999999997,46,46.200000000000003,46.399999999999999,46.600000000000001,46.799999999999997,47,47.200000000000003,47.399999999999999,47.600000000000001,47.799999999999997,48,48.200000000000003,48.399999999999999,48.600000000000001,48.799999999999997,49,49.200000000000003,49.399999999999999,49.600000000000001,49.799999999999997,50,50.200000000000003,50.399999999999999,50.600000000000001,50.799999999999997,51,51.200000000000003,51.399999999999999,51.600000000000001,51.799999999999997,52,52.200000000000003,52.399999999999999,52.600000000000001,52.799999999999997,53,53.200000000000003,53.399999999999999,53.600000000000001,53.799999999999997,54,54.200000000000003,54.399999999999999,54.600000000000001,54.799999999999997,55,55.200000000000003,55.400000000000006,55.600000000000001,55.799999999999997,56,56.200000000000003,56.400000000000006,56.600000000000001,56.799999999999997,57,57.200000000000003,57.400000000000006,57.600000000000001,57.799999999999997,58,58.200000000000003,58.400000000000006,58.600000000000001,58.799999999999997,59],"y":[0.063299679011381407,0.064157768966082412,0.065026683658208267,0.065906537650489649,0.066797446117387055,0.067699524830551763,0.068612890143657901,0.069537658976593461,0.070473948798998626,0.071421877613138104,0.072381563936096224,0.073353126781282127,0.074336685639232666,0.075332360457701641,0.076340271621022637,0.077360539928733915,0.078393286573453236,0.079438633117991528,0.080496701471693008,0.081567613865990832,0.082651492829166978,0.083748461160305016,0.084858641902425355,0.085982158314791959,0.087119133844379804,0.088269692096494268,0.089433956804530507,0.090612051798865223,0.091804100974870753,0.093010228260041794,0.094230557580228233,0.095465212824963577,0.096714317811883277,0.097977996250224728,0.099256371703401514,0.10054956755064762,0.10185770694772306,0.10318091278667818,0.10451930765467071,0.10587301379183077,0.10724215304817256,0.1086268468395476,0.11002721610263864,0.11144338124899295,0.11287546211809343,0.11432357792946839,0.11578784723384046,0.11726838786331695,0.11876531688062326,0.12027875052738381,0.12180880417145425,0.12335559225331046,0.12491922823150074,0.12649982452716882,0.12809749246765489,0.12971234222918615,0.13134448277866476,0.13299402181456763,0.13466106570696912,0.13634571943670093,0.13804808653366488,0.13976826901431511,0.14150636731832664,0.14326248024447075,0.14503670488571579,0.14682913656357735,0.14863986876173854,0.15046899305896672,0.15231659906135214,0.15418277433389502,0.15606760433147135,0.15797117232920621,0.15989355935228763,0.16183484410525412,0.16379510290078922,0.16577440958806228,0.16777283548065003,0.16979044928408141,0.17182731702304496,0.17388350196830099,0.1759590645633447,0.17805406235086355,0.18016854989903766,0.18230257872773176,0.1844561972346285,0.18662945062135569,0.18882238081965988,0.19103502641768266,0.19326742258639434,0.19551960100624449,0.19779158979408687,0.20008341343044042,0.202395092687149,0.20472664455550102,0.20707808217487633,0.20944941476198384,0.21184064754075824,0.21425178167298387,0.21668281418971538,0.21913373792356453,0.22160454144192571],"text":["age: 39.0<br />p(chd): 0.06330<br />colour: Type A","age: 39.2<br />p(chd): 0.06416<br />colour: Type A","age: 39.4<br />p(chd): 0.06503<br />colour: Type A","age: 39.6<br />p(chd): 0.06591<br />colour: Type A","age: 39.8<br />p(chd): 0.06680<br />colour: Type A","age: 40.0<br />p(chd): 0.06770<br />colour: Type A","age: 40.2<br />p(chd): 0.06861<br />colour: Type A","age: 40.4<br />p(chd): 0.06954<br />colour: Type A","age: 40.6<br />p(chd): 0.07047<br />colour: Type A","age: 40.8<br />p(chd): 0.07142<br />colour: Type A","age: 41.0<br />p(chd): 0.07238<br />colour: Type A","age: 41.2<br />p(chd): 0.07335<br />colour: Type A","age: 41.4<br />p(chd): 0.07434<br />colour: Type A","age: 41.6<br />p(chd): 0.07533<br />colour: Type A","age: 41.8<br />p(chd): 0.07634<br />colour: Type A","age: 42.0<br />p(chd): 0.07736<br />colour: Type A","age: 42.2<br />p(chd): 0.07839<br />colour: Type A","age: 42.4<br />p(chd): 0.07944<br />colour: Type A","age: 42.6<br />p(chd): 0.08050<br />colour: Type A","age: 42.8<br />p(chd): 0.08157<br />colour: Type A","age: 43.0<br />p(chd): 0.08265<br />colour: Type A","age: 43.2<br />p(chd): 0.08375<br />colour: Type A","age: 43.4<br />p(chd): 0.08486<br />colour: Type A","age: 43.6<br />p(chd): 0.08598<br />colour: Type A","age: 43.8<br />p(chd): 0.08712<br />colour: Type A","age: 44.0<br />p(chd): 0.08827<br />colour: Type A","age: 44.2<br />p(chd): 0.08943<br />colour: Type A","age: 44.4<br />p(chd): 0.09061<br />colour: Type A","age: 44.6<br />p(chd): 0.09180<br />colour: Type A","age: 44.8<br />p(chd): 0.09301<br />colour: Type A","age: 45.0<br />p(chd): 0.09423<br />colour: Type A","age: 45.2<br />p(chd): 0.09547<br />colour: Type A","age: 45.4<br />p(chd): 0.09671<br />colour: Type A","age: 45.6<br />p(chd): 0.09798<br />colour: Type A","age: 45.8<br />p(chd): 0.09926<br />colour: Type A","age: 46.0<br />p(chd): 0.10055<br />colour: Type A","age: 46.2<br />p(chd): 0.10186<br />colour: Type A","age: 46.4<br />p(chd): 0.10318<br />colour: Type A","age: 46.6<br />p(chd): 0.10452<br />colour: Type A","age: 46.8<br />p(chd): 0.10587<br />colour: Type A","age: 47.0<br />p(chd): 0.10724<br />colour: Type A","age: 47.2<br />p(chd): 0.10863<br />colour: Type A","age: 47.4<br />p(chd): 0.11003<br />colour: Type A","age: 47.6<br />p(chd): 0.11144<br />colour: Type A","age: 47.8<br />p(chd): 0.11288<br />colour: Type A","age: 48.0<br />p(chd): 0.11432<br />colour: Type A","age: 48.2<br />p(chd): 0.11579<br />colour: Type A","age: 48.4<br />p(chd): 0.11727<br />colour: Type A","age: 48.6<br />p(chd): 0.11877<br />colour: Type A","age: 48.8<br />p(chd): 0.12028<br />colour: Type A","age: 49.0<br />p(chd): 0.12181<br />colour: Type A","age: 49.2<br />p(chd): 0.12336<br />colour: Type A","age: 49.4<br />p(chd): 0.12492<br />colour: Type A","age: 49.6<br />p(chd): 0.12650<br />colour: Type A","age: 49.8<br />p(chd): 0.12810<br />colour: Type A","age: 50.0<br />p(chd): 0.12971<br />colour: Type A","age: 50.2<br />p(chd): 0.13134<br />colour: Type A","age: 50.4<br />p(chd): 0.13299<br />colour: Type A","age: 50.6<br />p(chd): 0.13466<br />colour: Type A","age: 50.8<br />p(chd): 0.13635<br />colour: Type A","age: 51.0<br />p(chd): 0.13805<br />colour: Type A","age: 51.2<br />p(chd): 0.13977<br />colour: Type A","age: 51.4<br />p(chd): 0.14151<br />colour: Type A","age: 51.6<br />p(chd): 0.14326<br />colour: Type A","age: 51.8<br />p(chd): 0.14504<br />colour: Type A","age: 52.0<br />p(chd): 0.14683<br />colour: Type A","age: 52.2<br />p(chd): 0.14864<br />colour: Type A","age: 52.4<br />p(chd): 0.15047<br />colour: Type A","age: 52.6<br />p(chd): 0.15232<br />colour: Type A","age: 52.8<br />p(chd): 0.15418<br />colour: Type A","age: 53.0<br />p(chd): 0.15607<br />colour: Type A","age: 53.2<br />p(chd): 0.15797<br />colour: Type A","age: 53.4<br />p(chd): 0.15989<br />colour: Type A","age: 53.6<br />p(chd): 0.16183<br />colour: Type A","age: 53.8<br />p(chd): 0.16380<br />colour: Type A","age: 54.0<br />p(chd): 0.16577<br />colour: Type A","age: 54.2<br />p(chd): 0.16777<br />colour: Type A","age: 54.4<br />p(chd): 0.16979<br />colour: Type A","age: 54.6<br />p(chd): 0.17183<br />colour: Type A","age: 54.8<br />p(chd): 0.17388<br />colour: Type A","age: 55.0<br />p(chd): 0.17596<br />colour: Type A","age: 55.2<br />p(chd): 0.17805<br />colour: Type A","age: 55.4<br />p(chd): 0.18017<br />colour: Type A","age: 55.6<br />p(chd): 0.18230<br />colour: Type A","age: 55.8<br />p(chd): 0.18446<br />colour: Type A","age: 56.0<br />p(chd): 0.18663<br />colour: Type A","age: 56.2<br />p(chd): 0.18882<br />colour: Type A","age: 56.4<br />p(chd): 0.19104<br />colour: Type A","age: 56.6<br />p(chd): 0.19327<br />colour: Type A","age: 56.8<br />p(chd): 0.19552<br />colour: Type A","age: 57.0<br />p(chd): 0.19779<br />colour: Type A","age: 57.2<br />p(chd): 0.20008<br />colour: Type A","age: 57.4<br />p(chd): 0.20240<br />colour: Type A","age: 57.6<br />p(chd): 0.20473<br />colour: Type A","age: 57.8<br />p(chd): 0.20708<br />colour: Type A","age: 58.0<br />p(chd): 0.20945<br />colour: Type A","age: 58.2<br />p(chd): 0.21184<br />colour: Type A","age: 58.4<br />p(chd): 0.21425<br />colour: Type A","age: 58.6<br />p(chd): 0.21668<br />colour: Type A","age: 58.8<br />p(chd): 0.21913<br />colour: Type A","age: 59.0<br />p(chd): 0.22160<br />colour: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,39.200000000000003,39.399999999999999,39.600000000000001,39.799999999999997,40,40.200000000000003,40.399999999999999,40.600000000000001,40.799999999999997,41,41.200000000000003,41.399999999999999,41.600000000000001,41.799999999999997,42,42.200000000000003,42.399999999999999,42.600000000000001,42.799999999999997,43,43.200000000000003,43.399999999999999,43.600000000000001,43.799999999999997,44,44.200000000000003,44.399999999999999,44.600000000000001,44.799999999999997,45,45.200000000000003,45.399999999999999,45.600000000000001,45.799999999999997,46,46.200000000000003,46.399999999999999,46.600000000000001,46.799999999999997,47,47.200000000000003,47.399999999999999,47.600000000000001,47.799999999999997,48,48.200000000000003,48.399999999999999,48.600000000000001,48.799999999999997,49,49.200000000000003,49.399999999999999,49.600000000000001,49.799999999999997,50,50.200000000000003,50.399999999999999,50.600000000000001,50.799999999999997,51,51.200000000000003,51.399999999999999,51.600000000000001,51.799999999999997,52,52.200000000000003,52.399999999999999,52.600000000000001,52.799999999999997,53,53.200000000000003,53.399999999999999,53.600000000000001,53.799999999999997,54,54.200000000000003,54.399999999999999,54.600000000000001,54.799999999999997,55,55.200000000000003,55.400000000000006,55.600000000000001,55.799999999999997,56,56.200000000000003,56.400000000000006,56.600000000000001,56.799999999999997,57,57.200000000000003,57.400000000000006,57.600000000000001,57.799999999999997,58,58.200000000000003,58.400000000000006,58.600000000000001,58.799999999999997,59],"y":[0.032224234433006586,0.032610434922715571,0.033001106109252679,0.033396295943880931,0.03379605280055574,0.034200425477384527,0.034609463198027199,0.035023215613035591,0.035441732801129965,0.03586506527040971,0.036293263959497085,0.036726380238610717,0.037164465910567192,0.037607573211708448,0.038055754812751939,0.038509063819562213,0.038967553773840161,0.039431278653728745,0.039900292874331666,0.040374651288142716,0.040854409185383488,0.041339622294246113,0.041830346781038981,0.042326639250232161,0.042828556744399948,0.043336156744057719,0.043849497167389888,0.044368636369866488,0.044893633143745011,0.045424546717454523,0.045961436754859135,0.046504363354397553,0.047053387048095661,0.047608568800448704,0.048169970007170146,0.04873765249380356,0.04931167851419449,0.049892110748818615,0.050479012302963248,0.051072446704758086,0.051672477903052176,0.052279170265133415,0.052892588574286914,0.053512798027188807,0.054139864231131429,0.054773853201076868,0.055414831356534189,0.056062865518257614,0.056718022904761099,0.057380371128645538,0.058049978192735434,0.058726912486019897,0.059411242779395468,0.060103038221205586,0.060802368332573527,0.061509303002524461,0.062223912482892406,0.062946267383008875,0.063676438664167972,0.064414497633864823,0.065160515939802752,0.065914565563665206,0.066676718814648414,0.067447048322750447,0.068225627031812799,0.069012528192310144,0.069807825353884162,0.070611592357617381,0.071423903328043034,0.072244832664886377,0.073074455034533747,0.073912845361225249,0.074760078817966577,0.075616230817156821,0.076481377000926679,0.077355593231185169,0.078238955579368663,0.079131540315889898,0.080033423899282655,0.080944682965037457,0.081865394314125983,0.082795634901208781,0.083735481822523966,0.084685012303452378,0.085644303685756012,0.086613433414486241,0.087592479024557857,0.088581518126986794,0.089580628394786505,0.090589887548521847,0.091609373341515601,0.092639163544705388,0.093679335931148827,0.094729968260172603,0.095791138261164574,0.096862923617004701,0.097945401947133665,0.09903865079025663,0.1001427475866794,0.10125776966027636,0.10238379420008667],"text":["age: 39.0<br />p(chd): 0.03222<br />colour: Type B","age: 39.2<br />p(chd): 0.03261<br />colour: Type B","age: 39.4<br />p(chd): 0.03300<br />colour: Type B","age: 39.6<br />p(chd): 0.03340<br />colour: Type B","age: 39.8<br />p(chd): 0.03380<br />colour: Type B","age: 40.0<br />p(chd): 0.03420<br />colour: Type B","age: 40.2<br />p(chd): 0.03461<br />colour: Type B","age: 40.4<br />p(chd): 0.03502<br />colour: Type B","age: 40.6<br />p(chd): 0.03544<br />colour: Type B","age: 40.8<br />p(chd): 0.03587<br />colour: Type B","age: 41.0<br />p(chd): 0.03629<br />colour: Type B","age: 41.2<br />p(chd): 0.03673<br />colour: Type B","age: 41.4<br />p(chd): 0.03716<br />colour: Type B","age: 41.6<br />p(chd): 0.03761<br />colour: Type B","age: 41.8<br />p(chd): 0.03806<br />colour: Type B","age: 42.0<br />p(chd): 0.03851<br />colour: Type B","age: 42.2<br />p(chd): 0.03897<br />colour: Type B","age: 42.4<br />p(chd): 0.03943<br />colour: Type B","age: 42.6<br />p(chd): 0.03990<br />colour: Type B","age: 42.8<br />p(chd): 0.04037<br />colour: Type B","age: 43.0<br />p(chd): 0.04085<br />colour: Type B","age: 43.2<br />p(chd): 0.04134<br />colour: Type B","age: 43.4<br />p(chd): 0.04183<br />colour: Type B","age: 43.6<br />p(chd): 0.04233<br />colour: Type B","age: 43.8<br />p(chd): 0.04283<br />colour: Type B","age: 44.0<br />p(chd): 0.04334<br />colour: Type B","age: 44.2<br />p(chd): 0.04385<br />colour: Type B","age: 44.4<br />p(chd): 0.04437<br />colour: Type B","age: 44.6<br />p(chd): 0.04489<br />colour: Type B","age: 44.8<br />p(chd): 0.04542<br />colour: Type B","age: 45.0<br />p(chd): 0.04596<br />colour: Type B","age: 45.2<br />p(chd): 0.04650<br />colour: Type B","age: 45.4<br />p(chd): 0.04705<br />colour: Type B","age: 45.6<br />p(chd): 0.04761<br />colour: Type B","age: 45.8<br />p(chd): 0.04817<br />colour: Type B","age: 46.0<br />p(chd): 0.04874<br />colour: Type B","age: 46.2<br />p(chd): 0.04931<br />colour: Type B","age: 46.4<br />p(chd): 0.04989<br />colour: Type B","age: 46.6<br />p(chd): 0.05048<br />colour: Type B","age: 46.8<br />p(chd): 0.05107<br />colour: Type B","age: 47.0<br />p(chd): 0.05167<br />colour: Type B","age: 47.2<br />p(chd): 0.05228<br />colour: Type B","age: 47.4<br />p(chd): 0.05289<br />colour: Type B","age: 47.6<br />p(chd): 0.05351<br />colour: Type B","age: 47.8<br />p(chd): 0.05414<br />colour: Type B","age: 48.0<br />p(chd): 0.05477<br />colour: Type B","age: 48.2<br />p(chd): 0.05541<br />colour: Type B","age: 48.4<br />p(chd): 0.05606<br />colour: Type B","age: 48.6<br />p(chd): 0.05672<br />colour: Type B","age: 48.8<br />p(chd): 0.05738<br />colour: Type B","age: 49.0<br />p(chd): 0.05805<br />colour: Type B","age: 49.2<br />p(chd): 0.05873<br />colour: Type B","age: 49.4<br />p(chd): 0.05941<br />colour: Type B","age: 49.6<br />p(chd): 0.06010<br />colour: Type B","age: 49.8<br />p(chd): 0.06080<br />colour: Type B","age: 50.0<br />p(chd): 0.06151<br />colour: Type B","age: 50.2<br />p(chd): 0.06222<br />colour: Type B","age: 50.4<br />p(chd): 0.06295<br />colour: Type B","age: 50.6<br />p(chd): 0.06368<br />colour: Type B","age: 50.8<br />p(chd): 0.06441<br />colour: Type B","age: 51.0<br />p(chd): 0.06516<br />colour: Type B","age: 51.2<br />p(chd): 0.06591<br />colour: Type B","age: 51.4<br />p(chd): 0.06668<br />colour: Type B","age: 51.6<br />p(chd): 0.06745<br />colour: Type B","age: 51.8<br />p(chd): 0.06823<br />colour: Type B","age: 52.0<br />p(chd): 0.06901<br />colour: Type B","age: 52.2<br />p(chd): 0.06981<br />colour: Type B","age: 52.4<br />p(chd): 0.07061<br />colour: Type B","age: 52.6<br />p(chd): 0.07142<br />colour: Type B","age: 52.8<br />p(chd): 0.07224<br />colour: Type B","age: 53.0<br />p(chd): 0.07307<br />colour: Type B","age: 53.2<br />p(chd): 0.07391<br />colour: Type B","age: 53.4<br />p(chd): 0.07476<br />colour: Type B","age: 53.6<br />p(chd): 0.07562<br />colour: Type B","age: 53.8<br />p(chd): 0.07648<br />colour: Type B","age: 54.0<br />p(chd): 0.07736<br />colour: Type B","age: 54.2<br />p(chd): 0.07824<br />colour: Type B","age: 54.4<br />p(chd): 0.07913<br />colour: Type B","age: 54.6<br />p(chd): 0.08003<br />colour: Type B","age: 54.8<br />p(chd): 0.08094<br />colour: Type B","age: 55.0<br />p(chd): 0.08187<br />colour: Type B","age: 55.2<br />p(chd): 0.08280<br />colour: Type B","age: 55.4<br />p(chd): 0.08374<br />colour: Type B","age: 55.6<br />p(chd): 0.08469<br />colour: Type B","age: 55.8<br />p(chd): 0.08564<br />colour: Type B","age: 56.0<br />p(chd): 0.08661<br />colour: Type B","age: 56.2<br />p(chd): 0.08759<br />colour: Type B","age: 56.4<br />p(chd): 0.08858<br />colour: Type B","age: 56.6<br />p(chd): 0.08958<br />colour: Type B","age: 56.8<br />p(chd): 0.09059<br />colour: Type B","age: 57.0<br />p(chd): 0.09161<br />colour: Type B","age: 57.2<br />p(chd): 0.09264<br />colour: Type B","age: 57.4<br />p(chd): 0.09368<br />colour: Type B","age: 57.6<br />p(chd): 0.09473<br />colour: Type B","age: 57.8<br />p(chd): 0.09579<br />colour: Type B","age: 58.0<br />p(chd): 0.09686<br />colour: Type B","age: 58.2<br />p(chd): 0.09795<br />colour: Type B","age: 58.4<br />p(chd): 0.09904<br />colour: Type B","age: 58.6<br />p(chd): 0.10014<br />colour: Type B","age: 58.8<br />p(chd): 0.10126<br />colour: Type B","age: 59.0<br />p(chd): 0.10238<br />colour: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[38,60],"tickmode":"array","ticktext":["40","45","50","55","60"],"tickvals":[40,45,50,55,60],"categoryorder":"array","categoryarray":["40","45","50","55","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Age (years)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.012244897959183675,0.25714285714285712],"tickmode":"array","ticktext":["0%","5%","10%","15%","20%","25%"],"tickvals":[1.7347234759768071e-18,0.050000000000000003,0.10000000000000001,0.15000000000000002,0.20000000000000001,0.24999999999999997],"categoryorder":"array","categoryarray":["0%","5%","10%","15%","20%","25%"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"P(CHD Event by 1969)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Behavioral Pattern<br />n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e5874c442":{"x":{},"y":{},"colour":{},"size":{},"type":"scatter"},"142e5a00f66c":{"x":{},"y":{},"colour":{}},"142e75325a9d":{"x":{},"y":{},"colour":{}},"142e3cdb3587":{"x":{},"y":{},"colour":{}}},"cur_data":"142e5874c442","visdat":{"142e5874c442":["function (y) ","x"],"142e5a00f66c":["function (y) ","x"],"142e75325a9d":["function (y) ","x"],"142e3cdb3587":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="odds-scale-1" class="level3" data-number="5.8.2">
<h3 data-number="5.8.2" class="anchored" data-anchor-id="odds-scale-1"><span class="header-section-number">5.8.2</span> odds scale</h3>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-38_c0a5adfb79469dc4e9226801915a61a1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>curve_type_A <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type A"</span>)) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>curve_type_B <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type B"</span>)) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>chd_plot_odds_2 <span class="ot">=</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  chd_plot_odds <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_A,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type A"</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_B,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type B"</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-39_d73a0be1501a148684d49e016d6ffa6c">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_odds_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-caf4974e7c612fd46ef0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-caf4974e7c612fd46ef0">{"x":{"data":[{"x":[50,51,59,44,47,40,41,43,54,48,39,49,55,56,42,45,46,57,53,52,58],"y":[0.11764705882352941,0.19642857142857142,0.30434782608695654,0.086538461538461536,0.1076923076923077,0.072580645161290328,0.069306930693069299,0.077777777777777765,0.15217391304347824,0.17647058823529413,0.094017094017094016,0.31372549019607843,0.19565217391304346,0.32432432432432434,0.041237113402061855,0.10000000000000001,0.070588235294117646,0.14814814814814814,0.12727272727272726,0.25,0.17241379310344829],"text":["age: 50<br />odds(chd): 0.117647<br />dibpat: Type A<br />n:  76","age: 51<br />odds(chd): 0.196429<br />dibpat: Type A<br />n:  67","age: 59<br />odds(chd): 0.304348<br />dibpat: Type A<br />n:  30","age: 44<br />odds(chd): 0.086538<br />dibpat: Type A<br />n: 113","age: 47<br />odds(chd): 0.107692<br />dibpat: Type A<br />n:  72","age: 40<br />odds(chd): 0.072581<br />dibpat: Type A<br />n: 133","age: 41<br />odds(chd): 0.069307<br />dibpat: Type A<br />n: 108","age: 43<br />odds(chd): 0.077778<br />dibpat: Type A<br />n:  97","age: 54<br />odds(chd): 0.152174<br />dibpat: Type A<br />n:  53","age: 48<br />odds(chd): 0.176471<br />dibpat: Type A<br />n:  80","age: 39<br />odds(chd): 0.094017<br />dibpat: Type A<br />n: 128","age: 49<br />odds(chd): 0.313725<br />dibpat: Type A<br />n:  67","age: 55<br />odds(chd): 0.195652<br />dibpat: Type A<br />n:  55","age: 56<br />odds(chd): 0.324324<br />dibpat: Type A<br />n:  49","age: 42<br />odds(chd): 0.041237<br />dibpat: Type A<br />n: 101","age: 45<br />odds(chd): 0.100000<br />dibpat: Type A<br />n:  77","age: 46<br />odds(chd): 0.070588<br />dibpat: Type A<br />n:  91","age: 57<br />odds(chd): 0.148148<br />dibpat: Type A<br />n:  31","age: 53<br />odds(chd): 0.127273<br />dibpat: Type A<br />n:  62","age: 52<br />odds(chd): 0.250000<br />dibpat: Type A<br />n:  65","age: 58<br />odds(chd): 0.172414<br />dibpat: Type A<br />n:  34"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.69999999999999996,"size":[11.507808770054302,10.893987081881484,7.4072043526108828,13.637611848597116,11.241235656543804,14.615949458394798,13.377458191723871,12.778686124337518,9.8163466467363971,11.765488567001361,14.379833505125502,10.893987081881484,9.9817695786372642,9.4710951773162115,13.000921034406357,11.573027489273997,12.434641120809431,7.5441456810618819,10.52889648301692,10.750245809698832,7.9279346825975772],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[45,41,47,39,49,51,42,50,44,56,40,58,48,43,53,54,46,52,55,57,59],"y":[0.04807692307692308,0.041666666666666671,0.013513513513513514,0.061538461538461542,0.080645161290322578,0.11999999999999998,0.0083333333333333332,0.053571428571428575,0.033898305084745763,0,0.021276595744680851,0.047619047619047616,0.090909090909090912,0.053571428571428575,0.13157894736842105,0.080000000000000002,0.067567567567567571,0.043478260869565216,0.041666666666666671,0.10344827586206896,0.30769230769230771],"text":["age: 45<br />odds(chd): 0.048077<br />dibpat: Type B<br />n: 109","age: 41<br />odds(chd): 0.041667<br />dibpat: Type B<br />n: 125","age: 47<br />odds(chd): 0.013514<br />dibpat: Type B<br />n:  75","age: 39<br />odds(chd): 0.061538<br />dibpat: Type B<br />n: 138","age: 49<br />odds(chd): 0.080645<br />dibpat: Type B<br />n:  67","age: 51<br />odds(chd): 0.120000<br />dibpat: Type B<br />n:  56","age: 42<br />odds(chd): 0.008333<br />dibpat: Type B<br />n: 121","age: 50<br />odds(chd): 0.053571<br />dibpat: Type B<br />n:  59","age: 44<br />odds(chd): 0.033898<br />dibpat: Type B<br />n: 122","age: 56<br />odds(chd): 0.000000<br />dibpat: Type B<br />n:  27","age: 40<br />odds(chd): 0.021277<br />dibpat: Type B<br />n: 144","age: 58<br />odds(chd): 0.047619<br />dibpat: Type B<br />n:  22","age: 48<br />odds(chd): 0.090909<br />dibpat: Type B<br />n:  84","age: 43<br />odds(chd): 0.053571<br />dibpat: Type B<br />n: 118","age: 53<br />odds(chd): 0.131579<br />dibpat: Type B<br />n:  43","age: 54<br />odds(chd): 0.080000<br />dibpat: Type B<br />n:  54","age: 46<br />odds(chd): 0.067568<br />dibpat: Type B<br />n:  79","age: 52<br />odds(chd): 0.043478<br />dibpat: Type B<br />n:  48","age: 55<br />odds(chd): 0.041667<br />dibpat: Type B<br />n:  25","age: 57<br />odds(chd): 0.103448<br />dibpat: Type B<br />n:  32","age: 59<br />odds(chd): 0.307692<br />dibpat: Type B<br />n:  17"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.69999999999999996,"size":[13.430049986134389,14.235604935020691,11.442034967876614,14.847029219804128,10.893987081881484,10.062848078932257,14.040147001760529,10.300037417465363,14.089358888134319,6.9612105822972117,15.118110236220474,6.0293172003757194,12.015109867829196,13.89107438878934,8.9098372804078227,9.8996170505112442,11.701854397452983,9.3814585892624311,6.6253113681856641,7.6762775241645578,3.7795275590551185],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.094017094017094016,0.072580645161290328,0.069306930693069299,0.041237113402061855,0.077777777777777765,0.086538461538461536,0.10000000000000001,0.070588235294117646,0.1076923076923077,0.17647058823529413,0.31372549019607843,0.11764705882352941,0.19642857142857142,0.25,0.12727272727272726,0.15217391304347824,0.19565217391304346,0.32432432432432434,0.14814814814814814,0.17241379310344829,0.30434782608695654],"text":["age: 39<br />odds(chd): 0.094017<br />dibpat: Type A","age: 40<br />odds(chd): 0.072581<br />dibpat: Type A","age: 41<br />odds(chd): 0.069307<br />dibpat: Type A","age: 42<br />odds(chd): 0.041237<br />dibpat: Type A","age: 43<br />odds(chd): 0.077778<br />dibpat: Type A","age: 44<br />odds(chd): 0.086538<br />dibpat: Type A","age: 45<br />odds(chd): 0.100000<br />dibpat: Type A","age: 46<br />odds(chd): 0.070588<br />dibpat: Type A","age: 47<br />odds(chd): 0.107692<br />dibpat: Type A","age: 48<br />odds(chd): 0.176471<br />dibpat: Type A","age: 49<br />odds(chd): 0.313725<br />dibpat: Type A","age: 50<br />odds(chd): 0.117647<br />dibpat: Type A","age: 51<br />odds(chd): 0.196429<br />dibpat: Type A","age: 52<br />odds(chd): 0.250000<br />dibpat: Type A","age: 53<br />odds(chd): 0.127273<br />dibpat: Type A","age: 54<br />odds(chd): 0.152174<br />dibpat: Type A","age: 55<br />odds(chd): 0.195652<br />dibpat: Type A","age: 56<br />odds(chd): 0.324324<br />dibpat: Type A","age: 57<br />odds(chd): 0.148148<br />dibpat: Type A","age: 58<br />odds(chd): 0.172414<br />dibpat: Type A","age: 59<br />odds(chd): 0.304348<br />dibpat: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[0.061538461538461542,0.021276595744680851,0.041666666666666671,0.0083333333333333332,0.053571428571428575,0.033898305084745763,0.04807692307692308,0.067567567567567571,0.013513513513513514,0.090909090909090912,0.080645161290322578,0.053571428571428575,0.11999999999999998,0.043478260869565216,0.13157894736842105,0.080000000000000002,0.041666666666666671,0,0.10344827586206896,0.047619047619047616,0.30769230769230771],"text":["age: 39<br />odds(chd): 0.061538<br />dibpat: Type B","age: 40<br />odds(chd): 0.021277<br />dibpat: Type B","age: 41<br />odds(chd): 0.041667<br />dibpat: Type B","age: 42<br />odds(chd): 0.008333<br />dibpat: Type B","age: 43<br />odds(chd): 0.053571<br />dibpat: Type B","age: 44<br />odds(chd): 0.033898<br />dibpat: Type B","age: 45<br />odds(chd): 0.048077<br />dibpat: Type B","age: 46<br />odds(chd): 0.067568<br />dibpat: Type B","age: 47<br />odds(chd): 0.013514<br />dibpat: Type B","age: 48<br />odds(chd): 0.090909<br />dibpat: Type B","age: 49<br />odds(chd): 0.080645<br />dibpat: Type B","age: 50<br />odds(chd): 0.053571<br />dibpat: Type B","age: 51<br />odds(chd): 0.120000<br />dibpat: Type B","age: 52<br />odds(chd): 0.043478<br />dibpat: Type B","age: 53<br />odds(chd): 0.131579<br />dibpat: Type B","age: 54<br />odds(chd): 0.080000<br />dibpat: Type B","age: 55<br />odds(chd): 0.041667<br />dibpat: Type B","age: 56<br />odds(chd): 0.000000<br />dibpat: Type B","age: 57<br />odds(chd): 0.103448<br />dibpat: Type B","age: 58<br />odds(chd): 0.047619<br />dibpat: Type B","age: 59<br />odds(chd): 0.307692<br />dibpat: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,39.200000000000003,39.399999999999999,39.600000000000001,39.799999999999997,40,40.200000000000003,40.399999999999999,40.600000000000001,40.799999999999997,41,41.200000000000003,41.399999999999999,41.600000000000001,41.799999999999997,42,42.200000000000003,42.399999999999999,42.600000000000001,42.799999999999997,43,43.200000000000003,43.399999999999999,43.600000000000001,43.799999999999997,44,44.200000000000003,44.399999999999999,44.600000000000001,44.799999999999997,45,45.200000000000003,45.399999999999999,45.600000000000001,45.799999999999997,46,46.200000000000003,46.399999999999999,46.600000000000001,46.799999999999997,47,47.200000000000003,47.399999999999999,47.600000000000001,47.799999999999997,48,48.200000000000003,48.399999999999999,48.600000000000001,48.799999999999997,49,49.200000000000003,49.399999999999999,49.600000000000001,49.799999999999997,50,50.200000000000003,50.399999999999999,50.600000000000001,50.799999999999997,51,51.200000000000003,51.399999999999999,51.600000000000001,51.799999999999997,52,52.200000000000003,52.399999999999999,52.600000000000001,52.799999999999997,53,53.200000000000003,53.399999999999999,53.600000000000001,53.799999999999997,54,54.200000000000003,54.399999999999999,54.600000000000001,54.799999999999997,55,55.200000000000003,55.400000000000006,55.600000000000001,55.799999999999997,56,56.200000000000003,56.400000000000006,56.600000000000001,56.799999999999997,57,57.200000000000003,57.400000000000006,57.600000000000001,57.799999999999997,58,58.200000000000003,58.400000000000006,58.600000000000001,58.799999999999997,59],"y":[0.067577300437532919,0.068556180559623786,0.069549240092363143,0.070556684429324654,0.071578721939277362,0.072615564009282721,0.073667425088415506,0.074734522732117947,0.07581707764719689,0.076915313737471944,0.078029458150085593,0.079159741322483781,0.080306397030076887,0.081469662434591569,0.082649778133122478,0.083846988207894851,0.085061540276747644,0.086293685544348353,0.087543678854149223,0.0888117787410964,0.090098247485102437,0.091403351165293287,0.092727359715041452,0.094070546977795877,0.095433190763720616,0.096815572907154493,0.098217979324902074,0.099640700075369834,0.10108402941855894,0.10254826587692614,0.1040337122971276,0.10554067591265577,0.10706946840738446,0.10862040598003443,0.11019380940957176,0.1117900041215551,0.1134093202554424,0.11505209273287365,0.11671866132694275,0.11840937073247176,0.12012457063730438,0.12186461579463131,0.12362986609636351,0.12542068664756839,0.12723744784198421,0.12908052543862811,0.13095030063951399,0.13284716016849638,0.13477149635125593,0.13672370719644397,0.13870419647800211,0.14071337381867452,0.14275165477472959,0.14481946092190956,0.14691721994262399,0.1490453657144076,0.15120433839965802,0.15339458453667468,0.15561655713201583,0.15787071575419331,0.16015752662872484,0.16247746273456284,0.16483100390192029,0.16721863691151381,0.16964085559524344,0.17209816093833225,0.17459106118294401,0.17712007193330251,0.17968571626233396,0.18228852481985305,0.18492903594231741,0.1876077957641705,0.19032535833079861,0.19308228571312361,0.19587914812385498,0.19871652403542719,0.20159500029964372,0.20451517226905569,0.2074776439200981,0.21048302797800908,0.21353194604356013,0.21662502872162057,0.21976291575158516,0.22294625613969077,0.22617570829325004,0.22945194015682885,0.23277562935039645,0.23614746330947742,0.23956813942733296,0.24303836519920252,0.24655885836863409,0.25013034707593412,0.25375357000876869,0.25742927655494502,0.26115822695740731,0.26494119247147679,0.26877895552436926,0.27267230987702429,0.27662206078827795,0.28062902518141386,0.28469403181312664],"text":["age: 39.0<br />odds(chd): 0.06758<br />colour: Type A","age: 39.2<br />odds(chd): 0.06856<br />colour: Type A","age: 39.4<br />odds(chd): 0.06955<br />colour: Type A","age: 39.6<br />odds(chd): 0.07056<br />colour: Type A","age: 39.8<br />odds(chd): 0.07158<br />colour: Type A","age: 40.0<br />odds(chd): 0.07262<br />colour: Type A","age: 40.2<br />odds(chd): 0.07367<br />colour: Type A","age: 40.4<br />odds(chd): 0.07473<br />colour: Type A","age: 40.6<br />odds(chd): 0.07582<br />colour: Type A","age: 40.8<br />odds(chd): 0.07692<br />colour: Type A","age: 41.0<br />odds(chd): 0.07803<br />colour: Type A","age: 41.2<br />odds(chd): 0.07916<br />colour: Type A","age: 41.4<br />odds(chd): 0.08031<br />colour: Type A","age: 41.6<br />odds(chd): 0.08147<br />colour: Type A","age: 41.8<br />odds(chd): 0.08265<br />colour: Type A","age: 42.0<br />odds(chd): 0.08385<br />colour: Type A","age: 42.2<br />odds(chd): 0.08506<br />colour: Type A","age: 42.4<br />odds(chd): 0.08629<br />colour: Type A","age: 42.6<br />odds(chd): 0.08754<br />colour: Type A","age: 42.8<br />odds(chd): 0.08881<br />colour: Type A","age: 43.0<br />odds(chd): 0.09010<br />colour: Type A","age: 43.2<br />odds(chd): 0.09140<br />colour: Type A","age: 43.4<br />odds(chd): 0.09273<br />colour: Type A","age: 43.6<br />odds(chd): 0.09407<br />colour: Type A","age: 43.8<br />odds(chd): 0.09543<br />colour: Type A","age: 44.0<br />odds(chd): 0.09682<br />colour: Type A","age: 44.2<br />odds(chd): 0.09822<br />colour: Type A","age: 44.4<br />odds(chd): 0.09964<br />colour: Type A","age: 44.6<br />odds(chd): 0.10108<br />colour: Type A","age: 44.8<br />odds(chd): 0.10255<br />colour: Type A","age: 45.0<br />odds(chd): 0.10403<br />colour: Type A","age: 45.2<br />odds(chd): 0.10554<br />colour: Type A","age: 45.4<br />odds(chd): 0.10707<br />colour: Type A","age: 45.6<br />odds(chd): 0.10862<br />colour: Type A","age: 45.8<br />odds(chd): 0.11019<br />colour: Type A","age: 46.0<br />odds(chd): 0.11179<br />colour: Type A","age: 46.2<br />odds(chd): 0.11341<br />colour: Type A","age: 46.4<br />odds(chd): 0.11505<br />colour: Type A","age: 46.6<br />odds(chd): 0.11672<br />colour: Type A","age: 46.8<br />odds(chd): 0.11841<br />colour: Type A","age: 47.0<br />odds(chd): 0.12012<br />colour: Type A","age: 47.2<br />odds(chd): 0.12186<br />colour: Type A","age: 47.4<br />odds(chd): 0.12363<br />colour: Type A","age: 47.6<br />odds(chd): 0.12542<br />colour: Type A","age: 47.8<br />odds(chd): 0.12724<br />colour: Type A","age: 48.0<br />odds(chd): 0.12908<br />colour: Type A","age: 48.2<br />odds(chd): 0.13095<br />colour: Type A","age: 48.4<br />odds(chd): 0.13285<br />colour: Type A","age: 48.6<br />odds(chd): 0.13477<br />colour: Type A","age: 48.8<br />odds(chd): 0.13672<br />colour: Type A","age: 49.0<br />odds(chd): 0.13870<br />colour: Type A","age: 49.2<br />odds(chd): 0.14071<br />colour: Type A","age: 49.4<br />odds(chd): 0.14275<br />colour: Type A","age: 49.6<br />odds(chd): 0.14482<br />colour: Type A","age: 49.8<br />odds(chd): 0.14692<br />colour: Type A","age: 50.0<br />odds(chd): 0.14905<br />colour: Type A","age: 50.2<br />odds(chd): 0.15120<br />colour: Type A","age: 50.4<br />odds(chd): 0.15339<br />colour: Type A","age: 50.6<br />odds(chd): 0.15562<br />colour: Type A","age: 50.8<br />odds(chd): 0.15787<br />colour: Type A","age: 51.0<br />odds(chd): 0.16016<br />colour: Type A","age: 51.2<br />odds(chd): 0.16248<br />colour: Type A","age: 51.4<br />odds(chd): 0.16483<br />colour: Type A","age: 51.6<br />odds(chd): 0.16722<br />colour: Type A","age: 51.8<br />odds(chd): 0.16964<br />colour: Type A","age: 52.0<br />odds(chd): 0.17210<br />colour: Type A","age: 52.2<br />odds(chd): 0.17459<br />colour: Type A","age: 52.4<br />odds(chd): 0.17712<br />colour: Type A","age: 52.6<br />odds(chd): 0.17969<br />colour: Type A","age: 52.8<br />odds(chd): 0.18229<br />colour: Type A","age: 53.0<br />odds(chd): 0.18493<br />colour: Type A","age: 53.2<br />odds(chd): 0.18761<br />colour: Type A","age: 53.4<br />odds(chd): 0.19033<br />colour: Type A","age: 53.6<br />odds(chd): 0.19308<br />colour: Type A","age: 53.8<br />odds(chd): 0.19588<br />colour: Type A","age: 54.0<br />odds(chd): 0.19872<br />colour: Type A","age: 54.2<br />odds(chd): 0.20160<br />colour: Type A","age: 54.4<br />odds(chd): 0.20452<br />colour: Type A","age: 54.6<br />odds(chd): 0.20748<br />colour: Type A","age: 54.8<br />odds(chd): 0.21048<br />colour: Type A","age: 55.0<br />odds(chd): 0.21353<br />colour: Type A","age: 55.2<br />odds(chd): 0.21663<br />colour: Type A","age: 55.4<br />odds(chd): 0.21976<br />colour: Type A","age: 55.6<br />odds(chd): 0.22295<br />colour: Type A","age: 55.8<br />odds(chd): 0.22618<br />colour: Type A","age: 56.0<br />odds(chd): 0.22945<br />colour: Type A","age: 56.2<br />odds(chd): 0.23278<br />colour: Type A","age: 56.4<br />odds(chd): 0.23615<br />colour: Type A","age: 56.6<br />odds(chd): 0.23957<br />colour: Type A","age: 56.8<br />odds(chd): 0.24304<br />colour: Type A","age: 57.0<br />odds(chd): 0.24656<br />colour: Type A","age: 57.2<br />odds(chd): 0.25013<br />colour: Type A","age: 57.4<br />odds(chd): 0.25375<br />colour: Type A","age: 57.6<br />odds(chd): 0.25743<br />colour: Type A","age: 57.8<br />odds(chd): 0.26116<br />colour: Type A","age: 58.0<br />odds(chd): 0.26494<br />colour: Type A","age: 58.2<br />odds(chd): 0.26878<br />colour: Type A","age: 58.4<br />odds(chd): 0.27267<br />colour: Type A","age: 58.6<br />odds(chd): 0.27662<br />colour: Type A","age: 58.8<br />odds(chd): 0.28063<br />colour: Type A","age: 59.0<br />odds(chd): 0.28469<br />colour: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,39.200000000000003,39.399999999999999,39.600000000000001,39.799999999999997,40,40.200000000000003,40.399999999999999,40.600000000000001,40.799999999999997,41,41.200000000000003,41.399999999999999,41.600000000000001,41.799999999999997,42,42.200000000000003,42.399999999999999,42.600000000000001,42.799999999999997,43,43.200000000000003,43.399999999999999,43.600000000000001,43.799999999999997,44,44.200000000000003,44.399999999999999,44.600000000000001,44.799999999999997,45,45.200000000000003,45.399999999999999,45.600000000000001,45.799999999999997,46,46.200000000000003,46.399999999999999,46.600000000000001,46.799999999999997,47,47.200000000000003,47.399999999999999,47.600000000000001,47.799999999999997,48,48.200000000000003,48.399999999999999,48.600000000000001,48.799999999999997,49,49.200000000000003,49.399999999999999,49.600000000000001,49.799999999999997,50,50.200000000000003,50.399999999999999,50.600000000000001,50.799999999999997,51,51.200000000000003,51.399999999999999,51.600000000000001,51.799999999999997,52,52.200000000000003,52.399999999999999,52.600000000000001,52.799999999999997,53,53.200000000000003,53.399999999999999,53.600000000000001,53.799999999999997,54,54.200000000000003,54.399999999999999,54.600000000000001,54.799999999999997,55,55.200000000000003,55.400000000000006,55.600000000000001,55.799999999999997,56,56.200000000000003,56.400000000000006,56.600000000000001,56.799999999999997,57,57.200000000000003,57.400000000000006,57.600000000000001,57.799999999999997,58,58.200000000000003,58.400000000000006,58.600000000000001,58.799999999999997,59],"y":[0.033297211585089949,0.033709723672810485,0.034127346285239064,0.034550142735581747,0.034978177121418388,0.035411514334420198,0.035850220070187531,0.03629436083820952,0.036744003971947381,0.037199217639042131,0.037660070851649359,0.038126633476901546,0.038598976247500208,0.039077170772439392,0.039561289547861651,0.040051405968049007,0.04054759433654951,0.041049929877442194,0.041558488746741264,0.042073348043941514,0.042594585823707155,0.043122281107704941,0.043656513896584349,0.04419736518210593,0.044744916959419928,0.045299252239497177,0.045860455061713712,0.046428610506591618,0.047003804708697514,0.047586124869700874,0.048175659271594146,0.048772497290076648,0.049376729408104274,0.049988447229607054,0.050607743493376663,0.051234712087125982,0.051869448061722875,0.052512047645600128,0.05316260825934431,0.053821228530464858,0.054488008308346533,0.055163048679386935,0.055846451982321507,0.056538321823738739,0.057238763093786948,0.057947881982076448,0.058665785993777912,0.059392583965920856,0.060128386083893703,0.060873303898148108,0.0616274503411108,0.062390939744304187,0.063163887855679765,0.063946411857165777,0.064738630382432522,0.065540663534877752,0.066352632905834541,0.067174661593005322,0.068006874219123797,0.068849396950848268,0.069702357517888988,0.070565885232372491,0.071440111008445814,0.072325167382123537,0.073221188531380849,0.074128310296495345,0.075046670200641069,0.07597640747073732,0.076917663058556351,0.077870579662091918,0.078835301747192901,0.07981197556946501,0.08080074919644345,0.081801772530040964,0.082815197329272949,0.083841177233265354,0.084879867784546495,0.085931426452627954,0.086996012657877958,0.088073787795689515,0.089164915260949218,0.090269560472807972,0.091387890899759586,0.092520076085029448,0.09366628767227797,0.094826699431622571,0.096001487285981554,0.09719082933774513,0.098394905895776,0.099613899502745309,0.10084799496280665,0.10209737936961277,0.10336224213468029,0.10464277501610457,0.10593917214763168,0.10725163006808927,0.10858034775118282,0.10992552663566091,0.11128737065585381,0.11266608627259123,0.11406188250450208],"text":["age: 39.0<br />odds(chd): 0.03330<br />colour: Type B","age: 39.2<br />odds(chd): 0.03371<br />colour: Type B","age: 39.4<br />odds(chd): 0.03413<br />colour: Type B","age: 39.6<br />odds(chd): 0.03455<br />colour: Type B","age: 39.8<br />odds(chd): 0.03498<br />colour: Type B","age: 40.0<br />odds(chd): 0.03541<br />colour: Type B","age: 40.2<br />odds(chd): 0.03585<br />colour: Type B","age: 40.4<br />odds(chd): 0.03629<br />colour: Type B","age: 40.6<br />odds(chd): 0.03674<br />colour: Type B","age: 40.8<br />odds(chd): 0.03720<br />colour: Type B","age: 41.0<br />odds(chd): 0.03766<br />colour: Type B","age: 41.2<br />odds(chd): 0.03813<br />colour: Type B","age: 41.4<br />odds(chd): 0.03860<br />colour: Type B","age: 41.6<br />odds(chd): 0.03908<br />colour: Type B","age: 41.8<br />odds(chd): 0.03956<br />colour: Type B","age: 42.0<br />odds(chd): 0.04005<br />colour: Type B","age: 42.2<br />odds(chd): 0.04055<br />colour: Type B","age: 42.4<br />odds(chd): 0.04105<br />colour: Type B","age: 42.6<br />odds(chd): 0.04156<br />colour: Type B","age: 42.8<br />odds(chd): 0.04207<br />colour: Type B","age: 43.0<br />odds(chd): 0.04259<br />colour: Type B","age: 43.2<br />odds(chd): 0.04312<br />colour: Type B","age: 43.4<br />odds(chd): 0.04366<br />colour: Type B","age: 43.6<br />odds(chd): 0.04420<br />colour: Type B","age: 43.8<br />odds(chd): 0.04474<br />colour: Type B","age: 44.0<br />odds(chd): 0.04530<br />colour: Type B","age: 44.2<br />odds(chd): 0.04586<br />colour: Type B","age: 44.4<br />odds(chd): 0.04643<br />colour: Type B","age: 44.6<br />odds(chd): 0.04700<br />colour: Type B","age: 44.8<br />odds(chd): 0.04759<br />colour: Type B","age: 45.0<br />odds(chd): 0.04818<br />colour: Type B","age: 45.2<br />odds(chd): 0.04877<br />colour: Type B","age: 45.4<br />odds(chd): 0.04938<br />colour: Type B","age: 45.6<br />odds(chd): 0.04999<br />colour: Type B","age: 45.8<br />odds(chd): 0.05061<br />colour: Type B","age: 46.0<br />odds(chd): 0.05123<br />colour: Type B","age: 46.2<br />odds(chd): 0.05187<br />colour: Type B","age: 46.4<br />odds(chd): 0.05251<br />colour: Type B","age: 46.6<br />odds(chd): 0.05316<br />colour: Type B","age: 46.8<br />odds(chd): 0.05382<br />colour: Type B","age: 47.0<br />odds(chd): 0.05449<br />colour: Type B","age: 47.2<br />odds(chd): 0.05516<br />colour: Type B","age: 47.4<br />odds(chd): 0.05585<br />colour: Type B","age: 47.6<br />odds(chd): 0.05654<br />colour: Type B","age: 47.8<br />odds(chd): 0.05724<br />colour: Type B","age: 48.0<br />odds(chd): 0.05795<br />colour: Type B","age: 48.2<br />odds(chd): 0.05867<br />colour: Type B","age: 48.4<br />odds(chd): 0.05939<br />colour: Type B","age: 48.6<br />odds(chd): 0.06013<br />colour: Type B","age: 48.8<br />odds(chd): 0.06087<br />colour: Type B","age: 49.0<br />odds(chd): 0.06163<br />colour: Type B","age: 49.2<br />odds(chd): 0.06239<br />colour: Type B","age: 49.4<br />odds(chd): 0.06316<br />colour: Type B","age: 49.6<br />odds(chd): 0.06395<br />colour: Type B","age: 49.8<br />odds(chd): 0.06474<br />colour: Type B","age: 50.0<br />odds(chd): 0.06554<br />colour: Type B","age: 50.2<br />odds(chd): 0.06635<br />colour: Type B","age: 50.4<br />odds(chd): 0.06717<br />colour: Type B","age: 50.6<br />odds(chd): 0.06801<br />colour: Type B","age: 50.8<br />odds(chd): 0.06885<br />colour: Type B","age: 51.0<br />odds(chd): 0.06970<br />colour: Type B","age: 51.2<br />odds(chd): 0.07057<br />colour: Type B","age: 51.4<br />odds(chd): 0.07144<br />colour: Type B","age: 51.6<br />odds(chd): 0.07233<br />colour: Type B","age: 51.8<br />odds(chd): 0.07322<br />colour: Type B","age: 52.0<br />odds(chd): 0.07413<br />colour: Type B","age: 52.2<br />odds(chd): 0.07505<br />colour: Type B","age: 52.4<br />odds(chd): 0.07598<br />colour: Type B","age: 52.6<br />odds(chd): 0.07692<br />colour: Type B","age: 52.8<br />odds(chd): 0.07787<br />colour: Type B","age: 53.0<br />odds(chd): 0.07884<br />colour: Type B","age: 53.2<br />odds(chd): 0.07981<br />colour: Type B","age: 53.4<br />odds(chd): 0.08080<br />colour: Type B","age: 53.6<br />odds(chd): 0.08180<br />colour: Type B","age: 53.8<br />odds(chd): 0.08282<br />colour: Type B","age: 54.0<br />odds(chd): 0.08384<br />colour: Type B","age: 54.2<br />odds(chd): 0.08488<br />colour: Type B","age: 54.4<br />odds(chd): 0.08593<br />colour: Type B","age: 54.6<br />odds(chd): 0.08700<br />colour: Type B","age: 54.8<br />odds(chd): 0.08807<br />colour: Type B","age: 55.0<br />odds(chd): 0.08916<br />colour: Type B","age: 55.2<br />odds(chd): 0.09027<br />colour: Type B","age: 55.4<br />odds(chd): 0.09139<br />colour: Type B","age: 55.6<br />odds(chd): 0.09252<br />colour: Type B","age: 55.8<br />odds(chd): 0.09367<br />colour: Type B","age: 56.0<br />odds(chd): 0.09483<br />colour: Type B","age: 56.2<br />odds(chd): 0.09600<br />colour: Type B","age: 56.4<br />odds(chd): 0.09719<br />colour: Type B","age: 56.6<br />odds(chd): 0.09839<br />colour: Type B","age: 56.8<br />odds(chd): 0.09961<br />colour: Type B","age: 57.0<br />odds(chd): 0.10085<br />colour: Type B","age: 57.2<br />odds(chd): 0.10210<br />colour: Type B","age: 57.4<br />odds(chd): 0.10336<br />colour: Type B","age: 57.6<br />odds(chd): 0.10464<br />colour: Type B","age: 57.8<br />odds(chd): 0.10594<br />colour: Type B","age: 58.0<br />odds(chd): 0.10725<br />colour: Type B","age: 58.2<br />odds(chd): 0.10858<br />colour: Type B","age: 58.4<br />odds(chd): 0.10993<br />colour: Type B","age: 58.6<br />odds(chd): 0.11129<br />colour: Type B","age: 58.8<br />odds(chd): 0.11267<br />colour: Type B","age: 59.0<br />odds(chd): 0.11406<br />colour: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[38,60],"tickmode":"array","ticktext":["40","45","50","55","60"],"tickvals":[40,45,50,55,60],"categoryorder":"array","categoryarray":["40","45","50","55","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Age (years)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.016216216216216217,0.34054054054054056],"tickmode":"array","ticktext":["0.0","0.1","0.2","0.3"],"tickvals":[0,0.10000000000000001,0.20000000000000001,0.30000000000000004],"categoryorder":"array","categoryarray":["0.0","0.1","0.2","0.3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"odds(CHD Event by 1969)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Behavioral Pattern<br />n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e7eaeb1eb":{"x":{},"y":{},"colour":{},"size":{},"type":"scatter"},"142e7f22fc46":{"x":{},"y":{},"colour":{}},"142e51e098df":{"x":{},"y":{},"colour":{}},"142e70548277":{"x":{},"y":{},"colour":{}}},"cur_data":"142e7eaeb1eb","visdat":{"142e7eaeb1eb":["function (y) ","x"],"142e7f22fc46":["function (y) ","x"],"142e51e098df":["function (y) ","x"],"142e70548277":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="log-odds-logit-scale-1" class="level3" data-number="5.8.3">
<h3 data-number="5.8.3" class="anchored" data-anchor-id="log-odds-logit-scale-1"><span class="header-section-number">5.8.3</span> log-odds (logit) scale</h3>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-41_0c11a549eead93385b4fe8222ab9e8a8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>curve_type_A <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type A"</span>))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>curve_type_B <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type B"</span>))</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>chd_plot_logit_2 <span class="ot">=</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  chd_plot_logit <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_A,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type A"</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_B,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type B"</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-42_1c8a0f2583113ee25c9d9f6caec7798a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_logit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e390e4543b3ba71e60ec" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e390e4543b3ba71e60ec">{"x":{"data":[{"x":[50,51,59,44,47,40,41,43,54,48,39,49,55,56,42,45,46,57,53,52,58],"y":[-2.1400661634962708,-1.6274564179367788,-1.1895840668738362,-2.4471663218051534,-2.2284771208403238,-2.6230569882688175,-2.6692103677859462,-2.553899521274952,-1.8827312474337818,-1.7346010553881064,-2.3642786619993856,-1.1592369104845446,-1.6314168191528757,-1.126011262856224,-3.188416617383492,-2.3025850929940455,-2.6508917872622613,-1.9095425048844386,-2.0614230361771577,-1.3862943611198906,-1.7578579175523736],"text":["age: 50<br />logit(chd): -2.140<br />dibpat: Type A<br />n:  76","age: 51<br />logit(chd): -1.627<br />dibpat: Type A<br />n:  67","age: 59<br />logit(chd): -1.190<br />dibpat: Type A<br />n:  30","age: 44<br />logit(chd): -2.447<br />dibpat: Type A<br />n: 113","age: 47<br />logit(chd): -2.228<br />dibpat: Type A<br />n:  72","age: 40<br />logit(chd): -2.623<br />dibpat: Type A<br />n: 133","age: 41<br />logit(chd): -2.669<br />dibpat: Type A<br />n: 108","age: 43<br />logit(chd): -2.554<br />dibpat: Type A<br />n:  97","age: 54<br />logit(chd): -1.883<br />dibpat: Type A<br />n:  53","age: 48<br />logit(chd): -1.735<br />dibpat: Type A<br />n:  80","age: 39<br />logit(chd): -2.364<br />dibpat: Type A<br />n: 128","age: 49<br />logit(chd): -1.159<br />dibpat: Type A<br />n:  67","age: 55<br />logit(chd): -1.631<br />dibpat: Type A<br />n:  55","age: 56<br />logit(chd): -1.126<br />dibpat: Type A<br />n:  49","age: 42<br />logit(chd): -3.188<br />dibpat: Type A<br />n: 101","age: 45<br />logit(chd): -2.303<br />dibpat: Type A<br />n:  77","age: 46<br />logit(chd): -2.651<br />dibpat: Type A<br />n:  91","age: 57<br />logit(chd): -1.910<br />dibpat: Type A<br />n:  31","age: 53<br />logit(chd): -2.061<br />dibpat: Type A<br />n:  62","age: 52<br />logit(chd): -1.386<br />dibpat: Type A<br />n:  65","age: 58<br />logit(chd): -1.758<br />dibpat: Type A<br />n:  34"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.69999999999999996,"size":[11.507808770054302,10.893987081881484,7.4072043526108828,13.637611848597116,11.241235656543804,14.615949458394798,13.377458191723871,12.778686124337518,9.8163466467363971,11.765488567001361,14.379833505125502,10.893987081881484,9.9817695786372642,9.4710951773162115,13.000921034406357,11.573027489273997,12.434641120809431,7.5441456810618819,10.52889648301692,10.750245809698832,7.9279346825975772],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[45,41,47,39,49,51,42,50,44,56,40,58,48,43,53,54,46,52,55,57,59],"y":[-3.0349529867072724,-3.1780538303479453,-4.3040650932041693,-2.7880929087757464,-2.5176964726109912,-2.120263536200091,-4.7874917427820458,-2.9267394020670396,-3.3843902633457743,null,-3.8501476017100584,-3.044522437723423,-2.3978952727983707,-2.9267394020670396,-2.0281482472922856,-2.5257286443082556,-2.6946271807700692,-3.1354942159291497,-3.1780538303479453,-2.2686835413183641,-1.1786549963416462],"text":["age: 45<br />logit(chd): -3.035<br />dibpat: Type B<br />n: 109","age: 41<br />logit(chd): -3.178<br />dibpat: Type B<br />n: 125","age: 47<br />logit(chd): -4.304<br />dibpat: Type B<br />n:  75","age: 39<br />logit(chd): -2.788<br />dibpat: Type B<br />n: 138","age: 49<br />logit(chd): -2.518<br />dibpat: Type B<br />n:  67","age: 51<br />logit(chd): -2.120<br />dibpat: Type B<br />n:  56","age: 42<br />logit(chd): -4.787<br />dibpat: Type B<br />n: 121","age: 50<br />logit(chd): -2.927<br />dibpat: Type B<br />n:  59","age: 44<br />logit(chd): -3.384<br />dibpat: Type B<br />n: 122","age: 56<br />logit(chd):   -Inf<br />dibpat: Type B<br />n:  27","age: 40<br />logit(chd): -3.850<br />dibpat: Type B<br />n: 144","age: 58<br />logit(chd): -3.045<br />dibpat: Type B<br />n:  22","age: 48<br />logit(chd): -2.398<br />dibpat: Type B<br />n:  84","age: 43<br />logit(chd): -2.927<br />dibpat: Type B<br />n: 118","age: 53<br />logit(chd): -2.028<br />dibpat: Type B<br />n:  43","age: 54<br />logit(chd): -2.526<br />dibpat: Type B<br />n:  54","age: 46<br />logit(chd): -2.695<br />dibpat: Type B<br />n:  79","age: 52<br />logit(chd): -3.135<br />dibpat: Type B<br />n:  48","age: 55<br />logit(chd): -3.178<br />dibpat: Type B<br />n:  25","age: 57<br />logit(chd): -2.269<br />dibpat: Type B<br />n:  32","age: 59<br />logit(chd): -1.179<br />dibpat: Type B<br />n:  17"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":0.69999999999999996,"size":[13.430049986134389,14.235604935020691,11.442034967876614,14.847029219804128,10.893987081881484,10.062848078932257,14.040147001760529,10.300037417465363,14.089358888134319,6.9612105822972117,15.118110236220474,6.0293172003757194,12.015109867829196,13.89107438878934,8.9098372804078227,9.8996170505112442,11.701854397452983,9.3814585892624311,6.6253113681856641,7.6762775241645578,3.7795275590551185],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[-2.3642786619993856,-2.6230569882688175,-2.6692103677859462,-3.188416617383492,-2.553899521274952,-2.4471663218051534,-2.3025850929940455,-2.6508917872622613,-2.2284771208403238,-1.7346010553881064,-1.1592369104845446,-2.1400661634962708,-1.6274564179367788,-1.3862943611198906,-2.0614230361771577,-1.8827312474337818,-1.6314168191528757,-1.126011262856224,-1.9095425048844386,-1.7578579175523736,-1.1895840668738362],"text":["age: 39<br />logit(chd): -2.364<br />dibpat: Type A","age: 40<br />logit(chd): -2.623<br />dibpat: Type A","age: 41<br />logit(chd): -2.669<br />dibpat: Type A","age: 42<br />logit(chd): -3.188<br />dibpat: Type A","age: 43<br />logit(chd): -2.554<br />dibpat: Type A","age: 44<br />logit(chd): -2.447<br />dibpat: Type A","age: 45<br />logit(chd): -2.303<br />dibpat: Type A","age: 46<br />logit(chd): -2.651<br />dibpat: Type A","age: 47<br />logit(chd): -2.228<br />dibpat: Type A","age: 48<br />logit(chd): -1.735<br />dibpat: Type A","age: 49<br />logit(chd): -1.159<br />dibpat: Type A","age: 50<br />logit(chd): -2.140<br />dibpat: Type A","age: 51<br />logit(chd): -1.627<br />dibpat: Type A","age: 52<br />logit(chd): -1.386<br />dibpat: Type A","age: 53<br />logit(chd): -2.061<br />dibpat: Type A","age: 54<br />logit(chd): -1.883<br />dibpat: Type A","age: 55<br />logit(chd): -1.631<br />dibpat: Type A","age: 56<br />logit(chd): -1.126<br />dibpat: Type A","age: 57<br />logit(chd): -1.910<br />dibpat: Type A","age: 58<br />logit(chd): -1.758<br />dibpat: Type A","age: 59<br />logit(chd): -1.190<br />dibpat: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[-2.7880929087757464,-3.8501476017100584,-3.1780538303479453,-4.7874917427820458,-2.9267394020670396,-3.3843902633457743,-3.0349529867072724,-2.6946271807700692,-4.3040650932041693,-2.3978952727983707,-2.5176964726109912,-2.9267394020670396,-2.120263536200091,-3.1354942159291497,-2.0281482472922856,-2.5257286443082556,-3.1780538303479453,null,-2.2686835413183641,-3.044522437723423,-1.1786549963416462],"text":["age: 39<br />logit(chd): -2.788<br />dibpat: Type B","age: 40<br />logit(chd): -3.850<br />dibpat: Type B","age: 41<br />logit(chd): -3.178<br />dibpat: Type B","age: 42<br />logit(chd): -4.787<br />dibpat: Type B","age: 43<br />logit(chd): -2.927<br />dibpat: Type B","age: 44<br />logit(chd): -3.384<br />dibpat: Type B","age: 45<br />logit(chd): -3.035<br />dibpat: Type B","age: 46<br />logit(chd): -2.695<br />dibpat: Type B","age: 47<br />logit(chd): -4.304<br />dibpat: Type B","age: 48<br />logit(chd): -2.398<br />dibpat: Type B","age: 49<br />logit(chd): -2.518<br />dibpat: Type B","age: 50<br />logit(chd): -2.927<br />dibpat: Type B","age: 51<br />logit(chd): -2.120<br />dibpat: Type B","age: 52<br />logit(chd): -3.135<br />dibpat: Type B","age: 53<br />logit(chd): -2.028<br />dibpat: Type B","age: 54<br />logit(chd): -2.526<br />dibpat: Type B","age: 55<br />logit(chd): -3.178<br />dibpat: Type B","age: 56<br />logit(chd):   -Inf<br />dibpat: Type B","age: 57<br />logit(chd): -2.269<br />dibpat: Type B","age: 58<br />logit(chd): -3.045<br />dibpat: Type B","age: 59<br />logit(chd): -1.179<br />dibpat: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,39.200000000000003,39.399999999999999,39.600000000000001,39.799999999999997,40,40.200000000000003,40.399999999999999,40.600000000000001,40.799999999999997,41,41.200000000000003,41.399999999999999,41.600000000000001,41.799999999999997,42,42.200000000000003,42.399999999999999,42.600000000000001,42.799999999999997,43,43.200000000000003,43.399999999999999,43.600000000000001,43.799999999999997,44,44.200000000000003,44.399999999999999,44.600000000000001,44.799999999999997,45,45.200000000000003,45.399999999999999,45.600000000000001,45.799999999999997,46,46.200000000000003,46.399999999999999,46.600000000000001,46.799999999999997,47,47.200000000000003,47.399999999999999,47.600000000000001,47.799999999999997,48,48.200000000000003,48.399999999999999,48.600000000000001,48.799999999999997,49,49.200000000000003,49.399999999999999,49.600000000000001,49.799999999999997,50,50.200000000000003,50.399999999999999,50.600000000000001,50.799999999999997,51,51.200000000000003,51.399999999999999,51.600000000000001,51.799999999999997,52,52.200000000000003,52.399999999999999,52.600000000000001,52.799999999999997,53,53.200000000000003,53.399999999999999,53.600000000000001,53.799999999999997,54,54.200000000000003,54.399999999999999,54.600000000000001,54.799999999999997,55,55.200000000000003,55.400000000000006,55.600000000000001,55.799999999999997,56,56.200000000000003,56.400000000000006,56.600000000000001,56.799999999999997,57,57.200000000000003,57.400000000000006,57.600000000000001,57.799999999999997,58,58.200000000000003,58.400000000000006,58.600000000000001,58.799999999999997,59],"y":[-2.6944831446682795,-2.6801017157015048,-2.6657202867347309,-2.6513388577679562,-2.6369574288011819,-2.6225759998344076,-2.6081945708676328,-2.593813141900859,-2.5794317129340842,-2.5650502839673099,-2.5506688550005356,-2.5362874260337609,-2.5219059970669866,-2.5075245681002123,-2.493143139133438,-2.4787617101666632,-2.4643802811998889,-2.4499988522331146,-2.4356174232663403,-2.421235994299566,-2.4068545653327913,-2.392473136366017,-2.3780917073992427,-2.3637102784324679,-2.3493288494656941,-2.3349474204989193,-2.3205659915321446,-2.3061845625653707,-2.291803133598596,-2.2774217046318221,-2.2630402756650474,-2.2486588466982727,-2.2342774177314988,-2.219895988764724,-2.2055145597979502,-2.1911331308311754,-2.1767517018644007,-2.1623702728976268,-2.1479888439308521,-2.1336074149640778,-2.1192259859973035,-2.1048445570305288,-2.0904631280637544,-2.0760816990969801,-2.0617002701302058,-2.0473188411634311,-2.0329374121966568,-2.0185559832298825,-2.0041745542631082,-1.9897931252963339,-1.9754116963295594,-1.9610302673627846,-1.9466488383960106,-1.932267409429236,-1.9178859804624619,-1.9035045514956872,-1.8891231225289127,-1.8747416935621386,-1.8603602645953641,-1.8459788356285898,-1.8315974066618153,-1.8172159776950407,-1.8028345487282667,-1.7884531197614919,-1.7740716907947178,-1.7596902618279433,-1.7453088328611686,-1.7309274038943945,-1.71654597492762,-1.7021645459608459,-1.6877831169940711,-1.6734016880272966,-1.6590202590605225,-1.644638830093748,-1.6302574011269739,-1.6158759721601992,-1.6014945431934247,-1.5871131142266506,-1.5727316852598758,-1.5583502562931018,-1.5439688273263272,-1.5295873983595525,-1.515205969392778,-1.5008245404260039,-1.4864431114592298,-1.4720616824924551,-1.4576802535256805,-1.443298824558906,-1.4289173955921319,-1.4145359666253579,-1.4001545376585831,-1.3857731086918086,-1.3713916797250338,-1.3570102507582598,-1.3426288217914857,-1.3282473928247112,-1.3138659638579364,-1.2994845348911619,-1.2851031059243878,-1.2707216769576137,-1.2563402479908392],"text":["age: 39.0<br />logit(chd): -2.694<br />colour: Type A","age: 39.2<br />logit(chd): -2.680<br />colour: Type A","age: 39.4<br />logit(chd): -2.666<br />colour: Type A","age: 39.6<br />logit(chd): -2.651<br />colour: Type A","age: 39.8<br />logit(chd): -2.637<br />colour: Type A","age: 40.0<br />logit(chd): -2.623<br />colour: Type A","age: 40.2<br />logit(chd): -2.608<br />colour: Type A","age: 40.4<br />logit(chd): -2.594<br />colour: Type A","age: 40.6<br />logit(chd): -2.579<br />colour: Type A","age: 40.8<br />logit(chd): -2.565<br />colour: Type A","age: 41.0<br />logit(chd): -2.551<br />colour: Type A","age: 41.2<br />logit(chd): -2.536<br />colour: Type A","age: 41.4<br />logit(chd): -2.522<br />colour: Type A","age: 41.6<br />logit(chd): -2.508<br />colour: Type A","age: 41.8<br />logit(chd): -2.493<br />colour: Type A","age: 42.0<br />logit(chd): -2.479<br />colour: Type A","age: 42.2<br />logit(chd): -2.464<br />colour: Type A","age: 42.4<br />logit(chd): -2.450<br />colour: Type A","age: 42.6<br />logit(chd): -2.436<br />colour: Type A","age: 42.8<br />logit(chd): -2.421<br />colour: Type A","age: 43.0<br />logit(chd): -2.407<br />colour: Type A","age: 43.2<br />logit(chd): -2.392<br />colour: Type A","age: 43.4<br />logit(chd): -2.378<br />colour: Type A","age: 43.6<br />logit(chd): -2.364<br />colour: Type A","age: 43.8<br />logit(chd): -2.349<br />colour: Type A","age: 44.0<br />logit(chd): -2.335<br />colour: Type A","age: 44.2<br />logit(chd): -2.321<br />colour: Type A","age: 44.4<br />logit(chd): -2.306<br />colour: Type A","age: 44.6<br />logit(chd): -2.292<br />colour: Type A","age: 44.8<br />logit(chd): -2.277<br />colour: Type A","age: 45.0<br />logit(chd): -2.263<br />colour: Type A","age: 45.2<br />logit(chd): -2.249<br />colour: Type A","age: 45.4<br />logit(chd): -2.234<br />colour: Type A","age: 45.6<br />logit(chd): -2.220<br />colour: Type A","age: 45.8<br />logit(chd): -2.206<br />colour: Type A","age: 46.0<br />logit(chd): -2.191<br />colour: Type A","age: 46.2<br />logit(chd): -2.177<br />colour: Type A","age: 46.4<br />logit(chd): -2.162<br />colour: Type A","age: 46.6<br />logit(chd): -2.148<br />colour: Type A","age: 46.8<br />logit(chd): -2.134<br />colour: Type A","age: 47.0<br />logit(chd): -2.119<br />colour: Type A","age: 47.2<br />logit(chd): -2.105<br />colour: Type A","age: 47.4<br />logit(chd): -2.090<br />colour: Type A","age: 47.6<br />logit(chd): -2.076<br />colour: Type A","age: 47.8<br />logit(chd): -2.062<br />colour: Type A","age: 48.0<br />logit(chd): -2.047<br />colour: Type A","age: 48.2<br />logit(chd): -2.033<br />colour: Type A","age: 48.4<br />logit(chd): -2.019<br />colour: Type A","age: 48.6<br />logit(chd): -2.004<br />colour: Type A","age: 48.8<br />logit(chd): -1.990<br />colour: Type A","age: 49.0<br />logit(chd): -1.975<br />colour: Type A","age: 49.2<br />logit(chd): -1.961<br />colour: Type A","age: 49.4<br />logit(chd): -1.947<br />colour: Type A","age: 49.6<br />logit(chd): -1.932<br />colour: Type A","age: 49.8<br />logit(chd): -1.918<br />colour: Type A","age: 50.0<br />logit(chd): -1.904<br />colour: Type A","age: 50.2<br />logit(chd): -1.889<br />colour: Type A","age: 50.4<br />logit(chd): -1.875<br />colour: Type A","age: 50.6<br />logit(chd): -1.860<br />colour: Type A","age: 50.8<br />logit(chd): -1.846<br />colour: Type A","age: 51.0<br />logit(chd): -1.832<br />colour: Type A","age: 51.2<br />logit(chd): -1.817<br />colour: Type A","age: 51.4<br />logit(chd): -1.803<br />colour: Type A","age: 51.6<br />logit(chd): -1.788<br />colour: Type A","age: 51.8<br />logit(chd): -1.774<br />colour: Type A","age: 52.0<br />logit(chd): -1.760<br />colour: Type A","age: 52.2<br />logit(chd): -1.745<br />colour: Type A","age: 52.4<br />logit(chd): -1.731<br />colour: Type A","age: 52.6<br />logit(chd): -1.717<br />colour: Type A","age: 52.8<br />logit(chd): -1.702<br />colour: Type A","age: 53.0<br />logit(chd): -1.688<br />colour: Type A","age: 53.2<br />logit(chd): -1.673<br />colour: Type A","age: 53.4<br />logit(chd): -1.659<br />colour: Type A","age: 53.6<br />logit(chd): -1.645<br />colour: Type A","age: 53.8<br />logit(chd): -1.630<br />colour: Type A","age: 54.0<br />logit(chd): -1.616<br />colour: Type A","age: 54.2<br />logit(chd): -1.601<br />colour: Type A","age: 54.4<br />logit(chd): -1.587<br />colour: Type A","age: 54.6<br />logit(chd): -1.573<br />colour: Type A","age: 54.8<br />logit(chd): -1.558<br />colour: Type A","age: 55.0<br />logit(chd): -1.544<br />colour: Type A","age: 55.2<br />logit(chd): -1.530<br />colour: Type A","age: 55.4<br />logit(chd): -1.515<br />colour: Type A","age: 55.6<br />logit(chd): -1.501<br />colour: Type A","age: 55.8<br />logit(chd): -1.486<br />colour: Type A","age: 56.0<br />logit(chd): -1.472<br />colour: Type A","age: 56.2<br />logit(chd): -1.458<br />colour: Type A","age: 56.4<br />logit(chd): -1.443<br />colour: Type A","age: 56.6<br />logit(chd): -1.429<br />colour: Type A","age: 56.8<br />logit(chd): -1.415<br />colour: Type A","age: 57.0<br />logit(chd): -1.400<br />colour: Type A","age: 57.2<br />logit(chd): -1.386<br />colour: Type A","age: 57.4<br />logit(chd): -1.371<br />colour: Type A","age: 57.6<br />logit(chd): -1.357<br />colour: Type A","age: 57.8<br />logit(chd): -1.343<br />colour: Type A","age: 58.0<br />logit(chd): -1.328<br />colour: Type A","age: 58.2<br />logit(chd): -1.314<br />colour: Type A","age: 58.4<br />logit(chd): -1.299<br />colour: Type A","age: 58.6<br />logit(chd): -1.285<br />colour: Type A","age: 58.8<br />logit(chd): -1.271<br />colour: Type A","age: 59.0<br />logit(chd): -1.256<br />colour: Type A"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39,39.200000000000003,39.399999999999999,39.600000000000001,39.799999999999997,40,40.200000000000003,40.399999999999999,40.600000000000001,40.799999999999997,41,41.200000000000003,41.399999999999999,41.600000000000001,41.799999999999997,42,42.200000000000003,42.399999999999999,42.600000000000001,42.799999999999997,43,43.200000000000003,43.399999999999999,43.600000000000001,43.799999999999997,44,44.200000000000003,44.399999999999999,44.600000000000001,44.799999999999997,45,45.200000000000003,45.399999999999999,45.600000000000001,45.799999999999997,46,46.200000000000003,46.399999999999999,46.600000000000001,46.799999999999997,47,47.200000000000003,47.399999999999999,47.600000000000001,47.799999999999997,48,48.200000000000003,48.399999999999999,48.600000000000001,48.799999999999997,49,49.200000000000003,49.399999999999999,49.600000000000001,49.799999999999997,50,50.200000000000003,50.399999999999999,50.600000000000001,50.799999999999997,51,51.200000000000003,51.399999999999999,51.600000000000001,51.799999999999997,52,52.200000000000003,52.399999999999999,52.600000000000001,52.799999999999997,53,53.200000000000003,53.399999999999999,53.600000000000001,53.799999999999997,54,54.200000000000003,54.399999999999999,54.600000000000001,54.799999999999997,55,55.200000000000003,55.400000000000006,55.600000000000001,55.799999999999997,56,56.200000000000003,56.400000000000006,56.600000000000001,56.799999999999997,57,57.200000000000003,57.400000000000006,57.600000000000001,57.799999999999997,58,58.200000000000003,58.400000000000006,58.600000000000001,58.799999999999997,59],"y":[-3.4022816216852938,-3.3899689469572318,-3.3776562722291708,-3.3653435975011092,-3.3530309227730477,-3.3407182480449862,-3.3284055733169242,-3.3160928985888631,-3.3037802238608012,-3.2914675491327401,-3.2791548744046786,-3.2668421996766166,-3.2545295249485555,-3.2422168502204936,-3.2299041754924325,-3.2175915007643705,-3.205278826036309,-3.1929661513082479,-3.1806534765801859,-3.1683408018521249,-3.1560281271240629,-3.1437154523960014,-3.1314027776679398,-3.1190901029398783,-3.1067774282118172,-3.0944647534837553,-3.0821520787556937,-3.0698394040276322,-3.0575267292995707,-3.0452140545715092,-3.0329013798434477,-3.0205887051153861,-3.0082760303873246,-2.9959633556592631,-2.9836506809312016,-2.97133800620314,-2.9590253314750781,-2.946712656747017,-2.9343999820189555,-2.9220873072908939,-2.9097746325628324,-2.8974619578347705,-2.8851492831067094,-2.8728366083786474,-2.8605239336505863,-2.8482112589225244,-2.8358985841944628,-2.8235859094664018,-2.8112732347383398,-2.7989605600102787,-2.7866478852822167,-2.7743352105541552,-2.7620225358260937,-2.7497098610980322,-2.7373971863699711,-2.7250845116419091,-2.7127718369138476,-2.7004591621857861,-2.6881464874577246,-2.675833812729663,-2.6635211380016015,-2.65120846327354,-2.6388957885454785,-2.6265831138174169,-2.6142704390893554,-2.6019577643612939,-2.5896450896332319,-2.5773324149051708,-2.5650197401771093,-2.5527070654490478,-2.5403943907209863,-2.5280817159929243,-2.5157690412648632,-2.5034563665368013,-2.4911436918087402,-2.4788310170806787,-2.4665183423526167,-2.4542056676245556,-2.4418929928964936,-2.4295803181684326,-2.4172676434403706,-2.4049549687123091,-2.3926422939842475,-2.380329619256186,-2.3680169445281249,-2.355704269800063,-2.3433915950720015,-2.3310789203439395,-2.3187662456158784,-2.3064535708878173,-2.2941408961597554,-2.2818282214316938,-2.2695155467036319,-2.2572028719755708,-2.2448901972475093,-2.2325775225194477,-2.2202648477913862,-2.2079521730633243,-2.1956394983352632,-2.1833268236072016,-2.1710141488791401],"text":["age: 39.0<br />logit(chd): -3.402<br />colour: Type B","age: 39.2<br />logit(chd): -3.390<br />colour: Type B","age: 39.4<br />logit(chd): -3.378<br />colour: Type B","age: 39.6<br />logit(chd): -3.365<br />colour: Type B","age: 39.8<br />logit(chd): -3.353<br />colour: Type B","age: 40.0<br />logit(chd): -3.341<br />colour: Type B","age: 40.2<br />logit(chd): -3.328<br />colour: Type B","age: 40.4<br />logit(chd): -3.316<br />colour: Type B","age: 40.6<br />logit(chd): -3.304<br />colour: Type B","age: 40.8<br />logit(chd): -3.291<br />colour: Type B","age: 41.0<br />logit(chd): -3.279<br />colour: Type B","age: 41.2<br />logit(chd): -3.267<br />colour: Type B","age: 41.4<br />logit(chd): -3.255<br />colour: Type B","age: 41.6<br />logit(chd): -3.242<br />colour: Type B","age: 41.8<br />logit(chd): -3.230<br />colour: Type B","age: 42.0<br />logit(chd): -3.218<br />colour: Type B","age: 42.2<br />logit(chd): -3.205<br />colour: Type B","age: 42.4<br />logit(chd): -3.193<br />colour: Type B","age: 42.6<br />logit(chd): -3.181<br />colour: Type B","age: 42.8<br />logit(chd): -3.168<br />colour: Type B","age: 43.0<br />logit(chd): -3.156<br />colour: Type B","age: 43.2<br />logit(chd): -3.144<br />colour: Type B","age: 43.4<br />logit(chd): -3.131<br />colour: Type B","age: 43.6<br />logit(chd): -3.119<br />colour: Type B","age: 43.8<br />logit(chd): -3.107<br />colour: Type B","age: 44.0<br />logit(chd): -3.094<br />colour: Type B","age: 44.2<br />logit(chd): -3.082<br />colour: Type B","age: 44.4<br />logit(chd): -3.070<br />colour: Type B","age: 44.6<br />logit(chd): -3.058<br />colour: Type B","age: 44.8<br />logit(chd): -3.045<br />colour: Type B","age: 45.0<br />logit(chd): -3.033<br />colour: Type B","age: 45.2<br />logit(chd): -3.021<br />colour: Type B","age: 45.4<br />logit(chd): -3.008<br />colour: Type B","age: 45.6<br />logit(chd): -2.996<br />colour: Type B","age: 45.8<br />logit(chd): -2.984<br />colour: Type B","age: 46.0<br />logit(chd): -2.971<br />colour: Type B","age: 46.2<br />logit(chd): -2.959<br />colour: Type B","age: 46.4<br />logit(chd): -2.947<br />colour: Type B","age: 46.6<br />logit(chd): -2.934<br />colour: Type B","age: 46.8<br />logit(chd): -2.922<br />colour: Type B","age: 47.0<br />logit(chd): -2.910<br />colour: Type B","age: 47.2<br />logit(chd): -2.897<br />colour: Type B","age: 47.4<br />logit(chd): -2.885<br />colour: Type B","age: 47.6<br />logit(chd): -2.873<br />colour: Type B","age: 47.8<br />logit(chd): -2.861<br />colour: Type B","age: 48.0<br />logit(chd): -2.848<br />colour: Type B","age: 48.2<br />logit(chd): -2.836<br />colour: Type B","age: 48.4<br />logit(chd): -2.824<br />colour: Type B","age: 48.6<br />logit(chd): -2.811<br />colour: Type B","age: 48.8<br />logit(chd): -2.799<br />colour: Type B","age: 49.0<br />logit(chd): -2.787<br />colour: Type B","age: 49.2<br />logit(chd): -2.774<br />colour: Type B","age: 49.4<br />logit(chd): -2.762<br />colour: Type B","age: 49.6<br />logit(chd): -2.750<br />colour: Type B","age: 49.8<br />logit(chd): -2.737<br />colour: Type B","age: 50.0<br />logit(chd): -2.725<br />colour: Type B","age: 50.2<br />logit(chd): -2.713<br />colour: Type B","age: 50.4<br />logit(chd): -2.700<br />colour: Type B","age: 50.6<br />logit(chd): -2.688<br />colour: Type B","age: 50.8<br />logit(chd): -2.676<br />colour: Type B","age: 51.0<br />logit(chd): -2.664<br />colour: Type B","age: 51.2<br />logit(chd): -2.651<br />colour: Type B","age: 51.4<br />logit(chd): -2.639<br />colour: Type B","age: 51.6<br />logit(chd): -2.627<br />colour: Type B","age: 51.8<br />logit(chd): -2.614<br />colour: Type B","age: 52.0<br />logit(chd): -2.602<br />colour: Type B","age: 52.2<br />logit(chd): -2.590<br />colour: Type B","age: 52.4<br />logit(chd): -2.577<br />colour: Type B","age: 52.6<br />logit(chd): -2.565<br />colour: Type B","age: 52.8<br />logit(chd): -2.553<br />colour: Type B","age: 53.0<br />logit(chd): -2.540<br />colour: Type B","age: 53.2<br />logit(chd): -2.528<br />colour: Type B","age: 53.4<br />logit(chd): -2.516<br />colour: Type B","age: 53.6<br />logit(chd): -2.503<br />colour: Type B","age: 53.8<br />logit(chd): -2.491<br />colour: Type B","age: 54.0<br />logit(chd): -2.479<br />colour: Type B","age: 54.2<br />logit(chd): -2.467<br />colour: Type B","age: 54.4<br />logit(chd): -2.454<br />colour: Type B","age: 54.6<br />logit(chd): -2.442<br />colour: Type B","age: 54.8<br />logit(chd): -2.430<br />colour: Type B","age: 55.0<br />logit(chd): -2.417<br />colour: Type B","age: 55.2<br />logit(chd): -2.405<br />colour: Type B","age: 55.4<br />logit(chd): -2.393<br />colour: Type B","age: 55.6<br />logit(chd): -2.380<br />colour: Type B","age: 55.8<br />logit(chd): -2.368<br />colour: Type B","age: 56.0<br />logit(chd): -2.356<br />colour: Type B","age: 56.2<br />logit(chd): -2.343<br />colour: Type B","age: 56.4<br />logit(chd): -2.331<br />colour: Type B","age: 56.6<br />logit(chd): -2.319<br />colour: Type B","age: 56.8<br />logit(chd): -2.306<br />colour: Type B","age: 57.0<br />logit(chd): -2.294<br />colour: Type B","age: 57.2<br />logit(chd): -2.282<br />colour: Type B","age: 57.4<br />logit(chd): -2.270<br />colour: Type B","age: 57.6<br />logit(chd): -2.257<br />colour: Type B","age: 57.8<br />logit(chd): -2.245<br />colour: Type B","age: 58.0<br />logit(chd): -2.233<br />colour: Type B","age: 58.2<br />logit(chd): -2.220<br />colour: Type B","age: 58.4<br />logit(chd): -2.208<br />colour: Type B","age: 58.6<br />logit(chd): -2.196<br />colour: Type B","age: 58.8<br />logit(chd): -2.183<br />colour: Type B","age: 59.0<br />logit(chd): -2.171<br />colour: Type B"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[38,60],"tickmode":"array","ticktext":["40","45","50","55","60"],"tickvals":[40,45,50,55,60],"categoryorder":"array","categoryarray":["40","45","50","55","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Age (years)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.9705657667783365,-0.94293723885993286],"tickmode":"array","ticktext":["-4","-3","-2","-1"],"tickvals":[-4,-3,-2,-1],"categoryorder":"array","categoryarray":["-4","-3","-2","-1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"log{odds(CHD Event by 1969)}","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Behavioral Pattern<br />n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e7552fb7":{"x":{},"y":{},"colour":{},"size":{},"type":"scatter"},"142e69af9b23":{"x":{},"y":{},"colour":{}},"142e7f24d0a":{"x":{},"y":{},"colour":{}},"142e349fcf99":{"x":{},"y":{},"colour":{}}},"cur_data":"142e7552fb7","visdat":{"142e7552fb7":["function (y) ","x"],"142e69af9b23":["function (y) ","x"],"142e7f24d0a":["function (y) ","x"],"142e349fcf99":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="reference-group-and-contrast-parametrization" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="reference-group-and-contrast-parametrization"><span class="header-section-number">5.9</span> reference-group and contrast parametrization</h2>
<p>We can also use the corner-point parametrization (with reference groups and contrasts):</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-44_5a9cd36403cab1bee0a9be401817e14b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>chd_glm_contrasts <span class="ot">=</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span> <span class="ot">=</span> _,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"formula"</span> <span class="ot">=</span> chd69 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> dibpat<span class="sc">*</span>age, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>chd_glm_contrasts <span class="sc">|&gt;</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Odds</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-5.50</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">(-6.83, -4.19)</td>
<td style="text-align: center;">-8.18</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B)</td>
<td style="text-align: center;">-0.30</td>
<td style="text-align: center;">1.18</td>
<td style="text-align: center;">(-2.63, 2.02)</td>
<td style="text-align: center;">-0.26</td>
<td style="text-align: center;">0.797</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.05, 0.10)</td>
<td style="text-align: center;">5.24</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B) × age</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(-0.06, 0.04)</td>
<td style="text-align: center;">-0.42</td>
<td style="text-align: center;">0.674</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Compare with what we had before:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-45_a9799788b4899226baf86559d018ec06">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Odds</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A)</td>
<td style="text-align: center;">-5.50</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">(-6.83, -4.19)</td>
<td style="text-align: center;">-8.18</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B)</td>
<td style="text-align: center;">-5.80</td>
<td style="text-align: center;">0.98</td>
<td style="text-align: center;">(-7.73, -3.90)</td>
<td style="text-align: center;">-5.95</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A) × age</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.05, 0.10)</td>
<td style="text-align: center;">5.24</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B) × age</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(0.02, 0.10)</td>
<td style="text-align: center;">3.01</td>
<td style="text-align: center;">0.003</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If I give you model 1, how would you get the coefficients of model 2?</p>
</section>
</section>
<section id="fitting-logistic-regression-models" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Fitting logistic regression models</h1>
<section id="section" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="section"><span class="header-section-number">6.1</span> </h2>
<p>In general, the estimating equation <span class="math inline">\(\ell'(\beta; \mathbf x) = 0\)</span> cannot be solved analytically.</p>
<p>Instead, we have to use a variant of the Newton-Raphson method, which was discussed briefly in Epi 203. We won’t go over it in this class; if you need to learn it, see Chapter 4 of Dobson and Barnett.</p>
<p>For now, all you need to know is that we make an iterative series of guesses, and each guess helps us make the next guess better (higher log-likelihood).</p>
<p>You can see some information about this process like so:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-46_1f139a5eb07a4aea5d5a2fca662c0bb4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">8</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">=</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glm.control</span>(<span class="at">trace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span> <span class="ot">=</span> _,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"formula"</span> <span class="ot">=</span> chd69 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> dibpat<span class="sc">*</span>age, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Deviance = 1775.7899 Iterations - 1
Deviance = 1708.5396 Iterations - 2
Deviance = 1704.0434 Iterations - 3
Deviance = 1703.9833 Iterations - 4
Deviance = 1703.9832 Iterations - 5
Deviance = 1703.9832 Iterations - 6</code></pre>
</div>
</div>
<p>After each iteration of the fitting procedure, the deviance (<span class="math inline">\(2(\ell_{\text{full}} - \ell(\hat\beta))\)</span> ) is printed. You can see that the algorithm took six iterations to converge to a solution where the likelihood wasn’t changing much anymore.</p>
</section>
</section>
<section id="sec-gof" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Model comparisons for logistic models</h1>
<section id="deviance-test" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="deviance-test"><span class="header-section-number">7.1</span> Deviance test</h2>
<p>We can compare the maximized log-likelihood of our model, <span class="math inline">\(\ell(\hat\beta; \mathbf x)\)</span>, versus the log-likelihood of the full model (aka saturated model aka maximal model), <span class="math inline">\(\ell_{\text{full}}\)</span>, which has one parameter per covariate pattern. With enough data, <span class="math inline">\(2(\ell_{\text{full}} - \ell(\hat\beta; \mathbf x)) \dot \sim \chi^2(N - p)\)</span>, where <span class="math inline">\(N\)</span> is the number of distinct covariate patterns and <span class="math inline">\(p\)</span> is the number of <span class="math inline">\(\beta\)</span> parameters in our model. A significant p-value for this <strong>deviance</strong> statistic indicates that there’s some detectable pattern in the data that our model isn’t flexible enough to catch.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The deviance statistic needs to have a large amount of data <strong>for each covariate pattern</strong> for the <span class="math inline">\(\chi^2\)</span> approximation to hold. A guideline from Dobson is that if there are <span class="math inline">\(q\)</span> distinct covariate patterns <span class="math inline">\(x_1...,x_q\)</span>, with <span class="math inline">\(n_1,...,n_q\)</span> observations per pattern, then the expected frequencies <span class="math inline">\(n_k \cdot \pi(x_k)\)</span> should be at least 1 for every pattern <span class="math inline">\(k\in 1:q\)</span>.</p>
</div>
</div>
<p>If you have covariates measured on a continuous scale, you may not be able to use the deviance tests to assess goodness of fit.</p>
</section>
<section id="hosmer-lemeshow-test" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="hosmer-lemeshow-test"><span class="header-section-number">7.2</span> Hosmer-Lemeshow test</h2>
<p>If our covariate patterns produce groups that are too small, a reasonable solution is to make bigger groups by merging some of the covariate-pattern groups together.</p>
<p>Hosmer and Lemeshow (1980) proposed that we group the patterns by their predicted probabilities according to the model of interest. For example, you could group all of the observations with predicted probabilities of 10% or less together, then group the observations with 11%-20% probability together, and so on; <span class="math inline">\(g=10\)</span> categories in all.</p>
<p>Then we can construct a statistic <span class="math display">\[X^2 = \sum_{c=1}^g \frac{(o_c - e_c)^2}{e_c}\]</span> where <span class="math inline">\(o_c\)</span> is the number of events <em>observed</em> in group <span class="math inline">\(c\)</span>, and <span class="math inline">\(e_c\)</span> is the number of events expected in group <span class="math inline">\(c\)</span> (based on the sum of the fitted values <span class="math inline">\(\hat\pi_i\)</span> for observations in group <span class="math inline">\(c\)</span>).</p>
<p>If each group has enough observations in it, you can compare <span class="math inline">\(X^2\)</span> to a <span class="math inline">\(\chi^2\)</span> distribution; by simulation, the degrees of freedom has been found to be approximately <span class="math inline">\(g-2\)</span>.</p>
<p>For our CHD model, this procedure would be:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-47_5b17177dd317cc6681946d53f8f7c514">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>wcgs <span class="ot">=</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_probs_glm1 =</span> chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_prob_cats1 =</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      pred_probs_glm1 <span class="sc">|&gt;</span> </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cut</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>), </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>HL_table <span class="ot">=</span> </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> pred_prob_cats1,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">o =</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="fu">sum</span>(pred_probs_glm1)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>HL_table <span class="sc">|&gt;</span> <span class="fu">pander</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">pred_prob_cats1</th>
<th style="text-align: center;">n</th>
<th style="text-align: center;">o</th>
<th style="text-align: center;">e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">(0.1,0.2]</td>
<td style="text-align: center;">785</td>
<td style="text-align: center;">116</td>
<td style="text-align: center;">108</td>
</tr>
<tr class="even">
<td style="text-align: center;">(0.2,0.3]</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">13.77</td>
</tr>
<tr class="odd">
<td style="text-align: center;">[0,0.1]</td>
<td style="text-align: center;">2305</td>
<td style="text-align: center;">129</td>
<td style="text-align: center;">135.2</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">=</span> HL_table <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">X^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>((o<span class="sc">-</span>e)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>e)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">`</span><span class="at">X^2</span><span class="st">`</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.1102871</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>pval1 <span class="ot">=</span> <span class="fu">pchisq</span>(X2, <span class="at">lower =</span> <span class="cn">FALSE</span>, <span class="at">df =</span> <span class="fu">nrow</span>(HL_table) <span class="sc">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Our statistic is <span class="math inline">\(X^2 = 1.11028711\)</span>; <span class="math inline">\(p(\chi^2(1) &gt; 1.11028711) = 0.29201955\)</span>, which is our p-value for detecting a lack of goodness of fit.</p>
<p>Unfortunately that grouping plan left us with just three categories with any observations, so instead of grouping by 10% increments of predicted probability, typically analysts use deciles of the predicted probabilities:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-48_c093be1b4fc48902c345943f5a67a897">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>wcgs <span class="ot">=</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_probs_glm1 =</span> chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_prob_cats1 =</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>      pred_probs_glm1 <span class="sc">|&gt;</span> </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cut</span>(<span class="at">breaks =</span> <span class="fu">quantile</span>(pred_probs_glm1, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)), </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>HL_table <span class="ot">=</span> </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> pred_prob_cats1,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">o =</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="fu">sum</span>(pred_probs_glm1)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>HL_table <span class="sc">|&gt;</span> <span class="fu">pander</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">pred_prob_cats1</th>
<th style="text-align: center;">n</th>
<th style="text-align: center;">o</th>
<th style="text-align: center;">e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">(0.114,0.147]</td>
<td style="text-align: center;">275</td>
<td style="text-align: center;">48</td>
<td style="text-align: center;">36.81</td>
</tr>
<tr class="even">
<td style="text-align: center;">(0.147,0.222]</td>
<td style="text-align: center;">314</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">57.19</td>
</tr>
<tr class="odd">
<td style="text-align: center;">(0.0774,0.0942]</td>
<td style="text-align: center;">371</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">32.56</td>
</tr>
<tr class="even">
<td style="text-align: center;">(0.0942,0.114]</td>
<td style="text-align: center;">282</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">29.89</td>
</tr>
<tr class="odd">
<td style="text-align: center;">(0.0633,0.069]</td>
<td style="text-align: center;">237</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">15.97</td>
</tr>
<tr class="even">
<td style="text-align: center;">(0.069,0.0774]</td>
<td style="text-align: center;">306</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">22.95</td>
</tr>
<tr class="odd">
<td style="text-align: center;">(0.0487,0.0633]</td>
<td style="text-align: center;">413</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">24.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">(0.0409,0.0487]</td>
<td style="text-align: center;">310</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">14.15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">[0.0322,0.0363]</td>
<td style="text-align: center;">407</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">13.91</td>
</tr>
<tr class="even">
<td style="text-align: center;">(0.0363,0.0409]</td>
<td style="text-align: center;">239</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">9.48</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">=</span> HL_table <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">X^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>((o<span class="sc">-</span>e)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>e)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">`</span><span class="at">X^2</span><span class="st">`</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.7811383</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>pval1 <span class="ot">=</span> <span class="fu">pchisq</span>(X2, <span class="at">lower =</span> <span class="cn">FALSE</span>, <span class="at">df =</span> <span class="fu">nrow</span>(HL_table) <span class="sc">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we have more evenly split categories. The p-value is <span class="math inline">\(0.56041994\)</span>, still not significant.</p>
<p>Graphically, we have compared:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-49_dbe7154895921e5128699978c34e2590">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>HL_plot <span class="ot">=</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  HL_table <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pred_prob_cats1)) <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> e, <span class="at">x =</span> pred_prob_cats1, <span class="at">group =</span> <span class="st">"Expected"</span>, <span class="at">col =</span> <span class="st">"Expected"</span>)) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> e, <span class="at">size =</span> n, <span class="at">col =</span> <span class="st">"Expected"</span>)) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> o, <span class="at">size =</span> n, <span class="at">col =</span> <span class="st">"Observed"</span>)) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> o, <span class="at">col =</span> <span class="st">"Observed"</span>, <span class="at">group =</span> <span class="st">"Observed"</span>)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"number of CHD events"</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-50_e419e0d47428595d60786d22bbc7766a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(HL_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-468aa991a53048169f54" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-468aa991a53048169f54">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10],"y":[13.908463615435355,9.4804170060423125,14.147082276065232,24.097195841138305,15.965627048323254,22.950027038869429,32.564120451983392,29.888840721910363,36.81244356329367,57.18578243693068],"text":["pred_prob_cats1: [0.0322,0.0363]<br />e: 13.908464<br />colour: Expected","pred_prob_cats1: (0.0363,0.0409]<br />e:  9.480417<br />colour: Expected","pred_prob_cats1: (0.0409,0.0487]<br />e: 14.147082<br />colour: Expected","pred_prob_cats1: (0.0487,0.0633]<br />e: 24.097196<br />colour: Expected","pred_prob_cats1: (0.0633,0.069]<br />e: 15.965627<br />colour: Expected","pred_prob_cats1: (0.069,0.0774]<br />e: 22.950027<br />colour: Expected","pred_prob_cats1: (0.0774,0.0942]<br />e: 32.564120<br />colour: Expected","pred_prob_cats1: (0.0942,0.114]<br />e: 29.888841<br />colour: Expected","pred_prob_cats1: (0.114,0.147]<br />e: 36.812444<br />colour: Expected","pred_prob_cats1: (0.147,0.222]<br />e: 57.185782<br />colour: Expected"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Expected","legendgroup":"Expected","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,10,7,8,5,6,4,3,1,2],"y":[36.81244356329367,57.18578243693068,32.564120451983392,29.888840721910363,15.965627048323254,22.950027038869429,24.097195841138305,14.147082276065232,13.908463615435355,9.4804170060423125],"text":["pred_prob_cats1: (0.114,0.147]<br />e: 36.812444<br />n: 275<br />colour: Expected","pred_prob_cats1: (0.147,0.222]<br />e: 57.185782<br />n: 314<br />colour: Expected","pred_prob_cats1: (0.0774,0.0942]<br />e: 32.564120<br />n: 371<br />colour: Expected","pred_prob_cats1: (0.0942,0.114]<br />e: 29.888841<br />n: 282<br />colour: Expected","pred_prob_cats1: (0.0633,0.069]<br />e: 15.965627<br />n: 237<br />colour: Expected","pred_prob_cats1: (0.069,0.0774]<br />e: 22.950027<br />n: 306<br />colour: Expected","pred_prob_cats1: (0.0487,0.0633]<br />e: 24.097196<br />n: 413<br />colour: Expected","pred_prob_cats1: (0.0409,0.0487]<br />e: 14.147082<br />n: 310<br />colour: Expected","pred_prob_cats1: [0.0322,0.0363]<br />e: 13.908464<br />n: 407<br />colour: Expected","pred_prob_cats1: (0.0363,0.0409]<br />e:  9.480417<br />n: 239<br />colour: Expected"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":[9.0481155247630038,11.279295054986243,13.673138690569633,9.5128807201598544,3.7795275590551185,10.879014793162673,15.118110236220474,11.081898115260863,14.923163051908769,4.9882245336696025],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Expected","legendgroup":"Expected","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[9,10,7,8,5,6,4,3,1,2],"y":[48,51,27,30,17,20,27,14,16,7],"text":["pred_prob_cats1: (0.114,0.147]<br />o: 48<br />n: 275<br />colour: Observed","pred_prob_cats1: (0.147,0.222]<br />o: 51<br />n: 314<br />colour: Observed","pred_prob_cats1: (0.0774,0.0942]<br />o: 27<br />n: 371<br />colour: Observed","pred_prob_cats1: (0.0942,0.114]<br />o: 30<br />n: 282<br />colour: Observed","pred_prob_cats1: (0.0633,0.069]<br />o: 17<br />n: 237<br />colour: Observed","pred_prob_cats1: (0.069,0.0774]<br />o: 20<br />n: 306<br />colour: Observed","pred_prob_cats1: (0.0487,0.0633]<br />o: 27<br />n: 413<br />colour: Observed","pred_prob_cats1: (0.0409,0.0487]<br />o: 14<br />n: 310<br />colour: Observed","pred_prob_cats1: [0.0322,0.0363]<br />o: 16<br />n: 407<br />colour: Observed","pred_prob_cats1: (0.0363,0.0409]<br />o:  7<br />n: 239<br />colour: Observed"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":[9.0481155247630038,11.279295054986243,13.673138690569633,9.5128807201598544,3.7795275590551185,10.879014793162673,15.118110236220474,11.081898115260863,14.923163051908769,4.9882245336696025],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Observed","legendgroup":"Observed","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[16,7,14,27,17,20,27,30,48,51],"text":["pred_prob_cats1: [0.0322,0.0363]<br />o: 16<br />colour: Observed","pred_prob_cats1: (0.0363,0.0409]<br />o:  7<br />colour: Observed","pred_prob_cats1: (0.0409,0.0487]<br />o: 14<br />colour: Observed","pred_prob_cats1: (0.0487,0.0633]<br />o: 27<br />colour: Observed","pred_prob_cats1: (0.0633,0.069]<br />o: 17<br />colour: Observed","pred_prob_cats1: (0.069,0.0774]<br />o: 20<br />colour: Observed","pred_prob_cats1: (0.0774,0.0942]<br />o: 27<br />colour: Observed","pred_prob_cats1: (0.0942,0.114]<br />o: 30<br />colour: Observed","pred_prob_cats1: (0.114,0.147]<br />o: 48<br />colour: Observed","pred_prob_cats1: (0.147,0.222]<br />o: 51<br />colour: Observed"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Observed","legendgroup":"Observed","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":74.956356961893121,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,10.6],"tickmode":"array","ticktext":["[0.0322,0.0363]","(0.0363,0.0409]","(0.0409,0.0487]","(0.0487,0.0633]","(0.0633,0.069]","(0.069,0.0774]","(0.0774,0.0942]","(0.0942,0.114]","(0.114,0.147]","(0.147,0.222]"],"tickvals":[1,2,3,4,5,6.0000000000000009,7,8,9,10],"categoryorder":"array","categoryarray":["[0.0322,0.0363]","(0.0363,0.0409]","(0.0409,0.0487]","(0.0487,0.0633]","(0.0633,0.069]","(0.069,0.0774]","(0.0774,0.0942]","(0.0942,0.114]","(0.114,0.147]","(0.147,0.222]"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"pred_prob_cats1","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[4.4907108781534664,59.695071558777215],"tickmode":"array","ticktext":["10","20","30","40","50"],"tickvals":[10,20,30,40,50],"categoryorder":"array","categoryarray":["10","20","30","40","50"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"number of CHD events","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"colour<br />n","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e260ae7cc":{"x":{},"y":{},"colour":{},"type":"scatter"},"142e15f81597":{"x":{},"y":{},"size":{},"colour":{}},"142e525177c5":{"x":{},"y":{},"size":{},"colour":{}},"142e628e50bb":{"x":{},"y":{},"colour":{}}},"cur_data":"142e260ae7cc","visdat":{"142e260ae7cc":["function (y) ","x"],"142e15f81597":["function (y) ","x"],"142e525177c5":["function (y) ","x"],"142e628e50bb":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="comparing-models" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="comparing-models"><span class="header-section-number">7.3</span> Comparing models</h2>
<ul>
<li>AIC = <span class="math inline">\(-2 * \ell(\hat\theta) + 2 * p\)</span> [lower is better]</li>
<li>BIC = <span class="math inline">\(-2 * \ell(\hat\theta) + p * \text{log}(n)\)</span> [lower is better]</li>
<li>likelihood ratio [higher is better]</li>
</ul>
</section>
</section>
<section id="residual-based-diagnostics" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Residual-based diagnostics</h1>
<section id="logistic-regression-residuals-only-work-for-grouped-data" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="logistic-regression-residuals-only-work-for-grouped-data"><span class="header-section-number">8.1</span> Logistic regression residuals only work for grouped data</h2>
<p>Residuals only work if there is more than one observation for most covariate patterns.</p>
<p>Here we will create the grouped-data version of our CHD model from the WCGS study:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-52_fd6e0e7568bd9c384027725e0ebe09b4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>wcgs_grouped <span class="ot">=</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(dibpat, age),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">chd =</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">!chd</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"No"</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>chd_glm_strat_grouped <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"formula"</span> <span class="ot">=</span> <span class="fu">cbind</span>(chd, <span class="st">`</span><span class="at">!chd</span><span class="st">`</span>) <span class="sc">~</span> dibpat <span class="sc">+</span> dibpat<span class="sc">:</span>age <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span> <span class="ot">=</span> wcgs_grouped,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Odds</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A)</td>
<td style="text-align: center;">-5.50</td>
<td style="text-align: center;">0.67</td>
<td style="text-align: center;">(-6.83, -4.19)</td>
<td style="text-align: center;">-8.18</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B)</td>
<td style="text-align: center;">-5.80</td>
<td style="text-align: center;">0.98</td>
<td style="text-align: center;">(-7.73, -3.90)</td>
<td style="text-align: center;">-5.95</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dibpat (Type A) × age</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(0.05, 0.10)</td>
<td style="text-align: center;">5.24</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dibpat (Type B) × age</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">(0.02, 0.10)</td>
<td style="text-align: center;">3.01</td>
<td style="text-align: center;">0.003</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="response-residuals" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="response-residuals"><span class="header-section-number">8.2</span> (Response) residuals</h2>
<p><span class="math display">\[e_k \eqdef \bar y_k - \hat{\pi}(x_k)\]</span></p>
<p>(<span class="math inline">\(k\)</span> indexes the covariate patterns)</p>
<p>We can graph these residuals <span class="math inline">\(e_k\)</span> against the fitted values <span class="math inline">\(\hat\pi(x_k)\)</span>:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-53_318bb82673dc740ac439eabe7bf559df">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-44"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-44-1"><a href="#annotated-cell-44-1" aria-hidden="true" tabindex="-1"></a>wcgs_grouped <span class="ot">=</span> </span>
<span id="annotated-cell-44-2"><a href="#annotated-cell-44-2" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-44-3"><a href="#annotated-cell-44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-44-4"><a href="#annotated-cell-44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted =</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="annotated-cell-44-5"><a href="#annotated-cell-44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_logit =</span> fitted <span class="sc">|&gt;</span> <span class="fu">logit</span>(),</span>
<span id="annotated-cell-44-6"><a href="#annotated-cell-44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">response_resids =</span> </span>
<span id="annotated-cell-44-7"><a href="#annotated-cell-44-7" aria-hidden="true" tabindex="-1"></a>      chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">resid</span>(<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="annotated-cell-44-8"><a href="#annotated-cell-44-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-44-9"><a href="#annotated-cell-44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-44-10"><a href="#annotated-cell-44-10" aria-hidden="true" tabindex="-1"></a>wcgs_response_resid_plot <span class="ot">=</span> </span>
<span id="annotated-cell-44-11"><a href="#annotated-cell-44-11" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-44-12"><a href="#annotated-cell-44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="annotated-cell-44-13"><a href="#annotated-cell-44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="annotated-cell-44-14"><a href="#annotated-cell-44-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fitted,</span>
<span id="annotated-cell-44-15"><a href="#annotated-cell-44-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> response_resids</span>
<span id="annotated-cell-44-16"><a href="#annotated-cell-44-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="annotated-cell-44-17"><a href="#annotated-cell-44-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="annotated-cell-44-18"><a href="#annotated-cell-44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="annotated-cell-44-19"><a href="#annotated-cell-44-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> dibpat)</span>
<span id="annotated-cell-44-20"><a href="#annotated-cell-44-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="annotated-cell-44-21"><a href="#annotated-cell-44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-44-22" class="code-annotation-target"><a href="#annotated-cell-44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="annotated-cell-44-23"><a href="#annotated-cell-44-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="annotated-cell-44-24"><a href="#annotated-cell-44-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">method.args =</span> <span class="fu">list</span>(</span>
<span id="annotated-cell-44-25"><a href="#annotated-cell-44-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">span=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="annotated-cell-44-26"><a href="#annotated-cell-44-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">degree=</span><span class="dv">1</span>,</span>
<span id="annotated-cell-44-27"><a href="#annotated-cell-44-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">family=</span><span class="st">"symmetric"</span>,</span>
<span id="annotated-cell-44-28"><a href="#annotated-cell-44-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">iterations=</span><span class="dv">3</span>),</span>
<span id="annotated-cell-44-29"><a href="#annotated-cell-44-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> stats<span class="sc">::</span>loess)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-44" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-lines="22,23,24,25,26,27,28,29" data-code-cell="annotated-cell-44">Don’t worry about these options for now; I chose them to match <code>autoplot()</code> as closely as I can. <code>plot.glm</code> and <code>autoplot</code> use <code>stats::lowess</code> instead of <code>stats::loess</code>; <code>stats::lowess</code> is older, hard to use with <code>geom_smooth</code>, and hard to match exactly with <code>stats::loess</code>; see https://support.bioconductor.org/p/2323/.]</span>
</dd>
</dl>
</div>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-55_f13bf0384f523a615873e31523b06ea3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>wcgs_response_resid_plot <span class="sc">|&gt;</span> <span class="fu">ggplotly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-59da30ade2a1cb555687" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-59da30ade2a1cb555687">{"x":{"data":[{"x":[0.12971234222919328,0.13804808653367218,0.22160454144193314,0.088269692096500443,0.10724215304817927,0.067699524830557176,0.072381563936101831,0.082651492829172932,0.16577440958806977,0.11432357792947521,0.063299679011386611,0.12180880417146124,0.17595906456335225,0.18662945062136324,0.077360539928739688,0.094230557580234589,0.10054956755065417,0.19779158979409439,0.15606760433147879,0.14682913656358473,0.20944941476199133],"y":[-0.024449184334456447,0.026131017943939766,0.011728791891400192,-0.0086236743973854002,-0.010019930825957049,-3.0351898226352314e-05,-0.0075667491212870197,-0.010486544375564691,-0.033698937889956565,0.03567642207052478,0.022637820988613389,0.11699716597779249,-0.012322700926988617,0.058268508562310223,-0.037756579532700084,-0.0033214666711436774,-0.034615501616588232,-0.068759331729578266,-0.043164378525027178,0.053170863436415278,-0.062390591232579562],"text":["fitted: 0.129712342<br />response_resids: -2.4449184e-02<br />dibpat: Type A","fitted: 0.138048087<br />response_resids:  2.6131018e-02<br />dibpat: Type A","fitted: 0.221604541<br />response_resids:  1.1728792e-02<br />dibpat: Type A","fitted: 0.088269692<br />response_resids: -8.6236744e-03<br />dibpat: Type A","fitted: 0.107242153<br />response_resids: -1.0019931e-02<br />dibpat: Type A","fitted: 0.067699525<br />response_resids: -3.0351898e-05<br />dibpat: Type A","fitted: 0.072381564<br />response_resids: -7.5667491e-03<br />dibpat: Type A","fitted: 0.082651493<br />response_resids: -1.0486544e-02<br />dibpat: Type A","fitted: 0.165774410<br />response_resids: -3.3698938e-02<br />dibpat: Type A","fitted: 0.114323578<br />response_resids:  3.5676422e-02<br />dibpat: Type A","fitted: 0.063299679<br />response_resids:  2.2637821e-02<br />dibpat: Type A","fitted: 0.121808804<br />response_resids:  1.1699717e-01<br />dibpat: Type A","fitted: 0.175959065<br />response_resids: -1.2322701e-02<br />dibpat: Type A","fitted: 0.186629451<br />response_resids:  5.8268509e-02<br />dibpat: Type A","fitted: 0.077360540<br />response_resids: -3.7756580e-02<br />dibpat: Type A","fitted: 0.094230558<br />response_resids: -3.3214667e-03<br />dibpat: Type A","fitted: 0.100549568<br />response_resids: -3.4615502e-02<br />dibpat: Type A","fitted: 0.197791590<br />response_resids: -6.8759332e-02<br />dibpat: Type A","fitted: 0.156067604<br />response_resids: -4.3164379e-02<br />dibpat: Type A","fitted: 0.146829137<br />response_resids:  5.3170863e-02<br />dibpat: Type A","fitted: 0.209449415<br />response_resids: -6.2390591e-02<br />dibpat: Type A"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.045961436757712824,0.036293263960852619,0.051672477906886234,0.032224234433804747,0.058049978197733429,0.065160515946172379,0.038509063821240842,0.061509303008180735,0.04333615674648298,0.086613433425361805,0.034200425478447295,0.096862923630182202,0.054773853205468445,0.040854409187417909,0.073074455042508049,0.077355593240057391,0.048737652497125951,0.069012528199451348,0.081865394323964141,0.091609373353503276,0.10238379421453493],"y":[-8.9877124685298904e-05,0.0037067360391473819,-0.038339144573552898,0.025746780058948877,0.016576887473908355,0.041982341196684758,-0.030244601011323487,-0.010661845381062088,-0.010549271500581339,-0.086613433425361805,-0.013367092145113963,-0.051408378175636746,0.028559480127864884,0.0099930484397007385,0.04320461472493381,-0.0032815191659833209,0.014553486743380382,-0.027345861532784684,-0.04186539432396414,0.0021406266464967239,0.1329103234325239],"text":["fitted: 0.045961437<br />response_resids: -8.9877125e-05<br />dibpat: Type B","fitted: 0.036293264<br />response_resids:  3.7067360e-03<br />dibpat: Type B","fitted: 0.051672478<br />response_resids: -3.8339145e-02<br />dibpat: Type B","fitted: 0.032224234<br />response_resids:  2.5746780e-02<br />dibpat: Type B","fitted: 0.058049978<br />response_resids:  1.6576887e-02<br />dibpat: Type B","fitted: 0.065160516<br />response_resids:  4.1982341e-02<br />dibpat: Type B","fitted: 0.038509064<br />response_resids: -3.0244601e-02<br />dibpat: Type B","fitted: 0.061509303<br />response_resids: -1.0661845e-02<br />dibpat: Type B","fitted: 0.043336157<br />response_resids: -1.0549272e-02<br />dibpat: Type B","fitted: 0.086613433<br />response_resids: -8.6613433e-02<br />dibpat: Type B","fitted: 0.034200425<br />response_resids: -1.3367092e-02<br />dibpat: Type B","fitted: 0.096862924<br />response_resids: -5.1408378e-02<br />dibpat: Type B","fitted: 0.054773853<br />response_resids:  2.8559480e-02<br />dibpat: Type B","fitted: 0.040854409<br />response_resids:  9.9930484e-03<br />dibpat: Type B","fitted: 0.073074455<br />response_resids:  4.3204615e-02<br />dibpat: Type B","fitted: 0.077355593<br />response_resids: -3.2815192e-03<br />dibpat: Type B","fitted: 0.048737652<br />response_resids:  1.4553487e-02<br />dibpat: Type B","fitted: 0.069012528<br />response_resids: -2.7345862e-02<br />dibpat: Type B","fitted: 0.081865394<br />response_resids: -4.1865394e-02<br />dibpat: Type B","fitted: 0.091609373<br />response_resids:  2.1406266e-03<br />dibpat: Type B","fitted: 0.102383794<br />response_resids:  1.3291032e-01<br />dibpat: Type B"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.022755219083398323,0.23107355679233957],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.032224234433804747,0.034621453509857007,0.037018672585909261,0.039415891661961522,0.041813110738013783,0.044210329814066043,0.046607548890118297,0.049004767966170558,0.051401987042222819,0.053799206118275072,0.056196425194327333,0.058593644270379594,0.060990863346431848,0.063388082422484116,0.065785301498536369,0.068182520574588623,0.070579739650640877,0.072976958726693145,0.075374177802745398,0.077771396878797666,0.08016861595484992,0.082565835030902174,0.084963054106954428,0.087360273183006695,0.089757492259058949,0.092154711335111217,0.094551930411163471,0.096949149487215724,0.099346368563267992,0.10174358763932025,0.1041408067153725,0.10653802579142477,0.10893524486747702,0.11133246394352928,0.11372968301958154,0.1161269020956338,0.11852412117168605,0.12092134024773832,0.12331855932379057,0.12571577839984283,0.12811299747589511,0.13051021655194733,0.13290743562799961,0.13530465470405187,0.13770187378010412,0.14009909285615638,0.14249631193220863,0.14489353100826091,0.14729075008431314,0.14968796916036542,0.15208518823641767,0.15448240731246993,0.15687962638852221,0.15927684546457443,0.16167406454062672,0.16407128361667894,0.16646850269273122,0.16886572176878351,0.17126294084483573,0.17366015992088801,0.17605737899694024,0.17845459807299252,0.1808518171490448,0.18324903622509703,0.18564625530114931,0.18804347437720154,0.19044069345325382,0.1928379125293061,0.19523513160535833,0.19763235068141061,0.20002956975746283,0.20242678883351511,0.20482400790956734,0.20722122698561962,0.2096184460616719,0.21201566513772413,0.21441288421377641,0.21681010328982864,0.21920732236588092,0.22160454144193314],"y":[0.0022873786418898521,0.0022855473977323221,0.0021280389946747164,0.0019864408924874857,0.001848596406463707,0.0015537869130376951,0.0012177186055594197,0.00087584068918245992,0.00050571153491429282,8.4889513762394613e-05,-0.00040906700326576038,-0.00098044561236798763,-0.0012676916653127201,-0.0014151484052982004,-0.0018150206943960128,-0.002859513394677742,-0.0046042492494451914,-0.0061773548575778745,-0.0076184909053804836,-0.0090564613961362297,-0.010620070333128293,-0.012307065012777785,-0.012576456285260475,-0.012435436833056276,-0.01295135308414791,-0.012351663434359226,-0.01130833619576363,-0.010790229676235729,-0.010673770207606003,-0.010333915551222294,-0.0098059247101166709,-0.0091250566873211907,-0.0083265704858679363,-0.0074457251087889668,-0.0065177795591163483,-0.0055779928398821564,-0.0046616239541184537,-0.0038039319048573041,-0.0030706766518604871,-0.0025845113062175486,-0.0023352534294963177,-0.0023008729248562856,-0.0024593396954569369,-0.0027886236444577533,-0.0032666946750182211,-0.0038715226902978277,-0.0045810775934560571,-0.0053733292876524024,-0.0062262476760463247,-0.007117802661797343,-0.0080259641480649197,-0.0089287020380085444,-0.009803986234787716,-0.010629786641561889,-0.011384073161490583,-0.012044815697733255,-0.01259608807221186,-0.013124543847799191,-0.013664464071742351,-0.014215175654193094,-0.014776005505303128,-0.015346280535224206,-0.015925327654108042,-0.016512473772106358,-0.017107045799370901,-0.017708370646053389,-0.018315775222305566,-0.018928586438279146,-0.019546131204125856,-0.020167736429997449,-0.02079272902604563,-0.021420435902422142,-0.0220501839692787,-0.022681300136767064,-0.02331311131503894,-0.023944944414246057,-0.024576126344540154,-0.025205984016072939,-0.02583384433899618,-0.026459034223461575],"text":["fitted: 0.032224234<br />response_resids:  2.2873786e-03","fitted: 0.034621454<br />response_resids:  2.2855474e-03","fitted: 0.037018673<br />response_resids:  2.1280390e-03","fitted: 0.039415892<br />response_resids:  1.9864409e-03","fitted: 0.041813111<br />response_resids:  1.8485964e-03","fitted: 0.044210330<br />response_resids:  1.5537869e-03","fitted: 0.046607549<br />response_resids:  1.2177186e-03","fitted: 0.049004768<br />response_resids:  8.7584069e-04","fitted: 0.051401987<br />response_resids:  5.0571153e-04","fitted: 0.053799206<br />response_resids:  8.4889514e-05","fitted: 0.056196425<br />response_resids: -4.0906700e-04","fitted: 0.058593644<br />response_resids: -9.8044561e-04","fitted: 0.060990863<br />response_resids: -1.2676917e-03","fitted: 0.063388082<br />response_resids: -1.4151484e-03","fitted: 0.065785301<br />response_resids: -1.8150207e-03","fitted: 0.068182521<br />response_resids: -2.8595134e-03","fitted: 0.070579740<br />response_resids: -4.6042492e-03","fitted: 0.072976959<br />response_resids: -6.1773549e-03","fitted: 0.075374178<br />response_resids: -7.6184909e-03","fitted: 0.077771397<br />response_resids: -9.0564614e-03","fitted: 0.080168616<br />response_resids: -1.0620070e-02","fitted: 0.082565835<br />response_resids: -1.2307065e-02","fitted: 0.084963054<br />response_resids: -1.2576456e-02","fitted: 0.087360273<br />response_resids: -1.2435437e-02","fitted: 0.089757492<br />response_resids: -1.2951353e-02","fitted: 0.092154711<br />response_resids: -1.2351663e-02","fitted: 0.094551930<br />response_resids: -1.1308336e-02","fitted: 0.096949149<br />response_resids: -1.0790230e-02","fitted: 0.099346369<br />response_resids: -1.0673770e-02","fitted: 0.101743588<br />response_resids: -1.0333916e-02","fitted: 0.104140807<br />response_resids: -9.8059247e-03","fitted: 0.106538026<br />response_resids: -9.1250567e-03","fitted: 0.108935245<br />response_resids: -8.3265705e-03","fitted: 0.111332464<br />response_resids: -7.4457251e-03","fitted: 0.113729683<br />response_resids: -6.5177796e-03","fitted: 0.116126902<br />response_resids: -5.5779928e-03","fitted: 0.118524121<br />response_resids: -4.6616240e-03","fitted: 0.120921340<br />response_resids: -3.8039319e-03","fitted: 0.123318559<br />response_resids: -3.0706767e-03","fitted: 0.125715778<br />response_resids: -2.5845113e-03","fitted: 0.128112997<br />response_resids: -2.3352534e-03","fitted: 0.130510217<br />response_resids: -2.3008729e-03","fitted: 0.132907436<br />response_resids: -2.4593397e-03","fitted: 0.135304655<br />response_resids: -2.7886236e-03","fitted: 0.137701874<br />response_resids: -3.2666947e-03","fitted: 0.140099093<br />response_resids: -3.8715227e-03","fitted: 0.142496312<br />response_resids: -4.5810776e-03","fitted: 0.144893531<br />response_resids: -5.3733293e-03","fitted: 0.147290750<br />response_resids: -6.2262477e-03","fitted: 0.149687969<br />response_resids: -7.1178027e-03","fitted: 0.152085188<br />response_resids: -8.0259641e-03","fitted: 0.154482407<br />response_resids: -8.9287020e-03","fitted: 0.156879626<br />response_resids: -9.8039862e-03","fitted: 0.159276845<br />response_resids: -1.0629787e-02","fitted: 0.161674065<br />response_resids: -1.1384073e-02","fitted: 0.164071284<br />response_resids: -1.2044816e-02","fitted: 0.166468503<br />response_resids: -1.2596088e-02","fitted: 0.168865722<br />response_resids: -1.3124544e-02","fitted: 0.171262941<br />response_resids: -1.3664464e-02","fitted: 0.173660160<br />response_resids: -1.4215176e-02","fitted: 0.176057379<br />response_resids: -1.4776006e-02","fitted: 0.178454598<br />response_resids: -1.5346281e-02","fitted: 0.180851817<br />response_resids: -1.5925328e-02","fitted: 0.183249036<br />response_resids: -1.6512474e-02","fitted: 0.185646255<br />response_resids: -1.7107046e-02","fitted: 0.188043474<br />response_resids: -1.7708371e-02","fitted: 0.190440693<br />response_resids: -1.8315775e-02","fitted: 0.192837913<br />response_resids: -1.8928586e-02","fitted: 0.195235132<br />response_resids: -1.9546131e-02","fitted: 0.197632351<br />response_resids: -2.0167736e-02","fitted: 0.200029570<br />response_resids: -2.0792729e-02","fitted: 0.202426789<br />response_resids: -2.1420436e-02","fitted: 0.204824008<br />response_resids: -2.2050184e-02","fitted: 0.207221227<br />response_resids: -2.2681300e-02","fitted: 0.209618446<br />response_resids: -2.3313111e-02","fitted: 0.212015665<br />response_resids: -2.3944944e-02","fitted: 0.214412884<br />response_resids: -2.4576126e-02","fitted: 0.216810103<br />response_resids: -2.5205984e-02","fitted: 0.219207322<br />response_resids: -2.5833844e-02","fitted: 0.221604541<br />response_resids: -2.6459034e-02"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.7795275590551185,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.032224234433804747,0.034621453509857007,0.037018672585909261,0.039415891661961522,0.041813110738013783,0.044210329814066043,0.046607548890118297,0.049004767966170558,0.051401987042222819,0.053799206118275072,0.056196425194327333,0.058593644270379594,0.060990863346431848,0.063388082422484116,0.065785301498536369,0.068182520574588623,0.070579739650640877,0.072976958726693145,0.075374177802745398,0.077771396878797666,0.08016861595484992,0.082565835030902174,0.084963054106954428,0.087360273183006695,0.089757492259058949,0.092154711335111217,0.094551930411163471,0.096949149487215724,0.099346368563267992,0.10174358763932025,0.1041408067153725,0.10653802579142477,0.10893524486747702,0.11133246394352928,0.11372968301958154,0.1161269020956338,0.11852412117168605,0.12092134024773832,0.12331855932379057,0.12571577839984283,0.12811299747589511,0.13051021655194733,0.13290743562799961,0.13530465470405187,0.13770187378010412,0.14009909285615638,0.14249631193220863,0.14489353100826091,0.14729075008431314,0.14968796916036542,0.15208518823641767,0.15448240731246993,0.15687962638852221,0.15927684546457443,0.16167406454062672,0.16407128361667894,0.16646850269273122,0.16886572176878351,0.17126294084483573,0.17366015992088801,0.17605737899694024,0.17845459807299252,0.1808518171490448,0.18324903622509703,0.18564625530114931,0.18804347437720154,0.19044069345325382,0.1928379125293061,0.19523513160535833,0.19763235068141061,0.20002956975746283,0.20242678883351511,0.20482400790956734,0.20722122698561962,0.2096184460616719,0.21201566513772413,0.21441288421377641,0.21681010328982864,0.21920732236588092,0.22160454144193314,0.22160454144193314,0.22160454144193314,0.21920732236588092,0.21681010328982864,0.21441288421377641,0.21201566513772413,0.2096184460616719,0.20722122698561962,0.20482400790956734,0.20242678883351511,0.20002956975746283,0.19763235068141061,0.19523513160535833,0.1928379125293061,0.19044069345325382,0.18804347437720154,0.18564625530114931,0.18324903622509703,0.1808518171490448,0.17845459807299252,0.17605737899694024,0.17366015992088801,0.17126294084483573,0.16886572176878351,0.16646850269273122,0.16407128361667894,0.16167406454062672,0.15927684546457443,0.15687962638852221,0.15448240731246993,0.15208518823641767,0.14968796916036542,0.14729075008431314,0.14489353100826091,0.14249631193220863,0.14009909285615638,0.13770187378010412,0.13530465470405187,0.13290743562799961,0.13051021655194733,0.12811299747589511,0.12571577839984283,0.12331855932379057,0.12092134024773832,0.11852412117168605,0.1161269020956338,0.11372968301958154,0.11133246394352928,0.10893524486747702,0.10653802579142477,0.1041408067153725,0.10174358763932025,0.099346368563267992,0.096949149487215724,0.094551930411163471,0.092154711335111217,0.089757492259058949,0.087360273183006695,0.084963054106954428,0.082565835030902174,0.08016861595484992,0.077771396878797666,0.075374177802745398,0.072976958726693145,0.070579739650640877,0.068182520574588623,0.065785301498536369,0.063388082422484116,0.060990863346431848,0.058593644270379594,0.056196425194327333,0.053799206118275072,0.051401987042222819,0.049004767966170558,0.046607548890118297,0.044210329814066043,0.041813110738013783,0.039415891661961522,0.037018672585909261,0.034621453509857007,0.032224234433804747,0.032224234433804747],"y":[-0.0291207962720463,-0.026928673147919132,-0.025049668515905441,-0.023240004042525401,-0.021546955218634596,-0.02018652529776999,-0.019027858198610942,-0.018083361190100986,-0.017422746720972986,-0.017078117023036177,-0.017039939312035096,-0.017269628078552649,-0.017604109969972075,-0.018177765826964731,-0.019105887664343495,-0.020423791084051481,-0.022115418182448183,-0.023513820224467886,-0.024691917091792297,-0.025924945293692707,-0.027500664314999548,-0.029492087333190638,-0.029853450281078209,-0.029922110016604747,-0.030973077994923989,-0.030448115725570574,-0.029509183566823877,-0.02958129998245309,-0.030169517519175022,-0.030166439136312825,-0.029667017598640561,-0.028812559687027249,-0.027763822063088139,-0.02668016581146973,-0.02569967134067833,-0.0249221254996966,-0.024401397192934708,-0.024152647460435224,-0.024135688192629866,-0.024193011121636639,-0.024285625937470065,-0.024402803718567706,-0.02454461632206207,-0.024718429424116263,-0.024936580507690619,-0.025214598648278175,-0.025569541213304389,-0.026018164976515212,-0.026574788292790915,-0.027248883870524859,-0.028042669242849504,-0.028949167022405773,-0.029951271039798985,-0.031022191389126857,-0.032127305759090605,-0.033227092735686872,-0.034284984307127946,-0.035345832380259262,-0.036434633709329714,-0.03755435784210439,-0.038708305309187077,-0.03989976255530471,-0.041131720683424265,-0.042406654379143247,-0.043726358147656894,-0.04509183669719713,-0.046503245276595481,-0.047959874451746494,-0.049460172597461216,-0.051001798593147463,-0.052581696999507571,-0.054196188367264309,-0.055841068182683043,-0.057511709121243516,-0.059203162581215732,-0.06091025674911927,-0.062627689599425482,-0.06435011618981186,-0.066072230360516626,-0.067788841491228075,-0.067788841491228075,0.014870773044304932,0.014404541682524259,0.013938148157665978,0.013475436910345171,0.013020367920627156,0.012576939951137848,0.012149108847709388,0.011740700244125643,0.011355316562420028,0.010996238947416314,0.01066632573315256,0.010367910189209507,0.010102701575188201,0.0098716948319843498,0.0096750954050903483,0.0095122665489150923,0.0093817068349305345,0.009281065375208182,0.0092072014848562991,0.0091562942985808186,0.0091240065337182038,0.0091057055658450136,0.0090967446846608839,0.0090928081627042259,0.0091374613402203601,0.0093591594361094356,0.0097626181060030785,0.010343298570223551,0.011091762946388684,0.011990740946719662,0.013013278546930174,0.014122292940698267,0.015271506401210409,0.016407386026392273,0.017471553267682519,0.018403191157654174,0.019141182135200753,0.019625936931148197,0.019801057868855138,0.019615119078477433,0.019023988509201541,0.017994334888908892,0.016544783650720617,0.015078149284697799,0.013766139819932285,0.012664112222445633,0.011788715593891795,0.011110681091352268,0.010562446312384866,0.010055168178407219,0.009498608033868235,0.0088219771039630187,0.0080008406299816315,0.006892511175296618,0.0057447888568521194,0.0050703718266281693,0.0050512363504921966,0.00470053771055726,0.0048779573076350689,0.0062605236487429643,0.0078120225014202474,0.0094549352810313278,0.011159110509312139,0.0129069196835578,0.014704764294695995,0.015475846275551468,0.015347469016368331,0.015068726639346636,0.015308736853816675,0.016221805305503573,0.017247896050560967,0.01843416979080157,0.019835042568465907,0.021463295409729778,0.023294099123845381,0.025244148031562011,0.027212885827500373,0.029305746505254873,0.031499767943383779,0.033695553555826006,-0.0291207962720463],"text":["fitted: 0.032224234<br />response_resids:  2.2873786e-03","fitted: 0.034621454<br />response_resids:  2.2855474e-03","fitted: 0.037018673<br />response_resids:  2.1280390e-03","fitted: 0.039415892<br />response_resids:  1.9864409e-03","fitted: 0.041813111<br />response_resids:  1.8485964e-03","fitted: 0.044210330<br />response_resids:  1.5537869e-03","fitted: 0.046607549<br />response_resids:  1.2177186e-03","fitted: 0.049004768<br />response_resids:  8.7584069e-04","fitted: 0.051401987<br />response_resids:  5.0571153e-04","fitted: 0.053799206<br />response_resids:  8.4889514e-05","fitted: 0.056196425<br />response_resids: -4.0906700e-04","fitted: 0.058593644<br />response_resids: -9.8044561e-04","fitted: 0.060990863<br />response_resids: -1.2676917e-03","fitted: 0.063388082<br />response_resids: -1.4151484e-03","fitted: 0.065785301<br />response_resids: -1.8150207e-03","fitted: 0.068182521<br />response_resids: -2.8595134e-03","fitted: 0.070579740<br />response_resids: -4.6042492e-03","fitted: 0.072976959<br />response_resids: -6.1773549e-03","fitted: 0.075374178<br />response_resids: -7.6184909e-03","fitted: 0.077771397<br />response_resids: -9.0564614e-03","fitted: 0.080168616<br />response_resids: -1.0620070e-02","fitted: 0.082565835<br />response_resids: -1.2307065e-02","fitted: 0.084963054<br />response_resids: -1.2576456e-02","fitted: 0.087360273<br />response_resids: -1.2435437e-02","fitted: 0.089757492<br />response_resids: -1.2951353e-02","fitted: 0.092154711<br />response_resids: -1.2351663e-02","fitted: 0.094551930<br />response_resids: -1.1308336e-02","fitted: 0.096949149<br />response_resids: -1.0790230e-02","fitted: 0.099346369<br />response_resids: -1.0673770e-02","fitted: 0.101743588<br />response_resids: -1.0333916e-02","fitted: 0.104140807<br />response_resids: -9.8059247e-03","fitted: 0.106538026<br />response_resids: -9.1250567e-03","fitted: 0.108935245<br />response_resids: -8.3265705e-03","fitted: 0.111332464<br />response_resids: -7.4457251e-03","fitted: 0.113729683<br />response_resids: -6.5177796e-03","fitted: 0.116126902<br />response_resids: -5.5779928e-03","fitted: 0.118524121<br />response_resids: -4.6616240e-03","fitted: 0.120921340<br />response_resids: -3.8039319e-03","fitted: 0.123318559<br />response_resids: -3.0706767e-03","fitted: 0.125715778<br />response_resids: -2.5845113e-03","fitted: 0.128112997<br />response_resids: -2.3352534e-03","fitted: 0.130510217<br />response_resids: -2.3008729e-03","fitted: 0.132907436<br />response_resids: -2.4593397e-03","fitted: 0.135304655<br />response_resids: -2.7886236e-03","fitted: 0.137701874<br />response_resids: -3.2666947e-03","fitted: 0.140099093<br />response_resids: -3.8715227e-03","fitted: 0.142496312<br />response_resids: -4.5810776e-03","fitted: 0.144893531<br />response_resids: -5.3733293e-03","fitted: 0.147290750<br />response_resids: -6.2262477e-03","fitted: 0.149687969<br />response_resids: -7.1178027e-03","fitted: 0.152085188<br />response_resids: -8.0259641e-03","fitted: 0.154482407<br />response_resids: -8.9287020e-03","fitted: 0.156879626<br />response_resids: -9.8039862e-03","fitted: 0.159276845<br />response_resids: -1.0629787e-02","fitted: 0.161674065<br />response_resids: -1.1384073e-02","fitted: 0.164071284<br />response_resids: -1.2044816e-02","fitted: 0.166468503<br />response_resids: -1.2596088e-02","fitted: 0.168865722<br />response_resids: -1.3124544e-02","fitted: 0.171262941<br />response_resids: -1.3664464e-02","fitted: 0.173660160<br />response_resids: -1.4215176e-02","fitted: 0.176057379<br />response_resids: -1.4776006e-02","fitted: 0.178454598<br />response_resids: -1.5346281e-02","fitted: 0.180851817<br />response_resids: -1.5925328e-02","fitted: 0.183249036<br />response_resids: -1.6512474e-02","fitted: 0.185646255<br />response_resids: -1.7107046e-02","fitted: 0.188043474<br />response_resids: -1.7708371e-02","fitted: 0.190440693<br />response_resids: -1.8315775e-02","fitted: 0.192837913<br />response_resids: -1.8928586e-02","fitted: 0.195235132<br />response_resids: -1.9546131e-02","fitted: 0.197632351<br />response_resids: -2.0167736e-02","fitted: 0.200029570<br />response_resids: -2.0792729e-02","fitted: 0.202426789<br />response_resids: -2.1420436e-02","fitted: 0.204824008<br />response_resids: -2.2050184e-02","fitted: 0.207221227<br />response_resids: -2.2681300e-02","fitted: 0.209618446<br />response_resids: -2.3313111e-02","fitted: 0.212015665<br />response_resids: -2.3944944e-02","fitted: 0.214412884<br />response_resids: -2.4576126e-02","fitted: 0.216810103<br />response_resids: -2.5205984e-02","fitted: 0.219207322<br />response_resids: -2.5833844e-02","fitted: 0.221604541<br />response_resids: -2.6459034e-02","fitted: 0.221604541<br />response_resids: -2.6459034e-02","fitted: 0.221604541<br />response_resids: -2.6459034e-02","fitted: 0.219207322<br />response_resids: -2.5833844e-02","fitted: 0.216810103<br />response_resids: -2.5205984e-02","fitted: 0.214412884<br />response_resids: -2.4576126e-02","fitted: 0.212015665<br />response_resids: -2.3944944e-02","fitted: 0.209618446<br />response_resids: -2.3313111e-02","fitted: 0.207221227<br />response_resids: -2.2681300e-02","fitted: 0.204824008<br />response_resids: -2.2050184e-02","fitted: 0.202426789<br />response_resids: -2.1420436e-02","fitted: 0.200029570<br />response_resids: -2.0792729e-02","fitted: 0.197632351<br />response_resids: -2.0167736e-02","fitted: 0.195235132<br />response_resids: -1.9546131e-02","fitted: 0.192837913<br />response_resids: -1.8928586e-02","fitted: 0.190440693<br />response_resids: -1.8315775e-02","fitted: 0.188043474<br />response_resids: -1.7708371e-02","fitted: 0.185646255<br />response_resids: -1.7107046e-02","fitted: 0.183249036<br />response_resids: -1.6512474e-02","fitted: 0.180851817<br />response_resids: -1.5925328e-02","fitted: 0.178454598<br />response_resids: -1.5346281e-02","fitted: 0.176057379<br />response_resids: -1.4776006e-02","fitted: 0.173660160<br />response_resids: -1.4215176e-02","fitted: 0.171262941<br />response_resids: -1.3664464e-02","fitted: 0.168865722<br />response_resids: -1.3124544e-02","fitted: 0.166468503<br />response_resids: -1.2596088e-02","fitted: 0.164071284<br />response_resids: -1.2044816e-02","fitted: 0.161674065<br />response_resids: -1.1384073e-02","fitted: 0.159276845<br />response_resids: -1.0629787e-02","fitted: 0.156879626<br />response_resids: -9.8039862e-03","fitted: 0.154482407<br />response_resids: -8.9287020e-03","fitted: 0.152085188<br />response_resids: -8.0259641e-03","fitted: 0.149687969<br />response_resids: -7.1178027e-03","fitted: 0.147290750<br />response_resids: -6.2262477e-03","fitted: 0.144893531<br />response_resids: -5.3733293e-03","fitted: 0.142496312<br />response_resids: -4.5810776e-03","fitted: 0.140099093<br />response_resids: -3.8715227e-03","fitted: 0.137701874<br />response_resids: -3.2666947e-03","fitted: 0.135304655<br />response_resids: -2.7886236e-03","fitted: 0.132907436<br />response_resids: -2.4593397e-03","fitted: 0.130510217<br />response_resids: -2.3008729e-03","fitted: 0.128112997<br />response_resids: -2.3352534e-03","fitted: 0.125715778<br />response_resids: -2.5845113e-03","fitted: 0.123318559<br />response_resids: -3.0706767e-03","fitted: 0.120921340<br />response_resids: -3.8039319e-03","fitted: 0.118524121<br />response_resids: -4.6616240e-03","fitted: 0.116126902<br />response_resids: -5.5779928e-03","fitted: 0.113729683<br />response_resids: -6.5177796e-03","fitted: 0.111332464<br />response_resids: -7.4457251e-03","fitted: 0.108935245<br />response_resids: -8.3265705e-03","fitted: 0.106538026<br />response_resids: -9.1250567e-03","fitted: 0.104140807<br />response_resids: -9.8059247e-03","fitted: 0.101743588<br />response_resids: -1.0333916e-02","fitted: 0.099346369<br />response_resids: -1.0673770e-02","fitted: 0.096949149<br />response_resids: -1.0790230e-02","fitted: 0.094551930<br />response_resids: -1.1308336e-02","fitted: 0.092154711<br />response_resids: -1.2351663e-02","fitted: 0.089757492<br />response_resids: -1.2951353e-02","fitted: 0.087360273<br />response_resids: -1.2435437e-02","fitted: 0.084963054<br />response_resids: -1.2576456e-02","fitted: 0.082565835<br />response_resids: -1.2307065e-02","fitted: 0.080168616<br />response_resids: -1.0620070e-02","fitted: 0.077771397<br />response_resids: -9.0564614e-03","fitted: 0.075374178<br />response_resids: -7.6184909e-03","fitted: 0.072976959<br />response_resids: -6.1773549e-03","fitted: 0.070579740<br />response_resids: -4.6042492e-03","fitted: 0.068182521<br />response_resids: -2.8595134e-03","fitted: 0.065785301<br />response_resids: -1.8150207e-03","fitted: 0.063388082<br />response_resids: -1.4151484e-03","fitted: 0.060990863<br />response_resids: -1.2676917e-03","fitted: 0.058593644<br />response_resids: -9.8044561e-04","fitted: 0.056196425<br />response_resids: -4.0906700e-04","fitted: 0.053799206<br />response_resids:  8.4889514e-05","fitted: 0.051401987<br />response_resids:  5.0571153e-04","fitted: 0.049004768<br />response_resids:  8.7584069e-04","fitted: 0.046607549<br />response_resids:  1.2177186e-03","fitted: 0.044210330<br />response_resids:  1.5537869e-03","fitted: 0.041813111<br />response_resids:  1.8485964e-03","fitted: 0.039415892<br />response_resids:  1.9864409e-03","fitted: 0.037018673<br />response_resids:  2.1280390e-03","fitted: 0.034621454<br />response_resids:  2.2855474e-03","fitted: 0.032224234<br />response_resids:  2.2873786e-03","fitted: 0.032224234<br />response_resids:  2.2873786e-03"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.4)","hoveron":"points","hoverinfo":"x+y","showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":54.794520547945211},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.022755219083398323,0.23107355679233957],"tickmode":"array","ticktext":["0.05","0.10","0.15","0.20"],"tickvals":[0.050000000000000003,0.10000000000000001,0.15000000000000002,0.20000000000000001],"categoryorder":"array","categoryarray":["0.05","0.10","0.15","0.20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"fitted","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.097589621268256099,0.14388651127541818],"tickmode":"array","ticktext":["-0.05","0.00","0.05","0.10"],"tickvals":[-0.050000000000000003,0,0.050000000000000017,0.10000000000000001],"categoryorder":"array","categoryarray":["-0.05","0.00","0.05","0.10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"response_resids","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"dibpat","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e654cd7e3":{"x":{},"y":{},"colour":{},"type":"scatter"},"142e17f1ac0a":{"yintercept":{}},"142e7b55d0cd":{"x":{},"y":{}}},"cur_data":"142e654cd7e3","visdat":{"142e654cd7e3":["function (y) ","x"],"142e17f1ac0a":["function (y) ","x"],"142e7b55d0cd":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We can see a slight fan-shape here: observations on the right have larger variance (as expected since <span class="math inline">\(var(\bar y) = \pi(1-\pi)/n\)</span> is maximized when <span class="math inline">\(\pi = 0.5\)</span>).</p>
</section>
<section id="pearson-residuals" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="pearson-residuals"><span class="header-section-number">8.3</span> Pearson residuals</h2>
<p>The fan-shape in the response residuals plot isn’t necessarily a concern here, since we haven’t made an assumption of constant residual variance, as we did for linear regression.</p>
<p>However, we might want to divide by the standard error in order to make the graph easier to interpret. Here’s one way to do that:</p>
<p>The Pearson (chi-squared) residual for covariate pattern <span class="math inline">\(k\)</span> is: <span class="math display">\[
\begin{aligned}
X_k &amp;= \frac{\bar y_k - \hat\pi_k}{\sqrt{\hat \pi_k (1-\hat\pi_k)/n_k}}
\end{aligned}
\]</span></p>
<p>where <span class="math display">\[
\begin{aligned}
\hat\pi_k
&amp;\eqdef \hat\pi(x_k)\\
&amp;\eqdef \hat P(Y=1|X=x_k)\\
&amp;\eqdef \text{expit}(x_i'\hat \beta)\\
&amp;\eqdef \text{expit}(\hat \beta_0 + \sum_{j=1}^p \hat \beta_j x_{ij})
\end{aligned}
\]</span></p>
<p>Let’s take a look at the Pearson residuals for our CHD model from the WCGS data (graphed against the fitted values on the logit scale):</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-56_0327e71e67b04f9d65e4a994a8b04bbb">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-58_1c5b31fb78d70040e3b00dc088012c50">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(chd_glm_strat_grouped, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The fan-shape is gone, and these residuals don’t show any obvious signs of model fit issues.</p>
<section id="pearson-residuals-plot-for-beetles-data" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="pearson-residuals-plot-for-beetles-data"><span class="header-section-number">8.3.1</span> Pearson residuals plot for <code>beetles</code> data</h3>
<p>If we create the same plot for the <code>beetles</code> model, we see some strong evidence of a lack of fit:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-59_9216f6a5dc1708b8924d403594a64793">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(beetles_glm_grouped, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pearson-residuals-with-individual-ungrouped-data" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="pearson-residuals-with-individual-ungrouped-data"><span class="header-section-number">8.3.2</span> Pearson residuals with individual (ungrouped) data</h3>
<p>What happens if we try to compute residuals without grouping the data by covariate pattern?</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-61_e8b3b9d5a1eb50e8ac062aea1bac9e47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-62_98258ba82952a215734460b54f779865">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(chd_glm_strat, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Meaningless.</p>
</section>
<section id="residuals-plot-by-hand-optional-section" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="residuals-plot-by-hand-optional-section"><span class="header-section-number">8.3.3</span> Residuals plot by hand (<em>optional section</em>)</h3>
<p>If you want to check your understanding of what these residual plots are, try building them yourself:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-64_f030110f0e7a75e3f83b412a305a01a3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>wcgs_grouped <span class="ot">=</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted =</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_logit =</span> fitted <span class="sc">|&gt;</span> <span class="fu">logit</span>(),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">resids =</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">resid</span>(<span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>wcgs_resid_plot1 <span class="ot">=</span> </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fitted_logit,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> resids</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> dibpat)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">span=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">degree=</span><span class="dv">1</span>,</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">"symmetric"</span>,</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">iterations=</span><span class="dv">3</span>,</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">surface=</span><span class="st">"direct"</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>                <span class="co"># span = 2/3, </span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>                <span class="co"># iterations = 3</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>              ),</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> stats<span class="sc">::</span>loess)</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plot.glm and autoplot use stats::lowess, which is hard to use with </span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_smooth and hard to match exactly; </span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a><span class="co"># see https://support.bioconductor.org/p/2323/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-66_7d3d103a29738ed888a0b5e84df1c0ba">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>wcgs_resid_plot1 <span class="sc">|&gt;</span> <span class="fu">ggplotly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-51e038e742babeaee094" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-51e038e742babeaee094">{"x":{"data":[{"x":[-1.9035045514956241,-1.8315974066617542,-1.2563402479907959,-2.3349474204988425,-2.1192259859972333,-2.6225759998343219,-2.5506688550004522,-2.4068545653327127,-1.6158759721601448,-2.0473188411633636,-2.6944831446681916,-1.9754116963294939,-1.5439688273262753,-1.4720616824924053,-2.4787617101665824,-2.2630402756649728,-2.1911331308311031,-1.4001545376585356,-1.687783116994015,-1.7596902618278842,-1.3282473928246661],"y":[-0.63437945290859576,0.62006470991397156,0.1546765344094129,-0.32314137640605828,-0.27477762864565447,-0.0013932880580615546,-0.30347473837674804,-0.37508157915284729,-0.6597108838003336,1.0028150453407565,1.0518129601938366,2.928052531785533,-0.23999767668657088,1.0468817563438477,-1.4202917745638999,-0.099763240763368691,-1.0980259512257797,-0.96109203501400919,-0.93650721161428807,1.2111732236224655,-0.89403423992454878],"text":["fitted_logit: -1.9035046<br />resids: -0.6343794529<br />dibpat: Type A","fitted_logit: -1.8315974<br />resids:  0.6200647099<br />dibpat: Type A","fitted_logit: -1.2563402<br />resids:  0.1546765344<br />dibpat: Type A","fitted_logit: -2.3349474<br />resids: -0.3231413764<br />dibpat: Type A","fitted_logit: -2.1192260<br />resids: -0.2747776286<br />dibpat: Type A","fitted_logit: -2.6225760<br />resids: -0.0013932881<br />dibpat: Type A","fitted_logit: -2.5506689<br />resids: -0.3034747384<br />dibpat: Type A","fitted_logit: -2.4068546<br />resids: -0.3750815792<br />dibpat: Type A","fitted_logit: -1.6158760<br />resids: -0.6597108838<br />dibpat: Type A","fitted_logit: -2.0473188<br />resids:  1.0028150453<br />dibpat: Type A","fitted_logit: -2.6944831<br />resids:  1.0518129602<br />dibpat: Type A","fitted_logit: -1.9754117<br />resids:  2.9280525318<br />dibpat: Type A","fitted_logit: -1.5439688<br />resids: -0.2399976767<br />dibpat: Type A","fitted_logit: -1.4720617<br />resids:  1.0468817563<br />dibpat: Type A","fitted_logit: -2.4787617<br />resids: -1.4202917746<br />dibpat: Type A","fitted_logit: -2.2630403<br />resids: -0.0997632408<br />dibpat: Type A","fitted_logit: -2.1911331<br />resids: -1.0980259512<br />dibpat: Type A","fitted_logit: -1.4001545<br />resids: -0.9610920350<br />dibpat: Type A","fitted_logit: -1.6877831<br />resids: -0.9365072116<br />dibpat: Type A","fitted_logit: -1.7596903<br />resids:  1.2111732236<br />dibpat: Type A","fitted_logit: -1.3282474<br />resids: -0.8940342399<br />dibpat: Type A"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Type A","legendgroup":"Type A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.0329013797783677,-3.2791548743659225,-2.9097746324845901,-3.4022816216597005,-2.7866478851908125,-2.6635211378970349,-3.2175915007190339,-2.7250845115439239,-3.0944647534252563,-2.3557042696625916,-3.340718248012811,-2.232577522368814,-2.8482112588377015,-3.1560281270721449,-2.5403943906032578,-2.4788310169563688,-2.9713380061314787,-2.6019577642501464,-2.4172676433094802,-2.2941408960157026,-2.1710141487219254],"y":[-0.0044810795747202495,0.22159563738581595,-1.4999066438812154,1.7127098317633715,0.58026373624415217,1.2729164139631557,-1.7289660562707454,-0.34085761194085429,-0.5722654257278228,-1.6001002734221939,-0.88258984970818233,-0.81524777266671644,1.1503643930417931,0.54837451298717932,1.088576980651593,-0.090262797175270082,0.60075603631230234,-0.74744001042634334,-0.76352248832054659,0.041976829957371384,1.8076827891719742],"text":["fitted_logit: -3.0329014<br />resids: -0.0044810796<br />dibpat: Type B","fitted_logit: -3.2791549<br />resids:  0.2215956374<br />dibpat: Type B","fitted_logit: -2.9097746<br />resids: -1.4999066439<br />dibpat: Type B","fitted_logit: -3.4022816<br />resids:  1.7127098318<br />dibpat: Type B","fitted_logit: -2.7866479<br />resids:  0.5802637362<br />dibpat: Type B","fitted_logit: -2.6635211<br />resids:  1.2729164140<br />dibpat: Type B","fitted_logit: -3.2175915<br />resids: -1.7289660563<br />dibpat: Type B","fitted_logit: -2.7250845<br />resids: -0.3408576119<br />dibpat: Type B","fitted_logit: -3.0944648<br />resids: -0.5722654257<br />dibpat: Type B","fitted_logit: -2.3557043<br />resids: -1.6001002734<br />dibpat: Type B","fitted_logit: -3.3407182<br />resids: -0.8825898497<br />dibpat: Type B","fitted_logit: -2.2325775<br />resids: -0.8152477727<br />dibpat: Type B","fitted_logit: -2.8482113<br />resids:  1.1503643930<br />dibpat: Type B","fitted_logit: -3.1560281<br />resids:  0.5483745130<br />dibpat: Type B","fitted_logit: -2.5403944<br />resids:  1.0885769807<br />dibpat: Type B","fitted_logit: -2.4788310<br />resids: -0.0902627972<br />dibpat: Type B","fitted_logit: -2.9713380<br />resids:  0.6007560363<br />dibpat: Type B","fitted_logit: -2.6019578<br />resids: -0.7474400104<br />dibpat: Type B","fitted_logit: -2.4172676<br />resids: -0.7635224883<br />dibpat: Type B","fitted_logit: -2.2941409<br />resids:  0.0419768300<br />dibpat: Type B","fitted_logit: -2.1710141<br />resids:  1.8076827892<br />dibpat: Type B"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"Type B","legendgroup":"Type B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.5095786903431456,-1.1490431793073508],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.4022816216597005,-3.3751178068031322,-3.3479539919465635,-3.3207901770899952,-3.293626362233427,-3.2664625473768583,-3.23929873252029,-3.2121349176637217,-3.184971102807153,-3.1578072879505847,-3.1306434730940165,-3.1034796582374478,-3.0763158433808795,-3.0491520285243112,-3.0219882136677425,-2.9948243988111742,-2.967660583954606,-2.9404967690980373,-2.913332954241469,-2.8861691393849007,-2.859005324528332,-2.8318415096717637,-2.8046776948151955,-2.7775138799586272,-2.7503500651020585,-2.7231862502454902,-2.6960224353889219,-2.6688586205323532,-2.641694805675785,-2.6145309908192167,-2.5873671759626484,-2.5602033611060797,-2.5330395462495114,-2.5058757313929432,-2.4787119165363745,-2.4515481016798062,-2.4243842868232379,-2.3972204719666692,-2.3700566571101009,-2.3428928422535327,-2.315729027396964,-2.2885652125403957,-2.2614013976838274,-2.2342375828272587,-2.2070737679706904,-2.1799099531141222,-2.1527461382575535,-2.1255823234009852,-2.0984185085444169,-2.0712546936878482,-2.0440908788312799,-2.0169270639747117,-1.9897632491181432,-1.9625994342615747,-1.9354356194050062,-1.9082718045484379,-1.8811079896918694,-1.8539441748353009,-1.8267803599787327,-1.7996165451221642,-1.7724527302655959,-1.7452889154090274,-1.7181251005524589,-1.6909612856958907,-1.6637974708393222,-1.6366336559827537,-1.6094698411261854,-1.5823060262696169,-1.5551422114130484,-1.5279783965564802,-1.5008145816999117,-1.4736507668433434,-1.4464869519867749,-1.4193231371302064,-1.3921593222736379,-1.3649955074170697,-1.3378316925605014,-1.3106678777039327,-1.2835040628473644,-1.2563402479907959],"y":[-0.0056926112342833837,-0.0014655068031602997,0.0028627248026834476,0.0071376363715596096,0.011246513751015819,0.015097338111743503,0.018582045097171176,0.02157482692137978,0.023974315498757084,0.025751021327794554,0.026887889906031977,0.027346860434061235,0.027094217114688859,0.026147923881664013,0.024585005309459972,0.02254490427645317,0.020263582531734988,0.018113137646755099,0.016657754155375296,0.016842469031119783,0.020289606626684154,0.029174973065879392,0.044375051881825819,0.046783001239037683,0.051484393544902252,0.033586659195390528,0.03385647365258114,0.0052100346390719999,-0.0045353664964380407,-0.026157728281577943,-0.047133383380822971,-0.064813583771287389,-0.085002087709815863,-0.10627308279077179,-0.12126748905293154,-0.1351465957664077,-0.15240532995624531,-0.14988788107447951,-0.16679400995316715,-0.15806755283735852,-0.15273952587831507,-0.14460201576937726,-0.11795052084855193,-0.10817191909296144,-0.084246034162126338,-0.067064948514251335,-0.051085251977567282,-0.047066257502924015,-0.02449204986805446,-0.032743711707001792,-0.023582312823514862,-0.028707823097400741,-0.019260001872353293,-0.027058464148146444,-0.014836382606264877,-0.028272022204856421,-0.041759652010189829,-0.053375393311701332,-0.062892322941483225,-0.070772843049209486,-0.077592345129053816,-0.083820381064163507,-0.089839591346039541,-0.09595284443716344,-0.10236609846578275,-0.10919046577718902,-0.11649054204259235,-0.12429788044746347,-0.13261049809424932,-0.14141701050857211,-0.1506981811532461,-0.16042975672316281,-0.17059476616468389,-0.18121455529685906,-0.19231662964913931,-0.20390758940743961,-0.21596504491025803,-0.22846234289960157,-0.24134957275708155,-0.25456360364553021],"text":["fitted_logit: -3.4022816<br />resids: -0.0056926112","fitted_logit: -3.3751178<br />resids: -0.0014655068","fitted_logit: -3.3479540<br />resids:  0.0028627248","fitted_logit: -3.3207902<br />resids:  0.0071376364","fitted_logit: -3.2936264<br />resids:  0.0112465138","fitted_logit: -3.2664625<br />resids:  0.0150973381","fitted_logit: -3.2392987<br />resids:  0.0185820451","fitted_logit: -3.2121349<br />resids:  0.0215748269","fitted_logit: -3.1849711<br />resids:  0.0239743155","fitted_logit: -3.1578073<br />resids:  0.0257510213","fitted_logit: -3.1306435<br />resids:  0.0268878899","fitted_logit: -3.1034797<br />resids:  0.0273468604","fitted_logit: -3.0763158<br />resids:  0.0270942171","fitted_logit: -3.0491520<br />resids:  0.0261479239","fitted_logit: -3.0219882<br />resids:  0.0245850053","fitted_logit: -2.9948244<br />resids:  0.0225449043","fitted_logit: -2.9676606<br />resids:  0.0202635825","fitted_logit: -2.9404968<br />resids:  0.0181131376","fitted_logit: -2.9133330<br />resids:  0.0166577542","fitted_logit: -2.8861691<br />resids:  0.0168424690","fitted_logit: -2.8590053<br />resids:  0.0202896066","fitted_logit: -2.8318415<br />resids:  0.0291749731","fitted_logit: -2.8046777<br />resids:  0.0443750519","fitted_logit: -2.7775139<br />resids:  0.0467830012","fitted_logit: -2.7503501<br />resids:  0.0514843935","fitted_logit: -2.7231863<br />resids:  0.0335866592","fitted_logit: -2.6960224<br />resids:  0.0338564737","fitted_logit: -2.6688586<br />resids:  0.0052100346","fitted_logit: -2.6416948<br />resids: -0.0045353665","fitted_logit: -2.6145310<br />resids: -0.0261577283","fitted_logit: -2.5873672<br />resids: -0.0471333834","fitted_logit: -2.5602034<br />resids: -0.0648135838","fitted_logit: -2.5330395<br />resids: -0.0850020877","fitted_logit: -2.5058757<br />resids: -0.1062730828","fitted_logit: -2.4787119<br />resids: -0.1212674891","fitted_logit: -2.4515481<br />resids: -0.1351465958","fitted_logit: -2.4243843<br />resids: -0.1524053300","fitted_logit: -2.3972205<br />resids: -0.1498878811","fitted_logit: -2.3700567<br />resids: -0.1667940100","fitted_logit: -2.3428928<br />resids: -0.1580675528","fitted_logit: -2.3157290<br />resids: -0.1527395259","fitted_logit: -2.2885652<br />resids: -0.1446020158","fitted_logit: -2.2614014<br />resids: -0.1179505208","fitted_logit: -2.2342376<br />resids: -0.1081719191","fitted_logit: -2.2070738<br />resids: -0.0842460342","fitted_logit: -2.1799100<br />resids: -0.0670649485","fitted_logit: -2.1527461<br />resids: -0.0510852520","fitted_logit: -2.1255823<br />resids: -0.0470662575","fitted_logit: -2.0984185<br />resids: -0.0244920499","fitted_logit: -2.0712547<br />resids: -0.0327437117","fitted_logit: -2.0440909<br />resids: -0.0235823128","fitted_logit: -2.0169271<br />resids: -0.0287078231","fitted_logit: -1.9897632<br />resids: -0.0192600019","fitted_logit: -1.9625994<br />resids: -0.0270584641","fitted_logit: -1.9354356<br />resids: -0.0148363826","fitted_logit: -1.9082718<br />resids: -0.0282720222","fitted_logit: -1.8811080<br />resids: -0.0417596520","fitted_logit: -1.8539442<br />resids: -0.0533753933","fitted_logit: -1.8267804<br />resids: -0.0628923229","fitted_logit: -1.7996165<br />resids: -0.0707728430","fitted_logit: -1.7724527<br />resids: -0.0775923451","fitted_logit: -1.7452889<br />resids: -0.0838203811","fitted_logit: -1.7181251<br />resids: -0.0898395913","fitted_logit: -1.6909613<br />resids: -0.0959528444","fitted_logit: -1.6637975<br />resids: -0.1023660985","fitted_logit: -1.6366337<br />resids: -0.1091904658","fitted_logit: -1.6094698<br />resids: -0.1164905420","fitted_logit: -1.5823060<br />resids: -0.1242978804","fitted_logit: -1.5551422<br />resids: -0.1326104981","fitted_logit: -1.5279784<br />resids: -0.1414170105","fitted_logit: -1.5008146<br />resids: -0.1506981812","fitted_logit: -1.4736508<br />resids: -0.1604297567","fitted_logit: -1.4464870<br />resids: -0.1705947662","fitted_logit: -1.4193231<br />resids: -0.1812145553","fitted_logit: -1.3921593<br />resids: -0.1923166296","fitted_logit: -1.3649955<br />resids: -0.2039075894","fitted_logit: -1.3378317<br />resids: -0.2159650449","fitted_logit: -1.3106679<br />resids: -0.2284623429","fitted_logit: -1.2835041<br />resids: -0.2413495728","fitted_logit: -1.2563402<br />resids: -0.2545636036"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.7795275590551185,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.5095786903431456,-1.1490431793073508],"tickmode":"array","ticktext":["-3.5","-3.0","-2.5","-2.0","-1.5"],"tickvals":[-3.5,-3,-2.5,-2,-1.5],"categoryorder":"array","categoryarray":["-3.5","-3.0","-2.5","-2.0","-1.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"fitted_logit","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.9618169856735594,3.1609034611883469],"tickmode":"array","ticktext":["-1","0","1","2","3"],"tickvals":[-1,2.2204460492503131e-16,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"resids","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"dibpat","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"142e41269bda":{"x":{},"y":{},"colour":{},"type":"scatter"},"142e4dc226a0":{"yintercept":{}},"142e575fa42":{"x":{},"y":{}}},"cur_data":"142e41269bda","visdat":{"142e41269bda":["function (y) ","x"],"142e4dc226a0":["function (y) ","x"],"142e575fa42":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="pearson-chi-squared-goodness-of-fit-test" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="pearson-chi-squared-goodness-of-fit-test"><span class="header-section-number">8.4</span> Pearson chi-squared goodness of fit test</h2>
<p>The Pearson chi-squared goodness of fit statistic is: <span class="math display">\[
X^2 = \sum_{k=1}^m X_k^2
\]</span> Under the null hypothesis that the model in question is correct (i.e., sufficiently complex), <span class="math inline">\(X^2\ \dot \sim\ \chi^2(N-p)\)</span>.</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-67_f4ea62f3239943d67bd8e28abb5bea54">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resid</span>(<span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>chisq_stat <span class="ot">=</span> <span class="fu">sum</span>(X<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">=</span> <span class="fu">pchisq</span>(</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  chisq_stat, </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="cn">FALSE</span>, </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">length</span>(X) <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">coef</span>(chd_glm_strat_grouped)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For our CHD model, the p-value for this test is 0.26523556; no significant evidence of a lack of fit at the 0.05 level.</p>
<section id="standardized-pearson-residuals" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="standardized-pearson-residuals"><span class="header-section-number">8.4.1</span> Standardized Pearson residuals</h3>
<p>Especially for small data sets, we might want to adjust our residuals for leverage (since outliers in <span class="math inline">\(X\)</span> add extra variance to the residuals):</p>
<p><span class="math display">\[r_{P_k} = \frac{X_k}{\sqrt{1-h_k}}\]</span></p>
<p>where <span class="math inline">\(h_k\)</span> is the leverage of <span class="math inline">\(X_k\)</span>. The functions <code>autoplot()</code> and <code>plot.lm()</code> use these for some of their graphs.</p>
</section>
</section>
<section id="deviance-residuals" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="deviance-residuals"><span class="header-section-number">8.5</span> Deviance residuals</h2>
<p>For large sample sizes, the Pearson and deviance residuals will be approximately the same. For small sample sizes, the deviance residuals from covariate patterns with small sample sizes can be unreliable (high variance).</p>
<p><span class="math display">\[d_k = \text{sign}(y_k - n_k \hat \pi_k)\left\{\sqrt{2[\ell_{\text{full}}(x_k) - \ell(\hat\beta; x_k)]}\right\}\]</span></p>
<section id="standardized-deviance-residuals" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="standardized-deviance-residuals"><span class="header-section-number">8.5.1</span> Standardized deviance residuals</h3>
<p><span class="math display">\[r_{D_k} = \frac{d_k}{\sqrt{1-h_k}}\]</span></p>
</section>
</section>
<section id="diagnostic-plots" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="diagnostic-plots"><span class="header-section-number">8.6</span> Diagnostic plots</h2>
<p>Let’s take a look at the full set of <code>autoplot()</code> diagnostics now for our <code>CHD</code> model:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-68_0aeca15a08bafe4b4d2ba00f5baaf203">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(<span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Things look pretty good here. The QQ plot is still usable; with large samples; the residuals should be approximately Gaussian.</p>
<section id="beetles" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="beetles"><span class="header-section-number">8.6.1</span> Beetles</h3>
<p>Let’s look at the beetles model diagnostic plots for comparison:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-70_4eacf18a77e7e600a76ff4c151e90cf7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(<span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hard to tell much from so little data, but there might be some issues here.</p>
</section>
</section>
</section>
<section id="sec-OR-RR" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Odds Ratios vs Probability (Risk) Ratios</h1>
<div id="def-rr" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 9.1 (Relative risk) </strong></span>The <strong>relative risk</strong> comparing two probabilities <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span>, also known as the <strong>risk ratio</strong>, <strong>relative risk ratio</strong>, <strong>probability ratio</strong>, and <strong>rate ratio</strong>, is:</p>
<p><span class="math display">\[\rho(1,2) \eqdef \frac{\pi_1}{\pi_2}\]</span></p>
</div>
<section id="section-1" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="section-1"><span class="header-section-number">9.1</span> </h2>
<section id="case-1-rare-events" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="case-1-rare-events"><span class="header-section-number">9.1.1</span> Case 1: rare events</h3>
<p>For rare events, odds ratios and probability (a.k.a. risk, a.k.a. prevalence) ratios will be close:</p>
<p><span class="math inline">\(\pi_1 = .01\)</span> <span class="math inline">\(\pi_2 = .02\)</span></p>
<div class="cell" data-hash="logistic-regression_cache/html/rare events or-rr_a8dd47d0ab0fb8283b2a1f5a1b8c6bf6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pi1 <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>pi2 <span class="ot">=</span> .<span class="dv">02</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>pi2<span class="sc">/</span>pi1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(pi2)<span class="sc">/</span><span class="fu">odds</span>(pi1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.0204082</code></pre>
</div>
</div>
</section>
<section id="case-2-frequent-events" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="case-2-frequent-events"><span class="header-section-number">9.1.2</span> Case 2: frequent events</h3>
<p><span class="math inline">\(\pi_1 = .4\)</span> <span class="math inline">\(\pi_2 = .5\)</span></p>
<p>For more frequently-occurring outcomes, this won’t be the case:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-72_5e36f2e58407e1ab6798e115a10c1760">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pi1 <span class="ot">=</span> .<span class="dv">4</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>pi2 <span class="ot">=</span> .<span class="dv">5</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>pi2<span class="sc">/</span>pi1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.25</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(pi2)<span class="sc">/</span><span class="fu">odds</span>(pi1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
<p>If you want risk ratios, you can sometimes get them by changing the link function:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-73_f245a325400c543c9bdda7b07a1091a1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(anthers, <span class="at">package =</span> <span class="st">"dobson"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>anthers.sum<span class="ot">&lt;-</span><span class="fu">aggregate</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  anthers[<span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"y"</span>)], </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span>anthers[<span class="fu">c</span>(<span class="st">"storage"</span>)],<span class="at">FUN=</span>sum) </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>anthers_glm_log <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">cbind</span>(y,n<span class="sc">-</span>y)<span class="sc">~</span>storage,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>anthers.sum, </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>anthers_glm_log <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Risk</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-0.80</td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">(-1.04, -0.58)</td>
<td style="text-align: center;">-6.81</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">storage</td>
<td style="text-align: center;">0.17</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">(0.02, 0.31)</td>
<td style="text-align: center;">2.31</td>
<td style="text-align: center;">0.021</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now <span class="math inline">\(\exp(\beta)\)</span> gives us risk ratios instead of odds ratios:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-74_4b2758a7a55bed4506b442132531f359">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>anthers_glm_log <span class="sc">|&gt;</span> <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Risk Ratio</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">(0.35, 0.56)</td>
<td style="text-align: center;">-6.81</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">storage</td>
<td style="text-align: center;">1.18</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">(1.03, 1.36)</td>
<td style="text-align: center;">2.31</td>
<td style="text-align: center;">0.021</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Let’s compare this model with a logistic model:</p>
<div class="cell" data-hash="logistic-regression_cache/html/unnamed-chunk-75_198694a50f475f87c2f187a8705e2f69">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>anthers_glm_logit <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(y,n<span class="sc">-</span>y)<span class="sc">~</span>storage,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>anthers.sum, </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>anthers_glm_logit <span class="sc">|&gt;</span> <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Odds Ratio</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">0.76</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">(0.45, 1.27)</td>
<td style="text-align: center;">-1.05</td>
<td style="text-align: center;">0.296</td>
</tr>
<tr class="even">
<td style="text-align: left;">storage</td>
<td style="text-align: center;">1.49</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">(1.06, 2.10)</td>
<td style="text-align: center;">2.29</td>
<td style="text-align: center;">0.022</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>[to add: fitted plots on each outcome scale]</p>
<p>When I try to use <code>link ="log"</code> in practice, I often get errors about not finding good starting values for the estimation procedure. This is likely because the model is producing fitted probabilities greater than 1.</p>
<p>When this happens, you can try to fit Poisson regression models instead (we will see those soon!). But then the outcome distribution isn’t quite right, and you won’t get warnings about fitted probabilities greater than 1. In my opinion, the Poisson model for binary outcomes is confusing and not very appealing.</p>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Linear-models-overview.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./count-regression.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Models for Count Outcomes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb86" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Logistic Regression"</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Ezra Morrison"</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> "[Last modified:] YYYY-MM-DD: H:mm:ss (A)"</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co">  revealjs:</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: dark</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co">    smaller: false</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co">    slide-number: true</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co">    scrollable: true</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: true</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "[R code]"</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="co">    # chalkboard: true</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="co">    # fig-width: 7</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co">    # fig-height: 5</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="co">    # out-width: "100%"</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>::: hidden</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>$$\def\eqdef{\stackrel{\text{def}}{=}}$$</span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## Acknowledgements {.unnumbered}</span></span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>This content is adapted from:</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dobson &amp; Barnett 2018, "An Introduction to Generalized Linear</span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a>    Models", 4th edition, Chapter 7</span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Vittinghoff et al 2012, "Regression Methods in Biostatistics", 2nd</span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>    edition, Chapter 5</span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Configuring R {.unnumbered}</span></span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>Functions from these packages will be used throughout this document:</span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r packages, message = FALSE}</span></span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander) <span class="co"># format tables for markdown</span></span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># graphics</span></span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co"># help with graphics</span></span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># manipulate data</span></span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co"># import Stata files</span></span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># format R output for markdown</span></span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># Tools to help to create tidy data</span></span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># interactive graphics</span></span>
<span id="cb86-67"><a href="#cb86-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dobson) <span class="co"># datasets from Dobson and Barnett 2018</span></span>
<span id="cb86-68"><a href="#cb86-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co"># format model output tables for markdown</span></span>
<span id="cb86-69"><a href="#cb86-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted) <span class="co"># check for conflicting function definitions</span></span>
<span id="cb86-70"><a href="#cb86-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-71"><a href="#cb86-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-72"><a href="#cb86-72" aria-hidden="true" tabindex="-1"></a>Here are some R settings I use in this document:</span>
<span id="cb86-73"><a href="#cb86-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-74"><a href="#cb86-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r options, message=FALSE}</span></span>
<span id="cb86-75"><a href="#cb86-75" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># delete any data that's already loaded into R</span></span>
<span id="cb86-76"><a href="#cb86-76" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb86-77"><a href="#cb86-77" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">panderOptions</span>(<span class="st">"table.emphasize.rownames"</span>, <span class="cn">FALSE</span>)</span>
<span id="cb86-78"><a href="#cb86-78" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">'digits'</span> <span class="ot">=</span> <span class="dv">4</span>)</span>
<span id="cb86-79"><a href="#cb86-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-80"><a href="#cb86-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-81"><a href="#cb86-81" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction to logistic regression</span></span>
<span id="cb86-82"><a href="#cb86-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-83"><a href="#cb86-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Binary outcomes models - one group, no covariates</span></span>
<span id="cb86-84"><a href="#cb86-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-85"><a href="#cb86-85" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-86"><a href="#cb86-86" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb86-87"><a href="#cb86-87" aria-hidden="true" tabindex="-1"></a>p(Y=1) &amp;= \pi<span class="sc">\\</span></span>
<span id="cb86-88"><a href="#cb86-88" aria-hidden="true" tabindex="-1"></a>p(Y=0) &amp;= 1-\pi<span class="sc">\\</span></span>
<span id="cb86-89"><a href="#cb86-89" aria-hidden="true" tabindex="-1"></a>p(Y=y) &amp;= \pi^y (1-\pi)^{1-y}<span class="sc">\\</span></span>
<span id="cb86-90"><a href="#cb86-90" aria-hidden="true" tabindex="-1"></a>\mathbf y  &amp;= (y_1, ..., y_n)<span class="sc">\\</span></span>
<span id="cb86-91"><a href="#cb86-91" aria-hidden="true" tabindex="-1"></a>\mathcal L(\pi;\mathbf y) &amp;= \pi^{\sum y_i} (1-\pi)^{n - \sum y_i}<span class="sc">\\</span></span>
<span id="cb86-92"><a href="#cb86-92" aria-hidden="true" tabindex="-1"></a>\ell(\pi, \mathbf y) &amp;= \left({\sum y_i}\right) \log \pi + \left(n - \sum y_i\right) \log (1-\pi)<span class="sc">\\</span></span>
<span id="cb86-93"><a href="#cb86-93" aria-hidden="true" tabindex="-1"></a>&amp;= \left({\sum y_i}\right) \left(\log \pi - \log (1-\pi)\right) + n \cdot \log (1-\pi)<span class="sc">\\</span></span>
<span id="cb86-94"><a href="#cb86-94" aria-hidden="true" tabindex="-1"></a>&amp;= \left({\sum y_i}\right) \log \left( \frac{\pi}{ 1-\pi}\right) + n \cdot \log (1-\pi)</span>
<span id="cb86-95"><a href="#cb86-95" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb86-96"><a href="#cb86-96" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-97"><a href="#cb86-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-98"><a href="#cb86-98" aria-hidden="true" tabindex="-1"></a><span class="fu">## Binary outcomes - general</span></span>
<span id="cb86-99"><a href="#cb86-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-100"><a href="#cb86-100" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-101"><a href="#cb86-101" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb86-102"><a href="#cb86-102" aria-hidden="true" tabindex="-1"></a>p(Y_i=1) &amp;= \pi_i<span class="sc">\\</span></span>
<span id="cb86-103"><a href="#cb86-103" aria-hidden="true" tabindex="-1"></a>p(Y_i=0) &amp;= 1-\pi_i<span class="sc">\\</span></span>
<span id="cb86-104"><a href="#cb86-104" aria-hidden="true" tabindex="-1"></a>p(Y_i=y) &amp;= (\pi_i)^y (1-\pi_i)^{1-y}<span class="sc">\\</span></span>
<span id="cb86-105"><a href="#cb86-105" aria-hidden="true" tabindex="-1"></a>\mathbf y  &amp;= (y_1, ..., y_n)<span class="sc">\\</span></span>
<span id="cb86-106"><a href="#cb86-106" aria-hidden="true" tabindex="-1"></a>\mathcal L(\pi;\mathbf y) &amp;= \prod_{i=1}^n </span>
<span id="cb86-107"><a href="#cb86-107" aria-hidden="true" tabindex="-1"></a>(\pi_i)^{y_i} (1-\pi_i)^{1 - y_i}<span class="sc">\\</span></span>
<span id="cb86-108"><a href="#cb86-108" aria-hidden="true" tabindex="-1"></a>\ell(\pi, \mathbf y) &amp;= </span>
<span id="cb86-109"><a href="#cb86-109" aria-hidden="true" tabindex="-1"></a>\sum_{i=1}^n </span>
<span id="cb86-110"><a href="#cb86-110" aria-hidden="true" tabindex="-1"></a>y_i \log \pi_i + (1 - y_i) \log (1-\pi_i)</span>
<span id="cb86-111"><a href="#cb86-111" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb86-112"><a href="#cb86-112" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-113"><a href="#cb86-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-114"><a href="#cb86-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modeling $\pi_i$ as a function of $X_i$</span></span>
<span id="cb86-115"><a href="#cb86-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-116"><a href="#cb86-116" aria-hidden="true" tabindex="-1"></a>If there are only a few distinct $X_i$ values, we can model each one</span>
<span id="cb86-117"><a href="#cb86-117" aria-hidden="true" tabindex="-1"></a>separately.</span>
<span id="cb86-118"><a href="#cb86-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-119"><a href="#cb86-119" aria-hidden="true" tabindex="-1"></a>Otherwise, we need regression.</span>
<span id="cb86-120"><a href="#cb86-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-121"><a href="#cb86-121" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-122"><a href="#cb86-122" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb86-123"><a href="#cb86-123" aria-hidden="true" tabindex="-1"></a>\pi(x) &amp;\equiv \text{E}(Y=1|X=x)<span class="sc">\\</span></span>
<span id="cb86-124"><a href="#cb86-124" aria-hidden="true" tabindex="-1"></a>&amp;= f(x^\top\beta)</span>
<span id="cb86-125"><a href="#cb86-125" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb86-126"><a href="#cb86-126" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-127"><a href="#cb86-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-128"><a href="#cb86-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### expit function</span></span>
<span id="cb86-129"><a href="#cb86-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-130"><a href="#cb86-130" aria-hidden="true" tabindex="-1"></a>Typically, we use</span>
<span id="cb86-131"><a href="#cb86-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-132"><a href="#cb86-132" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-133"><a href="#cb86-133" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb86-134"><a href="#cb86-134" aria-hidden="true" tabindex="-1"></a>f(\eta) &amp;= \text{expit}(\eta)<span class="sc">\\</span></span>
<span id="cb86-135"><a href="#cb86-135" aria-hidden="true" tabindex="-1"></a>&amp;\eqdef \frac{\exp(\eta)}{1+\exp(\eta)}<span class="sc">\\</span></span>
<span id="cb86-136"><a href="#cb86-136" aria-hidden="true" tabindex="-1"></a>&amp;= (1 + \exp<span class="sc">\{</span>-\eta<span class="sc">\}</span>)^{-1}</span>
<span id="cb86-137"><a href="#cb86-137" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb86-138"><a href="#cb86-138" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-139"><a href="#cb86-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-140"><a href="#cb86-140" aria-hidden="true" tabindex="-1"></a>This function is called the "expit", "inverse-logit", or "logistic"</span>
<span id="cb86-141"><a href="#cb86-141" aria-hidden="true" tabindex="-1"></a>function.</span>
<span id="cb86-142"><a href="#cb86-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-145"><a href="#cb86-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-146"><a href="#cb86-146" aria-hidden="true" tabindex="-1"></a>expit <span class="ot">=</span> <span class="cf">function</span>(eta) <span class="fu">exp</span>(eta)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(eta))</span>
<span id="cb86-147"><a href="#cb86-147" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-148"><a href="#cb86-148" aria-hidden="true" tabindex="-1"></a>expit_plot <span class="ot">=</span> </span>
<span id="cb86-149"><a href="#cb86-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb86-150"><a href="#cb86-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> expit) <span class="sc">+</span> </span>
<span id="cb86-151"><a href="#cb86-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb86-152"><a href="#cb86-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb86-153"><a href="#cb86-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">expit</span>(eta))) <span class="sc">+</span></span>
<span id="cb86-154"><a href="#cb86-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(eta)) <span class="sc">+</span></span>
<span id="cb86-155"><a href="#cb86-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb86-156"><a href="#cb86-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-157"><a href="#cb86-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-158"><a href="#cb86-158" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-161"><a href="#cb86-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-162"><a href="#cb86-162" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expit_plot)</span>
<span id="cb86-163"><a href="#cb86-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-164"><a href="#cb86-164" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-165"><a href="#cb86-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-166"><a href="#cb86-166" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-169"><a href="#cb86-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-170"><a href="#cb86-170" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expit_plot)</span>
<span id="cb86-171"><a href="#cb86-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-172"><a href="#cb86-172" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-173"><a href="#cb86-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-174"><a href="#cb86-174" aria-hidden="true" tabindex="-1"></a>The inverse of the <span class="in">`expit`</span> function is the <span class="in">`logit`</span> function:</span>
<span id="cb86-175"><a href="#cb86-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-176"><a href="#cb86-176" aria-hidden="true" tabindex="-1"></a>$$g(p) = f^{-1}(p) = \text{logit}(p) = \log \left<span class="sc">\{</span>\frac{p}{1-p}\right<span class="sc">\}</span>$$</span>
<span id="cb86-177"><a href="#cb86-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-178"><a href="#cb86-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### odds function</span></span>
<span id="cb86-179"><a href="#cb86-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-182"><a href="#cb86-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-183"><a href="#cb86-183" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">=</span> <span class="cf">function</span>(p) p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb86-184"><a href="#cb86-184" aria-hidden="true" tabindex="-1"></a>odds_plot <span class="ot">=</span> </span>
<span id="cb86-185"><a href="#cb86-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb86-186"><a href="#cb86-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> odds) <span class="sc">+</span> </span>
<span id="cb86-187"><a href="#cb86-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, .<span class="dv">99</span>) <span class="sc">+</span> </span>
<span id="cb86-188"><a href="#cb86-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"odds(p)"</span>) <span class="sc">+</span></span>
<span id="cb86-189"><a href="#cb86-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"p"</span>) <span class="sc">+</span></span>
<span id="cb86-190"><a href="#cb86-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb86-191"><a href="#cb86-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-192"><a href="#cb86-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-193"><a href="#cb86-193" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-196"><a href="#cb86-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-197"><a href="#cb86-197" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(odds_plot)</span>
<span id="cb86-198"><a href="#cb86-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-199"><a href="#cb86-199" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-200"><a href="#cb86-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-201"><a href="#cb86-201" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-204"><a href="#cb86-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-205"><a href="#cb86-205" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(odds_plot)</span>
<span id="cb86-206"><a href="#cb86-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-207"><a href="#cb86-207" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-208"><a href="#cb86-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-209"><a href="#cb86-209" aria-hidden="true" tabindex="-1"></a><span class="fu">### logit function</span></span>
<span id="cb86-210"><a href="#cb86-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-213"><a href="#cb86-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-214"><a href="#cb86-214" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">=</span> <span class="cf">function</span>(p) <span class="fu">log</span>(<span class="fu">odds</span>(p))</span>
<span id="cb86-215"><a href="#cb86-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-216"><a href="#cb86-216" aria-hidden="true" tabindex="-1"></a>logit_plot <span class="ot">=</span> </span>
<span id="cb86-217"><a href="#cb86-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb86-218"><a href="#cb86-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> logit) <span class="sc">+</span> </span>
<span id="cb86-219"><a href="#cb86-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(.<span class="dv">01</span>, .<span class="dv">99</span>) <span class="sc">+</span> </span>
<span id="cb86-220"><a href="#cb86-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"logit(p)"</span>) <span class="sc">+</span></span>
<span id="cb86-221"><a href="#cb86-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"p"</span>) <span class="sc">+</span></span>
<span id="cb86-222"><a href="#cb86-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb86-223"><a href="#cb86-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-224"><a href="#cb86-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-225"><a href="#cb86-225" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-228"><a href="#cb86-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-229"><a href="#cb86-229" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(logit_plot)</span>
<span id="cb86-230"><a href="#cb86-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-231"><a href="#cb86-231" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-232"><a href="#cb86-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-233"><a href="#cb86-233" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-236"><a href="#cb86-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-237"><a href="#cb86-237" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(logit_plot)</span>
<span id="cb86-238"><a href="#cb86-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-239"><a href="#cb86-239" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-240"><a href="#cb86-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-241"><a href="#cb86-241" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagram of expit and logit {#sec-expit-logit-diagram}</span></span>
<span id="cb86-242"><a href="#cb86-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-243"><a href="#cb86-243" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-244"><a href="#cb86-244" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-245"><a href="#cb86-245" aria-hidden="true" tabindex="-1"></a>\left<span class="co">[</span><span class="ot"> \pi  \eqdef\Pr(Y=1)\right</span><span class="co">]</span></span>
<span id="cb86-246"><a href="#cb86-246" aria-hidden="true" tabindex="-1"></a>\underbrace{</span>
<span id="cb86-247"><a href="#cb86-247" aria-hidden="true" tabindex="-1"></a>\overbrace{</span>
<span id="cb86-248"><a href="#cb86-248" aria-hidden="true" tabindex="-1"></a>\underset{</span>
<span id="cb86-249"><a href="#cb86-249" aria-hidden="true" tabindex="-1"></a>\xleftarrow<span class="co">[</span><span class="ot"> \frac{\omega}{1+\omega}</span><span class="co">]</span>{}</span>
<span id="cb86-250"><a href="#cb86-250" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-251"><a href="#cb86-251" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-252"><a href="#cb86-252" aria-hidden="true" tabindex="-1"></a>\xrightarrow{\frac{\pi}{1-\pi}}</span>
<span id="cb86-253"><a href="#cb86-253" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-254"><a href="#cb86-254" aria-hidden="true" tabindex="-1"></a>\left<span class="co">[</span><span class="ot">\omega \eqdef \text{odds}(Y=1)\right</span><span class="co">]</span></span>
<span id="cb86-255"><a href="#cb86-255" aria-hidden="true" tabindex="-1"></a>\underset{</span>
<span id="cb86-256"><a href="#cb86-256" aria-hidden="true" tabindex="-1"></a>\xleftarrow<span class="co">[</span><span class="ot">\exp\{\eta\}</span><span class="co">]</span>{}</span>
<span id="cb86-257"><a href="#cb86-257" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-258"><a href="#cb86-258" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-259"><a href="#cb86-259" aria-hidden="true" tabindex="-1"></a>\xrightarrow{\log<span class="sc">\{</span>\omega<span class="sc">\}</span>}</span>
<span id="cb86-260"><a href="#cb86-260" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-261"><a href="#cb86-261" aria-hidden="true" tabindex="-1"></a>}^{\text{logit}(\pi)}</span>
<span id="cb86-262"><a href="#cb86-262" aria-hidden="true" tabindex="-1"></a>}_{\text{expit}(\eta)}</span>
<span id="cb86-263"><a href="#cb86-263" aria-hidden="true" tabindex="-1"></a>\left<span class="co">[</span><span class="ot">\eta \eqdef \text{log-odds}(Y=1)\right</span><span class="co">]</span></span>
<span id="cb86-264"><a href="#cb86-264" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-265"><a href="#cb86-265" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-266"><a href="#cb86-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-267"><a href="#cb86-267" aria-hidden="true" tabindex="-1"></a>::: {.content-hidden when-format="pdf"}</span>
<span id="cb86-268"><a href="#cb86-268" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-269"><a href="#cb86-269" aria-hidden="true" tabindex="-1"></a>\underbrace{\pi}_{\atop{\Pr(Y=1)} }</span>
<span id="cb86-270"><a href="#cb86-270" aria-hidden="true" tabindex="-1"></a>\overbrace{</span>
<span id="cb86-271"><a href="#cb86-271" aria-hidden="true" tabindex="-1"></a>\underbrace{</span>
<span id="cb86-272"><a href="#cb86-272" aria-hidden="true" tabindex="-1"></a>\underset{</span>
<span id="cb86-273"><a href="#cb86-273" aria-hidden="true" tabindex="-1"></a>\xleftarrow<span class="co">[</span><span class="ot">\frac{\omega}{1+\omega}</span><span class="co">]</span>{}</span>
<span id="cb86-274"><a href="#cb86-274" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-275"><a href="#cb86-275" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-276"><a href="#cb86-276" aria-hidden="true" tabindex="-1"></a>\xrightarrow{\frac{\pi}{1-\pi}}</span>
<span id="cb86-277"><a href="#cb86-277" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-278"><a href="#cb86-278" aria-hidden="true" tabindex="-1"></a>\underbrace{\omega}_{\text{odds}(Y=1)}</span>
<span id="cb86-279"><a href="#cb86-279" aria-hidden="true" tabindex="-1"></a>\underset{</span>
<span id="cb86-280"><a href="#cb86-280" aria-hidden="true" tabindex="-1"></a>\xleftarrow<span class="co">[</span><span class="ot">\exp\{\eta\}</span><span class="co">]</span>{}</span>
<span id="cb86-281"><a href="#cb86-281" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-282"><a href="#cb86-282" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-283"><a href="#cb86-283" aria-hidden="true" tabindex="-1"></a>\xrightarrow{\log<span class="sc">\{</span>\omega<span class="sc">\}</span>}</span>
<span id="cb86-284"><a href="#cb86-284" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-285"><a href="#cb86-285" aria-hidden="true" tabindex="-1"></a>}_{\text{expit}(\eta)}</span>
<span id="cb86-286"><a href="#cb86-286" aria-hidden="true" tabindex="-1"></a>}^{\text{logit}(\pi)}</span>
<span id="cb86-287"><a href="#cb86-287" aria-hidden="true" tabindex="-1"></a>\underbrace{\eta}_{\atop{\text{log-odds}(Y=1)}}</span>
<span id="cb86-288"><a href="#cb86-288" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-289"><a href="#cb86-289" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-290"><a href="#cb86-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-291"><a href="#cb86-291" aria-hidden="true" tabindex="-1"></a><span class="fu">## Meet the beetles</span></span>
<span id="cb86-292"><a href="#cb86-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-295"><a href="#cb86-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-296"><a href="#cb86-296" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmx)</span>
<span id="cb86-297"><a href="#cb86-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-298"><a href="#cb86-298" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(BeetleMortality, <span class="at">package =</span> <span class="st">"glmx"</span>)</span>
<span id="cb86-299"><a href="#cb86-299" aria-hidden="true" tabindex="-1"></a>beetles <span class="ot">=</span> BeetleMortality <span class="sc">|&gt;</span></span>
<span id="cb86-300"><a href="#cb86-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-301"><a href="#cb86-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct =</span> died<span class="sc">/</span>n,</span>
<span id="cb86-302"><a href="#cb86-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">survived =</span> n <span class="sc">-</span> died</span>
<span id="cb86-303"><a href="#cb86-303" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-304"><a href="#cb86-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-305"><a href="#cb86-305" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">=</span> </span>
<span id="cb86-306"><a href="#cb86-306" aria-hidden="true" tabindex="-1"></a>  beetles <span class="sc">|&gt;</span> </span>
<span id="cb86-307"><a href="#cb86-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> pct)) <span class="sc">+</span></span>
<span id="cb86-308"><a href="#cb86-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n)) <span class="sc">+</span></span>
<span id="cb86-309"><a href="#cb86-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Dose (log mg/L)"</span>) <span class="sc">+</span></span>
<span id="cb86-310"><a href="#cb86-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mortality rate (%)"</span>) <span class="sc">+</span></span>
<span id="cb86-311"><a href="#cb86-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb86-312"><a href="#cb86-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb86-313"><a href="#cb86-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span>
<span id="cb86-314"><a href="#cb86-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-315"><a href="#cb86-315" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot1)</span>
<span id="cb86-316"><a href="#cb86-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-317"><a href="#cb86-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-318"><a href="#cb86-318" aria-hidden="true" tabindex="-1"></a>Mortality rates of adult flour beetles after five hours' exposure to</span>
<span id="cb86-319"><a href="#cb86-319" aria-hidden="true" tabindex="-1"></a>gaseous carbon disulphide (Bliss 1935)</span>
<span id="cb86-320"><a href="#cb86-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-321"><a href="#cb86-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why don't we use linear regression?</span></span>
<span id="cb86-322"><a href="#cb86-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-325"><a href="#cb86-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-326"><a href="#cb86-326" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="ot">=</span> beetles <span class="sc">|&gt;</span> </span>
<span id="cb86-327"><a href="#cb86-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(<span class="at">formula =</span> <span class="fu">cbind</span>(died, survived) <span class="sc">~</span> dose, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb86-328"><a href="#cb86-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-329"><a href="#cb86-329" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">=</span> </span>
<span id="cb86-330"><a href="#cb86-330" aria-hidden="true" tabindex="-1"></a>  beetles  <span class="sc">|&gt;</span> </span>
<span id="cb86-331"><a href="#cb86-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb86-332"><a href="#cb86-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">everything</span>(),</span>
<span id="cb86-333"><a href="#cb86-333" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">c</span>(</span>
<span id="cb86-334"><a href="#cb86-334" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> died), </span>
<span id="cb86-335"><a href="#cb86-335" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> survived))</span>
<span id="cb86-336"><a href="#cb86-336" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb86-337"><a href="#cb86-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb86-338"><a href="#cb86-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> outcome <span class="sc">~</span> dose, </span>
<span id="cb86-339"><a href="#cb86-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _)</span>
<span id="cb86-340"><a href="#cb86-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-341"><a href="#cb86-341" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">=</span> </span>
<span id="cb86-342"><a href="#cb86-342" aria-hidden="true" tabindex="-1"></a>  beetles  <span class="sc">|&gt;</span> </span>
<span id="cb86-343"><a href="#cb86-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb86-344"><a href="#cb86-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">everything</span>(),</span>
<span id="cb86-345"><a href="#cb86-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">c</span>(</span>
<span id="cb86-346"><a href="#cb86-346" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> died), </span>
<span id="cb86-347"><a href="#cb86-347" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> survived))</span>
<span id="cb86-348"><a href="#cb86-348" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb86-349"><a href="#cb86-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb86-350"><a href="#cb86-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> outcome <span class="sc">~</span> <span class="fu">log</span>(dose), </span>
<span id="cb86-351"><a href="#cb86-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _)</span>
<span id="cb86-352"><a href="#cb86-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-353"><a href="#cb86-353" aria-hidden="true" tabindex="-1"></a>range1 <span class="ot">=</span> <span class="fu">range</span>(beetles<span class="sc">$</span>dose) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, .<span class="dv">2</span>)</span>
<span id="cb86-354"><a href="#cb86-354" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">predict</span>(beetles_glm_grouped, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> x), <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb86-355"><a href="#cb86-355" aria-hidden="true" tabindex="-1"></a>f.linear <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">predict</span>(lm1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> x))</span>
<span id="cb86-356"><a href="#cb86-356" aria-hidden="true" tabindex="-1"></a>f.linearlog <span class="ot">=</span> <span class="cf">function</span>(x) <span class="fu">predict</span>(lm2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">dose =</span> x))</span>
<span id="cb86-357"><a href="#cb86-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-358"><a href="#cb86-358" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">=</span> </span>
<span id="cb86-359"><a href="#cb86-359" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="sc">+</span> </span>
<span id="cb86-360"><a href="#cb86-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb86-361"><a href="#cb86-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> f.linear, </span>
<span id="cb86-362"><a href="#cb86-362" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Straight line"</span>)) <span class="sc">+</span></span>
<span id="cb86-363"><a href="#cb86-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">"Model"</span>, <span class="at">size =</span> <span class="st">""</span>)</span>
<span id="cb86-364"><a href="#cb86-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-365"><a href="#cb86-365" aria-hidden="true" tabindex="-1"></a>plot2 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-366"><a href="#cb86-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-367"><a href="#cb86-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-368"><a href="#cb86-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-369"><a href="#cb86-369" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zoom out</span></span>
<span id="cb86-370"><a href="#cb86-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-373"><a href="#cb86-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-374"><a href="#cb86-374" aria-hidden="true" tabindex="-1"></a>(plot2 <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">2</span>))) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-375"><a href="#cb86-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-376"><a href="#cb86-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-377"><a href="#cb86-377" aria-hidden="true" tabindex="-1"></a><span class="fu">## log transformation of dose?</span></span>
<span id="cb86-378"><a href="#cb86-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-381"><a href="#cb86-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-382"><a href="#cb86-382" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">=</span> plot2 <span class="sc">+</span> </span>
<span id="cb86-383"><a href="#cb86-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb86-384"><a href="#cb86-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> f.linearlog, <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Log-transform dose"</span>))</span>
<span id="cb86-385"><a href="#cb86-385" aria-hidden="true" tabindex="-1"></a>(plot3 <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="dv">2</span>))) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-386"><a href="#cb86-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-387"><a href="#cb86-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-388"><a href="#cb86-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-389"><a href="#cb86-389" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic regression</span></span>
<span id="cb86-390"><a href="#cb86-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-393"><a href="#cb86-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-394"><a href="#cb86-394" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">=</span> plot3 <span class="sc">+</span> <span class="fu">geom_function</span>(<span class="at">fun =</span> f, <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Logistic regression"</span>))</span>
<span id="cb86-395"><a href="#cb86-395" aria-hidden="true" tabindex="-1"></a>plot4 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-396"><a href="#cb86-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-397"><a href="#cb86-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-398"><a href="#cb86-398" aria-hidden="true" tabindex="-1"></a><span class="fu">## Three parts to regression models</span></span>
<span id="cb86-399"><a href="#cb86-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-400"><a href="#cb86-400" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What distribution does the outcome have for a specific subpopulation</span>
<span id="cb86-401"><a href="#cb86-401" aria-hidden="true" tabindex="-1"></a>    defined by covariates? (outcome model)</span>
<span id="cb86-402"><a href="#cb86-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-403"><a href="#cb86-403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How does the combination of covariates relate to the mean? (link</span>
<span id="cb86-404"><a href="#cb86-404" aria-hidden="true" tabindex="-1"></a>    function)</span>
<span id="cb86-405"><a href="#cb86-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-406"><a href="#cb86-406" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How do the covariates combine? (linear predictor, interactions)</span>
<span id="cb86-407"><a href="#cb86-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-408"><a href="#cb86-408" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic regression in R</span></span>
<span id="cb86-409"><a href="#cb86-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-412"><a href="#cb86-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-413"><a href="#cb86-413" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="ot">=</span> </span>
<span id="cb86-414"><a href="#cb86-414" aria-hidden="true" tabindex="-1"></a>  beetles <span class="sc">|&gt;</span> </span>
<span id="cb86-415"><a href="#cb86-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb86-416"><a href="#cb86-416" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> <span class="fu">cbind</span>(died, survived) <span class="sc">~</span> dose, </span>
<span id="cb86-417"><a href="#cb86-417" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb86-418"><a href="#cb86-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-419"><a href="#cb86-419" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="sc">|&gt;</span> </span>
<span id="cb86-420"><a href="#cb86-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-421"><a href="#cb86-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span>
<span id="cb86-422"><a href="#cb86-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-423"><a href="#cb86-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-424"><a href="#cb86-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-425"><a href="#cb86-425" aria-hidden="true" tabindex="-1"></a>Fitted values:</span>
<span id="cb86-426"><a href="#cb86-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-429"><a href="#cb86-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-430"><a href="#cb86-430" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted.values</span>(beetles_glm_grouped)</span>
<span id="cb86-431"><a href="#cb86-431" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(beetles_glm_grouped, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb86-432"><a href="#cb86-432" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(beetles_glm_grouped, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb86-433"><a href="#cb86-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-434"><a href="#cb86-434" aria-hidden="true" tabindex="-1"></a>fit_y <span class="ot">=</span> beetles<span class="sc">$</span>n <span class="sc">*</span> <span class="fu">fitted.values</span>(beetles_glm_grouped)</span>
<span id="cb86-435"><a href="#cb86-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-436"><a href="#cb86-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-437"><a href="#cb86-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Individual observations</span></span>
<span id="cb86-438"><a href="#cb86-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-441"><a href="#cb86-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-442"><a href="#cb86-442" aria-hidden="true" tabindex="-1"></a>beetles_long <span class="ot">=</span> </span>
<span id="cb86-443"><a href="#cb86-443" aria-hidden="true" tabindex="-1"></a>  beetles  <span class="sc">|&gt;</span> </span>
<span id="cb86-444"><a href="#cb86-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb86-445"><a href="#cb86-445" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">everything</span>(),</span>
<span id="cb86-446"><a href="#cb86-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">c</span>(</span>
<span id="cb86-447"><a href="#cb86-447" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> died), </span>
<span id="cb86-448"><a href="#cb86-448" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> survived))</span>
<span id="cb86-449"><a href="#cb86-449" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-450"><a href="#cb86-450" aria-hidden="true" tabindex="-1"></a>beetles_long <span class="sc">|&gt;</span> <span class="fu">tibble</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-451"><a href="#cb86-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-452"><a href="#cb86-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-453"><a href="#cb86-453" aria-hidden="true" tabindex="-1"></a>Here's the model with individual data</span>
<span id="cb86-454"><a href="#cb86-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-457"><a href="#cb86-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-458"><a href="#cb86-458" aria-hidden="true" tabindex="-1"></a>beetles_glm_ungrouped <span class="ot">=</span> </span>
<span id="cb86-459"><a href="#cb86-459" aria-hidden="true" tabindex="-1"></a>  beetles_long <span class="sc">|&gt;</span> </span>
<span id="cb86-460"><a href="#cb86-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb86-461"><a href="#cb86-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> outcome <span class="sc">~</span> dose, </span>
<span id="cb86-462"><a href="#cb86-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb86-463"><a href="#cb86-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-464"><a href="#cb86-464" aria-hidden="true" tabindex="-1"></a>beetles_glm_ungrouped <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb86-465"><a href="#cb86-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-466"><a href="#cb86-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-467"><a href="#cb86-467" aria-hidden="true" tabindex="-1"></a>Here's the previous version again:</span>
<span id="cb86-468"><a href="#cb86-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-471"><a href="#cb86-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-472"><a href="#cb86-472" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb86-473"><a href="#cb86-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-474"><a href="#cb86-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-475"><a href="#cb86-475" aria-hidden="true" tabindex="-1"></a>They seem the same! But not quite:</span>
<span id="cb86-476"><a href="#cb86-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-479"><a href="#cb86-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-480"><a href="#cb86-480" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(beetles_glm_grouped)</span>
<span id="cb86-481"><a href="#cb86-481" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(beetles_glm_ungrouped)</span>
<span id="cb86-482"><a href="#cb86-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-483"><a href="#cb86-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-484"><a href="#cb86-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-485"><a href="#cb86-485" aria-hidden="true" tabindex="-1"></a>The difference is due to the binomial coefficient</span>
<span id="cb86-486"><a href="#cb86-486" aria-hidden="true" tabindex="-1"></a>$\left(n\atop x \right)$ which isn't included in the</span>
<span id="cb86-487"><a href="#cb86-487" aria-hidden="true" tabindex="-1"></a>individual-observations (Bernoulli) version of the model.</span>
<span id="cb86-488"><a href="#cb86-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-489"><a href="#cb86-489" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple logistic regression</span></span>
<span id="cb86-490"><a href="#cb86-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-491"><a href="#cb86-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coronary heart disease (WCGS) study data</span></span>
<span id="cb86-492"><a href="#cb86-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-493"><a href="#cb86-493" aria-hidden="true" tabindex="-1"></a>Let's use the data from the following study to explore multiple logistic</span>
<span id="cb86-494"><a href="#cb86-494" aria-hidden="true" tabindex="-1"></a>regression:</span>
<span id="cb86-495"><a href="#cb86-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-496"><a href="#cb86-496" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary of study</span></span>
<span id="cb86-497"><a href="#cb86-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-498"><a href="#cb86-498" aria-hidden="true" tabindex="-1"></a>*From Vittinghoff et al 2012:*</span>
<span id="cb86-499"><a href="#cb86-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-500"><a href="#cb86-500" aria-hidden="true" tabindex="-1"></a>"The **Western Collaborative Group Study (WCGS)** was a large</span>
<span id="cb86-501"><a href="#cb86-501" aria-hidden="true" tabindex="-1"></a>epidemiological study designed to investigate the association between</span>
<span id="cb86-502"><a href="#cb86-502" aria-hidden="true" tabindex="-1"></a>the"type A" behavior pattern and coronary heart disease (CHD) (Rosenman</span>
<span id="cb86-503"><a href="#cb86-503" aria-hidden="true" tabindex="-1"></a>et al. 1964)."</span>
<span id="cb86-504"><a href="#cb86-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-505"><a href="#cb86-505" aria-hidden="true" tabindex="-1"></a>*From Wikipedia, "Type A and Type B personality theory":*</span>
<span id="cb86-506"><a href="#cb86-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-507"><a href="#cb86-507" aria-hidden="true" tabindex="-1"></a>"The hypothesis describes Type A individuals as outgoing, ambitious,</span>
<span id="cb86-508"><a href="#cb86-508" aria-hidden="true" tabindex="-1"></a>rigidly organized, highly status-conscious, impatient, anxious,</span>
<span id="cb86-509"><a href="#cb86-509" aria-hidden="true" tabindex="-1"></a>proactive, and concerned with time management....</span>
<span id="cb86-510"><a href="#cb86-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-511"><a href="#cb86-511" aria-hidden="true" tabindex="-1"></a>The hypothesis describes Type B individuals as a contrast to those of</span>
<span id="cb86-512"><a href="#cb86-512" aria-hidden="true" tabindex="-1"></a>Type A. Type B personalities, by definition, are noted to live at lower</span>
<span id="cb86-513"><a href="#cb86-513" aria-hidden="true" tabindex="-1"></a>stress levels. They typically work steadily and may enjoy achievement,</span>
<span id="cb86-514"><a href="#cb86-514" aria-hidden="true" tabindex="-1"></a>although they have a greater tendency to disregard physical or mental</span>
<span id="cb86-515"><a href="#cb86-515" aria-hidden="true" tabindex="-1"></a>stress when they do not achieve."</span>
<span id="cb86-516"><a href="#cb86-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-517"><a href="#cb86-517" aria-hidden="true" tabindex="-1"></a><span class="fu">### Study design</span></span>
<span id="cb86-518"><a href="#cb86-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-519"><a href="#cb86-519" aria-hidden="true" tabindex="-1"></a>*from `?faraway::wcgs`:*</span>
<span id="cb86-520"><a href="#cb86-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-521"><a href="#cb86-521" aria-hidden="true" tabindex="-1"></a>3154 healthy young men aged 39-59 from the San Francisco area were</span>
<span id="cb86-522"><a href="#cb86-522" aria-hidden="true" tabindex="-1"></a>assessed for their personality type. All were free from coronary heart</span>
<span id="cb86-523"><a href="#cb86-523" aria-hidden="true" tabindex="-1"></a>disease at the start of the research. Eight and a half years later</span>
<span id="cb86-524"><a href="#cb86-524" aria-hidden="true" tabindex="-1"></a>change in CHD status was recorded.</span>
<span id="cb86-525"><a href="#cb86-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-526"><a href="#cb86-526" aria-hidden="true" tabindex="-1"></a>*Details (from `faraway::wcgs`)*</span>
<span id="cb86-527"><a href="#cb86-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-528"><a href="#cb86-528" aria-hidden="true" tabindex="-1"></a>The WCGS began in 1960 with 3,524 male volunteers who were employed by</span>
<span id="cb86-529"><a href="#cb86-529" aria-hidden="true" tabindex="-1"></a>11 California companies. Subjects were 39 to 59 years old and free of</span>
<span id="cb86-530"><a href="#cb86-530" aria-hidden="true" tabindex="-1"></a>heart disease as determined by electrocardiogram. After the initial</span>
<span id="cb86-531"><a href="#cb86-531" aria-hidden="true" tabindex="-1"></a>screening, the study population dropped to 3,154 and the number of</span>
<span id="cb86-532"><a href="#cb86-532" aria-hidden="true" tabindex="-1"></a>companies to 10 because of various exclusions. The cohort comprised both</span>
<span id="cb86-533"><a href="#cb86-533" aria-hidden="true" tabindex="-1"></a>blue- and white-collar employees.</span>
<span id="cb86-534"><a href="#cb86-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-535"><a href="#cb86-535" aria-hidden="true" tabindex="-1"></a>At baseline the following information was collected:</span>
<span id="cb86-536"><a href="#cb86-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-537"><a href="#cb86-537" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>socio-demographic including:</span>
<span id="cb86-538"><a href="#cb86-538" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>age</span>
<span id="cb86-539"><a href="#cb86-539" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>education</span>
<span id="cb86-540"><a href="#cb86-540" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>marital status</span>
<span id="cb86-541"><a href="#cb86-541" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>income</span>
<span id="cb86-542"><a href="#cb86-542" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>occupation</span>
<span id="cb86-543"><a href="#cb86-543" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>physical and physiological including:</span>
<span id="cb86-544"><a href="#cb86-544" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>height</span>
<span id="cb86-545"><a href="#cb86-545" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>weight</span>
<span id="cb86-546"><a href="#cb86-546" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>blood pressure</span>
<span id="cb86-547"><a href="#cb86-547" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>electrocardiogram</span>
<span id="cb86-548"><a href="#cb86-548" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>corneal arcus;</span>
<span id="cb86-549"><a href="#cb86-549" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>biochemical including:</span>
<span id="cb86-550"><a href="#cb86-550" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>cholesterol and lipoprotein fractions;</span>
<span id="cb86-551"><a href="#cb86-551" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>medical and family history and use of medications;</span>
<span id="cb86-552"><a href="#cb86-552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>behavioral data including</span>
<span id="cb86-553"><a href="#cb86-553" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Type A interview,</span>
<span id="cb86-554"><a href="#cb86-554" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>smoking,</span>
<span id="cb86-555"><a href="#cb86-555" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exercise</span>
<span id="cb86-556"><a href="#cb86-556" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>alcohol use.</span>
<span id="cb86-557"><a href="#cb86-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-558"><a href="#cb86-558" aria-hidden="true" tabindex="-1"></a>Later surveys added data on: <span class="sc">\*</span> anthropometry <span class="sc">\*</span> triglycerides <span class="sc">\*</span></span>
<span id="cb86-559"><a href="#cb86-559" aria-hidden="true" tabindex="-1"></a>Jenkins Activity Survey <span class="sc">\*</span> caffeine use.</span>
<span id="cb86-560"><a href="#cb86-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-561"><a href="#cb86-561" aria-hidden="true" tabindex="-1"></a>Average follow-up continued for 8.5 years with repeat examinations.</span>
<span id="cb86-562"><a href="#cb86-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-563"><a href="#cb86-563" aria-hidden="true" tabindex="-1"></a>Reference: Coronary Heart Disease in the Western Collaborative Group</span>
<span id="cb86-564"><a href="#cb86-564" aria-hidden="true" tabindex="-1"></a>Study Final Follow-up Experience of 8 1/2 Years Ray H. Rosenman, MD;</span>
<span id="cb86-565"><a href="#cb86-565" aria-hidden="true" tabindex="-1"></a>Richard J. Brand, PhD; C. David Jenkins, PhD; Meyer Friedman, MD; Reuben</span>
<span id="cb86-566"><a href="#cb86-566" aria-hidden="true" tabindex="-1"></a>Straus, MD; Moses Wurm, MD JAMA. 1975;233(8):872-877.</span>
<span id="cb86-567"><a href="#cb86-567" aria-hidden="true" tabindex="-1"></a>doi:10.1001/jama.1975.03260080034016.</span>
<span id="cb86-568"><a href="#cb86-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-569"><a href="#cb86-569" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load the data</span></span>
<span id="cb86-570"><a href="#cb86-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-571"><a href="#cb86-571" aria-hidden="true" tabindex="-1"></a>Here, I load the data:</span>
<span id="cb86-572"><a href="#cb86-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-575"><a href="#cb86-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-576"><a href="#cb86-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb86-577"><a href="#cb86-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-578"><a href="#cb86-578" aria-hidden="true" tabindex="-1"></a><span class="do">## load the data directly from a UCSF website:</span></span>
<span id="cb86-579"><a href="#cb86-579" aria-hidden="true" tabindex="-1"></a><span class="co"># library(haven)</span></span>
<span id="cb86-580"><a href="#cb86-580" aria-hidden="true" tabindex="-1"></a><span class="co"># url = paste0( </span></span>
<span id="cb86-581"><a href="#cb86-581" aria-hidden="true" tabindex="-1"></a><span class="co">#     # I'm breaking up the url into two chunks for readability</span></span>
<span id="cb86-582"><a href="#cb86-582" aria-hidden="true" tabindex="-1"></a><span class="co">#     "https://regression.ucsf.edu/sites/g/files/",</span></span>
<span id="cb86-583"><a href="#cb86-583" aria-hidden="true" tabindex="-1"></a><span class="co">#     "tkssra6706/f/wysiwyg/home/data/wcgs.dta")</span></span>
<span id="cb86-584"><a href="#cb86-584" aria-hidden="true" tabindex="-1"></a><span class="co"># wcgs = haven::read_dta(url)</span></span>
<span id="cb86-585"><a href="#cb86-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-586"><a href="#cb86-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-587"><a href="#cb86-587" aria-hidden="true" tabindex="-1"></a><span class="co"># I presaved the data in my project's `data` folder</span></span>
<span id="cb86-588"><a href="#cb86-588" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># provides the `here()` function</span></span>
<span id="cb86-589"><a href="#cb86-589" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs) <span class="co"># provides the `path()` function</span></span>
<span id="cb86-590"><a href="#cb86-590" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">here</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-591"><a href="#cb86-591" aria-hidden="true" tabindex="-1"></a>  fs<span class="sc">::</span><span class="fu">path</span>(<span class="st">'data/wcgs.rda'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-592"><a href="#cb86-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">load</span>()</span>
<span id="cb86-593"><a href="#cb86-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-594"><a href="#cb86-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-595"><a href="#cb86-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-596"><a href="#cb86-596" aria-hidden="true" tabindex="-1"></a><span class="fu">## Now let's do some data cleaning</span></span>
<span id="cb86-597"><a href="#cb86-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-600"><a href="#cb86-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-601"><a href="#cb86-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb86-602"><a href="#cb86-602" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arsenal) <span class="co"># provides `set_labels()`</span></span>
<span id="cb86-603"><a href="#cb86-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-604"><a href="#cb86-604" aria-hidden="true" tabindex="-1"></a>wcgs <span class="ot">=</span> wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-605"><a href="#cb86-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-606"><a href="#cb86-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> age <span class="sc">|&gt;</span> </span>
<span id="cb86-607"><a href="#cb86-607" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Age (years)"</span>),</span>
<span id="cb86-608"><a href="#cb86-608" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-609"><a href="#cb86-609" aria-hidden="true" tabindex="-1"></a>    <span class="at">arcus =</span> </span>
<span id="cb86-610"><a href="#cb86-610" aria-hidden="true" tabindex="-1"></a>      arcus <span class="sc">|&gt;</span> </span>
<span id="cb86-611"><a href="#cb86-611" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.logical</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-612"><a href="#cb86-612" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Arcus Senilis"</span>),</span>
<span id="cb86-613"><a href="#cb86-613" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-614"><a href="#cb86-614" aria-hidden="true" tabindex="-1"></a>    <span class="at">time169 =</span> </span>
<span id="cb86-615"><a href="#cb86-615" aria-hidden="true" tabindex="-1"></a>      time169 <span class="sc">|&gt;</span> </span>
<span id="cb86-616"><a href="#cb86-616" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-617"><a href="#cb86-617" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Observation (follow up) time (days)"</span>),</span>
<span id="cb86-618"><a href="#cb86-618" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-619"><a href="#cb86-619" aria-hidden="true" tabindex="-1"></a>    <span class="at">dibpat =</span></span>
<span id="cb86-620"><a href="#cb86-620" aria-hidden="true" tabindex="-1"></a>      dibpat <span class="sc">|&gt;</span> </span>
<span id="cb86-621"><a href="#cb86-621" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_factor</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-622"><a href="#cb86-622" aria-hidden="true" tabindex="-1"></a>      <span class="fu">relevel</span>(<span class="at">ref =</span> <span class="st">"Type A"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-623"><a href="#cb86-623" aria-hidden="true" tabindex="-1"></a>      arsenal<span class="sc">::</span><span class="fu">set_labels</span>(<span class="st">"Behavioral Pattern"</span>),</span>
<span id="cb86-624"><a href="#cb86-624" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-625"><a href="#cb86-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">typchd69 =</span> typchd69 <span class="sc">|&gt;</span> </span>
<span id="cb86-626"><a href="#cb86-626" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labelled</span>(</span>
<span id="cb86-627"><a href="#cb86-627" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Type of CHD Event"</span>,</span>
<span id="cb86-628"><a href="#cb86-628" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> </span>
<span id="cb86-629"><a href="#cb86-629" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(</span>
<span id="cb86-630"><a href="#cb86-630" aria-hidden="true" tabindex="-1"></a>            <span class="st">"None"</span> <span class="ot">=</span> <span class="dv">0</span>, </span>
<span id="cb86-631"><a href="#cb86-631" aria-hidden="true" tabindex="-1"></a>            <span class="st">"infdeath"</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb86-632"><a href="#cb86-632" aria-hidden="true" tabindex="-1"></a>            <span class="st">"silent"</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb86-633"><a href="#cb86-633" aria-hidden="true" tabindex="-1"></a>            <span class="st">"angina"</span> <span class="ot">=</span> <span class="dv">3</span>)),</span>
<span id="cb86-634"><a href="#cb86-634" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-635"><a href="#cb86-635" aria-hidden="true" tabindex="-1"></a>    <span class="co"># turn stata-style labelled variables in to R-style factors:</span></span>
<span id="cb86-636"><a href="#cb86-636" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb86-637"><a href="#cb86-637" aria-hidden="true" tabindex="-1"></a>      <span class="fu">where</span>(is.labelled), </span>
<span id="cb86-638"><a href="#cb86-638" aria-hidden="true" tabindex="-1"></a>      haven<span class="sc">::</span>as_factor)</span>
<span id="cb86-639"><a href="#cb86-639" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-640"><a href="#cb86-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-641"><a href="#cb86-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-642"><a href="#cb86-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-643"><a href="#cb86-643" aria-hidden="true" tabindex="-1"></a><span class="fu">## What's in the data {.smaller}</span></span>
<span id="cb86-644"><a href="#cb86-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-645"><a href="#cb86-645" aria-hidden="true" tabindex="-1"></a>Here's a table of the data:</span>
<span id="cb86-646"><a href="#cb86-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-647"><a href="#cb86-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results = "asis"}</span></span>
<span id="cb86-648"><a href="#cb86-648" aria-hidden="true" tabindex="-1"></a>wcgs <span class="sc">|&gt;</span></span>
<span id="cb86-649"><a href="#cb86-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(id, uni, t1)) <span class="sc">|&gt;</span></span>
<span id="cb86-650"><a href="#cb86-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tableby</span>(chd69 <span class="sc">~</span> ., <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb86-651"><a href="#cb86-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb86-652"><a href="#cb86-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">pfootnote =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-653"><a href="#cb86-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span></span>
<span id="cb86-654"><a href="#cb86-654" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Baseline characteristics by CHD status at end of follow-up"</span>)</span>
<span id="cb86-655"><a href="#cb86-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-656"><a href="#cb86-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-657"><a href="#cb86-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-658"><a href="#cb86-658" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data by age and personality type</span></span>
<span id="cb86-659"><a href="#cb86-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-660"><a href="#cb86-660" aria-hidden="true" tabindex="-1"></a>For now, we will look at the interaction between age and personality</span>
<span id="cb86-661"><a href="#cb86-661" aria-hidden="true" tabindex="-1"></a>type (<span class="in">`dibpat`</span>). To make it easier to visualize the data, we summarize</span>
<span id="cb86-662"><a href="#cb86-662" aria-hidden="true" tabindex="-1"></a>the event rates for each combination of age:</span>
<span id="cb86-663"><a href="#cb86-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-666"><a href="#cb86-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-667"><a href="#cb86-667" aria-hidden="true" tabindex="-1"></a>chd_grouped_data <span class="ot">=</span> </span>
<span id="cb86-668"><a href="#cb86-668" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-669"><a href="#cb86-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb86-670"><a href="#cb86-670" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(age, dibpat),</span>
<span id="cb86-671"><a href="#cb86-671" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb86-672"><a href="#cb86-672" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-673"><a href="#cb86-673" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labelled</span>(<span class="at">label =</span> <span class="st">"CHD Event by 1969"</span>),</span>
<span id="cb86-674"><a href="#cb86-674" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">odds(chd)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span>),</span>
<span id="cb86-675"><a href="#cb86-675" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">logit(chd)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">log</span>(<span class="st">`</span><span class="at">odds(chd)</span><span class="st">`</span>)</span>
<span id="cb86-676"><a href="#cb86-676" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-677"><a href="#cb86-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-678"><a href="#cb86-678" aria-hidden="true" tabindex="-1"></a>chd_grouped_data</span>
<span id="cb86-679"><a href="#cb86-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-680"><a href="#cb86-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-681"><a href="#cb86-681" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graphical exploration</span></span>
<span id="cb86-682"><a href="#cb86-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-683"><a href="#cb86-683" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability scale</span></span>
<span id="cb86-684"><a href="#cb86-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-685"><a href="#cb86-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r "graphical exploration"}</span></span>
<span id="cb86-686"><a href="#cb86-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-687"><a href="#cb86-687" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-688"><a href="#cb86-688" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy)</span>
<span id="cb86-689"><a href="#cb86-689" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb86-690"><a href="#cb86-690" aria-hidden="true" tabindex="-1"></a>chd_plot_probs <span class="ot">=</span> </span>
<span id="cb86-691"><a href="#cb86-691" aria-hidden="true" tabindex="-1"></a>  chd_grouped_data <span class="sc">|&gt;</span> </span>
<span id="cb86-692"><a href="#cb86-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb86-693"><a href="#cb86-693" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb86-694"><a href="#cb86-694" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age, </span>
<span id="cb86-695"><a href="#cb86-695" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">p(chd)</span><span class="st">`</span>, </span>
<span id="cb86-696"><a href="#cb86-696" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> dibpat)</span>
<span id="cb86-697"><a href="#cb86-697" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-698"><a href="#cb86-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb86-699"><a href="#cb86-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb86-700"><a href="#cb86-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb86-701"><a href="#cb86-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb86-702"><a href="#cb86-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"P(CHD Event by 1969)"</span>) <span class="sc">+</span></span>
<span id="cb86-703"><a href="#cb86-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb86-704"><a href="#cb86-704" aria-hidden="true" tabindex="-1"></a>  ggeasy<span class="sc">::</span><span class="fu">easy_labs</span>()</span>
<span id="cb86-705"><a href="#cb86-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-706"><a href="#cb86-706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-707"><a href="#cb86-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-708"><a href="#cb86-708" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-711"><a href="#cb86-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-712"><a href="#cb86-712" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_probs)</span>
<span id="cb86-713"><a href="#cb86-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-714"><a href="#cb86-714" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-715"><a href="#cb86-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-716"><a href="#cb86-716" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-719"><a href="#cb86-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-720"><a href="#cb86-720" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chd_plot_probs)</span>
<span id="cb86-721"><a href="#cb86-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-722"><a href="#cb86-722" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-723"><a href="#cb86-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-724"><a href="#cb86-724" aria-hidden="true" tabindex="-1"></a><span class="fu">### Odds scale</span></span>
<span id="cb86-725"><a href="#cb86-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-728"><a href="#cb86-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-729"><a href="#cb86-729" aria-hidden="true" tabindex="-1"></a>chd_plot_odds <span class="ot">=</span> </span>
<span id="cb86-730"><a href="#cb86-730" aria-hidden="true" tabindex="-1"></a>  chd_grouped_data <span class="sc">|&gt;</span> </span>
<span id="cb86-731"><a href="#cb86-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb86-732"><a href="#cb86-732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb86-733"><a href="#cb86-733" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age, </span>
<span id="cb86-734"><a href="#cb86-734" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">odds(chd)</span><span class="st">`</span>, </span>
<span id="cb86-735"><a href="#cb86-735" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> dibpat)</span>
<span id="cb86-736"><a href="#cb86-736" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-737"><a href="#cb86-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb86-738"><a href="#cb86-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb86-739"><a href="#cb86-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb86-740"><a href="#cb86-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb86-741"><a href="#cb86-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"odds(CHD Event by 1969)"</span>) <span class="sc">+</span></span>
<span id="cb86-742"><a href="#cb86-742" aria-hidden="true" tabindex="-1"></a>  ggeasy<span class="sc">::</span><span class="fu">easy_labs</span>()</span>
<span id="cb86-743"><a href="#cb86-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-744"><a href="#cb86-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-745"><a href="#cb86-745" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-748"><a href="#cb86-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-749"><a href="#cb86-749" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_odds)</span>
<span id="cb86-750"><a href="#cb86-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-751"><a href="#cb86-751" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-752"><a href="#cb86-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-753"><a href="#cb86-753" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-756"><a href="#cb86-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-757"><a href="#cb86-757" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chd_plot_odds)</span>
<span id="cb86-758"><a href="#cb86-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-759"><a href="#cb86-759" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-760"><a href="#cb86-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-761"><a href="#cb86-761" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log-odds (logit) scale</span></span>
<span id="cb86-762"><a href="#cb86-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-765"><a href="#cb86-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-766"><a href="#cb86-766" aria-hidden="true" tabindex="-1"></a>chd_plot_logit <span class="ot">=</span> </span>
<span id="cb86-767"><a href="#cb86-767" aria-hidden="true" tabindex="-1"></a>  chd_grouped_data <span class="sc">|&gt;</span> </span>
<span id="cb86-768"><a href="#cb86-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb86-769"><a href="#cb86-769" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb86-770"><a href="#cb86-770" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age, </span>
<span id="cb86-771"><a href="#cb86-771" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">`</span><span class="at">logit(chd)</span><span class="st">`</span>, </span>
<span id="cb86-772"><a href="#cb86-772" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> dibpat)</span>
<span id="cb86-773"><a href="#cb86-773" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-774"><a href="#cb86-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> n), <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb86-775"><a href="#cb86-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb86-776"><a href="#cb86-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb86-777"><a href="#cb86-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb86-778"><a href="#cb86-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"log{odds(CHD Event by 1969)}"</span>) <span class="sc">+</span></span>
<span id="cb86-779"><a href="#cb86-779" aria-hidden="true" tabindex="-1"></a>  ggeasy<span class="sc">::</span><span class="fu">easy_labs</span>()</span>
<span id="cb86-780"><a href="#cb86-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-781"><a href="#cb86-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-782"><a href="#cb86-782" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-785"><a href="#cb86-785" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-786"><a href="#cb86-786" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_logit)</span>
<span id="cb86-787"><a href="#cb86-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-788"><a href="#cb86-788" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-789"><a href="#cb86-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-790"><a href="#cb86-790" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-793"><a href="#cb86-793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-794"><a href="#cb86-794" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chd_plot_logit)</span>
<span id="cb86-795"><a href="#cb86-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-796"><a href="#cb86-796" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-797"><a href="#cb86-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-798"><a href="#cb86-798" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic regression models for CHD data {.smaller}</span></span>
<span id="cb86-799"><a href="#cb86-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-800"><a href="#cb86-800" aria-hidden="true" tabindex="-1"></a>Here, we fit stratified models for CHD by personality type.</span>
<span id="cb86-801"><a href="#cb86-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-804"><a href="#cb86-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-805"><a href="#cb86-805" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb86-806"><a href="#cb86-806" aria-hidden="true" tabindex="-1"></a>  <span class="st">"formula"</span> <span class="ot">=</span> chd69 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> dibpat <span class="sc">+</span> dibpat<span class="sc">:</span>age <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb86-807"><a href="#cb86-807" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span> <span class="ot">=</span> wcgs,</span>
<span id="cb86-808"><a href="#cb86-808" aria-hidden="true" tabindex="-1"></a>  <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb86-809"><a href="#cb86-809" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-810"><a href="#cb86-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-811"><a href="#cb86-811" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb86-812"><a href="#cb86-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-813"><a href="#cb86-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-814"><a href="#cb86-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-815"><a href="#cb86-815" aria-hidden="true" tabindex="-1"></a>We can get the corresponding odds ratios ($e^{\beta}$s) by passing</span>
<span id="cb86-816"><a href="#cb86-816" aria-hidden="true" tabindex="-1"></a><span class="in">`exponentiate = TRUE`</span> to <span class="in">`parameters()`</span>:</span>
<span id="cb86-817"><a href="#cb86-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-820"><a href="#cb86-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-821"><a href="#cb86-821" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="sc">|&gt;</span> </span>
<span id="cb86-822"><a href="#cb86-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-823"><a href="#cb86-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span>
<span id="cb86-824"><a href="#cb86-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-825"><a href="#cb86-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-826"><a href="#cb86-826" aria-hidden="true" tabindex="-1"></a><span class="fu">## Models superimposed on data</span></span>
<span id="cb86-827"><a href="#cb86-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-828"><a href="#cb86-828" aria-hidden="true" tabindex="-1"></a>We can graph our fitted models on each scale (probability, odds,</span>
<span id="cb86-829"><a href="#cb86-829" aria-hidden="true" tabindex="-1"></a>log-odds).</span>
<span id="cb86-830"><a href="#cb86-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-831"><a href="#cb86-831" aria-hidden="true" tabindex="-1"></a><span class="fu">### probability scale</span></span>
<span id="cb86-832"><a href="#cb86-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-835"><a href="#cb86-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-836"><a href="#cb86-836" aria-hidden="true" tabindex="-1"></a>curve_type_A <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb86-837"><a href="#cb86-837" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-838"><a href="#cb86-838" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb86-839"><a href="#cb86-839" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb86-840"><a href="#cb86-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type A"</span>))</span>
<span id="cb86-841"><a href="#cb86-841" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-842"><a href="#cb86-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-843"><a href="#cb86-843" aria-hidden="true" tabindex="-1"></a>curve_type_B <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb86-844"><a href="#cb86-844" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-845"><a href="#cb86-845" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb86-846"><a href="#cb86-846" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"response"</span>,</span>
<span id="cb86-847"><a href="#cb86-847" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type B"</span>))</span>
<span id="cb86-848"><a href="#cb86-848" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-849"><a href="#cb86-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-850"><a href="#cb86-850" aria-hidden="true" tabindex="-1"></a>chd_plot_probs_2 <span class="ot">=</span></span>
<span id="cb86-851"><a href="#cb86-851" aria-hidden="true" tabindex="-1"></a>  chd_plot_probs <span class="sc">+</span></span>
<span id="cb86-852"><a href="#cb86-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb86-853"><a href="#cb86-853" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_A,</span>
<span id="cb86-854"><a href="#cb86-854" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type A"</span>)</span>
<span id="cb86-855"><a href="#cb86-855" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-856"><a href="#cb86-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb86-857"><a href="#cb86-857" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_B,</span>
<span id="cb86-858"><a href="#cb86-858" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type B"</span>)</span>
<span id="cb86-859"><a href="#cb86-859" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-860"><a href="#cb86-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-861"><a href="#cb86-861" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-862"><a href="#cb86-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-863"><a href="#cb86-863" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-866"><a href="#cb86-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-867"><a href="#cb86-867" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_probs_2)</span>
<span id="cb86-868"><a href="#cb86-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-869"><a href="#cb86-869" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-870"><a href="#cb86-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-871"><a href="#cb86-871" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-874"><a href="#cb86-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-875"><a href="#cb86-875" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chd_plot_probs_2)</span>
<span id="cb86-876"><a href="#cb86-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-877"><a href="#cb86-877" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-878"><a href="#cb86-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-879"><a href="#cb86-879" aria-hidden="true" tabindex="-1"></a><span class="fu">### odds scale</span></span>
<span id="cb86-880"><a href="#cb86-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-883"><a href="#cb86-883" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-884"><a href="#cb86-884" aria-hidden="true" tabindex="-1"></a>curve_type_A <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb86-885"><a href="#cb86-885" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-886"><a href="#cb86-886" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb86-887"><a href="#cb86-887" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb86-888"><a href="#cb86-888" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type A"</span>)) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span>
<span id="cb86-889"><a href="#cb86-889" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-890"><a href="#cb86-890" aria-hidden="true" tabindex="-1"></a>curve_type_B <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb86-891"><a href="#cb86-891" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-892"><a href="#cb86-892" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb86-893"><a href="#cb86-893" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb86-894"><a href="#cb86-894" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type B"</span>)) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span>
<span id="cb86-895"><a href="#cb86-895" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-896"><a href="#cb86-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-897"><a href="#cb86-897" aria-hidden="true" tabindex="-1"></a>chd_plot_odds_2 <span class="ot">=</span></span>
<span id="cb86-898"><a href="#cb86-898" aria-hidden="true" tabindex="-1"></a>  chd_plot_odds <span class="sc">+</span></span>
<span id="cb86-899"><a href="#cb86-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb86-900"><a href="#cb86-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_A,</span>
<span id="cb86-901"><a href="#cb86-901" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type A"</span>)</span>
<span id="cb86-902"><a href="#cb86-902" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-903"><a href="#cb86-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb86-904"><a href="#cb86-904" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_B,</span>
<span id="cb86-905"><a href="#cb86-905" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type B"</span>)</span>
<span id="cb86-906"><a href="#cb86-906" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-907"><a href="#cb86-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-908"><a href="#cb86-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-909"><a href="#cb86-909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-910"><a href="#cb86-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-911"><a href="#cb86-911" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-914"><a href="#cb86-914" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-915"><a href="#cb86-915" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_odds_2)</span>
<span id="cb86-916"><a href="#cb86-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-917"><a href="#cb86-917" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-918"><a href="#cb86-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-919"><a href="#cb86-919" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-922"><a href="#cb86-922" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-923"><a href="#cb86-923" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chd_plot_odds_2)</span>
<span id="cb86-924"><a href="#cb86-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-925"><a href="#cb86-925" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-926"><a href="#cb86-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-927"><a href="#cb86-927" aria-hidden="true" tabindex="-1"></a><span class="fu">### log-odds (logit) scale</span></span>
<span id="cb86-928"><a href="#cb86-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-931"><a href="#cb86-931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-932"><a href="#cb86-932" aria-hidden="true" tabindex="-1"></a>curve_type_A <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb86-933"><a href="#cb86-933" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-934"><a href="#cb86-934" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb86-935"><a href="#cb86-935" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb86-936"><a href="#cb86-936" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type A"</span>))</span>
<span id="cb86-937"><a href="#cb86-937" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-938"><a href="#cb86-938" aria-hidden="true" tabindex="-1"></a>curve_type_B <span class="ot">=</span> <span class="cf">function</span>(x) </span>
<span id="cb86-939"><a href="#cb86-939" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-940"><a href="#cb86-940" aria-hidden="true" tabindex="-1"></a>  chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">predict</span>(</span>
<span id="cb86-941"><a href="#cb86-941" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"link"</span>,</span>
<span id="cb86-942"><a href="#cb86-942" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">age =</span> x, <span class="at">dibpat =</span> <span class="st">"Type B"</span>))</span>
<span id="cb86-943"><a href="#cb86-943" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-944"><a href="#cb86-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-945"><a href="#cb86-945" aria-hidden="true" tabindex="-1"></a>chd_plot_logit_2 <span class="ot">=</span></span>
<span id="cb86-946"><a href="#cb86-946" aria-hidden="true" tabindex="-1"></a>  chd_plot_logit <span class="sc">+</span></span>
<span id="cb86-947"><a href="#cb86-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb86-948"><a href="#cb86-948" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_A,</span>
<span id="cb86-949"><a href="#cb86-949" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type A"</span>)</span>
<span id="cb86-950"><a href="#cb86-950" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-951"><a href="#cb86-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb86-952"><a href="#cb86-952" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> curve_type_B,</span>
<span id="cb86-953"><a href="#cb86-953" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> <span class="st">"Type B"</span>)</span>
<span id="cb86-954"><a href="#cb86-954" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-955"><a href="#cb86-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-956"><a href="#cb86-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-957"><a href="#cb86-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-958"><a href="#cb86-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-959"><a href="#cb86-959" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-962"><a href="#cb86-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-963"><a href="#cb86-963" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(chd_plot_logit_2)</span>
<span id="cb86-964"><a href="#cb86-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-965"><a href="#cb86-965" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-966"><a href="#cb86-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-967"><a href="#cb86-967" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-970"><a href="#cb86-970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-971"><a href="#cb86-971" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chd_plot_logit_2)</span>
<span id="cb86-972"><a href="#cb86-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-973"><a href="#cb86-973" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-974"><a href="#cb86-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-975"><a href="#cb86-975" aria-hidden="true" tabindex="-1"></a><span class="fu">## reference-group and contrast parametrization</span></span>
<span id="cb86-976"><a href="#cb86-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-977"><a href="#cb86-977" aria-hidden="true" tabindex="-1"></a>We can also use the corner-point parametrization (with reference groups</span>
<span id="cb86-978"><a href="#cb86-978" aria-hidden="true" tabindex="-1"></a>and contrasts):</span>
<span id="cb86-979"><a href="#cb86-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-982"><a href="#cb86-982" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-983"><a href="#cb86-983" aria-hidden="true" tabindex="-1"></a>chd_glm_contrasts <span class="ot">=</span> </span>
<span id="cb86-984"><a href="#cb86-984" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-985"><a href="#cb86-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb86-986"><a href="#cb86-986" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span> <span class="ot">=</span> _,</span>
<span id="cb86-987"><a href="#cb86-987" aria-hidden="true" tabindex="-1"></a>    <span class="st">"formula"</span> <span class="ot">=</span> chd69 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> dibpat<span class="sc">*</span>age, </span>
<span id="cb86-988"><a href="#cb86-988" aria-hidden="true" tabindex="-1"></a>    <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb86-989"><a href="#cb86-989" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-990"><a href="#cb86-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-991"><a href="#cb86-991" aria-hidden="true" tabindex="-1"></a>chd_glm_contrasts <span class="sc">|&gt;</span> </span>
<span id="cb86-992"><a href="#cb86-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-993"><a href="#cb86-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span>
<span id="cb86-994"><a href="#cb86-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-995"><a href="#cb86-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-996"><a href="#cb86-996" aria-hidden="true" tabindex="-1"></a>Compare with what we had before:</span>
<span id="cb86-997"><a href="#cb86-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1000"><a href="#cb86-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1001"><a href="#cb86-1001" aria-hidden="true" tabindex="-1"></a>chd_glm_strat <span class="sc">|&gt;</span> </span>
<span id="cb86-1002"><a href="#cb86-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-1003"><a href="#cb86-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span>
<span id="cb86-1004"><a href="#cb86-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1005"><a href="#cb86-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1006"><a href="#cb86-1006" aria-hidden="true" tabindex="-1"></a>If I give you model 1, how would you get the coefficients of model 2?</span>
<span id="cb86-1007"><a href="#cb86-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1008"><a href="#cb86-1008" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fitting logistic regression models</span></span>
<span id="cb86-1009"><a href="#cb86-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1010"><a href="#cb86-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb86-1011"><a href="#cb86-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1012"><a href="#cb86-1012" aria-hidden="true" tabindex="-1"></a>In general, the estimating equation $\ell'(\beta; \mathbf x) = 0$ cannot</span>
<span id="cb86-1013"><a href="#cb86-1013" aria-hidden="true" tabindex="-1"></a>be solved analytically.</span>
<span id="cb86-1014"><a href="#cb86-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1015"><a href="#cb86-1015" aria-hidden="true" tabindex="-1"></a>Instead, we have to use a variant of the Newton-Raphson method, which</span>
<span id="cb86-1016"><a href="#cb86-1016" aria-hidden="true" tabindex="-1"></a>was discussed briefly in Epi 203. We won't go over it in this class; if</span>
<span id="cb86-1017"><a href="#cb86-1017" aria-hidden="true" tabindex="-1"></a>you need to learn it, see Chapter 4 of Dobson and Barnett.</span>
<span id="cb86-1018"><a href="#cb86-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1019"><a href="#cb86-1019" aria-hidden="true" tabindex="-1"></a>For now, all you need to know is that we make an iterative series of</span>
<span id="cb86-1020"><a href="#cb86-1020" aria-hidden="true" tabindex="-1"></a>guesses, and each guess helps us make the next guess better (higher</span>
<span id="cb86-1021"><a href="#cb86-1021" aria-hidden="true" tabindex="-1"></a>log-likelihood).</span>
<span id="cb86-1022"><a href="#cb86-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1023"><a href="#cb86-1023" aria-hidden="true" tabindex="-1"></a>You can see some information about this process like so:</span>
<span id="cb86-1024"><a href="#cb86-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1027"><a href="#cb86-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1028"><a href="#cb86-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">8</span>)</span>
<span id="cb86-1029"><a href="#cb86-1029" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">=</span> </span>
<span id="cb86-1030"><a href="#cb86-1030" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-1031"><a href="#cb86-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb86-1032"><a href="#cb86-1032" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glm.control</span>(<span class="at">trace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-1033"><a href="#cb86-1033" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span> <span class="ot">=</span> _,</span>
<span id="cb86-1034"><a href="#cb86-1034" aria-hidden="true" tabindex="-1"></a>    <span class="st">"formula"</span> <span class="ot">=</span> chd69 <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">~</span> dibpat<span class="sc">*</span>age, </span>
<span id="cb86-1035"><a href="#cb86-1035" aria-hidden="true" tabindex="-1"></a>    <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb86-1036"><a href="#cb86-1036" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1037"><a href="#cb86-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1038"><a href="#cb86-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1039"><a href="#cb86-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1040"><a href="#cb86-1040" aria-hidden="true" tabindex="-1"></a>After each iteration of the fitting procedure, the deviance</span>
<span id="cb86-1041"><a href="#cb86-1041" aria-hidden="true" tabindex="-1"></a>($2(\ell_{\text{full}} - \ell(\hat\beta))$ ) is printed. You can see</span>
<span id="cb86-1042"><a href="#cb86-1042" aria-hidden="true" tabindex="-1"></a>that the algorithm took six iterations to converge to a solution where</span>
<span id="cb86-1043"><a href="#cb86-1043" aria-hidden="true" tabindex="-1"></a>the likelihood wasn't changing much anymore.</span>
<span id="cb86-1044"><a href="#cb86-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1045"><a href="#cb86-1045" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model comparisons for logistic models {#sec-gof}</span></span>
<span id="cb86-1046"><a href="#cb86-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1047"><a href="#cb86-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deviance test</span></span>
<span id="cb86-1048"><a href="#cb86-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1049"><a href="#cb86-1049" aria-hidden="true" tabindex="-1"></a>We can compare the maximized log-likelihood of our model,</span>
<span id="cb86-1050"><a href="#cb86-1050" aria-hidden="true" tabindex="-1"></a>$\ell(\hat\beta; \mathbf x)$, versus the log-likelihood of the full</span>
<span id="cb86-1051"><a href="#cb86-1051" aria-hidden="true" tabindex="-1"></a>model (aka saturated model aka maximal model), $\ell_{\text{full}}$,</span>
<span id="cb86-1052"><a href="#cb86-1052" aria-hidden="true" tabindex="-1"></a>which has one parameter per covariate pattern. With enough data,</span>
<span id="cb86-1053"><a href="#cb86-1053" aria-hidden="true" tabindex="-1"></a>$2(\ell_{\text{full}} - \ell(\hat\beta; \mathbf x)) \dot \sim \chi^2(N - p)$,</span>
<span id="cb86-1054"><a href="#cb86-1054" aria-hidden="true" tabindex="-1"></a>where $N$ is the number of distinct covariate patterns and $p$ is the</span>
<span id="cb86-1055"><a href="#cb86-1055" aria-hidden="true" tabindex="-1"></a>number of $\beta$ parameters in our model. A significant p-value for</span>
<span id="cb86-1056"><a href="#cb86-1056" aria-hidden="true" tabindex="-1"></a>this **deviance** statistic indicates that there's some detectable</span>
<span id="cb86-1057"><a href="#cb86-1057" aria-hidden="true" tabindex="-1"></a>pattern in the data that our model isn't flexible enough to catch.</span>
<span id="cb86-1058"><a href="#cb86-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1059"><a href="#cb86-1059" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb86-1060"><a href="#cb86-1060" aria-hidden="true" tabindex="-1"></a>The deviance statistic needs to have a large amount of data **for each</span>
<span id="cb86-1061"><a href="#cb86-1061" aria-hidden="true" tabindex="-1"></a>covariate pattern** for the $\chi^2$ approximation to hold. A guideline</span>
<span id="cb86-1062"><a href="#cb86-1062" aria-hidden="true" tabindex="-1"></a>from Dobson is that if there are $q$ distinct covariate patterns</span>
<span id="cb86-1063"><a href="#cb86-1063" aria-hidden="true" tabindex="-1"></a>$x_1...,x_q$, with $n_1,...,n_q$ observations per pattern, then the</span>
<span id="cb86-1064"><a href="#cb86-1064" aria-hidden="true" tabindex="-1"></a>expected frequencies $n_k \cdot \pi(x_k)$ should be at least 1 for every</span>
<span id="cb86-1065"><a href="#cb86-1065" aria-hidden="true" tabindex="-1"></a>pattern $k\in 1:q$.</span>
<span id="cb86-1066"><a href="#cb86-1066" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1067"><a href="#cb86-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1068"><a href="#cb86-1068" aria-hidden="true" tabindex="-1"></a>If you have covariates measured on a continuous scale, you may not be</span>
<span id="cb86-1069"><a href="#cb86-1069" aria-hidden="true" tabindex="-1"></a>able to use the deviance tests to assess goodness of fit.</span>
<span id="cb86-1070"><a href="#cb86-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1071"><a href="#cb86-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hosmer-Lemeshow test</span></span>
<span id="cb86-1072"><a href="#cb86-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1073"><a href="#cb86-1073" aria-hidden="true" tabindex="-1"></a>If our covariate patterns produce groups that are too small, a</span>
<span id="cb86-1074"><a href="#cb86-1074" aria-hidden="true" tabindex="-1"></a>reasonable solution is to make bigger groups by merging some of the</span>
<span id="cb86-1075"><a href="#cb86-1075" aria-hidden="true" tabindex="-1"></a>covariate-pattern groups together.</span>
<span id="cb86-1076"><a href="#cb86-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1077"><a href="#cb86-1077" aria-hidden="true" tabindex="-1"></a>Hosmer and Lemeshow (1980) proposed that we group the patterns by their</span>
<span id="cb86-1078"><a href="#cb86-1078" aria-hidden="true" tabindex="-1"></a>predicted probabilities according to the model of interest. For example,</span>
<span id="cb86-1079"><a href="#cb86-1079" aria-hidden="true" tabindex="-1"></a>you could group all of the observations with predicted probabilities of</span>
<span id="cb86-1080"><a href="#cb86-1080" aria-hidden="true" tabindex="-1"></a>10% or less together, then group the observations with 11%-20%</span>
<span id="cb86-1081"><a href="#cb86-1081" aria-hidden="true" tabindex="-1"></a>probability together, and so on; $g=10$ categories in all.</span>
<span id="cb86-1082"><a href="#cb86-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1083"><a href="#cb86-1083" aria-hidden="true" tabindex="-1"></a>Then we can construct a statistic</span>
<span id="cb86-1084"><a href="#cb86-1084" aria-hidden="true" tabindex="-1"></a>$$X^2 = \sum_{c=1}^g \frac{(o_c - e_c)^2}{e_c}$$ where $o_c$ is the</span>
<span id="cb86-1085"><a href="#cb86-1085" aria-hidden="true" tabindex="-1"></a>number of events *observed* in group $c$, and $e_c$ is the number of</span>
<span id="cb86-1086"><a href="#cb86-1086" aria-hidden="true" tabindex="-1"></a>events expected in group $c$ (based on the sum of the fitted values</span>
<span id="cb86-1087"><a href="#cb86-1087" aria-hidden="true" tabindex="-1"></a>$\hat\pi_i$ for observations in group $c$).</span>
<span id="cb86-1088"><a href="#cb86-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1089"><a href="#cb86-1089" aria-hidden="true" tabindex="-1"></a>If each group has enough observations in it, you can compare $X^2$ to a</span>
<span id="cb86-1090"><a href="#cb86-1090" aria-hidden="true" tabindex="-1"></a>$\chi^2$ distribution; by simulation, the degrees of freedom has been</span>
<span id="cb86-1091"><a href="#cb86-1091" aria-hidden="true" tabindex="-1"></a>found to be approximately $g-2$.</span>
<span id="cb86-1092"><a href="#cb86-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1093"><a href="#cb86-1093" aria-hidden="true" tabindex="-1"></a>For our CHD model, this procedure would be:</span>
<span id="cb86-1094"><a href="#cb86-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1097"><a href="#cb86-1097" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1098"><a href="#cb86-1098" aria-hidden="true" tabindex="-1"></a>wcgs <span class="ot">=</span> </span>
<span id="cb86-1099"><a href="#cb86-1099" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-1100"><a href="#cb86-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-1101"><a href="#cb86-1101" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_probs_glm1 =</span> chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="cb86-1102"><a href="#cb86-1102" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_prob_cats1 =</span> </span>
<span id="cb86-1103"><a href="#cb86-1103" aria-hidden="true" tabindex="-1"></a>      pred_probs_glm1 <span class="sc">|&gt;</span> </span>
<span id="cb86-1104"><a href="#cb86-1104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cut</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>), </span>
<span id="cb86-1105"><a href="#cb86-1105" aria-hidden="true" tabindex="-1"></a>          <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb86-1106"><a href="#cb86-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1107"><a href="#cb86-1107" aria-hidden="true" tabindex="-1"></a>HL_table <span class="ot">=</span> </span>
<span id="cb86-1108"><a href="#cb86-1108" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-1109"><a href="#cb86-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb86-1110"><a href="#cb86-1110" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> pred_prob_cats1,</span>
<span id="cb86-1111"><a href="#cb86-1111" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb86-1112"><a href="#cb86-1112" aria-hidden="true" tabindex="-1"></a>    <span class="at">o =</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb86-1113"><a href="#cb86-1113" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="fu">sum</span>(pred_probs_glm1)</span>
<span id="cb86-1114"><a href="#cb86-1114" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1115"><a href="#cb86-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1116"><a href="#cb86-1116" aria-hidden="true" tabindex="-1"></a>HL_table <span class="sc">|&gt;</span> <span class="fu">pander</span>()</span>
<span id="cb86-1117"><a href="#cb86-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1118"><a href="#cb86-1118" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">=</span> HL_table <span class="sc">|&gt;</span> </span>
<span id="cb86-1119"><a href="#cb86-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb86-1120"><a href="#cb86-1120" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">X^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>((o<span class="sc">-</span>e)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>e)</span>
<span id="cb86-1121"><a href="#cb86-1121" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb86-1122"><a href="#cb86-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">`</span><span class="at">X^2</span><span class="st">`</span>)</span>
<span id="cb86-1123"><a href="#cb86-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X2)</span>
<span id="cb86-1124"><a href="#cb86-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1125"><a href="#cb86-1125" aria-hidden="true" tabindex="-1"></a>pval1 <span class="ot">=</span> <span class="fu">pchisq</span>(X2, <span class="at">lower =</span> <span class="cn">FALSE</span>, <span class="at">df =</span> <span class="fu">nrow</span>(HL_table) <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb86-1126"><a href="#cb86-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1127"><a href="#cb86-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1128"><a href="#cb86-1128" aria-hidden="true" tabindex="-1"></a>Our statistic is $X^2 = <span class="in">`r X2`</span>$; $p(\chi^2(1) &gt; <span class="in">`r X2`</span>) = <span class="in">`r pval1`</span>$,</span>
<span id="cb86-1129"><a href="#cb86-1129" aria-hidden="true" tabindex="-1"></a>which is our p-value for detecting a lack of goodness of fit.</span>
<span id="cb86-1130"><a href="#cb86-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1131"><a href="#cb86-1131" aria-hidden="true" tabindex="-1"></a>Unfortunately that grouping plan left us with just three categories with</span>
<span id="cb86-1132"><a href="#cb86-1132" aria-hidden="true" tabindex="-1"></a>any observations, so instead of grouping by 10% increments of predicted</span>
<span id="cb86-1133"><a href="#cb86-1133" aria-hidden="true" tabindex="-1"></a>probability, typically analysts use deciles of the predicted</span>
<span id="cb86-1134"><a href="#cb86-1134" aria-hidden="true" tabindex="-1"></a>probabilities:</span>
<span id="cb86-1135"><a href="#cb86-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1138"><a href="#cb86-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1139"><a href="#cb86-1139" aria-hidden="true" tabindex="-1"></a>wcgs <span class="ot">=</span> </span>
<span id="cb86-1140"><a href="#cb86-1140" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-1141"><a href="#cb86-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-1142"><a href="#cb86-1142" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_probs_glm1 =</span> chd_glm_strat <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="cb86-1143"><a href="#cb86-1143" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_prob_cats1 =</span> </span>
<span id="cb86-1144"><a href="#cb86-1144" aria-hidden="true" tabindex="-1"></a>      pred_probs_glm1 <span class="sc">|&gt;</span> </span>
<span id="cb86-1145"><a href="#cb86-1145" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cut</span>(<span class="at">breaks =</span> <span class="fu">quantile</span>(pred_probs_glm1, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)), </span>
<span id="cb86-1146"><a href="#cb86-1146" aria-hidden="true" tabindex="-1"></a>          <span class="at">include.lowest =</span> <span class="cn">TRUE</span>))</span>
<span id="cb86-1147"><a href="#cb86-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1148"><a href="#cb86-1148" aria-hidden="true" tabindex="-1"></a>HL_table <span class="ot">=</span> </span>
<span id="cb86-1149"><a href="#cb86-1149" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-1150"><a href="#cb86-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb86-1151"><a href="#cb86-1151" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> pred_prob_cats1,</span>
<span id="cb86-1152"><a href="#cb86-1152" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb86-1153"><a href="#cb86-1153" aria-hidden="true" tabindex="-1"></a>    <span class="at">o =</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb86-1154"><a href="#cb86-1154" aria-hidden="true" tabindex="-1"></a>    <span class="at">e =</span> <span class="fu">sum</span>(pred_probs_glm1)</span>
<span id="cb86-1155"><a href="#cb86-1155" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1156"><a href="#cb86-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1157"><a href="#cb86-1157" aria-hidden="true" tabindex="-1"></a>HL_table <span class="sc">|&gt;</span> <span class="fu">pander</span>()</span>
<span id="cb86-1158"><a href="#cb86-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1159"><a href="#cb86-1159" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">=</span> HL_table <span class="sc">|&gt;</span> </span>
<span id="cb86-1160"><a href="#cb86-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb86-1161"><a href="#cb86-1161" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">X^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>((o<span class="sc">-</span>e)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>e)</span>
<span id="cb86-1162"><a href="#cb86-1162" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb86-1163"><a href="#cb86-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">`</span><span class="at">X^2</span><span class="st">`</span>)</span>
<span id="cb86-1164"><a href="#cb86-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1165"><a href="#cb86-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X2)</span>
<span id="cb86-1166"><a href="#cb86-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1167"><a href="#cb86-1167" aria-hidden="true" tabindex="-1"></a>pval1 <span class="ot">=</span> <span class="fu">pchisq</span>(X2, <span class="at">lower =</span> <span class="cn">FALSE</span>, <span class="at">df =</span> <span class="fu">nrow</span>(HL_table) <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb86-1168"><a href="#cb86-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1169"><a href="#cb86-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1170"><a href="#cb86-1170" aria-hidden="true" tabindex="-1"></a>Now we have more evenly split categories. The p-value is $<span class="in">`r pval1`</span>$,</span>
<span id="cb86-1171"><a href="#cb86-1171" aria-hidden="true" tabindex="-1"></a>still not significant.</span>
<span id="cb86-1172"><a href="#cb86-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1173"><a href="#cb86-1173" aria-hidden="true" tabindex="-1"></a>Graphically, we have compared:</span>
<span id="cb86-1174"><a href="#cb86-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1177"><a href="#cb86-1177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1178"><a href="#cb86-1178" aria-hidden="true" tabindex="-1"></a>HL_plot <span class="ot">=</span> </span>
<span id="cb86-1179"><a href="#cb86-1179" aria-hidden="true" tabindex="-1"></a>  HL_table <span class="sc">|&gt;</span> </span>
<span id="cb86-1180"><a href="#cb86-1180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pred_prob_cats1)) <span class="sc">+</span> </span>
<span id="cb86-1181"><a href="#cb86-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> e, <span class="at">x =</span> pred_prob_cats1, <span class="at">group =</span> <span class="st">"Expected"</span>, <span class="at">col =</span> <span class="st">"Expected"</span>)) <span class="sc">+</span></span>
<span id="cb86-1182"><a href="#cb86-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> e, <span class="at">size =</span> n, <span class="at">col =</span> <span class="st">"Expected"</span>)) <span class="sc">+</span></span>
<span id="cb86-1183"><a href="#cb86-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> o, <span class="at">size =</span> n, <span class="at">col =</span> <span class="st">"Observed"</span>)) <span class="sc">+</span></span>
<span id="cb86-1184"><a href="#cb86-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> o, <span class="at">col =</span> <span class="st">"Observed"</span>, <span class="at">group =</span> <span class="st">"Observed"</span>)) <span class="sc">+</span></span>
<span id="cb86-1185"><a href="#cb86-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb86-1186"><a href="#cb86-1186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb86-1187"><a href="#cb86-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"number of CHD events"</span>) <span class="sc">+</span></span>
<span id="cb86-1188"><a href="#cb86-1188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>))</span>
<span id="cb86-1189"><a href="#cb86-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1190"><a href="#cb86-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1191"><a href="#cb86-1191" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1194"><a href="#cb86-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1195"><a href="#cb86-1195" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(HL_plot)</span>
<span id="cb86-1196"><a href="#cb86-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1197"><a href="#cb86-1197" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1198"><a href="#cb86-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1199"><a href="#cb86-1199" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1202"><a href="#cb86-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1203"><a href="#cb86-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(HL_plot)</span>
<span id="cb86-1204"><a href="#cb86-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1205"><a href="#cb86-1205" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1206"><a href="#cb86-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1207"><a href="#cb86-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparing models</span></span>
<span id="cb86-1208"><a href="#cb86-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1209"><a href="#cb86-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>AIC = $-2 * \ell(\hat\theta) + 2 * p$ <span class="sc">\[</span>lower is better<span class="sc">\]</span></span>
<span id="cb86-1210"><a href="#cb86-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>BIC = $-2 * \ell(\hat\theta) + p * \text{log}(n)$ <span class="sc">\[</span>lower is</span>
<span id="cb86-1211"><a href="#cb86-1211" aria-hidden="true" tabindex="-1"></a>    better<span class="sc">\]</span></span>
<span id="cb86-1212"><a href="#cb86-1212" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>likelihood ratio <span class="sc">\[</span>higher is better<span class="sc">\]</span></span>
<span id="cb86-1213"><a href="#cb86-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1214"><a href="#cb86-1214" aria-hidden="true" tabindex="-1"></a><span class="fu"># Residual-based diagnostics</span></span>
<span id="cb86-1215"><a href="#cb86-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1216"><a href="#cb86-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Logistic regression residuals only work for grouped data</span></span>
<span id="cb86-1217"><a href="#cb86-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1218"><a href="#cb86-1218" aria-hidden="true" tabindex="-1"></a>Residuals only work if there is more than one observation for most</span>
<span id="cb86-1219"><a href="#cb86-1219" aria-hidden="true" tabindex="-1"></a>covariate patterns.</span>
<span id="cb86-1220"><a href="#cb86-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1221"><a href="#cb86-1221" aria-hidden="true" tabindex="-1"></a>Here we will create the grouped-data version of our CHD model from the</span>
<span id="cb86-1222"><a href="#cb86-1222" aria-hidden="true" tabindex="-1"></a>WCGS study:</span>
<span id="cb86-1223"><a href="#cb86-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1226"><a href="#cb86-1226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1227"><a href="#cb86-1227" aria-hidden="true" tabindex="-1"></a>wcgs_grouped <span class="ot">=</span> </span>
<span id="cb86-1228"><a href="#cb86-1228" aria-hidden="true" tabindex="-1"></a>  wcgs <span class="sc">|&gt;</span> </span>
<span id="cb86-1229"><a href="#cb86-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb86-1230"><a href="#cb86-1230" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(dibpat, age),</span>
<span id="cb86-1231"><a href="#cb86-1231" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb86-1232"><a href="#cb86-1232" aria-hidden="true" tabindex="-1"></a>    <span class="at">chd =</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb86-1233"><a href="#cb86-1233" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">!chd</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(chd69 <span class="sc">==</span> <span class="st">"No"</span>)</span>
<span id="cb86-1234"><a href="#cb86-1234" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1235"><a href="#cb86-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1236"><a href="#cb86-1236" aria-hidden="true" tabindex="-1"></a>chd_glm_strat_grouped <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb86-1237"><a href="#cb86-1237" aria-hidden="true" tabindex="-1"></a>  <span class="st">"formula"</span> <span class="ot">=</span> <span class="fu">cbind</span>(chd, <span class="st">`</span><span class="at">!chd</span><span class="st">`</span>) <span class="sc">~</span> dibpat <span class="sc">+</span> dibpat<span class="sc">:</span>age <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb86-1238"><a href="#cb86-1238" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span> <span class="ot">=</span> wcgs_grouped,</span>
<span id="cb86-1239"><a href="#cb86-1239" aria-hidden="true" tabindex="-1"></a>  <span class="st">"family"</span> <span class="ot">=</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb86-1240"><a href="#cb86-1240" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1241"><a href="#cb86-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1242"><a href="#cb86-1242" aria-hidden="true" tabindex="-1"></a>chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb86-1243"><a href="#cb86-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1244"><a href="#cb86-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1245"><a href="#cb86-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1246"><a href="#cb86-1246" aria-hidden="true" tabindex="-1"></a><span class="fu">## (Response) residuals</span></span>
<span id="cb86-1247"><a href="#cb86-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1248"><a href="#cb86-1248" aria-hidden="true" tabindex="-1"></a>$$e_k \eqdef \bar y_k - \hat{\pi}(x_k)$$</span>
<span id="cb86-1249"><a href="#cb86-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1250"><a href="#cb86-1250" aria-hidden="true" tabindex="-1"></a>($k$ indexes the covariate patterns)</span>
<span id="cb86-1251"><a href="#cb86-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1252"><a href="#cb86-1252" aria-hidden="true" tabindex="-1"></a>We can graph these residuals $e_k$ against the fitted values</span>
<span id="cb86-1253"><a href="#cb86-1253" aria-hidden="true" tabindex="-1"></a>$\hat\pi(x_k)$:</span>
<span id="cb86-1254"><a href="#cb86-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1257"><a href="#cb86-1257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1258"><a href="#cb86-1258" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb86-1259"><a href="#cb86-1259" aria-hidden="true" tabindex="-1"></a>wcgs_grouped <span class="ot">=</span> </span>
<span id="cb86-1260"><a href="#cb86-1260" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="cb86-1261"><a href="#cb86-1261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-1262"><a href="#cb86-1262" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted =</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="cb86-1263"><a href="#cb86-1263" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_logit =</span> fitted <span class="sc">|&gt;</span> <span class="fu">logit</span>(),</span>
<span id="cb86-1264"><a href="#cb86-1264" aria-hidden="true" tabindex="-1"></a>    <span class="at">response_resids =</span> </span>
<span id="cb86-1265"><a href="#cb86-1265" aria-hidden="true" tabindex="-1"></a>      chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">resid</span>(<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb86-1266"><a href="#cb86-1266" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1267"><a href="#cb86-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1268"><a href="#cb86-1268" aria-hidden="true" tabindex="-1"></a>wcgs_response_resid_plot <span class="ot">=</span> </span>
<span id="cb86-1269"><a href="#cb86-1269" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="cb86-1270"><a href="#cb86-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb86-1271"><a href="#cb86-1271" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb86-1272"><a href="#cb86-1272" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fitted,</span>
<span id="cb86-1273"><a href="#cb86-1273" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> response_resids</span>
<span id="cb86-1274"><a href="#cb86-1274" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-1275"><a href="#cb86-1275" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb86-1276"><a href="#cb86-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb86-1277"><a href="#cb86-1277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> dibpat)</span>
<span id="cb86-1278"><a href="#cb86-1278" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1279"><a href="#cb86-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb86-1280"><a href="#cb86-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>( <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1281"><a href="#cb86-1281" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">TRUE</span>,  <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1282"><a href="#cb86-1282" aria-hidden="true" tabindex="-1"></a>    <span class="at">method.args =</span> <span class="fu">list</span>( <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1283"><a href="#cb86-1283" aria-hidden="true" tabindex="-1"></a>      <span class="at">span=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1284"><a href="#cb86-1284" aria-hidden="true" tabindex="-1"></a>      <span class="at">degree=</span><span class="dv">1</span>, <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1285"><a href="#cb86-1285" aria-hidden="true" tabindex="-1"></a>      <span class="at">family=</span><span class="st">"symmetric"</span>, <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1286"><a href="#cb86-1286" aria-hidden="true" tabindex="-1"></a>      <span class="at">iterations=</span><span class="dv">3</span>), <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1287"><a href="#cb86-1287" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> stats<span class="sc">::</span>loess) <span class="co">#&lt;1&gt;</span></span>
<span id="cb86-1288"><a href="#cb86-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1289"><a href="#cb86-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1290"><a href="#cb86-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1291"><a href="#cb86-1291" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Don't worry about these options for now; I chose them to match</span>
<span id="cb86-1292"><a href="#cb86-1292" aria-hidden="true" tabindex="-1"></a>    <span class="in">`autoplot()`</span> as closely as I can. <span class="in">`plot.glm`</span> and <span class="in">`autoplot`</span> use</span>
<span id="cb86-1293"><a href="#cb86-1293" aria-hidden="true" tabindex="-1"></a>    <span class="in">`stats::lowess`</span> instead of <span class="in">`stats::loess`</span>; <span class="in">`stats::lowess`</span> is older,</span>
<span id="cb86-1294"><a href="#cb86-1294" aria-hidden="true" tabindex="-1"></a>    hard to use with <span class="in">`geom_smooth`</span>, and hard to match exactly with</span>
<span id="cb86-1295"><a href="#cb86-1295" aria-hidden="true" tabindex="-1"></a>    <span class="in">`stats::loess`</span>; see https://support.bioconductor.org/p/2323/.<span class="sc">\]</span></span>
<span id="cb86-1296"><a href="#cb86-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1297"><a href="#cb86-1297" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1300"><a href="#cb86-1300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1301"><a href="#cb86-1301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1302"><a href="#cb86-1302" aria-hidden="true" tabindex="-1"></a>wcgs_response_resid_plot <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1303"><a href="#cb86-1303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1304"><a href="#cb86-1304" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1305"><a href="#cb86-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1306"><a href="#cb86-1306" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1309"><a href="#cb86-1309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1310"><a href="#cb86-1310" aria-hidden="true" tabindex="-1"></a>wcgs_response_resid_plot <span class="sc">|&gt;</span> <span class="fu">ggplotly</span>()</span>
<span id="cb86-1311"><a href="#cb86-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1312"><a href="#cb86-1312" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1313"><a href="#cb86-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1314"><a href="#cb86-1314" aria-hidden="true" tabindex="-1"></a>We can see a slight fan-shape here: observations on the right have</span>
<span id="cb86-1315"><a href="#cb86-1315" aria-hidden="true" tabindex="-1"></a>larger variance (as expected since $var(\bar y) = \pi(1-\pi)/n$ is</span>
<span id="cb86-1316"><a href="#cb86-1316" aria-hidden="true" tabindex="-1"></a>maximized when $\pi = 0.5$).</span>
<span id="cb86-1317"><a href="#cb86-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1318"><a href="#cb86-1318" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pearson residuals</span></span>
<span id="cb86-1319"><a href="#cb86-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1320"><a href="#cb86-1320" aria-hidden="true" tabindex="-1"></a>The fan-shape in the response residuals plot isn't necessarily a concern</span>
<span id="cb86-1321"><a href="#cb86-1321" aria-hidden="true" tabindex="-1"></a>here, since we haven't made an assumption of constant residual variance,</span>
<span id="cb86-1322"><a href="#cb86-1322" aria-hidden="true" tabindex="-1"></a>as we did for linear regression.</span>
<span id="cb86-1323"><a href="#cb86-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1324"><a href="#cb86-1324" aria-hidden="true" tabindex="-1"></a>However, we might want to divide by the standard error in order to make</span>
<span id="cb86-1325"><a href="#cb86-1325" aria-hidden="true" tabindex="-1"></a>the graph easier to interpret. Here's one way to do that:</span>
<span id="cb86-1326"><a href="#cb86-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1327"><a href="#cb86-1327" aria-hidden="true" tabindex="-1"></a>The Pearson (chi-squared) residual for covariate pattern $k$ is: $$</span>
<span id="cb86-1328"><a href="#cb86-1328" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb86-1329"><a href="#cb86-1329" aria-hidden="true" tabindex="-1"></a>X_k &amp;= \frac{\bar y_k - \hat\pi_k}{\sqrt{\hat \pi_k (1-\hat\pi_k)/n_k}}</span>
<span id="cb86-1330"><a href="#cb86-1330" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb86-1331"><a href="#cb86-1331" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-1332"><a href="#cb86-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1333"><a href="#cb86-1333" aria-hidden="true" tabindex="-1"></a>where $$</span>
<span id="cb86-1334"><a href="#cb86-1334" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb86-1335"><a href="#cb86-1335" aria-hidden="true" tabindex="-1"></a>\hat\pi_k </span>
<span id="cb86-1336"><a href="#cb86-1336" aria-hidden="true" tabindex="-1"></a>&amp;\eqdef \hat\pi(x_k)<span class="sc">\\</span></span>
<span id="cb86-1337"><a href="#cb86-1337" aria-hidden="true" tabindex="-1"></a>&amp;\eqdef \hat P(Y=1|X=x_k)<span class="sc">\\</span> </span>
<span id="cb86-1338"><a href="#cb86-1338" aria-hidden="true" tabindex="-1"></a>&amp;\eqdef \text{expit}(x_i'\hat \beta)<span class="sc">\\</span></span>
<span id="cb86-1339"><a href="#cb86-1339" aria-hidden="true" tabindex="-1"></a>&amp;\eqdef \text{expit}(\hat \beta_0 + \sum_{j=1}^p \hat \beta_j x_{ij})</span>
<span id="cb86-1340"><a href="#cb86-1340" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb86-1341"><a href="#cb86-1341" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb86-1342"><a href="#cb86-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1343"><a href="#cb86-1343" aria-hidden="true" tabindex="-1"></a>Let's take a look at the Pearson residuals for our CHD model from the</span>
<span id="cb86-1344"><a href="#cb86-1344" aria-hidden="true" tabindex="-1"></a>WCGS data (graphed against the fitted values on the logit scale):</span>
<span id="cb86-1345"><a href="#cb86-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1348"><a href="#cb86-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1349"><a href="#cb86-1349" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb86-1350"><a href="#cb86-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1351"><a href="#cb86-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1352"><a href="#cb86-1352" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1355"><a href="#cb86-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1356"><a href="#cb86-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1357"><a href="#cb86-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(chd_glm_strat_grouped, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1358"><a href="#cb86-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1359"><a href="#cb86-1359" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1360"><a href="#cb86-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1361"><a href="#cb86-1361" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1364"><a href="#cb86-1364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1365"><a href="#cb86-1365" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(chd_glm_strat_grouped, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1366"><a href="#cb86-1366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1367"><a href="#cb86-1367" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1368"><a href="#cb86-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1369"><a href="#cb86-1369" aria-hidden="true" tabindex="-1"></a>The fan-shape is gone, and these residuals don't show any obvious signs</span>
<span id="cb86-1370"><a href="#cb86-1370" aria-hidden="true" tabindex="-1"></a>of model fit issues.</span>
<span id="cb86-1371"><a href="#cb86-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1372"><a href="#cb86-1372" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pearson residuals plot for `beetles` data</span></span>
<span id="cb86-1373"><a href="#cb86-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1374"><a href="#cb86-1374" aria-hidden="true" tabindex="-1"></a>If we create the same plot for the <span class="in">`beetles`</span> model, we see some strong</span>
<span id="cb86-1375"><a href="#cb86-1375" aria-hidden="true" tabindex="-1"></a>evidence of a lack of fit:</span>
<span id="cb86-1376"><a href="#cb86-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1377"><a href="#cb86-1377" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1380"><a href="#cb86-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1381"><a href="#cb86-1381" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(beetles_glm_grouped, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1382"><a href="#cb86-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1383"><a href="#cb86-1383" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1384"><a href="#cb86-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1385"><a href="#cb86-1385" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1388"><a href="#cb86-1388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1389"><a href="#cb86-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1390"><a href="#cb86-1390" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(beetles_glm_grouped, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1391"><a href="#cb86-1391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1392"><a href="#cb86-1392" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1393"><a href="#cb86-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1394"><a href="#cb86-1394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pearson residuals with individual (ungrouped) data</span></span>
<span id="cb86-1395"><a href="#cb86-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1396"><a href="#cb86-1396" aria-hidden="true" tabindex="-1"></a>What happens if we try to compute residuals without grouping the data by</span>
<span id="cb86-1397"><a href="#cb86-1397" aria-hidden="true" tabindex="-1"></a>covariate pattern?</span>
<span id="cb86-1398"><a href="#cb86-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1401"><a href="#cb86-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1402"><a href="#cb86-1402" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb86-1403"><a href="#cb86-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1404"><a href="#cb86-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1405"><a href="#cb86-1405" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1408"><a href="#cb86-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1409"><a href="#cb86-1409" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(chd_glm_strat, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1410"><a href="#cb86-1410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1411"><a href="#cb86-1411" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1412"><a href="#cb86-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1413"><a href="#cb86-1413" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1416"><a href="#cb86-1416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1417"><a href="#cb86-1417" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1418"><a href="#cb86-1418" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(chd_glm_strat, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1419"><a href="#cb86-1419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1420"><a href="#cb86-1420" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1421"><a href="#cb86-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1422"><a href="#cb86-1422" aria-hidden="true" tabindex="-1"></a>Meaningless.</span>
<span id="cb86-1423"><a href="#cb86-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1424"><a href="#cb86-1424" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residuals plot by hand (*optional section*)</span></span>
<span id="cb86-1425"><a href="#cb86-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1426"><a href="#cb86-1426" aria-hidden="true" tabindex="-1"></a>If you want to check your understanding of what these residual plots</span>
<span id="cb86-1427"><a href="#cb86-1427" aria-hidden="true" tabindex="-1"></a>are, try building them yourself:</span>
<span id="cb86-1428"><a href="#cb86-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1431"><a href="#cb86-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1432"><a href="#cb86-1432" aria-hidden="true" tabindex="-1"></a>wcgs_grouped <span class="ot">=</span> </span>
<span id="cb86-1433"><a href="#cb86-1433" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="cb86-1434"><a href="#cb86-1434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-1435"><a href="#cb86-1435" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted =</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">fitted</span>(),</span>
<span id="cb86-1436"><a href="#cb86-1436" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_logit =</span> fitted <span class="sc">|&gt;</span> <span class="fu">logit</span>(),</span>
<span id="cb86-1437"><a href="#cb86-1437" aria-hidden="true" tabindex="-1"></a>    <span class="at">resids =</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">resid</span>(<span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb86-1438"><a href="#cb86-1438" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1439"><a href="#cb86-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1440"><a href="#cb86-1440" aria-hidden="true" tabindex="-1"></a>wcgs_resid_plot1 <span class="ot">=</span> </span>
<span id="cb86-1441"><a href="#cb86-1441" aria-hidden="true" tabindex="-1"></a>  wcgs_grouped <span class="sc">|&gt;</span> </span>
<span id="cb86-1442"><a href="#cb86-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb86-1443"><a href="#cb86-1443" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb86-1444"><a href="#cb86-1444" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> fitted_logit,</span>
<span id="cb86-1445"><a href="#cb86-1445" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> resids</span>
<span id="cb86-1446"><a href="#cb86-1446" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb86-1447"><a href="#cb86-1447" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb86-1448"><a href="#cb86-1448" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-1449"><a href="#cb86-1449" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb86-1450"><a href="#cb86-1450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb86-1451"><a href="#cb86-1451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">col =</span> dibpat)</span>
<span id="cb86-1452"><a href="#cb86-1452" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1453"><a href="#cb86-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb86-1454"><a href="#cb86-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb86-1455"><a href="#cb86-1455" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(</span>
<span id="cb86-1456"><a href="#cb86-1456" aria-hidden="true" tabindex="-1"></a>                <span class="at">span=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb86-1457"><a href="#cb86-1457" aria-hidden="true" tabindex="-1"></a>                <span class="at">degree=</span><span class="dv">1</span>,</span>
<span id="cb86-1458"><a href="#cb86-1458" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">"symmetric"</span>,</span>
<span id="cb86-1459"><a href="#cb86-1459" aria-hidden="true" tabindex="-1"></a>                <span class="at">iterations=</span><span class="dv">3</span>,</span>
<span id="cb86-1460"><a href="#cb86-1460" aria-hidden="true" tabindex="-1"></a>                <span class="at">surface=</span><span class="st">"direct"</span></span>
<span id="cb86-1461"><a href="#cb86-1461" aria-hidden="true" tabindex="-1"></a>                <span class="co"># span = 2/3, </span></span>
<span id="cb86-1462"><a href="#cb86-1462" aria-hidden="true" tabindex="-1"></a>                <span class="co"># iterations = 3</span></span>
<span id="cb86-1463"><a href="#cb86-1463" aria-hidden="true" tabindex="-1"></a>              ),</span>
<span id="cb86-1464"><a href="#cb86-1464" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> stats<span class="sc">::</span>loess)</span>
<span id="cb86-1465"><a href="#cb86-1465" aria-hidden="true" tabindex="-1"></a><span class="co"># plot.glm and autoplot use stats::lowess, which is hard to use with </span></span>
<span id="cb86-1466"><a href="#cb86-1466" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_smooth and hard to match exactly; </span></span>
<span id="cb86-1467"><a href="#cb86-1467" aria-hidden="true" tabindex="-1"></a><span class="co"># see https://support.bioconductor.org/p/2323/</span></span>
<span id="cb86-1468"><a href="#cb86-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1469"><a href="#cb86-1469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1470"><a href="#cb86-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1471"><a href="#cb86-1471" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1474"><a href="#cb86-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1475"><a href="#cb86-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1476"><a href="#cb86-1476" aria-hidden="true" tabindex="-1"></a>wcgs_resid_plot1 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1477"><a href="#cb86-1477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1478"><a href="#cb86-1478" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1479"><a href="#cb86-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1480"><a href="#cb86-1480" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1483"><a href="#cb86-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1484"><a href="#cb86-1484" aria-hidden="true" tabindex="-1"></a>wcgs_resid_plot1 <span class="sc">|&gt;</span> <span class="fu">ggplotly</span>()</span>
<span id="cb86-1485"><a href="#cb86-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1486"><a href="#cb86-1486" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1487"><a href="#cb86-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1488"><a href="#cb86-1488" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pearson chi-squared goodness of fit test</span></span>
<span id="cb86-1489"><a href="#cb86-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1490"><a href="#cb86-1490" aria-hidden="true" tabindex="-1"></a>The Pearson chi-squared goodness of fit statistic is: $$</span>
<span id="cb86-1491"><a href="#cb86-1491" aria-hidden="true" tabindex="-1"></a>X^2 = \sum_{k=1}^m X_k^2 </span>
<span id="cb86-1492"><a href="#cb86-1492" aria-hidden="true" tabindex="-1"></a>$$ Under the null hypothesis that the model in question is correct</span>
<span id="cb86-1493"><a href="#cb86-1493" aria-hidden="true" tabindex="-1"></a>(i.e., sufficiently complex), $X^2\ \dot \sim\ \chi^2(N-p)$.</span>
<span id="cb86-1494"><a href="#cb86-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1497"><a href="#cb86-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1498"><a href="#cb86-1498" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> chd_glm_strat_grouped <span class="sc">|&gt;</span> </span>
<span id="cb86-1499"><a href="#cb86-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resid</span>(<span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb86-1500"><a href="#cb86-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1501"><a href="#cb86-1501" aria-hidden="true" tabindex="-1"></a>chisq_stat <span class="ot">=</span> <span class="fu">sum</span>(X<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-1502"><a href="#cb86-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1503"><a href="#cb86-1503" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">=</span> <span class="fu">pchisq</span>(</span>
<span id="cb86-1504"><a href="#cb86-1504" aria-hidden="true" tabindex="-1"></a>  chisq_stat, </span>
<span id="cb86-1505"><a href="#cb86-1505" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="cn">FALSE</span>, </span>
<span id="cb86-1506"><a href="#cb86-1506" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">length</span>(X) <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">coef</span>(chd_glm_strat_grouped)))</span>
<span id="cb86-1507"><a href="#cb86-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1508"><a href="#cb86-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1509"><a href="#cb86-1509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1510"><a href="#cb86-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1511"><a href="#cb86-1511" aria-hidden="true" tabindex="-1"></a>For our CHD model, the p-value for this test is <span class="in">`r pval`</span>; no significant</span>
<span id="cb86-1512"><a href="#cb86-1512" aria-hidden="true" tabindex="-1"></a>evidence of a lack of fit at the 0.05 level.</span>
<span id="cb86-1513"><a href="#cb86-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1514"><a href="#cb86-1514" aria-hidden="true" tabindex="-1"></a><span class="fu">### Standardized Pearson residuals</span></span>
<span id="cb86-1515"><a href="#cb86-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1516"><a href="#cb86-1516" aria-hidden="true" tabindex="-1"></a>Especially for small data sets, we might want to adjust our residuals</span>
<span id="cb86-1517"><a href="#cb86-1517" aria-hidden="true" tabindex="-1"></a>for leverage (since outliers in $X$ add extra variance to the</span>
<span id="cb86-1518"><a href="#cb86-1518" aria-hidden="true" tabindex="-1"></a>residuals):</span>
<span id="cb86-1519"><a href="#cb86-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1520"><a href="#cb86-1520" aria-hidden="true" tabindex="-1"></a>$$r_{P_k} = \frac{X_k}{\sqrt{1-h_k}}$$</span>
<span id="cb86-1521"><a href="#cb86-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1522"><a href="#cb86-1522" aria-hidden="true" tabindex="-1"></a>where $h_k$ is the leverage of $X_k$. The functions <span class="in">`autoplot()`</span> and</span>
<span id="cb86-1523"><a href="#cb86-1523" aria-hidden="true" tabindex="-1"></a><span class="in">`plot.lm()`</span> use these for some of their graphs.</span>
<span id="cb86-1524"><a href="#cb86-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1525"><a href="#cb86-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deviance residuals</span></span>
<span id="cb86-1526"><a href="#cb86-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1527"><a href="#cb86-1527" aria-hidden="true" tabindex="-1"></a>For large sample sizes, the Pearson and deviance residuals will be</span>
<span id="cb86-1528"><a href="#cb86-1528" aria-hidden="true" tabindex="-1"></a>approximately the same. For small sample sizes, the deviance residuals</span>
<span id="cb86-1529"><a href="#cb86-1529" aria-hidden="true" tabindex="-1"></a>from covariate patterns with small sample sizes can be unreliable (high</span>
<span id="cb86-1530"><a href="#cb86-1530" aria-hidden="true" tabindex="-1"></a>variance).</span>
<span id="cb86-1531"><a href="#cb86-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1532"><a href="#cb86-1532" aria-hidden="true" tabindex="-1"></a>$$d_k = \text{sign}(y_k - n_k \hat \pi_k)\left<span class="sc">\{</span>\sqrt{2<span class="co">[</span><span class="ot">\ell_{\text{full}}(x_k) - \ell(\hat\beta; x_k)</span><span class="co">]</span>}\right<span class="sc">\}</span>$$</span>
<span id="cb86-1533"><a href="#cb86-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1534"><a href="#cb86-1534" aria-hidden="true" tabindex="-1"></a><span class="fu">### Standardized deviance residuals</span></span>
<span id="cb86-1535"><a href="#cb86-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1536"><a href="#cb86-1536" aria-hidden="true" tabindex="-1"></a>$$r_{D_k} = \frac{d_k}{\sqrt{1-h_k}}$$</span>
<span id="cb86-1537"><a href="#cb86-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1538"><a href="#cb86-1538" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnostic plots</span></span>
<span id="cb86-1539"><a href="#cb86-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1540"><a href="#cb86-1540" aria-hidden="true" tabindex="-1"></a>Let's take a look at the full set of <span class="in">`autoplot()`</span> diagnostics now for</span>
<span id="cb86-1541"><a href="#cb86-1541" aria-hidden="true" tabindex="-1"></a>our <span class="in">`CHD`</span> model:</span>
<span id="cb86-1542"><a href="#cb86-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1543"><a href="#cb86-1543" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1546"><a href="#cb86-1546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1547"><a href="#cb86-1547" aria-hidden="true" tabindex="-1"></a>chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(<span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1548"><a href="#cb86-1548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1549"><a href="#cb86-1549" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1550"><a href="#cb86-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1551"><a href="#cb86-1551" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1554"><a href="#cb86-1554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1555"><a href="#cb86-1555" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1556"><a href="#cb86-1556" aria-hidden="true" tabindex="-1"></a>chd_glm_strat_grouped <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(<span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1557"><a href="#cb86-1557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1558"><a href="#cb86-1558" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1559"><a href="#cb86-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1560"><a href="#cb86-1560" aria-hidden="true" tabindex="-1"></a>Things look pretty good here. The QQ plot is still usable; with large</span>
<span id="cb86-1561"><a href="#cb86-1561" aria-hidden="true" tabindex="-1"></a>samples; the residuals should be approximately Gaussian.</span>
<span id="cb86-1562"><a href="#cb86-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1563"><a href="#cb86-1563" aria-hidden="true" tabindex="-1"></a><span class="fu">### Beetles</span></span>
<span id="cb86-1564"><a href="#cb86-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1565"><a href="#cb86-1565" aria-hidden="true" tabindex="-1"></a>Let's look at the beetles model diagnostic plots for comparison:</span>
<span id="cb86-1566"><a href="#cb86-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1567"><a href="#cb86-1567" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb86-1570"><a href="#cb86-1570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1571"><a href="#cb86-1571" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(<span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1572"><a href="#cb86-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1573"><a href="#cb86-1573" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1574"><a href="#cb86-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1575"><a href="#cb86-1575" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb86-1578"><a href="#cb86-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1579"><a href="#cb86-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1580"><a href="#cb86-1580" aria-hidden="true" tabindex="-1"></a>beetles_glm_grouped <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(<span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb86-1581"><a href="#cb86-1581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1582"><a href="#cb86-1582" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1583"><a href="#cb86-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1584"><a href="#cb86-1584" aria-hidden="true" tabindex="-1"></a>Hard to tell much from so little data, but there might be some issues</span>
<span id="cb86-1585"><a href="#cb86-1585" aria-hidden="true" tabindex="-1"></a>here.</span>
<span id="cb86-1586"><a href="#cb86-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1587"><a href="#cb86-1587" aria-hidden="true" tabindex="-1"></a><span class="fu"># Odds Ratios vs Probability (Risk) Ratios {#sec-OR-RR}</span></span>
<span id="cb86-1588"><a href="#cb86-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1589"><a href="#cb86-1589" aria-hidden="true" tabindex="-1"></a>::: {#def-rr}</span>
<span id="cb86-1590"><a href="#cb86-1590" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relative risk</span></span>
<span id="cb86-1591"><a href="#cb86-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1592"><a href="#cb86-1592" aria-hidden="true" tabindex="-1"></a>The **relative risk** comparing two probabilities $\pi_1$ and $\pi_2$,</span>
<span id="cb86-1593"><a href="#cb86-1593" aria-hidden="true" tabindex="-1"></a>also known as the **risk ratio**, **relative risk ratio**, **probability</span>
<span id="cb86-1594"><a href="#cb86-1594" aria-hidden="true" tabindex="-1"></a>ratio**, and **rate ratio**, is:</span>
<span id="cb86-1595"><a href="#cb86-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1596"><a href="#cb86-1596" aria-hidden="true" tabindex="-1"></a>$$\rho(1,2) \eqdef \frac{\pi_1}{\pi_2}$$</span>
<span id="cb86-1597"><a href="#cb86-1597" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1598"><a href="#cb86-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1599"><a href="#cb86-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb86-1600"><a href="#cb86-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1601"><a href="#cb86-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">### Case 1: rare events</span></span>
<span id="cb86-1602"><a href="#cb86-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1603"><a href="#cb86-1603" aria-hidden="true" tabindex="-1"></a>For rare events, odds ratios and probability (a.k.a. risk, a.k.a.</span>
<span id="cb86-1604"><a href="#cb86-1604" aria-hidden="true" tabindex="-1"></a>prevalence) ratios will be close:</span>
<span id="cb86-1605"><a href="#cb86-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1606"><a href="#cb86-1606" aria-hidden="true" tabindex="-1"></a>$\pi_1 = .01$ $\pi_2 = .02$</span>
<span id="cb86-1607"><a href="#cb86-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1608"><a href="#cb86-1608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r "rare events or-rr"}</span></span>
<span id="cb86-1609"><a href="#cb86-1609" aria-hidden="true" tabindex="-1"></a>pi1 <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb86-1610"><a href="#cb86-1610" aria-hidden="true" tabindex="-1"></a>pi2 <span class="ot">=</span> .<span class="dv">02</span></span>
<span id="cb86-1611"><a href="#cb86-1611" aria-hidden="true" tabindex="-1"></a>pi2<span class="sc">/</span>pi1</span>
<span id="cb86-1612"><a href="#cb86-1612" aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(pi2)<span class="sc">/</span><span class="fu">odds</span>(pi1)</span>
<span id="cb86-1613"><a href="#cb86-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1614"><a href="#cb86-1614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1615"><a href="#cb86-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1616"><a href="#cb86-1616" aria-hidden="true" tabindex="-1"></a><span class="fu">### Case 2: frequent events</span></span>
<span id="cb86-1617"><a href="#cb86-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1618"><a href="#cb86-1618" aria-hidden="true" tabindex="-1"></a>$\pi_1 = .4$ $\pi_2 = .5$</span>
<span id="cb86-1619"><a href="#cb86-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1620"><a href="#cb86-1620" aria-hidden="true" tabindex="-1"></a>For more frequently-occurring outcomes, this won't be the case:</span>
<span id="cb86-1621"><a href="#cb86-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1624"><a href="#cb86-1624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1625"><a href="#cb86-1625" aria-hidden="true" tabindex="-1"></a>pi1 <span class="ot">=</span> .<span class="dv">4</span></span>
<span id="cb86-1626"><a href="#cb86-1626" aria-hidden="true" tabindex="-1"></a>pi2 <span class="ot">=</span> .<span class="dv">5</span></span>
<span id="cb86-1627"><a href="#cb86-1627" aria-hidden="true" tabindex="-1"></a>pi2<span class="sc">/</span>pi1</span>
<span id="cb86-1628"><a href="#cb86-1628" aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(pi2)<span class="sc">/</span><span class="fu">odds</span>(pi1)</span>
<span id="cb86-1629"><a href="#cb86-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1630"><a href="#cb86-1630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1631"><a href="#cb86-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1632"><a href="#cb86-1632" aria-hidden="true" tabindex="-1"></a>If you want risk ratios, you can sometimes get them by changing the link</span>
<span id="cb86-1633"><a href="#cb86-1633" aria-hidden="true" tabindex="-1"></a>function:</span>
<span id="cb86-1634"><a href="#cb86-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1637"><a href="#cb86-1637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1638"><a href="#cb86-1638" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(anthers, <span class="at">package =</span> <span class="st">"dobson"</span>)</span>
<span id="cb86-1639"><a href="#cb86-1639" aria-hidden="true" tabindex="-1"></a>anthers.sum<span class="ot">&lt;-</span><span class="fu">aggregate</span>(</span>
<span id="cb86-1640"><a href="#cb86-1640" aria-hidden="true" tabindex="-1"></a>  anthers[<span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"y"</span>)], </span>
<span id="cb86-1641"><a href="#cb86-1641" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span>anthers[<span class="fu">c</span>(<span class="st">"storage"</span>)],<span class="at">FUN=</span>sum) </span>
<span id="cb86-1642"><a href="#cb86-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1643"><a href="#cb86-1643" aria-hidden="true" tabindex="-1"></a>anthers_glm_log <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb86-1644"><a href="#cb86-1644" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">cbind</span>(y,n<span class="sc">-</span>y)<span class="sc">~</span>storage,</span>
<span id="cb86-1645"><a href="#cb86-1645" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>anthers.sum, </span>
<span id="cb86-1646"><a href="#cb86-1646" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb86-1647"><a href="#cb86-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1648"><a href="#cb86-1648" aria-hidden="true" tabindex="-1"></a>anthers_glm_log <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb86-1649"><a href="#cb86-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1650"><a href="#cb86-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1651"><a href="#cb86-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1652"><a href="#cb86-1652" aria-hidden="true" tabindex="-1"></a>Now $\exp(\beta)$ gives us risk ratios instead of odds ratios:</span>
<span id="cb86-1653"><a href="#cb86-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1656"><a href="#cb86-1656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1657"><a href="#cb86-1657" aria-hidden="true" tabindex="-1"></a>anthers_glm_log <span class="sc">|&gt;</span> <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb86-1658"><a href="#cb86-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1659"><a href="#cb86-1659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1660"><a href="#cb86-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1661"><a href="#cb86-1661" aria-hidden="true" tabindex="-1"></a>Let's compare this model with a logistic model:</span>
<span id="cb86-1662"><a href="#cb86-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1665"><a href="#cb86-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1666"><a href="#cb86-1666" aria-hidden="true" tabindex="-1"></a>anthers_glm_logit <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb86-1667"><a href="#cb86-1667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(y,n<span class="sc">-</span>y)<span class="sc">~</span>storage,</span>
<span id="cb86-1668"><a href="#cb86-1668" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>anthers.sum, </span>
<span id="cb86-1669"><a href="#cb86-1669" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb86-1670"><a href="#cb86-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1671"><a href="#cb86-1671" aria-hidden="true" tabindex="-1"></a>anthers_glm_logit <span class="sc">|&gt;</span> <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb86-1672"><a href="#cb86-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1673"><a href="#cb86-1673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1674"><a href="#cb86-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1675"><a href="#cb86-1675" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>to add: fitted plots on each outcome scale<span class="sc">\]</span></span>
<span id="cb86-1676"><a href="#cb86-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1677"><a href="#cb86-1677" aria-hidden="true" tabindex="-1"></a>When I try to use <span class="in">`link ="log"`</span> in practice, I often get errors about</span>
<span id="cb86-1678"><a href="#cb86-1678" aria-hidden="true" tabindex="-1"></a>not finding good starting values for the estimation procedure. This is</span>
<span id="cb86-1679"><a href="#cb86-1679" aria-hidden="true" tabindex="-1"></a>likely because the model is producing fitted probabilities greater than</span>
<span id="cb86-1680"><a href="#cb86-1680" aria-hidden="true" tabindex="-1"></a>1.</span>
<span id="cb86-1681"><a href="#cb86-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1682"><a href="#cb86-1682" aria-hidden="true" tabindex="-1"></a>When this happens, you can try to fit Poisson regression models instead</span>
<span id="cb86-1683"><a href="#cb86-1683" aria-hidden="true" tabindex="-1"></a>(we will see those soon!). But then the outcome distribution isn't quite</span>
<span id="cb86-1684"><a href="#cb86-1684" aria-hidden="true" tabindex="-1"></a>right, and you won't get warnings about fitted probabilities greater</span>
<span id="cb86-1685"><a href="#cb86-1685" aria-hidden="true" tabindex="-1"></a>than 1. In my opinion, the Poisson model for binary outcomes is</span>
<span id="cb86-1686"><a href="#cb86-1686" aria-hidden="true" tabindex="-1"></a>confusing and not very appealing.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>