<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Regression Models for Epidemiology - 2&nbsp; Linear (Gaussian) Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./logistic-regression.html" rel="next">
<link href="./glms.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W625DGE908"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-W625DGE908', { 'anonymize_ip': true});
</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false,
  "enableExperimentalNewNoteButton": true
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="site_libs/plotly-binding-4.10.4/plotly.js"></script><script src="site_libs/typedarray-0.1/typedarray.min.js"></script><script src="site_libs/jquery-3.5.1/jquery.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom.scss">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./glms.html">Generalized Linear Models</a></li><li class="breadcrumb-item"><a href="./Linear-models-overview.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Regression Models for Epidemiology</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/d-morrison/rme" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Regression-Models-for-Epidemiology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-to-GLMs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./glms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Linear-models-overview.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models for Binary Outcomes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Models for Count Outcomes</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-to-event-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time to Event Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-to-survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Survival Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./proportional-hazards-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Proportional Hazards Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./coxph-model-building.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Building Cox Proportional Hazards models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parametric-survival-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parametric survival models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-MLEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to Maximum Likelihood Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./common-mistakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Common Mistakes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">2.1</span> Overview</a>
  <ul class="collapse">
<li><a href="#why-this-course-includes-linear-regression" id="toc-why-this-course-includes-linear-regression" class="nav-link" data-scroll-target="#why-this-course-includes-linear-regression"><span class="header-section-number">2.1.1</span> Why this course includes linear regression</a></li>
  <li><a href="#chapter-overview" id="toc-chapter-overview" class="nav-link" data-scroll-target="#chapter-overview"><span class="header-section-number">2.1.2</span> Chapter overview</a></li>
  </ul>
</li>
  <li>
<a href="#sec-understand-LMs" id="toc-sec-understand-LMs" class="nav-link" data-scroll-target="#sec-understand-LMs"><span class="header-section-number">2.2</span> Understanding Gaussian Linear Regression Models</a>
  <ul class="collapse">
<li><a href="#motivating-example-birthweights-and-gestational-age" id="toc-motivating-example-birthweights-and-gestational-age" class="nav-link" data-scroll-target="#motivating-example-birthweights-and-gestational-age"><span class="header-section-number">2.2.1</span> Motivating example: birthweights and gestational age</a></li>
  <li><a href="#parallel-lines-regression" id="toc-parallel-lines-regression" class="nav-link" data-scroll-target="#parallel-lines-regression"><span class="header-section-number">2.2.2</span> Parallel lines regression</a></li>
  <li><a href="#interactions" id="toc-interactions" class="nav-link" data-scroll-target="#interactions"><span class="header-section-number">2.2.3</span> Interactions</a></li>
  <li><a href="#stratified-regression" id="toc-stratified-regression" class="nav-link" data-scroll-target="#stratified-regression"><span class="header-section-number">2.2.4</span> Stratified regression</a></li>
  <li><a href="#curved-line-regression" id="toc-curved-line-regression" class="nav-link" data-scroll-target="#curved-line-regression"><span class="header-section-number">2.2.5</span> Curved-line regression</a></li>
  </ul>
</li>
  <li>
<a href="#sec-est-LMs" id="toc-sec-est-LMs" class="nav-link" data-scroll-target="#sec-est-LMs"><span class="header-section-number">2.3</span> Estimating Linear Models via Maximum Likelihood</a>
  <ul class="collapse">
<li><a href="#review-of-one-sample-inference" id="toc-review-of-one-sample-inference" class="nav-link" data-scroll-target="#review-of-one-sample-inference"><span class="header-section-number">2.3.1</span> Review of one-sample inference</a></li>
  <li><a href="#mles-for-linear-regression" id="toc-mles-for-linear-regression" class="nav-link" data-scroll-target="#mles-for-linear-regression"><span class="header-section-number">2.3.2</span> MLEs for Linear Regression</a></li>
  </ul>
</li>
  <li>
<a href="#sec-infer-LMs" id="toc-sec-infer-LMs" class="nav-link" data-scroll-target="#sec-infer-LMs"><span class="header-section-number">2.4</span> Inference about Gaussian Linear Regression Models</a>
  <ul class="collapse">
<li><a href="#wald-tests-and-cis" id="toc-wald-tests-and-cis" class="nav-link" data-scroll-target="#wald-tests-and-cis"><span class="header-section-number">2.4.1</span> Wald tests and CIs</a></li>
  <li><a href="#one-parameter-inference-by-hand" id="toc-one-parameter-inference-by-hand" class="nav-link" data-scroll-target="#one-parameter-inference-by-hand"><span class="header-section-number">2.4.2</span> One-parameter inference by hand</a></li>
  <li><a href="#gaussian-approximations" id="toc-gaussian-approximations" class="nav-link" data-scroll-target="#gaussian-approximations"><span class="header-section-number">2.4.3</span> Gaussian approximations</a></li>
  <li><a href="#likelihood-ratio-statistics" id="toc-likelihood-ratio-statistics" class="nav-link" data-scroll-target="#likelihood-ratio-statistics"><span class="header-section-number">2.4.4</span> Likelihood ratio statistics</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">2.4.5</span> </a></li>
  </ul>
</li>
  <li>
<a href="#goodness-of-fit" id="toc-goodness-of-fit" class="nav-link" data-scroll-target="#goodness-of-fit"><span class="header-section-number">2.5</span> Goodness of fit</a>
  <ul class="collapse">
<li><a href="#aic-and-bic" id="toc-aic-and-bic" class="nav-link" data-scroll-target="#aic-and-bic"><span class="header-section-number">2.5.1</span> AIC and BIC</a></li>
  <li><a href="#residual-deviance" id="toc-residual-deviance" class="nav-link" data-scroll-target="#residual-deviance"><span class="header-section-number">2.5.2</span> (Residual) Deviance</a></li>
  <li><a href="#null-deviance" id="toc-null-deviance" class="nav-link" data-scroll-target="#null-deviance"><span class="header-section-number">2.5.3</span> Null Deviance</a></li>
  </ul>
</li>
  <li>
<a href="#rescaling" id="toc-rescaling" class="nav-link" data-scroll-target="#rescaling"><span class="header-section-number">2.6</span> Rescaling</a>
  <ul class="collapse">
<li><a href="#rescale-age" id="toc-rescale-age" class="nav-link" data-scroll-target="#rescale-age"><span class="header-section-number">2.6.1</span> Rescale age</a></li>
  </ul>
</li>
  <li>
<a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">2.7</span> Prediction</a>
  <ul class="collapse">
<li><a href="#prediction-for-linear-models" id="toc-prediction-for-linear-models" class="nav-link" data-scroll-target="#prediction-for-linear-models"><span class="header-section-number">2.7.1</span> Prediction for linear models</a></li>
  <li><a href="#prediction-in-r" id="toc-prediction-in-r" class="nav-link" data-scroll-target="#prediction-in-r"><span class="header-section-number">2.7.2</span> prediction in R</a></li>
  </ul>
</li>
  <li>
<a href="#sec-diagnose-LMs" id="toc-sec-diagnose-LMs" class="nav-link" data-scroll-target="#sec-diagnose-LMs"><span class="header-section-number">2.8</span> Diagnostics</a>
  <ul class="collapse">
<li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals"><span class="header-section-number">2.8.1</span> Residuals</a></li>
  <li><a href="#marginal-distributions-of-residuals" id="toc-marginal-distributions-of-residuals" class="nav-link" data-scroll-target="#marginal-distributions-of-residuals"><span class="header-section-number">2.8.2</span> Marginal distributions of residuals</a></li>
  <li><a href="#qq-plot-of-standardized-residuals" id="toc-qq-plot-of-standardized-residuals" class="nav-link" data-scroll-target="#qq-plot-of-standardized-residuals"><span class="header-section-number">2.8.3</span> QQ plot of standardized residuals</a></li>
  <li><a href="#conditional-distributions-of-residuals" id="toc-conditional-distributions-of-residuals" class="nav-link" data-scroll-target="#conditional-distributions-of-residuals"><span class="header-section-number">2.8.4</span> Conditional distributions of residuals</a></li>
  <li><a href="#diagnostics-constructed-by-hand" id="toc-diagnostics-constructed-by-hand" class="nav-link" data-scroll-target="#diagnostics-constructed-by-hand"><span class="header-section-number">2.8.5</span> Diagnostics constructed by hand</a></li>
  </ul>
</li>
  <li>
<a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection"><span class="header-section-number">2.9</span> Model selection</a>
  <ul class="collapse">
<li><a href="#mean-squared-error" id="toc-mean-squared-error" class="nav-link" data-scroll-target="#mean-squared-error"><span class="header-section-number">2.9.1</span> Mean squared error</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"><span class="header-section-number">2.9.2</span> Cross-validation</a></li>
  </ul>
</li>
  <li>
<a href="#categorical-covariates-with-more-than-two-levels" id="toc-categorical-covariates-with-more-than-two-levels" class="nav-link" data-scroll-target="#categorical-covariates-with-more-than-two-levels"><span class="header-section-number">2.10</span> Categorical covariates with more than two levels</a>
  <ul class="collapse">
<li><a href="#example-birthweight" id="toc-example-birthweight" class="nav-link" data-scroll-target="#example-birthweight"><span class="header-section-number">2.10.1</span> Example: <code>birthweight</code></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">2.10.2</span> </a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"><span class="header-section-number">2.10.3</span> </a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"><span class="header-section-number">2.10.4</span> </a></li>
  <li><a href="#lets-see-how-that-model-looks" id="toc-lets-see-how-that-model-looks" class="nav-link" data-scroll-target="#lets-see-how-that-model-looks"><span class="header-section-number">2.10.5</span> Let’s see how that model looks:</a></li>
  <li><a href="#lets-see-what-r-does-with-categorical-variables-by-default" id="toc-lets-see-what-r-does-with-categorical-variables-by-default" class="nav-link" data-scroll-target="#lets-see-what-r-does-with-categorical-variables-by-default"><span class="header-section-number">2.10.6</span> Let’s see what R does with categorical variables by default:</a></li>
  <li><a href="#re-parametrize-with-no-intercept" id="toc-re-parametrize-with-no-intercept" class="nav-link" data-scroll-target="#re-parametrize-with-no-intercept"><span class="header-section-number">2.10.7</span> Re-parametrize with no intercept</a></li>
  <li><a href="#lets-see-what-these-new-models-look-like" id="toc-lets-see-what-these-new-models-look-like" class="nav-link" data-scroll-target="#lets-see-what-these-new-models-look-like"><span class="header-section-number">2.10.8</span> Let’s see what these new models look like:</a></li>
  <li><a href="#lets-see-how-r-did-that" id="toc-lets-see-how-r-did-that" class="nav-link" data-scroll-target="#lets-see-how-r-did-that"><span class="header-section-number">2.10.9</span> Let’s see how R did that:</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/d-morrison/rme/edit/main/Linear-models-overview.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/d-morrison/rme/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./glms.html">Generalized Linear Models</a></li><li class="breadcrumb-item"><a href="./Linear-models-overview.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Last modified: 2024-04-11: 19:08:32 (PM)</p>
    </div>
  </div>
  
    
  </div>
  


</header><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This content is adapted from:</p>
<ul>
<li>
<span class="citation" data-cites="dobson2018introduction">Dobson and Barnett (<a href="references.html#ref-dobson2018introduction" role="doc-biblioref">2018</a>)</span>, Chapters 2-6</li>
<li>
<span class="citation" data-cites="dunn2018generalized">Dunn, Smyth, et al. (<a href="references.html#ref-dunn2018generalized" role="doc-biblioref">2018</a>)</span>, Chapters 2-3</li>
</ul>
</div>
</div>
<p>Functions from these packages will be used throughout this document:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span> <span class="co"># compiling .qmd files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/">pander</a></span><span class="op">)</span> <span class="co"># format tables for markdown</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span> <span class="co"># graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonocarroll/ggeasy">ggeasy</a></span><span class="op">)</span> <span class="co"># help with graphics: </span></span>
<span><span class="co"># - `ggeasy::easy_labs()` applies same logic as `ggplot2::labs()` but uses as default the "label" attribute, if present, as the variable label in the plot."</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span> <span class="co"># manipulate data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org">haven</a></span><span class="op">)</span> <span class="co"># import Stata files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span> <span class="co"># Tools to help to create tidy data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span> <span class="co"># interactive graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dobson</span><span class="op">)</span> <span class="co"># datasets from Dobson and Barnett 2018</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span> <span class="co"># format model output tables for markdown</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://conflicted.r-lib.org/">conflicted</a></span><span class="op">)</span> <span class="co"># check for conflicting function definitions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="overview" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="overview">
<span class="header-section-number">2.1</span> Overview</h2>
<section id="why-this-course-includes-linear-regression" class="level3 smaller" data-number="2.1.1"><h3 class="smaller anchored" data-number="2.1.1" data-anchor-id="why-this-course-includes-linear-regression">
<span class="header-section-number">2.1.1</span> Why this course includes linear regression</h3>
<div class="fragment fade-in-then-semi-out">
<ul>
<li>This course is about <em>generalized linear models</em> (for non-Gaussian outcomes)</li>
</ul>
</div>
<div class="fragment fade-in-then-semi-out">
<ul>
<li>UC Davis STA 108 (“Applied Statistical Methods: Regression Analysis”) is a prerequisite for this course, so everyone here should have some understanding of linear regression already.</li>
</ul>
</div>
<div class="fragment fade-in">
<ul>
<li>We will review linear regression to:
<ul>
<li>make sure everyone is caught up</li>
<li>to provide an epidemiological perspective on model intepretation.</li>
</ul>
</li>
</ul>
</div>
</section><section id="chapter-overview" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="chapter-overview">
<span class="header-section-number">2.1.2</span> Chapter overview</h3>
<ul>
<li><p><a href="#sec-understand-LMs" class="quarto-xref"><span>Section 2.2</span></a>: how to interpret linear regression models</p></li>
<li><p><a href="#sec-est-LMs" class="quarto-xref"><span>Section 2.3</span></a>: how to estimate linear regression models</p></li>
<li><p><a href="#sec-infer-LMs" class="quarto-xref"><span>Section 2.4</span></a>: how to quantify uncertainty about our estimates</p></li>
<li><p><a href="#sec-diagnose-LMs" class="quarto-xref"><span>Section 2.8</span></a>: how to tell if your model is insufficiently complex</p></li>
</ul></section></section><section id="sec-understand-LMs" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="sec-understand-LMs">
<span class="header-section-number">2.2</span> Understanding Gaussian Linear Regression Models</h2>
<section id="motivating-example-birthweights-and-gestational-age" class="level3 smaller" data-number="2.2.1"><h3 class="smaller anchored" data-number="2.2.1" data-anchor-id="motivating-example-birthweights-and-gestational-age">
<span class="header-section-number">2.2.1</span> Motivating example: birthweights and gestational age</h3>
<p>Suppose we want to learn about the distributions of birthweights (<em>outcome</em> <span class="math inline">\(Y\)</span>) for (human) babies born at different gestational ages (<em>covariate</em> <span class="math inline">\(X_1\)</span>) and with different chromosomal sexes (<em>covariate</em> <span class="math inline">\(X_2\)</span>) (<span class="citation" data-cites="dobson2018introduction">Dobson and Barnett (<a href="references.html#ref-dobson2018introduction" role="doc-biblioref">2018</a>)</span> Example 2.2.2).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Data as table</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Reshape data for graphing</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Data as graph</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dobson</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"birthweight"</span>, package <span class="op">=</span> <span class="st">"dobson"</span><span class="op">)</span></span>
<span><span class="va">birthweight</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-birthweight-data1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-birthweight-data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.1: <code>birthweight</code> data (<span class="citation" data-cites="dobson2018introduction">Dobson and Barnett (<a href="references.html#ref-dobson2018introduction" role="doc-biblioref">2018</a>)</span> Example 2.2.2)
</figcaption><div aria-describedby="tbl-birthweight-data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 17%">
<col style="width: 32%">
<col style="width: 19%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">boys gestational age</th>
<th style="text-align: right;">boys weight</th>
<th style="text-align: right;">girls gestational age</th>
<th style="text-align: right;">girls weight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">40</td>
<td style="text-align: right;">2968</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3317</td>
</tr>
<tr class="even">
<td style="text-align: right;">38</td>
<td style="text-align: right;">2795</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2729</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40</td>
<td style="text-align: right;">3163</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">2935</td>
</tr>
<tr class="even">
<td style="text-align: right;">35</td>
<td style="text-align: right;">2925</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2754</td>
</tr>
<tr class="odd">
<td style="text-align: right;">36</td>
<td style="text-align: right;">2625</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">3210</td>
</tr>
<tr class="even">
<td style="text-align: right;">37</td>
<td style="text-align: right;">2847</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">2817</td>
</tr>
<tr class="odd">
<td style="text-align: right;">41</td>
<td style="text-align: right;">3292</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3126</td>
</tr>
<tr class="even">
<td style="text-align: right;">40</td>
<td style="text-align: right;">3473</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2539</td>
</tr>
<tr class="odd">
<td style="text-align: right;">37</td>
<td style="text-align: right;">2628</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2412</td>
</tr>
<tr class="even">
<td style="text-align: right;">38</td>
<td style="text-align: right;">3176</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2991</td>
</tr>
<tr class="odd">
<td style="text-align: right;">40</td>
<td style="text-align: right;">3421</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">2875</td>
</tr>
<tr class="even">
<td style="text-align: right;">38</td>
<td style="text-align: right;">2975</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3231</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">=</span> </span>
<span>  <span class="va">birthweight</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">".value"</span><span class="op">)</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">"s "</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">`gestational age`</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    sex <span class="op">=</span> <span class="va">sex</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html">case_match</a></span><span class="op">(</span></span>
<span>        <span class="st">"boy"</span> <span class="op">~</span> <span class="st">"male"</span>,</span>
<span>        <span class="st">"girl"</span> <span class="op">~</span> <span class="st">"female"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bw</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-birthweight-data2" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-birthweight-data2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.2: <code>birthweight</code> data reshaped
</figcaption><div aria-describedby="tbl-birthweight-data2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">sex</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">weight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">2968</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3317</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2795</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2729</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3163</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">2935</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">2925</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2625</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">3210</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2847</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">2817</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">3292</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3126</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3473</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2539</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2628</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2412</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">3176</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2991</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3421</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">2875</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2975</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3231</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot1</span> <span class="op">=</span> <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">age</span>, </span>
<span>    y <span class="op">=</span> <span class="va">weight</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    shape <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    col <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Gestational age (weeks)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Birthweight (grams)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># expand_limits(y = 0, x = 0) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-plot-birthweight1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-plot-birthweight1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: <code>birthweight</code> data (<span class="citation" data-cites="dobson2018introduction">Dobson and Barnett (<a href="references.html#ref-dobson2018introduction" role="doc-biblioref">2018</a>)</span> Example 2.2.2)
</figcaption><div aria-describedby="fig-plot-birthweight1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Linear-models-overview_files/figure-html/fig-plot-birthweight1-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<hr>
<section id="data-notation" class="level4"><h4 class="anchored" data-anchor-id="data-notation">Data notation</h4>
<p>Let’s define some notation to represent this data.</p>
<ul>
<li>
<span class="math inline">\(Y\)</span>: birthweight (measured in grams)</li>
<li>
<span class="math inline">\(X_1\)</span>: chromosomal sex:
<ul>
<li>
<span class="math inline">\(X_1 = 0\)</span> if female (XX)</li>
<li>
<span class="math inline">\(X_1 = 1\)</span> if male (XY)</li>
</ul>
</li>
<li>
<span class="math inline">\(X_2\)</span>: gestational age at birth (measured in weeks).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Female is the <strong>reference level</strong> for the categorical variable <span class="math inline">\(X_1\)</span> (chromosomal sex). The choice of a reference level is arbitrary and does not limit what we can do with the resulting model; it only makes it more computationally convenient to make inferences about comparisons involving that reference group.</p>
</div>
</div>
</section></section><section id="parallel-lines-regression" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="parallel-lines-regression">
<span class="header-section-number">2.2.2</span> Parallel lines regression</h3>
<p>We don’t have enough data to model the distribution of birth weight separately for each combination of gestational age and sex, so let’s instead consider a (relatively) simple model for how that distribution varies with gestational age and sex:</p>
<p><span class="math display">\[p(y|x_1,x_2) \sim_{\text{iid}}N(\mu(x_1,x_2), \sigma^2)\]</span></p>
<p><span id="eq-lm-parallel"><span class="math display">\[
\begin{aligned}
\mu(x_1,x_2)
&amp;\stackrel{\text{def}}{=}\mathbb{E}\left[Y|X_1=x_1, X_2=x_2\right] \\
&amp;= \beta_0 + \beta_1 x_1+ \beta_2 x_2
\end{aligned}
\tag{2.1}\]</span></span></p>
<div class="notes">
<p><a href="#tbl-lm-parallel" class="quarto-xref">Table&nbsp;<span>2.3</span></a> shows the parameter estimates from R. <a href="#fig-parallel-fit1" class="quarto-xref">Figure&nbsp;<span>2.2</span></a> shows the estimated model, superimposed on the data.</p>
</div><div class="column" style="width:40%;">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, </span>
<span>  data <span class="op">=</span> <span class="va">bw</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bw_lm1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span></span>
<span>    include_reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># show_sigma = TRUE,</span></span>
<span>    select <span class="op">=</span> <span class="st">"{estimate}"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-lm-parallel" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lm-parallel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.3: Estimate of <a href="#eq-lm-parallel" class="quarto-xref">Equation&nbsp;<span>2.1</span></a> for <code>birthweight</code> data
</figcaption><div aria-describedby="tbl-lm-parallel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-1773.32</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female)</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">163.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: center;">120.89</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`E[Y|X=x]` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot2</span> <span class="op">=</span> </span>
<span>  <span class="va">plot1</span> <span class="op"><a href="https://ggplot2.tidyverse.org/reference/gg-add.html">%+%</a></span> <span class="va">bw</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`E[Y|X=x]`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-parallel-fit1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-parallel-fit1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Parallel-slopes model of birthweight
</figcaption><div aria-describedby="fig-parallel-fit1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Linear-models-overview_files/figure-html/fig-parallel-fit1-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</div>
<hr>
<section id="model-assumptions-and-predictions" class="level4"><h4 class="anchored" data-anchor-id="model-assumptions-and-predictions">Model assumptions and predictions</h4>
<p>To learn what this model is assuming, let’s plug in a few values.</p>
<div id="exr-pred-fem-parallel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.1</strong></span> According to this model, what’s the mean birthweight for a female born at 36 weeks?</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     sexmale         age 
-1773.32184   163.03930   120.89433 </code></pre>
</div>
</div>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred_female</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">[</span><span class="st">"age"</span><span class="op">]</span><span class="op">*</span><span class="fl">36</span></span>
<span></span>
<span><span class="co"># print(pred_female)</span></span>
<span><span class="co">### built-in prediction: </span></span>
<span><span class="co"># predict(bw_lm1, newdata = tibble(sex = "female", age = 36))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[
\begin{aligned}
E[Y|X_1 = 0, X_2 = 36]
&amp;= \beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36 \\
&amp;=  2578.873934
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="exr-pred-male-parallel" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.2</strong></span> What’s the mean birthweight for a male born at 36 weeks?</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     sexmale         age 
-1773.32184   163.03930   120.89433 </code></pre>
</div>
</div>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred_male</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">[</span><span class="st">"sexmale"</span><span class="op">]</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">[</span><span class="st">"age"</span><span class="op">]</span><span class="op">*</span><span class="fl">36</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[
\begin{aligned}
E[Y|X_1 = 1, X_2 = 36]
&amp;= \beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36 \\
&amp;=  2741.91323693
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="exr-diff-sex-parallel-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.3</strong></span> What’s the difference in mean birthweights between males born at 36 weeks and females born at 36 weeks?</p>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     sexmale         age 
-1773.32184   163.03930   120.89433 </code></pre>
</div>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
\begin{aligned}
&amp; E[Y|X_1 = 1, X_2 = 36] - E[Y|X_1 = 0, X_2 = 36]\\
&amp;=
2741.91323693 - 2578.873934\\
&amp;=
163.03930293
\end{aligned}
\]</span> Shortcut:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; E[Y|X_1 = 1, X_2 = 36] -
E[Y|X_1 = 0, X_2 = 36]\\
&amp;= (\beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36) - (\beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36) \\
&amp;= \beta_1 \\
&amp;=  163.03930293
\end{aligned}
\]</span></p>
</div>
<div class="notes">
<p>Note that age doesn’t show up in this difference: in other words, according to this model, the difference between females and males with the same gestational age is the same for every age.</p>
<p>That’s an assumption of the model; it’s built-in to the parametric structure, even before we plug in the estimated values of those parameters.</p>
<p>That’s why the lines are parallel.</p>
</div>
</section></section><section id="interactions" class="level3" data-number="2.2.3"><h3 data-number="2.2.3" class="anchored" data-anchor-id="interactions">
<span class="header-section-number">2.2.3</span> Interactions</h3>
<div class="notes">
<p>What if we don’t like that parallel lines assumption?</p>
<p>Then we need to allow an “interaction” between age and sex:</p>
</div>
<p><span class="math display">\[
E[Y|X_1, X_2] = \beta_0 + \beta_1 X_1+ \beta_2 X_2 + \beta_3 (X_1 \cdot X_2)
\]</span></p>
<div class="column" style="width:40%;">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span><span class="op">:</span><span class="va">age</span>, data <span class="op">=</span> <span class="va">bw</span><span class="op">)</span></span>
<span><span class="va">bw_lm2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span></span>
<span>    include_reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># show_sigma = TRUE,</span></span>
<span>    select <span class="op">=</span> <span class="st">"{estimate}"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-bw-model-coefs-interact" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bw-model-coefs-interact-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.4: Birthweight model with interaction term
</figcaption><div aria-describedby="tbl-bw-model-coefs-interact-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-2141.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female)</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">872.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: center;">130.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male) × age</td>
<td style="text-align: center;">-18.42</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:50%;">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    predlm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot1_interact</span> <span class="op">=</span> </span>
<span>  <span class="va">plot1</span> <span class="op"><a href="https://ggplot2.tidyverse.org/reference/gg-add.html">%+%</a></span> <span class="va">bw</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">predlm2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot1_interact</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-bw-interaction" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-bw-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: Birthweight model with interaction term
</figcaption><div aria-describedby="fig-bw-interaction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Linear-models-overview_files/figure-html/fig-bw-interaction-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="notes">
<p>Now we can see that the lines aren’t parallel.</p>
</div>
<hr>
<p>Here’s another way we could rewrite this model (by collecting terms involving <span class="math inline">\(X_2\)</span>):</p>
<p><span class="math display">\[
E[Y|X_1, X_2] = \beta_0 + \beta_1 X_1+ (\beta_2 + \beta_3 X_1) X_2
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want to understand a coefficient in a model with interactions, collect terms for the corresponding variable, and you will see what other variables are interacting with the variable you are interested in.</p>
</div>
</div>
<div class="notes">
<p>In this case, the coefficient <span class="math inline">\(X_2\)</span> is interacting with <span class="math inline">\(X_1\)</span>. So the slope of <span class="math inline">\(Y\)</span> with respect to <span class="math inline">\(X_2\)</span> depends on the value of <span class="math inline">\(X_2\)</span>.</p>
<p>According to this model, there is no such thing as “<em>the</em> slope of birthweight with respect to age”. There are two slopes, one for each sex.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> We can only talk about “the slope of birthweight with respect to age among males” and “the slope of birthweight with respect to age among females”.</p>
<p>Then: that coefficient is the difference in means per unit change in its corresponding coefficient, when the other collected variables are set to 0.</p>
</div>
<hr>
<p>To learn what this model is assuming, let’s plug in a few values.</p>
<div id="exr-pred-fem-interact" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.4</strong></span> According to this model, what’s the mean birthweight for a female born at 36 weeks?</p>
</div>
<hr>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred_female</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">[</span><span class="st">"age"</span><span class="op">]</span><span class="op">*</span><span class="fl">36</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[E[Y|X_1 = 0, X_2 = 36] = \beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36 + \beta_3 \cdot (0 * 36) =  2552.73333333\]</span> What’s the mean birthweight for a male born at 36 weeks?</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pred_male</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">[</span><span class="st">"sexmale"</span><span class="op">]</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">[</span><span class="st">"age"</span><span class="op">]</span><span class="op">*</span><span class="fl">36</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">[</span><span class="st">"sexmale:age"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">36</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[E[Y|X_1 = 0, X_2 = 36] = \beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36 + \beta_3 \cdot 1 \cdot 36 =  2762.70689655\]</span></p>
<div id="exr-diff-gender-interact" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2.5</strong></span> What’s the difference in mean birthweights between males born at 36 weeks and females born at 36 weeks?</p>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
\begin{aligned}
&amp; E[Y|X_1 = 1, X_2 = 36] - E[Y|X_1 = 0, X_2 = 36]\\
&amp;= (\beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36 + \beta_3 \cdot 1 \cdot 36)\\
&amp;\ \ \ \ \  -(\beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36 + \beta_3 \cdot 0 \cdot 36) \\
&amp;= \beta_2 + \beta_3\cdot 36\\
&amp;=  209.97356322
\end{aligned}
\]</span></p>
</div>
<p>Note that age now does show up in the difference: in other words, according to this model, the difference in mean birthweights between females and males with the same gestational age can vary by gestational age.</p>
<p>That’s how the lines in the graph ended up non-parallel.</p>
</section><section id="stratified-regression" class="level3" data-number="2.2.4"><h3 data-number="2.2.4" class="anchored" data-anchor-id="stratified-regression">
<span class="header-section-number">2.2.4</span> Stratified regression</h3>
<div class="notes">
<p>We could re-write the interaction model as a stratified model, with a slope and intercept for each sex:</p>
</div><div class="column" style="width:45%;">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span><span class="op">:</span><span class="va">age</span>, data <span class="op">=</span> <span class="va">bw</span><span class="op">)</span></span>
<span><span class="va">bw_lm2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span></span>
<span>    include_reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># show_sigma = TRUE,</span></span>
<span>    select <span class="op">=</span> <span class="st">"{estimate}"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-bw-model-coefs-interact2" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bw-model-coefs-interact2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.5: Birthweight model with interaction term
</figcaption><div aria-describedby="tbl-bw-model-coefs-interact2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-2141.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female)</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">872.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: center;">130.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male) × age</td>
<td style="text-align: center;">-18.42</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div><div class="column" style="width:10%;">

</div><div class="column" style="width:45%;">
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm_strat</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">sex</span><span class="op">:</span><span class="va">age</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>    data <span class="op">=</span> <span class="va">_</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bw_lm_strat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span></span>
<span>    <span class="co"># show_sigma = TRUE,</span></span>
<span>    select <span class="op">=</span> <span class="st">"{estimate}"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-bw-model-coefs-strat" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bw-model-coefs-strat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.6: Birthweight model - stratified betas
</figcaption><div aria-describedby="tbl-bw-model-coefs-strat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sex (female)</td>
<td style="text-align: center;">-2141.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">-1268.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (female) × age</td>
<td style="text-align: center;">130.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male) × age</td>
<td style="text-align: center;">111.98</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</section><section id="curved-line-regression" class="level3" data-number="2.2.5"><h3 data-number="2.2.5" class="anchored" data-anchor-id="curved-line-regression">
<span class="header-section-number">2.2.5</span> Curved-line regression</h3>
<p>If we transform some of our covariates (<span class="math inline">\(X\)</span>s) and plot the resulting model on the original covariate scale, we end up with curved regression lines:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">bw</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ggpenguins</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span> , y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Bill length (mm)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Body mass (g)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ggpenguins2</span> <span class="op">=</span> <span class="va">ggpenguins</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>              formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>              geom <span class="op">=</span> <span class="st">"smooth"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Bill length (mm)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Body mass (g)"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ggpenguins2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-penguins-log-x" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-penguins-log-x-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: <code>palmerpenguins</code> model with bill_length entering on log scale
</figcaption><div aria-describedby="fig-penguins-log-x-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Linear-models-overview_files/figure-html/fig-penguins-log-x-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</section></section><section id="sec-est-LMs" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="sec-est-LMs">
<span class="header-section-number">2.3</span> Estimating Linear Models via Maximum Likelihood</h2>
<section id="review-of-one-sample-inference" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="review-of-one-sample-inference">
<span class="header-section-number">2.3.1</span> Review of one-sample inference</h3>
<p>Previously, we learned how to fit outcome-only models of the form <span class="math inline">\(p(X=x|\theta)\)</span> to iid data <span class="math inline">\(\mathbf x = (x_1,…,x_n)\)</span> using maximum likelihood estimation:</p>
<p><span class="math display">\[\mathcal L(\mathbf x|\theta) = p(X_1 = x_1, …,X_n =x_n|\theta) = \prod_{i=1}^n p(X=x_i|\theta)\]</span></p>
<p><span class="math display">\[\ell(x|\theta) = \text{log}\left\{\mathcal L(x|\theta)\right\}\]</span></p>
<p><span class="math display">\[\hat \theta_{ML} = \arg \max_\theta \ell(x|\theta)\]</span></p>
<p>We learned how to quantify our uncertainty about these maximum likelihood estimates; with sufficient sample size, <span class="math inline">\(\hat \theta_{ML}\)</span> has the approximate distribution:</p>
<p><span class="math display">\[
\hat\theta_{ML} \dot \sim N(\theta,\mathcal I(\theta)^{-1})
\]</span></p>
<p>For models in the “exponential family” of distributions, which includes the Gaussian, Poisson, Bernoulli, Binomial, Exponential, and Gamma distributions, <span class="math inline">\(\mathcal I(\theta) = \text -E[\mathcal{l}''(X|\theta)]\)</span>, so we estimated <span class="math inline">\(\mathcal I(\theta)\)</span> using either <span class="math inline">\(\mathcal I(\theta)|_{\theta = \hat \theta_{ML}}\)</span> or <span class="math inline">\(\mathcal{l}''(\mathbf x |\theta)|_{\theta = \hat \theta_{ML}}\)</span>.</p>
<p>Then an asymptotic approximation of a 95% confidence interval for <span class="math inline">\(\theta_k\)</span> is</p>
<p><span class="math display">\[\hat \theta_{ML} \pm z_{0.975} \times \left[\left(\hat{\mathcal I}(\hat \theta_{ML})\right)^{-1}\right]_{kk}\]</span></p>
<p>where <span class="math inline">\(z_\beta\)</span> the <span class="math inline">\(\beta\)</span> quantile of the standard Gaussian distribution.</p>
</section><section id="mles-for-linear-regression" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="mles-for-linear-regression">
<span class="header-section-number">2.3.2</span> MLEs for Linear Regression</h3>
<p>Let’s use maximum likelihood again:</p>
<p><span class="math display">\[
\mathcal L(\mathbf y|\mathbf x,\beta, \sigma^2) =
\prod_{i=1}^n (2\pi\sigma^2)^{-1/2}
\text{exp}\left\{-\frac{1}{2\sigma^2}(y_i - x_i'\beta)^2\right\}
\]</span></p>
<p><span class="math display">\[
\ell(\mathbf y|\mathbf x,\beta, \sigma^2) \propto -\frac{n}{2}\text{log}\left\{\sigma^2\right\} - \frac{1}{2\sigma^2}\sum_{i=1}^n (y_i - x_i' \beta)^2
\]</span></p>
<p><span class="math display">\[
\ell'(\mathbf y|\mathbf x,\beta, \sigma^2) \propto -\frac{n}{2}\text{log}\left\{\sigma^2\right\} - \frac{1}{2\sigma^2}\frac{d}{d\beta}\left(\sum_{i=1}^n (y_i - x_i' \beta)^2\right)
\]</span></p>
<p>A few tools from linear algebra will make this analysis go easier (see <span class="citation" data-cites="fieller2018basics">Fieller (<a href="references.html#ref-fieller2018basics" role="doc-biblioref">2016</a>)</span>, Section 7.2 for details).</p>
<p><span class="math display">\[
f_{\beta}(\mathbf x) = (f_{\beta}(x_1), f_{\beta}(x_2), ..., f_{\beta}(x_n))^\top
\]</span></p>
<p>Let <span class="math inline">\(\mathbf x\)</span> and <span class="math inline">\(\beta\)</span> be vectors of length <span class="math inline">\(p\)</span>, or in other words, matrices of length <span class="math inline">\(p\times 1\)</span>:</p>
<p><span class="math display">\[
x = \begin{bmatrix}
x_{1} \\
x_{2} \\
\vdots \\
x_{p}
\end{bmatrix} \\
\beta = \begin{bmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{p}
\end{bmatrix}
\]</span></p>
<p>Then</p>
<p><span class="math display">\[
x' \equiv x^\top \equiv [x_1, x_2, ..., x_p]
\]</span></p>
<p>and</p>
<p><span class="math display">\[
x'\beta = [x_1, x_2, ..., x_p]
\begin{bmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{p}
\end{bmatrix} =
x_1\beta_1+x_2\beta_2 +...+x_p \beta_p
\]</span></p>
<p>If <span class="math inline">\(f(\beta)\)</span> is a function that takes <span class="math inline">\(\beta\)</span> as input and outputs a scalar, such as <span class="math inline">\(f(\beta) = x'\beta\)</span>, then:</p>
<p><span class="math display">\[
\frac{d}{d \beta} f(\beta)=
\begin{bmatrix}
\frac{d}{d\beta_1}f(\beta) \\
\frac{d}{d\beta_2}f(\beta) \\
\vdots \\
\frac{d}{d\beta_p}f(\beta)
\end{bmatrix}
\]</span></p>
<p>In particular, if <span class="math inline">\(f(\beta) = x'\beta\)</span>, then:</p>
<p><span class="math display">\[
\frac{d}{d \beta} x'\beta=
\begin{bmatrix}
\frac{d}{d\beta_1}(x_1\beta_1+x_2\beta_2 +...+x_p \beta_p ) \\
\frac{d}{d\beta_2}(x_1\beta_1+x_2\beta_2 +...+x_p \beta_p ) \\
\vdots \\
\frac{d}{d\beta_p}(x_1\beta_1+x_2\beta_2 +...+x_p \beta_p )
\end{bmatrix}
=
\begin{bmatrix}
x_{1} \\
x_{2} \\
\vdots \\
x_{p}
\end{bmatrix}
= \mathbf x
\]</span></p>
<p>In general:</p>
<p><span class="math display">\[
\frac{d}{d\beta} x'\beta = x
\]</span></p>
<p>This looks a lot like non-vector calculus, except that you have to transpose the coefficient.</p>
<p>Similarly,</p>
<p><span class="math display">\[
\frac{d}{d\beta} \beta'\beta = 2\beta
\]</span></p>
<p>This is like taking the derivative of <span class="math inline">\(x^2\)</span>.</p>
<p>And finally, if <span class="math inline">\(S\)</span> is a <span class="math inline">\(p\times p\)</span> matrix, then:</p>
<p><span class="math display">\[
\frac{d}{d\beta} \beta'S\beta = 2S\beta
\]</span></p>
<p>Again, this is like taking the derivative of <span class="math inline">\(cx^2\)</span> with respect to <span class="math inline">\(c\)</span> in non-vector calculus.</p>
<p>Thus:</p>
<p><span class="math display">\[
\sum_{i=1}^n (y_i - f_\beta(x_i))^2 = (\mathbf y - X\beta)'(\mathbf y - X\beta)
\]</span></p>
<p><span class="math display">\[
(\mathbf y - X\beta)' = (\mathbf y' - (X\beta)') = (\mathbf y' - \beta'X')
\]</span></p>
<p>So</p>
<p><span class="math display">\[
\begin{aligned}
(\mathbf y - X\beta)'(\mathbf y - X\beta) &amp;= (\mathbf y' - \beta'X')(\mathbf y - X\beta)\\
&amp;= y'y - \beta'X'y - y'X\beta +\beta'X'X\beta\\
&amp;= y'y - 2y'X\beta +\beta'X'X\beta
\end{aligned}
\]</span></p>
<p>So</p>
<p><span class="math display">\[
\begin{aligned}
\frac{d}{d\beta}\left(\sum_{i=1}^n (y_i - x_i' \beta)^2\right) &amp;=
\frac{d}{d\beta}(\mathbf y - X\beta)'(\mathbf y - X\beta)\\
&amp;= \frac{d}{d\beta} (y'y - 2y'X\beta +\beta'X'X\beta)\\
&amp;= (- 2X'y +2X'X\beta)
\end{aligned}
\]</span></p>
<p>So if <span class="math inline">\(\ell(\beta,\sigma^2) =0\)</span>, then</p>
<p><span class="math display">\[
\begin{aligned}
0 &amp;= (- 2X'y +2X'X\beta)\\
2X'y &amp;= 2X'X\beta\\
X'y &amp;= X'X\beta\\
(X'X)^{-1}X'y &amp;= \beta
\end{aligned}
\]</span></p>
<p>The second derivative matrix <span class="math inline">\(\ell_{\beta, \beta'} ''(\beta, \sigma^2;\mathbf X,\mathbf y)\)</span> is negative definite at <span class="math inline">\(\beta = (X'X)^{-1}X'y\)</span>, so <span class="math inline">\(\hat \beta_{ML} = (X'X)^{-1}X'y\)</span> is the MLE for <span class="math inline">\(\beta\)</span>.</p>
<p>Similarly (not shown):</p>
<p><span class="math display">\[
\hat\sigma^2_{ML} = \frac{1}{n} (Y-X\hat\beta)'(Y-X\hat\beta)
\]</span></p>
<p>And</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal I_{\beta} &amp;= E[-\ell_{\beta, \beta'} ''(Y|X,\beta, \sigma^2)]\\
&amp;= \frac{1}{\sigma^2}X'X
\end{aligned}
\]</span></p>
<p>So:</p>
<p><span class="math display">\[
Var(\hat \beta) \approx (\mathcal I_{\beta})^{-1} = \sigma^2 (X'X)^{-1}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\hat\beta \dot \sim N(\beta, \mathcal I_{\beta}^{-1})
\]</span> These are all results you have hopefully seen before, and in the Gaussian linear regression case they are exact, not just approximate.</p>
<p>In our model 2 above, this matrix is:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">sexmale</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">sexmale:age</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">1353968.361</td>
<td style="text-align: right;">-1353968.361</td>
<td style="text-align: right;">-34870.96582</td>
<td style="text-align: right;">34870.96582</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexmale</td>
<td style="text-align: right;">-1353968.361</td>
<td style="text-align: right;">2596387.127</td>
<td style="text-align: right;">34870.96582</td>
<td style="text-align: right;">-67210.97445</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-34870.966</td>
<td style="text-align: right;">34870.966</td>
<td style="text-align: right;">899.89589</td>
<td style="text-align: right;">-899.89589</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexmale:age</td>
<td style="text-align: right;">34870.966</td>
<td style="text-align: right;">-67210.974</td>
<td style="text-align: right;">-899.89589</td>
<td style="text-align: right;">1743.54829</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that if we take the square roots of the diagonals, we get the standard errors listed in the model output:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     sexmale         age sexmale:age 
1163.601461 1611.330856   29.998265   41.755817 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Std. Error</th>
<th style="text-align: center;">t value</th>
<th style="text-align: center;">Pr(&gt;|t|)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept)</strong></td>
<td style="text-align: center;">-2142</td>
<td style="text-align: center;">1164</td>
<td style="text-align: center;">-1.841</td>
<td style="text-align: center;">0.08057</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>sexmale</strong></td>
<td style="text-align: center;">873</td>
<td style="text-align: center;">1611</td>
<td style="text-align: center;">0.5418</td>
<td style="text-align: center;">0.594</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>age</strong></td>
<td style="text-align: center;">130.4</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">4.347</td>
<td style="text-align: center;">0.0003127</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>sexmale:age</strong></td>
<td style="text-align: center;">-18.42</td>
<td style="text-align: center;">41.76</td>
<td style="text-align: center;">-0.4411</td>
<td style="text-align: center;">0.6639</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So we can do confidence intervals, hypothesis tests, and p-values exactly as in the one-variable case we looked at previously.</p>
</section></section><section id="sec-infer-LMs" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="sec-infer-LMs">
<span class="header-section-number">2.4</span> Inference about Gaussian Linear Regression Models</h2>
<p>Research question: is there really an interaction between sex and age?</p>
<p><span class="math inline">\(H_0: \beta_3 = 0\)</span></p>
<p><span class="math inline">\(H_A: \beta_3 \neq 0\)</span></p>
<p><span class="math inline">\(P(|\hat\beta_3| &gt; |-18.41724138| \mid H_0)\)</span> = ?</p>
<section id="wald-tests-and-cis" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="wald-tests-and-cis">
<span class="header-section-number">2.4.1</span> Wald tests and CIs</h3>
<p>R can give you Wald tests for single coefficients and corresponding CIs:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw_lm2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span></span>
<span>    include_reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co"># show_sigma = TRUE,</span></span>
<span>    select <span class="op">=</span> <span class="st">"{estimate}"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-2141.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female)</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">872.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: center;">130.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male) × age</td>
<td style="text-align: center;">-18.42</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="one-parameter-inference-by-hand" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="one-parameter-inference-by-hand">
<span class="header-section-number">2.4.2</span> One-parameter inference by hand</h3>
<p>To understand what’s happening, let’s replicate these results by hand for the interaction term.</p>
<section id="p-value" class="level4"><h4 class="anchored" data-anchor-id="p-value">P-value</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">beta_hat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="st">"sexmale:age"</span>, <span class="st">"Estimate"</span><span class="op">]</span></span>
<span><span class="va">se_hat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="st">"sexmale:age"</span>, <span class="st">"Std. Error"</span><span class="op">]</span></span>
<span><span class="va">dfresid</span> <span class="op">=</span> <span class="va">bw_lm2</span><span class="op">$</span><span class="va">df.residual</span></span>
<span><span class="va">t_stat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">beta_hat</span><span class="op">)</span><span class="op">/</span><span class="va">se_hat</span></span>
<span><span class="va">pval_t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t_stat</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dfresid</span>, lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[
\begin{aligned}
&amp;P\left(
| \hat \beta_3  | &gt;
| -18.41724138| \middle| H_0
\right)
&amp;= P\left(
\left| \frac{\hat\beta_3}{\hat{SE}(\hat\beta_3)} \right| &gt;
\left| \frac{-18.41724138}{41.75581745} \right| \middle| H_0
\right)\\
&amp;= P\left(
| T_{20} | &gt;  0.44107007 \middle| H_0
\right)\\
&amp;= 0.66389342
\end{aligned}
\]</span> This matches the result in the table above.</p>
</section><section id="confidence-interval" class="level4"><h4 class="anchored" data-anchor-id="confidence-interval">Confidence interval</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">confint_radius_t</span> <span class="op">=</span> <span class="va">se_hat</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.975</span>, df <span class="op">=</span> <span class="va">dfresid</span>, lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">confint_t</span> <span class="op">=</span> <span class="va">beta_hat</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">confint_radius_t</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">confint_t</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -105.518350   68.683868</code></pre>
</div>
</div>
<p>This also matches.</p>
</section></section><section id="gaussian-approximations" class="level3" data-number="2.4.3"><h3 data-number="2.4.3" class="anchored" data-anchor-id="gaussian-approximations">
<span class="header-section-number">2.4.3</span> Gaussian approximations</h3>
<p>Here are the asymptotic (Gaussian approximation) equivalents:</p>
<section id="p-value-1" class="level4"><h4 class="anchored" data-anchor-id="p-value-1">P-value</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval_z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t_stat</span><span class="op">)</span>, lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pval_z</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.65916227</code></pre>
</div>
</div>
</section><section id="confidence-interval-1" class="level4"><h4 class="anchored" data-anchor-id="confidence-interval-1">Confidence interval</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">confint_radius_z</span> <span class="op">=</span> <span class="va">se_hat</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span>, lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">confint_z</span> <span class="op">=</span> </span>
<span>  <span class="va">beta_hat</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">confint_radius_z</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">confint_z</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -100.257140   63.422657</code></pre>
</div>
</div>
</section></section><section id="likelihood-ratio-statistics" class="level3" data-number="2.4.4"><h3 data-number="2.4.4" class="anchored" data-anchor-id="likelihood-ratio-statistics">
<span class="header-section-number">2.4.4</span> Likelihood ratio statistics</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -156.57929 (df=5)</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -156.69545 (df=4)</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lLR</span> <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">delta_df</span> <span class="op">=</span> <span class="op">(</span><span class="va">bw_lm1</span><span class="op">$</span><span class="va">df.residual</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_lLR</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">df</span> <span class="op">=</span> <span class="va">delta_df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">dchisq</a></span><span class="op">(</span><span class="va">x</span>, df <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_max</span> <span class="op">=</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">chisq_plot</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">d_lLR</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span> fun <span class="op">=</span> <span class="va">d_lLR</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lLR</span>, <span class="va">x_max</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lLR</span>, xend <span class="op">=</span> <span class="va">lLR</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fu">d_lLR</span><span class="op">(</span><span class="va">lLR</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0.0001</span>,<span class="va">x_max</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"p(X=x)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"log(likelihood ratio) statistic [x]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span></span>
<span>  q <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">lLR</span>, </span>
<span>  df <span class="op">=</span> <span class="va">delta_df</span>, </span>
<span>  lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.62980648</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">chisq_plot</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ba95550b0b463378fe97" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ba95550b0b463378fe97">{"x":{"data":[{"x":[0.0001,0.010099,0.020098000000000001,0.030097000000000002,0.040096000000000007,0.050095000000000008,0.060094000000000009,0.070093000000000003,0.08009200000000001,0.090091000000000018,0.10009000000000001,0.11008900000000001,0.12008800000000001,0.13008700000000001,0.14008599999999999,0.150085,0.160084,0.17008300000000001,0.18008200000000002,0.190081,0.20008000000000001,0.21007900000000002,0.220078,0.230077,0.24007600000000001,0.25007500000000005,0.26007400000000003,0.27007300000000001,0.28007199999999999,0.29007100000000002,0.30007,0.31006900000000004,0.32006800000000002,0.330067,0.34006600000000003,0.35006500000000002,0.36006400000000005,0.37006300000000003,0.38006200000000001,0.39006100000000005,0.40006000000000003,0.41005900000000001,0.42005800000000004,0.43005700000000002,0.440056,0.45005500000000004,0.46005400000000002,0.47005300000000005,0.48005200000000003,0.49005100000000001,0.50005000000000011,0.51004900000000009,0.52004800000000007,0.53004700000000005,0.54004600000000003,0.55004500000000001,0.56004399999999999,0.57004300000000008,0.58004200000000006,0.59004100000000004,0.60004000000000002,0.610039,0.62003800000000009,0.63003700000000007,0.64003600000000005,0.65003500000000003,0.66003400000000001,0.6700330000000001,0.68003200000000008,0.69003100000000006,0.70003000000000004,0.71002900000000002,0.72002800000000011,0.73002700000000009,0.74002600000000007,0.75002500000000005,0.76002400000000003,0.77002300000000001,0.7800220000000001,0.79002100000000008,0.80002000000000006,0.81001900000000004,0.82001800000000002,0.83001700000000012,0.8400160000000001,0.85001500000000008,0.86001400000000006,0.87001300000000004,0.88001200000000002,0.89001100000000011,0.90001000000000009,0.91000900000000007,0.92000800000000005,0.93000700000000003,0.94000600000000012,0.9500050000000001,0.96000400000000008,0.97000300000000006,0.98000200000000004,0.99000100000000013,1],"y":[39.892233378608211,3.9498255041164581,2.7859249938531958,2.2652335286559815,1.952777692966801,1.7383406432944384,1.5792295551876125,1.4549639743681413,1.3543276329342735,1.2705926828004384,1.1994453188881977,1.1379746294835569,1.0841352911975315,1.036442190511474,0.99378722601206693,0.95532441573429994,0.92039511119107975,0.88847775319425448,0.85915318360328641,0.83208012204289161,0.8069774638017968,0.78361126352561805,0.76178500543916616,0.74133222193747894,0.72211081849024927,0.70399865724438782,0.68689008198862567,0.67069315604458435,0.65532744633275142,0.64072223031972542,0.62681503360276558,0.61355042836081763,0.60087903936270781,0.58875671641591942,0.57714384126415663,0.56600474383689359,0.55530720801142619,0.54502205109060153,0.53512276433281702,0.52558520431779765,0.51638732685596689,0.50750895667267981,0.4989315873122746,0.49063820667961483,0.48261314442078679,0.47484193797992336,0.46731121468657144,0.46000858765153185,0.45292256359735444,0.44604246103729223,0.43935833745509195,0.43286092433667872,0.42654156907090063,0.42039218287588992,0.4144051940249871,0.40857350574537088,0.4028904582466461,0.39734979440817308,0.39194562871494626,0.3866724190840507,0.38152494126852282,0.37649826556399446,0.37158773557675234,0.36678894884060376,0.36209773909487486,0.35751016005753811,0.35302247054633501,0.34863112081724362,0.34433274000404906,0.34012412455541624,0.33600222757696374,0.33196414899560928,0.32800712647207186,0.32412852699503247,0.32032583909718687,0.31659666563940414,0.31293871711450377,0.30934980542688845,0.30582783810847058,0.30237081293508788,0.29897681291095074,0.2956440015916717,0.29237061871911502,0.28915497614372088,0.28599545401212684,0.28289049719986759,0.27983861197069038,0.27683836284561486,0.27388836966630153,0.27098730483858907,0.2681338907432409,0.26532689730200226,0.26256513968804235,0.25984747617073045,0.25717280608549875,0.25454006792027045,0.25194823751059747,0.24939632633625639,0.24688337991260653,0.24440847627051809,0.24197072451914337],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.11616163586791117,0.12500001950923206,0.13383840315055295,0.14267678679187384,0.15151517043319473,0.16035355407451563,0.16919193771583652,0.17803032135715741,0.1868687049984783,0.19570708863979919,0.20454547228112008,0.21338385592244097,0.22222223956376183,0.23106062320508272,0.23989900684640361,0.2487373904877245,0.25757577412904542,0.26641415777036626,0.2752525414116872,0.28409092505300804,0.29292930869432898,0.30176769233564982,0.31060607597697076,0.3194444596182916,0.32828284325961249,0.33712122690093338,0.34595961054225427,0.35479799418357516,0.36363637782489605,0.37247476146621694,0.38131314510753783,0.39015152874885872,0.39898991239017961,0.4078282960315005,0.41666667967282139,0.42550506331414228,0.43434344695546317,0.44318183059678407,0.45202021423810496,0.46085859787942585,0.46969698152074674,0.47853536516206763,0.48737374880338852,0.49621213244470941,0.50505051608603035,0.51388889972735119,0.52272728336867202,0.53156566700999297,0.54040405065131381,0.54924243429263475,0.55808081793395559,0.56691920157527642,0.57575758521659737,0.58459596885791831,0.59343435249923915,0.60227273614055998,0.61111111978188093,0.61994950342320188,0.62878788706452271,0.63762627070584366,0.64646465434716449,0.65530303798848544,0.66414142162980627,0.67297980527112722,0.68181818891244805,0.69065657255376889,0.69949495619508983,0.70833333983641067,0.71717172347773162,0.72601010711905245,0.7348484907603734,0.74368687440169423,0.75252525804301518,0.76136364168433601,0.77020202532565696,0.77904040896697779,0.78787879260829874,0.79671717624961957,0.80555555989094052,0.81439394353226136,0.8232323271735823,0.83207071081490314,0.84090909445622408,0.84974747809754492,0.85858586173886586,0.8674242453801867,0.87626262902150764,0.88510101266282848,0.89393939630414943,0.90277777994547026,0.91161616358679121,0.92045454722811204,0.92929293086943299,0.93813131451075382,0.94696969815207477,0.9558080817933956,0.96464646543471644,0.97348484907603738,0.98232323271735822,0.99116161635867917,1,1,1,0.99116161635867917,0.98232323271735822,0.97348484907603738,0.96464646543471644,0.9558080817933956,0.94696969815207477,0.93813131451075382,0.92929293086943299,0.92045454722811204,0.91161616358679121,0.90277777994547026,0.89393939630414943,0.88510101266282848,0.87626262902150764,0.8674242453801867,0.85858586173886586,0.84974747809754492,0.84090909445622408,0.83207071081490314,0.8232323271735823,0.81439394353226136,0.80555555989094052,0.79671717624961957,0.78787879260829874,0.77904040896697779,0.77020202532565696,0.76136364168433601,0.75252525804301518,0.74368687440169423,0.7348484907603734,0.72601010711905245,0.71717172347773162,0.70833333983641067,0.69949495619508983,0.69065657255376889,0.68181818891244805,0.67297980527112722,0.66414142162980627,0.65530303798848544,0.64646465434716449,0.63762627070584366,0.62878788706452271,0.61994950342320188,0.61111111978188093,0.60227273614055998,0.59343435249923915,0.58459596885791831,0.57575758521659737,0.56691920157527642,0.55808081793395559,0.54924243429263475,0.54040405065131381,0.53156566700999297,0.52272728336867202,0.51388889972735119,0.50505051608603035,0.49621213244470941,0.48737374880338852,0.47853536516206763,0.46969698152074674,0.46085859787942585,0.45202021423810496,0.44318183059678407,0.43434344695546317,0.42550506331414228,0.41666667967282139,0.4078282960315005,0.39898991239017961,0.39015152874885872,0.38131314510753783,0.37247476146621694,0.36363637782489605,0.35479799418357516,0.34595961054225427,0.33712122690093338,0.32828284325961249,0.3194444596182916,0.31060607597697076,0.30176769233564982,0.29292930869432898,0.28409092505300804,0.2752525414116872,0.26641415777036626,0.25757577412904542,0.2487373904877245,0.23989900684640361,0.23106062320508272,0.22222223956376183,0.21338385592244097,0.20454547228112008,0.19570708863979919,0.1868687049984783,0.17803032135715741,0.16919193771583652,0.16035355407451563,0.15151517043319473,0.14267678679187384,0.13383840315055295,0.12500001950923206,0.11616163586791117,0.11616163586791117],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.24197072451914337,0.24412362931957554,0.24630548218417012,0.24851689472866273,0.25075849734268546,0.2530309399527586,0.25533489282388261,0.25767104740206992,0.26004011720032155,0.26244283873073171,0.26487997248560036,0.26735230397063803,0.26986064479357907,0.27240583381176436,0.27498873834251947,0.27761025544044837,0.28027131324607546,0.28297287241061253,0.28571592760200204,0.28850150909779354,0.29133068447085519,0.2942045603744074,0.29712428443339461,0.30009104724979041,0.30310608453006643,0.30617067934375075,0.30928616452276037,0.31245392521203591,0.31567540158291935,0.31895209172173566,0.32228555470714693,0.32567741389108529,0.32912936039942248,0.33264315687003954,0.33622064144761954,0.33986373205632836,0.34357443097358875,0.34735482973042675,0.35120711436638885,0.35513357106984239,0.35913659223760963,0.36321868299138538,0.36738246819231346,0.37163069999948278,0.37596626602303723,0.38039219812812924,0.38491168195218267,0.3895280672049648,0.39424487882890674,0.39906582910610566,0.40399483080862775,0.40903601150031366,0.41419372911145919,0.41947258892276956,0.42487746211215877,0.43041350603762674,0.43608618645201758,0.44190130187142829,0.44786501034897186,0.45398385894021376,0.46026481618669873,0.46671530799058963,0.47334325730772903,0.48015712814986145,0.4871659744610824,0.49437949452092955,0.501808091629528,0.50946294195202679,0.51735607054416244,0.52550043675303104,0.53391003039306273,0.5425999803443472,0.55158667751826185,0.5608879144957486,0.57052304458161529,0.58051316355311522,0.59088131803734179,0.60165274526134904,0.61285514992240275,0.62451902517696656,0.63667802631633652,0.64936940767747775,0.66263453585395427,0.67651949549123624,0.6910758081001559,0.70636128971292234,0.72244108026807985,0.73938888694541427,0.75728849612897919,0.77623562547183578,0.79634021043110403,0.81772925122379936,0.84055039027995737,0.86497645278359558,0.89121127280302537,0.91949725897428303,0.95012534941928251,0.98344830281186113,1.019898733947463,1.0600140363158475,1.1044715346883747,0],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(190,190,190,1)","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.11616163586791117,0.11616163586791117],"y":[0,1.1044715346883747],"text":"lLR: 0.11616164<br />y: 0<br />lLR: 0.11616164<br />d_lLR(lLR): 1.1044715","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":31.415525114155255},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.049895000000000002,1.049995],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"log(likelihood ratio) statistic [x]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.20000000000000001,4.2000000000000002],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"p(X=x)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"11ec81b4be3c9":{"type":"scatter"},"11ec81357af1f":[],"11ec861aa2624":{"x":{},"y":{},"xend":{},"yend":{}}},"cur_data":"11ec81b4be3c9","visdat":{"11ec81b4be3c9":["function (y) ","x"],"11ec81357af1f":["function (y) ","x"],"11ec861aa2624":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Now we can get the p-value:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">lLR</span>, df <span class="op">=</span> <span class="va">delta_df</span>, lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.62980648</code></pre>
</div>
</div>
</section><section id="section" class="level3" data-number="2.4.5"><h3 data-number="2.4.5" class="anchored" data-anchor-id="section">
<span class="header-section-number">2.4.5</span> </h3>
<p>In practice you don’t have to do this by hand; there are functions to do it for you:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># built in</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">bw_lm2</span>, <span class="va">bw_lm1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">#Df</th>
<th style="text-align: right;">LogLik</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Chisq</th>
<th style="text-align: right;">Pr(&gt;Chisq)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-156.57929</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-156.69545</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">0.23232327</td>
<td style="text-align: right;">0.62980648</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="goodness-of-fit" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="goodness-of-fit">
<span class="header-section-number">2.5</span> Goodness of fit</h2>
<section id="aic-and-bic" class="level3" data-number="2.5.1"><h3 data-number="2.5.1" class="anchored" data-anchor-id="aic-and-bic">
<span class="header-section-number">2.5.1</span> AIC and BIC</h3>
<p>When we use likelihood ratio tests, we are comparing how well different models fit the data.</p>
<p>Likelihood ratio tests require “nested” models: one must be a special case of the other.</p>
<p>If we have non-nested models, we can instead use the Akaike Information Criterion (AIC) or Bayesian Information Criterion (BIC):</p>
<ul>
<li><p>AIC = <span class="math inline">\(-2 * \ell(\hat\theta) + 2 * p\)</span></p></li>
<li><p>BIC = <span class="math inline">\(-2 * \ell(\hat\theta) + p * \text{log}(n)\)</span></p></li>
</ul>
<p>where <span class="math inline">\(\ell\)</span> is the log-likelihood of the data evaluated using the parameter estimates <span class="math inline">\(\hat\theta\)</span>, <span class="math inline">\(p\)</span> is the number of estimated parameters in the model (including <span class="math inline">\(\hat\sigma^2\)</span>), and <span class="math inline">\(n\)</span> is the number of observations.</p>
<p>You can calculate these criteria using the <code><a href="https://rdrr.io/r/stats/logLik.html">logLik()</a></code> function, or use the built-in R functions:</p>
<section id="aic-in-r" class="level4"><h4 class="anchored" data-anchor-id="aic-in-r">AIC in R</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co"># sigma counts as a parameter here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 323.15858</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 323.15858</code></pre>
</div>
</div>
</section><section id="bic-in-r" class="level4"><h4 class="anchored" data-anchor-id="bic-in-r">BIC in R</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html">nobs</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 329.04884</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 329.04884</code></pre>
</div>
</div>
<p>Large values of AIC and BIC are worse than small values. There are no hypothesis tests or p-values associated with these criteria.</p>
</section></section><section id="residual-deviance" class="level3" data-number="2.5.2"><h3 data-number="2.5.2" class="anchored" data-anchor-id="residual-deviance">
<span class="header-section-number">2.5.2</span> (Residual) Deviance</h3>
<p>Let <span class="math inline">\(q\)</span> be the number of distinct covariate combinations in a data set.</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw.X.unique</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_unique.bw</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">bw.X.unique</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For example, in the <code>birthweight</code> data, there are <span class="math inline">\(q = 12\)</span> unique patterns:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw.X.unique</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span></span>
<span>    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">bw.X.unique</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>3</strong></td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>4</strong></td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">39</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>5</strong></td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>6</strong></td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>7</strong></td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>9</strong></td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>10</strong></td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">38</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>11</strong></td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>12</strong></td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a given covariate pattern has more than one observation in a dataset, those observations are called <strong>replicates</strong>.</p>
</div>
</div>
<p>Then the most complicated model we could fit would have one parameter (a mean) for each of these combinations, plus a variance parameter:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_max</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span><span class="op">:</span><span class="va">age</span> <span class="op">-</span> <span class="fl">1</span>, </span>
<span>    data <span class="op">=</span> <span class="va">_</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_max</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 27%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 25%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(12)</th>
<th style="text-align: center;">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sex (male) × age35</td>
<td style="text-align: center;">2925.00</td>
<td style="text-align: center;">187.92</td>
<td style="text-align: center;">(2515.55, 3334.45)</td>
<td style="text-align: center;">15.56</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female) × age36</td>
<td style="text-align: center;">2570.50</td>
<td style="text-align: center;">132.88</td>
<td style="text-align: center;">(2280.98, 2860.02)</td>
<td style="text-align: center;">19.34</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male) × age36</td>
<td style="text-align: center;">2625.00</td>
<td style="text-align: center;">187.92</td>
<td style="text-align: center;">(2215.55, 3034.45)</td>
<td style="text-align: center;">13.97</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female) × age37</td>
<td style="text-align: center;">2539.00</td>
<td style="text-align: center;">187.92</td>
<td style="text-align: center;">(2129.55, 2948.45)</td>
<td style="text-align: center;">13.51</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male) × age37</td>
<td style="text-align: center;">2737.50</td>
<td style="text-align: center;">132.88</td>
<td style="text-align: center;">(2447.98, 3027.02)</td>
<td style="text-align: center;">20.60</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female) × age38</td>
<td style="text-align: center;">2872.50</td>
<td style="text-align: center;">132.88</td>
<td style="text-align: center;">(2582.98, 3162.02)</td>
<td style="text-align: center;">21.62</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male) × age38</td>
<td style="text-align: center;">2982.00</td>
<td style="text-align: center;">108.50</td>
<td style="text-align: center;">(2745.60, 3218.40)</td>
<td style="text-align: center;">27.48</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female) × age39</td>
<td style="text-align: center;">2846.00</td>
<td style="text-align: center;">132.88</td>
<td style="text-align: center;">(2556.48, 3135.52)</td>
<td style="text-align: center;">21.42</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (female) × age40</td>
<td style="text-align: center;">3152.25</td>
<td style="text-align: center;">93.96</td>
<td style="text-align: center;">(2947.52, 3356.98)</td>
<td style="text-align: center;">33.55</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male) × age40</td>
<td style="text-align: center;">3256.25</td>
<td style="text-align: center;">93.96</td>
<td style="text-align: center;">(3051.52, 3460.98)</td>
<td style="text-align: center;">34.66</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex (male) × age41</td>
<td style="text-align: center;">3292.00</td>
<td style="text-align: center;">187.92</td>
<td style="text-align: center;">(2882.55, 3701.45)</td>
<td style="text-align: center;">17.52</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (female) × age42</td>
<td style="text-align: center;">3210.00</td>
<td style="text-align: center;">187.92</td>
<td style="text-align: center;">(2800.55, 3619.45)</td>
<td style="text-align: center;">17.08</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We call this model the <strong>full</strong>, <strong>maximal</strong>, or <strong>saturated</strong> model for this dataset.</p>
<p>We can calculate the log-likelihood of this model as usual:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">lm_max</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -151.4016 (df=13)</code></pre>
</div>
</div>
<p>We can compare this model to our other models using chi-square tests, as usual:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">lm_max</span>, <span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">#Df</th>
<th style="text-align: right;">LogLik</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Chisq</th>
<th style="text-align: right;">Pr(&gt;Chisq)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-151.40160</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-156.57929</td>
<td style="text-align: right;">-8</td>
<td style="text-align: right;">10.355374</td>
<td style="text-align: right;">0.24096372</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The likelihood ratio statistic for this test is <span class="math display">\[\lambda = 2 * (\ell_{\text{full}} - \ell) = 10.35537421\]</span> where:</p>
<ul>
<li>
<span class="math inline">\(\ell_{\text{max}}\)</span> is the log-likelihood of the full model: -151.40160056</li>
<li>
<span class="math inline">\(\ell\)</span> is the log-likelihood of our comparison model (two slopes, two intercepts): -156.57928767</li>
</ul>
<p>This statistic is called the <strong>deviance</strong> or <strong>residual deviance</strong> for our two-slopes and two-intercepts model; it tells us how much the likelihood of that model deviates from the likelihood of the maximal model.</p>
<p>The corresponding p-value tells us whether there we have enough evidence to detect that our two-slopes, two-intercepts model is a worse fit for the data than the maximal model; in other words, it tells us if there’s evidence that we missed any important patterns. (Remember, a nonsignificant p-value could mean that we didn’t miss anything and a more complicated model is unnecessary, or it could mean we just don’t have enough data to tell the difference between these models.)</p>
</section><section id="null-deviance" class="level3" data-number="2.5.3"><h3 data-number="2.5.3" class="anchored" data-anchor-id="null-deviance">
<span class="header-section-number">2.5.3</span> Null Deviance</h3>
<p>Similarly, the <em>least</em> complicated model we could fit would have only one mean parameter, an intercept:</p>
<p><span class="math display">\[\text E[Y|X=x] = \beta_0\]</span> We can fit this model in R like so:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">bw</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm0</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 29%">
<col style="width: 10%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(23)</th>
<th style="text-align: center;">p</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">2967.67</td>
<td style="text-align: center;">57.58</td>
<td style="text-align: center;">(2848.56, 3086.77)</td>
<td style="text-align: center;">51.54</td>
<td style="text-align: center;">&lt; .001</td>
</tr></tbody>
</table>
</div>
</div>
<p>This model also has a likelihood:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">lm0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -168.95497 (df=2)</code></pre>
</div>
</div>
<p>And we can compare it to more complicated models using a likelihood ratio test:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">bw_lm2</span>, <span class="va">lm0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">#Df</th>
<th style="text-align: right;">LogLik</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Chisq</th>
<th style="text-align: right;">Pr(&gt;Chisq)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-156.57929</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-168.95497</td>
<td style="text-align: right;">-3</td>
<td style="text-align: right;">24.751358</td>
<td style="text-align: right;">1.74e-05</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The likelihood ratio statistic for the test comparing the null model to the maximal model is <span class="math display">\[\lambda = 2 * (\ell_{\text{full}} - \ell_{0}) = 35.10673188\]</span> where:</p>
<ul>
<li>
<span class="math inline">\(\ell_{\text{0}}\)</span> is the log-likelihood of the null model: -168.9549665</li>
<li>
<span class="math inline">\(\ell_{\text{full}}\)</span> is the log-likelihood of the maximal model: -151.40160056</li>
</ul>
<p>In R, this test is:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html">lrtest</a></span><span class="op">(</span><span class="va">lm_max</span>, <span class="va">lm0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">#Df</th>
<th style="text-align: right;">LogLik</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">Chisq</th>
<th style="text-align: right;">Pr(&gt;Chisq)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-151.40160</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-168.95497</td>
<td style="text-align: right;">-11</td>
<td style="text-align: right;">35.106732</td>
<td style="text-align: right;">0.00023795</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This log-likelihood ratio statistic is called the <strong>null deviance</strong>. It tells us whether we have enough data to detect a difference between the null and full models.</p>
</section></section><section id="rescaling" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="rescaling">
<span class="header-section-number">2.6</span> Rescaling</h2>
<section id="rescale-age" class="level3 smaller" data-number="2.6.1"><h3 class="smaller anchored" data-number="2.6.1" data-anchor-id="rescale-age">
<span class="header-section-number">2.6.1</span> Rescale age</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    `age - mean` <span class="op">=</span> <span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    `age - 36wks` <span class="op">=</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">36</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">lm1c</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">`age - 36wks`</span>, data <span class="op">=</span> <span class="va">bw</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm2c</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">`age - 36wks`</span> <span class="op">+</span> <span class="va">sex</span><span class="op">:</span><span class="va">`age - 36wks`</span>, data <span class="op">=</span> <span class="va">bw</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="va">lm2c</span>, ci_method <span class="op">=</span> <span class="st">"wald"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 24%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(20)</th>
<th style="text-align: center;">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">2552.73</td>
<td style="text-align: center;">97.59</td>
<td style="text-align: center;">(2349.16, 2756.30)</td>
<td style="text-align: center;">26.16</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">209.97</td>
<td style="text-align: center;">129.75</td>
<td style="text-align: center;">(-60.68, 480.63)</td>
<td style="text-align: center;">1.62</td>
<td style="text-align: center;">0.121</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age - 36wks</td>
<td style="text-align: center;">130.40</td>
<td style="text-align: center;">30.00</td>
<td style="text-align: center;">(67.82, 192.98)</td>
<td style="text-align: center;">4.35</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male) × age - 36wks</td>
<td style="text-align: center;">-18.42</td>
<td style="text-align: center;">41.76</td>
<td style="text-align: center;">(-105.52, 68.68)</td>
<td style="text-align: center;">-0.44</td>
<td style="text-align: center;">0.664</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Compare with what we got without rescaling:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="va">bw_lm2</span>, ci_method <span class="op">=</span> <span class="st">"wald"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 28%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(20)</th>
<th style="text-align: center;">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">-2141.67</td>
<td style="text-align: center;">1163.60</td>
<td style="text-align: center;">(-4568.90, 285.56)</td>
<td style="text-align: center;">-1.84</td>
<td style="text-align: center;">0.081</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male)</td>
<td style="text-align: center;">872.99</td>
<td style="text-align: center;">1611.33</td>
<td style="text-align: center;">(-2488.18, 4234.17)</td>
<td style="text-align: center;">0.54</td>
<td style="text-align: center;">0.594</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: center;">130.40</td>
<td style="text-align: center;">30.00</td>
<td style="text-align: center;">(67.82, 192.98)</td>
<td style="text-align: center;">4.35</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex (male) × age</td>
<td style="text-align: center;">-18.42</td>
<td style="text-align: center;">41.76</td>
<td style="text-align: center;">(-105.52, 68.68)</td>
<td style="text-align: center;">-0.44</td>
<td style="text-align: center;">0.664</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="prediction" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="prediction">
<span class="header-section-number">2.7</span> Prediction</h2>
<section id="prediction-for-linear-models" class="level3" data-number="2.7.1"><h3 data-number="2.7.1" class="anchored" data-anchor-id="prediction-for-linear-models">
<span class="header-section-number">2.7.1</span> Prediction for linear models</h3>
<p><span class="math display">\[
\begin{aligned}
\hat Y &amp;= \hat E[Y|X=x] \\
&amp;= x'\hat\beta \\
&amp;= \hat\beta_0\cdot 1 + \hat\beta_1 x_1 + ... + \hat\beta_p x_p
\end{aligned}
\]</span></p>
</section><section id="prediction-in-r" class="level3" data-number="2.7.2"><h3 data-number="2.7.2" class="anchored" data-anchor-id="prediction-in-r">
<span class="header-section-number">2.7.2</span> prediction in R</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 3
   `(Intercept)` sexmale   age
           &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1             1       1    40
 2             1       0    40
 3             1       1    38
 4             1       0    36
 5             1       1    40
 6             1       0    40
 7             1       1    35
 8             1       0    38
 9             1       1    36
10             1       0    42
# ℹ 14 more rows</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     sexmale         age 
          1           1          40 </code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     sexmale         age 
-1773.32184   163.03930   120.89433 </code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     sexmale         age 
 -1773.3218    163.0393   4835.7731 </code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">{</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span><span class="op">}</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3225.4905</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] 3225.4905 3062.4512 2983.7019 2578.8739 3225.4905 3062.4512 2621.0189
 [8] 2820.6626 2741.9132 3304.2399 2862.8076 2941.5569 3346.3849 3062.4512
[15] 3225.4905 2699.7683 2862.8076 2578.8739 2983.7019 2820.6626 3225.4905
[22] 2941.5569 2983.7019 3062.4512</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
3225.4905 3062.4512 2983.7019 2578.8739 3225.4905 3062.4512 2621.0189 2820.6626 
        9        10        11        12        13        14        15        16 
2741.9132 3304.2399 2862.8076 2941.5569 3346.3849 3062.4512 3225.4905 2699.7683 
       17        18        19        20        21        22        23        24 
2862.8076 2578.8739 2983.7019 2820.6626 3225.4905 2941.5569 2983.7019 3062.4512 </code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm1</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$fit
        1         2         3         4         5         6         7         8 
3225.4905 3062.4512 2983.7019 2578.8739 3225.4905 3062.4512 2621.0189 2820.6626 
        9        10        11        12        13        14        15        16 
2741.9132 3304.2399 2862.8076 2941.5569 3346.3849 3062.4512 3225.4905 2699.7683 
       17        18        19        20        21        22        23        24 
2862.8076 2578.8739 2983.7019 2820.6626 3225.4905 2941.5569 2983.7019 3062.4512 

$se.fit
 [1] 61.459866 57.170263 51.581930 76.031792 61.459866 57.170263 85.245245
 [8] 53.382643 69.956665 83.887011 57.953281 51.384243 74.778488 57.170263
[15] 61.459866 62.422252 57.953281 76.031792 51.581930 53.382643 61.459866
[22] 51.384243 51.581930 57.170263

$df
[1] 21

$residual.scale
[1] 177.11588</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm1</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
3225.4905 3062.4512 2983.7019 2578.8739 3225.4905 3062.4512 2621.0189 2820.6626 
        9        10        11        12        13        14        15        16 
2741.9132 3304.2399 2862.8076 2941.5569 3346.3849 3062.4512 3225.4905 2699.7683 
       17        18        19        20        21        22        23        24 
2862.8076 2578.8739 2983.7019 2820.6626 3225.4905 2941.5569 2983.7019 3062.4512 </code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm1</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">se.fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] 61.459866 57.170263 51.581930 76.031792 61.459866 57.170263 85.245245
 [8] 53.382643 69.956665 83.887011 57.953281 51.384243 74.778488 57.170263
[15] 61.459866 62.422252 57.953281 76.031792 51.581930 53.382643 61.459866
[22] 51.384243 51.581930 57.170263</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm1</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span><span class="op">$</span><span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">fit</th>
<th style="text-align: right;">lwr</th>
<th style="text-align: right;">upr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">3097.6778</td>
<td style="text-align: right;">3353.3033</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2943.5592</td>
<td style="text-align: right;">3181.3433</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2983.7019</td>
<td style="text-align: right;">2876.4314</td>
<td style="text-align: right;">3090.9724</td>
</tr>
<tr class="even">
<td style="text-align: right;">2578.8739</td>
<td style="text-align: right;">2420.7572</td>
<td style="text-align: right;">2736.9907</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">3097.6778</td>
<td style="text-align: right;">3353.3033</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2943.5592</td>
<td style="text-align: right;">3181.3433</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2621.0189</td>
<td style="text-align: right;">2443.7417</td>
<td style="text-align: right;">2798.2961</td>
</tr>
<tr class="even">
<td style="text-align: right;">2820.6626</td>
<td style="text-align: right;">2709.6473</td>
<td style="text-align: right;">2931.6779</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2741.9132</td>
<td style="text-align: right;">2596.4304</td>
<td style="text-align: right;">2887.3961</td>
</tr>
<tr class="even">
<td style="text-align: right;">3304.2399</td>
<td style="text-align: right;">3129.7873</td>
<td style="text-align: right;">3478.6925</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2862.8076</td>
<td style="text-align: right;">2742.2871</td>
<td style="text-align: right;">2983.3280</td>
</tr>
<tr class="even">
<td style="text-align: right;">2941.5569</td>
<td style="text-align: right;">2834.6975</td>
<td style="text-align: right;">3048.4163</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3346.3849</td>
<td style="text-align: right;">3190.8745</td>
<td style="text-align: right;">3501.8953</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2943.5592</td>
<td style="text-align: right;">3181.3433</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">3097.6778</td>
<td style="text-align: right;">3353.3033</td>
</tr>
<tr class="even">
<td style="text-align: right;">2699.7683</td>
<td style="text-align: right;">2569.9541</td>
<td style="text-align: right;">2829.5824</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2862.8076</td>
<td style="text-align: right;">2742.2871</td>
<td style="text-align: right;">2983.3280</td>
</tr>
<tr class="even">
<td style="text-align: right;">2578.8739</td>
<td style="text-align: right;">2420.7572</td>
<td style="text-align: right;">2736.9907</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2983.7019</td>
<td style="text-align: right;">2876.4314</td>
<td style="text-align: right;">3090.9724</td>
</tr>
<tr class="even">
<td style="text-align: right;">2820.6626</td>
<td style="text-align: right;">2709.6473</td>
<td style="text-align: right;">2931.6779</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">3097.6778</td>
<td style="text-align: right;">3353.3033</td>
</tr>
<tr class="even">
<td style="text-align: right;">2941.5569</td>
<td style="text-align: right;">2834.6975</td>
<td style="text-align: right;">3048.4163</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2983.7019</td>
<td style="text-align: right;">2876.4314</td>
<td style="text-align: right;">3090.9724</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2943.5592</td>
<td style="text-align: right;">3181.3433</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm1</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span>, interval <span class="op">=</span> <span class="st">"predict"</span><span class="op">)</span><span class="op">$</span><span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">fit</th>
<th style="text-align: right;">lwr</th>
<th style="text-align: right;">upr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">2835.6123</td>
<td style="text-align: right;">3615.3688</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2675.4057</td>
<td style="text-align: right;">3449.4968</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2983.7019</td>
<td style="text-align: right;">2600.0668</td>
<td style="text-align: right;">3367.3370</td>
</tr>
<tr class="even">
<td style="text-align: right;">2578.8739</td>
<td style="text-align: right;">2178.0375</td>
<td style="text-align: right;">2979.7104</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">2835.6123</td>
<td style="text-align: right;">3615.3688</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2675.4057</td>
<td style="text-align: right;">3449.4968</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2621.0189</td>
<td style="text-align: right;">2212.2450</td>
<td style="text-align: right;">3029.7929</td>
</tr>
<tr class="even">
<td style="text-align: right;">2820.6626</td>
<td style="text-align: right;">2435.9636</td>
<td style="text-align: right;">3205.3616</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2741.9132</td>
<td style="text-align: right;">2345.8903</td>
<td style="text-align: right;">3137.9362</td>
</tr>
<tr class="even">
<td style="text-align: right;">3304.2399</td>
<td style="text-align: right;">2896.6830</td>
<td style="text-align: right;">3711.7968</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2862.8076</td>
<td style="text-align: right;">2475.2587</td>
<td style="text-align: right;">3250.3564</td>
</tr>
<tr class="even">
<td style="text-align: right;">2941.5569</td>
<td style="text-align: right;">2558.0366</td>
<td style="text-align: right;">3325.0773</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3346.3849</td>
<td style="text-align: right;">2946.5694</td>
<td style="text-align: right;">3746.2003</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2675.4057</td>
<td style="text-align: right;">3449.4968</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">2835.6123</td>
<td style="text-align: right;">3615.3688</td>
</tr>
<tr class="even">
<td style="text-align: right;">2699.7683</td>
<td style="text-align: right;">2309.2293</td>
<td style="text-align: right;">3090.3072</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2862.8076</td>
<td style="text-align: right;">2475.2587</td>
<td style="text-align: right;">3250.3564</td>
</tr>
<tr class="even">
<td style="text-align: right;">2578.8739</td>
<td style="text-align: right;">2178.0375</td>
<td style="text-align: right;">2979.7104</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2983.7019</td>
<td style="text-align: right;">2600.0668</td>
<td style="text-align: right;">3367.3370</td>
</tr>
<tr class="even">
<td style="text-align: right;">2820.6626</td>
<td style="text-align: right;">2435.9636</td>
<td style="text-align: right;">3205.3616</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3225.4905</td>
<td style="text-align: right;">2835.6123</td>
<td style="text-align: right;">3615.3688</td>
</tr>
<tr class="even">
<td style="text-align: right;">2941.5569</td>
<td style="text-align: right;">2558.0366</td>
<td style="text-align: right;">3325.0773</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2983.7019</td>
<td style="text-align: right;">2600.0668</td>
<td style="text-align: right;">3367.3370</td>
</tr>
<tr class="even">
<td style="text-align: right;">3062.4512</td>
<td style="text-align: right;">2675.4057</td>
<td style="text-align: right;">3449.4968</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The warning from the last command is: “predictions on current data refer to <em>future</em> responses” (since you already know what happened to the current data, and thus don’t need to predict it). You could also supply <code>newdata</code> to get predictions for new combinations of predictors that you didn’t see in your original dataset. See <code><a href="https://rdrr.io/r/stats/predict.lm.html">?predict.lm</a></code> for more.</p>
</section></section><section id="sec-diagnose-LMs" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="sec-diagnose-LMs">
<span class="header-section-number">2.8</span> Diagnostics</h2>
<section id="residuals" class="level3" data-number="2.8.1"><h3 data-number="2.8.1" class="anchored" data-anchor-id="residuals">
<span class="header-section-number">2.8.1</span> Residuals</h3>
<section id="definitions-of-residuals" class="level4"><h4 class="anchored" data-anchor-id="definitions-of-residuals">Definitions of residuals</h4>
<ul>
<li><p>Residuals: <span class="math display">\[e_i = y_i - \hat E[Y|X=x]\]</span></p></li>
<li><p>For Gaussian models, <span class="math inline">\(e_i\)</span> can be seen as an estimate of <span class="math display">\[\epsilon_i = Y_i - \text{E}[Y|X=x_i]\]</span></p></li>
<li><p>Standardized residuals: <span class="math display">\[r_i = \frac{e_i}{\hat{SD}(e_i)}\]</span></p></li>
<li><p>For Gaussian models: <span class="math display">\[\hat{SD}(e_i) \approx \frac{e_i}{\hat{\sigma}}\]</span></p></li>
</ul></section><section id="characteristics-of-residuals" class="level4"><h4 class="anchored" data-anchor-id="characteristics-of-residuals">Characteristics of residuals</h4>
<p>With enough data and a correct model, the residuals will be approximately Guassian distributed, with variance <span class="math inline">\(\sigma^2\)</span>, which we can estimate using <span class="math inline">\(\hat\sigma^2\)</span>: that is:</p>
<p><span class="math display">\[
e_i\ \dot \sim_{iid}\ N(0, \hat\sigma^2)
\]</span></p>
<p>Hence, with enough data and a correct model, the standardized residuals will be approximately standard Gaussian; that is,</p>
<p><span class="math display">\[
r_i\ \dot \sim_{iid}\ N(0,1)
\]</span></p>
</section></section><section id="marginal-distributions-of-residuals" class="level3" data-number="2.8.2"><h3 data-number="2.8.2" class="anchored" data-anchor-id="marginal-distributions-of-residuals">
<span class="header-section-number">2.8.2</span> Marginal distributions of residuals</h3>
<p>To look for problems with our model, we can check whether the residuals <span class="math inline">\(e_i\)</span> and standardized residuals <span class="math inline">\(r_i\)</span> look like they have the distributions that they are supposed to have, according to the model.</p>
<p>First, we need to compute the residuals. R makes this easy:</p>
<section id="non-standardized-residuals-in-r" class="level4"><h4 class="anchored" data-anchor-id="non-standardized-residuals-in-r">(non-standardized) residuals in R</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
 176.266667 -140.733333 -144.133333  -59.533333  177.466667 -126.933333 
          7           8           9          10          11          12 
 -68.933333  242.666667 -139.333333   51.666667  156.666667 -125.133333 
         13          14          15          16          17          18 
 274.275862 -137.706897  -27.689655 -246.689655 -191.672414  189.327586 
         19          20          21          22          23          24 
 -11.672414 -242.637931  -47.637931  262.362069  210.362069  -30.620690 </code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check by hand</span></span>
<span><span class="va">bw</span><span class="op">$</span><span class="va">weight</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>          1           2           3           4           5           6 
 176.266667 -140.733333 -144.133333  -59.533333  177.466667 -126.933333 
          7           8           9          10          11          12 
 -68.933333  242.666667 -139.333333   51.666667  156.666667 -125.133333 
         13          14          15          16          17          18 
 274.275862 -137.706897  -27.689655 -246.689655 -191.672414  189.327586 
         19          20          21          22          23          24 
 -11.672414 -242.637931  -47.637931  262.362069  210.362069  -30.620690 </code></pre>
</div>
</div>
<p>Success!</p>
</section><section id="standardized-residuals-in-r" class="level4"><h4 class="anchored" data-anchor-id="standardized-residuals-in-r">Standardized residuals in R</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           1            2            3            4            5            6 
 1.159816604 -0.926010912 -0.874791659 -0.347225534  1.035066486 -0.734731462 
           7            8            9           10           11           12 
-0.399008578  1.437516422 -0.825387176  0.306064623  0.928066921 -0.876159249 
          13           14           15           16           17           18 
 1.914278022 -0.865592113 -0.164299301 -1.463757406 -1.110159894  1.096578735 
          19           20           21           22           23           24 
-0.067606211 -1.461586459 -0.286958245  1.580399427  1.267165237 -0.198054338 </code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html">sigma</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>           1            2            3            4            5            6 
 0.975933108 -0.779196215 -0.798020946 -0.329617347  0.982577131 -0.702789954 
           7            8            9           10           11           12 
-0.381662191  1.343569030 -0.771444855  0.286062087  0.867414071 -0.692823920 
          13           14           15           16           17           18 
 1.518579205 -0.762439786 -0.153308914 -1.365843052 -1.061229886  1.048247313 
          19           20           21           22           23           24 
-0.064626485 -1.343409930 -0.263756245  1.452616279  1.164708630 -0.169537130 </code></pre>
</div>
</div>
<p>These are not quite the same, because R is doing something more complicated and precise to get the standard errors. Let’s not worry about those details for now; the difference is pretty small in this case:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rstandard_compare_plot</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html">sigma</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span>, </span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"resid(bw_lm2)/sigma(bw_lm2)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"rstandard(bw_lm2)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    slope <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"x=y"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">rstandard_compare_plot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-febc92748372736cebb3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-febc92748372736cebb3">{"x":{"data":[{"x":[0.97593310836753411,-0.77919621473670087,-0.79802094564696546,-0.32961734711505347,0.98257713104171884,-0.70278995398326394,-0.38166219139637442,1.3435690296738827,-0.77144485495011328,0.28606208736188449,0.8674140713553915,-0.69282391997193882,1.5185792054792597,-0.76243978590412931,-0.15330891400551366,-1.3658430520491134,-1.0612298860518581,1.0482473130102949,-0.064626484920132371,-1.3434099295140582,-0.26375624495468836,1.4526162792166168,1.164708630000785,-0.1695371303074639],"y":[1.1598166040138622,-0.92601091190364337,-0.87479165935721714,-0.34722553413920726,1.0350664858662388,-0.73473146215227003,-0.39900857766042508,1.4375164217020691,-0.82538717619706636,0.30606462275250113,0.92806692060435803,-0.87615924904963072,1.9142780218641546,-0.86559211299437477,-0.16429930069729987,-1.4637574062122991,-1.1101598943215265,1.0965787352293495,-0.067606211069144315,-1.4615864587633849,-0.28695824526136698,1.5803994274854296,1.2671652372182252,-0.19805433812125872],"text":["x:  0.975933108<br />y:  1.159816604","x: -0.779196215<br />y: -0.926010912","x: -0.798020946<br />y: -0.874791659","x: -0.329617347<br />y: -0.347225534","x:  0.982577131<br />y:  1.035066486","x: -0.702789954<br />y: -0.734731462","x: -0.381662191<br />y: -0.399008578","x:  1.343569030<br />y:  1.437516422","x: -0.771444855<br />y: -0.825387176","x:  0.286062087<br />y:  0.306064623","x:  0.867414071<br />y:  0.928066921","x: -0.692823920<br />y: -0.876159249","x:  1.518579205<br />y:  1.914278022","x: -0.762439786<br />y: -0.865592113","x: -0.153308914<br />y: -0.164299301","x: -1.365843052<br />y: -1.463757406","x: -1.061229886<br />y: -1.110159894","x:  1.048247313<br />y:  1.096578735","x: -0.064626485<br />y: -0.067606211","x: -1.343409930<br />y: -1.461586459","x: -0.263756245<br />y: -0.286958245","x:  1.452616279<br />y:  1.580399427","x:  1.164708630<br />y:  1.267165237","x: -0.169537130<br />y: -0.198054338"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783],"y":[-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,-1.510064164925532,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783,1.6628003183556783],"text":"intercept: 0<br />slope: 1<br />colour: x=y","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"x=y","legendgroup":"x=y","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.510064164925532,1.6628003183556783],"tickmode":"array","ticktext":["-1","0","1"],"tickvals":[-1,0,0.99999999999999978],"categoryorder":"array","categoryarray":["-1","0","1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"resid(bw_lm2)/sigma(bw_lm2)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"scaleanchor":"y","scaleratio":1,"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.6326591776161219,2.0831797932679774],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1.0000000000000002,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"rstandard(bw_lm2)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"scaleanchor":"x","scaleratio":1,"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"11ec875473423":{"x":{},"y":{},"type":"scatter"},"11ec815b021fc":{"intercept":{},"slope":{},"colour":{}}},"cur_data":"11ec875473423","visdat":{"11ec875473423":["function (y) ","x"],"11ec815b021fc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s add these residuals to the <code>tibble</code> of our dataset:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    fitted_lm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span>,</span>
<span>    </span>
<span>    resid_lm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span>,</span>
<span>    <span class="co"># resid_lm2 = weight - fitted_lm2,</span></span>
<span>    </span>
<span>    std_resid_lm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span>,</span>
<span>    <span class="co"># std_resid_lm2 = resid_lm2 / sigma(bw_lm2)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">sex</span>,</span>
<span>    <span class="va">age</span>,</span>
<span>    <span class="va">weight</span>,</span>
<span>    <span class="va">fitted_lm2</span>,</span>
<span>    <span class="va">resid_lm2</span>,</span>
<span>    <span class="va">std_resid_lm2</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">sex</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">weight</th>
<th style="text-align: right;">fitted_lm2</th>
<th style="text-align: right;">resid_lm2</th>
<th style="text-align: right;">std_resid_lm2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2729</td>
<td style="text-align: right;">2552.7333</td>
<td style="text-align: right;">176.266667</td>
<td style="text-align: right;">1.15981660</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2412</td>
<td style="text-align: right;">2552.7333</td>
<td style="text-align: right;">-140.733333</td>
<td style="text-align: right;">-0.92601091</td>
</tr>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2539</td>
<td style="text-align: right;">2683.1333</td>
<td style="text-align: right;">-144.133333</td>
<td style="text-align: right;">-0.87479166</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2754</td>
<td style="text-align: right;">2813.5333</td>
<td style="text-align: right;">-59.533333</td>
<td style="text-align: right;">-0.34722553</td>
</tr>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2991</td>
<td style="text-align: right;">2813.5333</td>
<td style="text-align: right;">177.466667</td>
<td style="text-align: right;">1.03506649</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">2817</td>
<td style="text-align: right;">2943.9333</td>
<td style="text-align: right;">-126.933333</td>
<td style="text-align: right;">-0.73473146</td>
</tr>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">2875</td>
<td style="text-align: right;">2943.9333</td>
<td style="text-align: right;">-68.933333</td>
<td style="text-align: right;">-0.39900858</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3317</td>
<td style="text-align: right;">3074.3333</td>
<td style="text-align: right;">242.666667</td>
<td style="text-align: right;">1.43751642</td>
</tr>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">2935</td>
<td style="text-align: right;">3074.3333</td>
<td style="text-align: right;">-139.333333</td>
<td style="text-align: right;">-0.82538718</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3126</td>
<td style="text-align: right;">3074.3333</td>
<td style="text-align: right;">51.666667</td>
<td style="text-align: right;">0.30606462</td>
</tr>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3231</td>
<td style="text-align: right;">3074.3333</td>
<td style="text-align: right;">156.666667</td>
<td style="text-align: right;">0.92806692</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">3210</td>
<td style="text-align: right;">3335.1333</td>
<td style="text-align: right;">-125.133333</td>
<td style="text-align: right;">-0.87615925</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">2925</td>
<td style="text-align: right;">2650.7241</td>
<td style="text-align: right;">274.275862</td>
<td style="text-align: right;">1.91427802</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">2625</td>
<td style="text-align: right;">2762.7069</td>
<td style="text-align: right;">-137.706897</td>
<td style="text-align: right;">-0.86559211</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2847</td>
<td style="text-align: right;">2874.6897</td>
<td style="text-align: right;">-27.689655</td>
<td style="text-align: right;">-0.16429930</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">2628</td>
<td style="text-align: right;">2874.6897</td>
<td style="text-align: right;">-246.689655</td>
<td style="text-align: right;">-1.46375741</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2795</td>
<td style="text-align: right;">2986.6724</td>
<td style="text-align: right;">-191.672414</td>
<td style="text-align: right;">-1.11015989</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">3176</td>
<td style="text-align: right;">2986.6724</td>
<td style="text-align: right;">189.327586</td>
<td style="text-align: right;">1.09657874</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">2975</td>
<td style="text-align: right;">2986.6724</td>
<td style="text-align: right;">-11.672414</td>
<td style="text-align: right;">-0.06760621</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">2968</td>
<td style="text-align: right;">3210.6379</td>
<td style="text-align: right;">-242.637931</td>
<td style="text-align: right;">-1.46158646</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3163</td>
<td style="text-align: right;">3210.6379</td>
<td style="text-align: right;">-47.637931</td>
<td style="text-align: right;">-0.28695825</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3473</td>
<td style="text-align: right;">3210.6379</td>
<td style="text-align: right;">262.362069</td>
<td style="text-align: right;">1.58039943</td>
</tr>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3421</td>
<td style="text-align: right;">3210.6379</td>
<td style="text-align: right;">210.362069</td>
<td style="text-align: right;">1.26716524</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">3292</td>
<td style="text-align: right;">3322.6207</td>
<td style="text-align: right;">-30.620690</td>
<td style="text-align: right;">-0.19805434</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now let’s build histograms:</p>
</section><section id="marginal-distribution-of-nonstandardized-residuals" class="level4"><h4 class="anchored" data-anchor-id="marginal-distribution-of-nonstandardized-residuals">Marginal distribution of (nonstandardized) residuals</h4>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">resid_marginal_hist</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">resid_lm2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">resid_marginal_hist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c0eeb36a3c994ce17ca6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c0eeb36a3c994ce17ca6">{"x":{"data":[{"orientation":"v","width":[17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737226,17.964328180737198,17.964328180737226,17.964328180737198,17.964328180737198,17.964328180737226,17.964328180737198,17.964328180737226,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737255,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737255,17.964328180737198,17.964328180737198,17.964328180737198,17.964328180737255,17.964328180737198],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[-251.50059453032094,-233.53626634958374,-215.57193816884651,-197.60760998810929,-179.64328180737209,-161.67895362663489,-143.7146254458977,-125.75029726516048,-107.78596908442327,-89.82164090368606,-71.857312722948848,-53.89298454221165,-35.928656361474438,-17.964328180737226,-1.4210854715202004e-14,17.964328180737198,35.928656361474395,53.892984542211593,71.857312722948819,89.821640903686045,107.78596908442324,125.75029726516044,143.71462544589764,161.67895362663484,179.64328180737206,197.60760998810929,215.57193816884649,233.53626634958368,251.50059453032091,269.46492271105814],"y":[2,0,0,1,0,0,4,2,0,0,1,2,2,1,0,0,0,1,0,0,0,0,0,1,2,1,1,0,1,2],"text":["count: 2<br />resid_lm2: -2.5150059e+02","count: 0<br />resid_lm2: -2.3353627e+02","count: 0<br />resid_lm2: -2.1557194e+02","count: 1<br />resid_lm2: -1.9760761e+02","count: 0<br />resid_lm2: -1.7964328e+02","count: 0<br />resid_lm2: -1.6167895e+02","count: 4<br />resid_lm2: -1.4371463e+02","count: 2<br />resid_lm2: -1.2575030e+02","count: 0<br />resid_lm2: -1.0778597e+02","count: 0<br />resid_lm2: -8.9821641e+01","count: 1<br />resid_lm2: -7.1857313e+01","count: 2<br />resid_lm2: -5.3892985e+01","count: 2<br />resid_lm2: -3.5928656e+01","count: 1<br />resid_lm2: -1.7964328e+01","count: 0<br />resid_lm2: -1.4210855e-14","count: 0<br />resid_lm2:  1.7964328e+01","count: 0<br />resid_lm2:  3.5928656e+01","count: 1<br />resid_lm2:  5.3892985e+01","count: 0<br />resid_lm2:  7.1857313e+01","count: 0<br />resid_lm2:  8.9821641e+01","count: 0<br />resid_lm2:  1.0778597e+02","count: 0<br />resid_lm2:  1.2575030e+02","count: 0<br />resid_lm2:  1.4371463e+02","count: 1<br />resid_lm2:  1.6167895e+02","count: 2<br />resid_lm2:  1.7964328e+02","count: 1<br />resid_lm2:  1.9760761e+02","count: 1<br />resid_lm2:  2.1557194e+02","count: 0<br />resid_lm2:  2.3353627e+02","count: 1<br />resid_lm2:  2.5150059e+02","count: 2<br />resid_lm2:  2.6946492e+02"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":31.415525114155255},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-287.42925089179533,305.39357907253253],"tickmode":"array","ticktext":["-200","-100","0","100","200","300"],"tickvals":[-200,-100,0,100,200,300.00000000000006],"categoryorder":"array","categoryarray":["-200","-100","0","100","200","300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"resid_lm2","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.20000000000000001,4.2000000000000002],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"11ec81267a74d":{"x":{},"type":"bar"}},"cur_data":"11ec81267a74d","visdat":{"11ec81267a74d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Hard to tell with this small amount of data, but I’m a bit concerned that the histogram doesn’t show a bell-curve shape.</p>
<section id="marginal-distribution-of-standardized-residuals" class="level5"><h5 class="anchored" data-anchor-id="marginal-distribution-of-standardized-residuals">Marginal distribution of standardized residuals</h5>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">std_resid_marginal_hist</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">std_resid_lm2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">std_resid_marginal_hist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-bfc58801af474c65660a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bfc58801af474c65660a">{"x":{"data":[{"orientation":"v","width":[0.11648398027849849,0.11648398027849804,0.11648398027849849,0.11648398027849804,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849827,0.11648398027849849,0.11648398027849849,0.11648398027849827,0.11648398027849849,0.11648398027849827,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849804,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849804,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849849,0.11648398027849804],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[-1.5142917436204792,-1.397807763341981,-1.2813237830634825,-1.164839802784984,-1.0483558225064857,-0.93187184222798725,-0.81538786194948876,-0.69890388167099049,-0.582419901392492,-0.46593592111399362,-0.34945194083549524,-0.23296796055699676,-0.11648398027849838,0,0.11648398027849838,0.23296796055699676,0.34945194083549524,0.46593592111399373,0.582419901392492,0.69890388167099027,0.81538786194948876,0.93187184222798725,1.0483558225064857,1.1648398027849842,1.2813237830634825,1.3978077633419808,1.5142917436204792,1.6307757238989777,1.7472597041774762,1.8637436844559745],"y":[2,0,0,1,0,3,2,1,0,0,2,2,2,0,0,0,1,0,0,0,0,1,2,1,1,1,0,1,0,1],"text":["count: 2<br />std_resid_lm2: -1.51429174","count: 0<br />std_resid_lm2: -1.39780776","count: 0<br />std_resid_lm2: -1.28132378","count: 1<br />std_resid_lm2: -1.16483980","count: 0<br />std_resid_lm2: -1.04835582","count: 3<br />std_resid_lm2: -0.93187184","count: 2<br />std_resid_lm2: -0.81538786","count: 1<br />std_resid_lm2: -0.69890388","count: 0<br />std_resid_lm2: -0.58241990","count: 0<br />std_resid_lm2: -0.46593592","count: 2<br />std_resid_lm2: -0.34945194","count: 2<br />std_resid_lm2: -0.23296796","count: 2<br />std_resid_lm2: -0.11648398","count: 0<br />std_resid_lm2:  0.00000000","count: 0<br />std_resid_lm2:  0.11648398","count: 0<br />std_resid_lm2:  0.23296796","count: 1<br />std_resid_lm2:  0.34945194","count: 0<br />std_resid_lm2:  0.46593592","count: 0<br />std_resid_lm2:  0.58241990","count: 0<br />std_resid_lm2:  0.69890388","count: 0<br />std_resid_lm2:  0.81538786","count: 1<br />std_resid_lm2:  0.93187184","count: 2<br />std_resid_lm2:  1.04835582","count: 1<br />std_resid_lm2:  1.16483980","count: 1<br />std_resid_lm2:  1.28132378","count: 1<br />std_resid_lm2:  1.39780776","count: 0<br />std_resid_lm2:  1.51429174","count: 1<br />std_resid_lm2:  1.63077572","count: 0<br />std_resid_lm2:  1.74725970","count: 1<br />std_resid_lm2:  1.86374368"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":31.415525114155255},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.747259704177476,2.096711645012971],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"std_resid_lm2","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.15000000000000002,3.1499999999999999],"tickmode":"array","ticktext":["0","1","2","3"],"tickvals":[0,0.99999999999999989,2,3],"categoryorder":"array","categoryarray":["0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"11ec8147ef12":{"x":{},"type":"bar"}},"cur_data":"11ec8147ef12","visdat":{"11ec8147ef12":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This looks similar, although the scale of the x-axis got narrower, because we divided by <span class="math inline">\(\hat\sigma\)</span> (roughly speaking).</p>
<p>Still hard to tell if the distribution is Gaussian.</p>
</section></section></section><section id="qq-plot-of-standardized-residuals" class="level3" data-number="2.8.3"><h3 data-number="2.8.3" class="anchored" data-anchor-id="qq-plot-of-standardized-residuals">
<span class="header-section-number">2.8.3</span> QQ plot of standardized residuals</h3>
<p>Another way to assess normality is the QQ plot of the standardized residuals versus normal quantiles:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify">ggfortify</a></span><span class="op">)</span> </span>
<span><span class="co"># needed to make ggplot2::autoplot() work for `lm` objects</span></span>
<span></span>
<span><span class="va">qqplot_lm2_auto</span> <span class="op">=</span> </span>
<span>  <span class="va">bw_lm2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span></span>
<span>    which <span class="op">=</span> <span class="fl">2</span>, <span class="co"># options are 1:6; can do multiple at once</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">qqplot_lm2_auto</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If the Gaussian model were correct, these points should follow the dotted line.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Fig 2.4 panel (c) in Dobson is a little different; they didn’t specify how they produced it, but other statistical analysis systems do things differently from R.</p>
</div>
</div>
<section id="qq-plot---how-its-built" class="level4"><h4 class="anchored" data-anchor-id="qq-plot---how-its-built">QQ plot - how it’s built</h4>
<p>Let’s construct it by hand:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">=</span> <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    p <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">std_resid_lm2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># "Blom's method"</span></span>
<span>    expected_quantiles_lm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">qqplot_lm2</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">expected_quantiles_lm2</span>, </span>
<span>      y <span class="op">=</span> <span class="va">std_resid_lm2</span>, </span>
<span>      col <span class="op">=</span> <span class="va">sex</span>, </span>
<span>      shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">'none'</span><span class="op">)</span> <span class="op">+</span> <span class="co"># removing the plot legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Normal Q-Q"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Theoretical Quantiles"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Standardized residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We find the expected line like so:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.75</span><span class="op">)</span>                  <span class="co"># reference probabilities</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span>, <span class="va">ps</span><span class="op">)</span>  <span class="co"># empirical quantiles</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span>                     <span class="co"># theoretical quantiles</span></span>
<span></span>
<span><span class="va">qq_slope</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="va">qq_intcpt</span> <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">qq_slope</span></span>
<span></span>
<span><span class="va">qqplot_lm2</span> <span class="op">=</span> </span>
<span>  <span class="va">qqplot_lm2</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="va">qq_slope</span>, intercept <span class="op">=</span> <span class="va">qq_intcpt</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">qqplot_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-33c0707a35eb4ddf3937" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-33c0707a35eb4ddf3937">{"x":{"data":[{"x":[0.88714655901887585,-1.0544724517700528,-0.74159404386151651,-0.15731068461017067,0.61029461018633246,-0.37409541019772347,-0.26414697682592359,1.2581615610630972,-0.48877641111466941,0.37409541019772358,0.48877641111466941,-0.88714655901887585],"y":[1.1598166040138622,-0.92601091190364337,-0.87479165935721714,-0.34722553413920726,1.0350664858662388,-0.73473146215227003,-0.39900857766042508,1.4375164217020691,-0.82538717619706636,0.30606462275250113,0.92806692060435803,-0.87615924904963072],"text":["expected_quantiles_lm2:  0.88714656<br />std_resid_lm2:  1.159816604<br />sex: female<br />sex: female","expected_quantiles_lm2: -1.05447245<br />std_resid_lm2: -0.926010912<br />sex: female<br />sex: female","expected_quantiles_lm2: -0.74159404<br />std_resid_lm2: -0.874791659<br />sex: female<br />sex: female","expected_quantiles_lm2: -0.15731068<br />std_resid_lm2: -0.347225534<br />sex: female<br />sex: female","expected_quantiles_lm2:  0.61029461<br />std_resid_lm2:  1.035066486<br />sex: female<br />sex: female","expected_quantiles_lm2: -0.37409541<br />std_resid_lm2: -0.734731462<br />sex: female<br />sex: female","expected_quantiles_lm2: -0.26414698<br />std_resid_lm2: -0.399008578<br />sex: female<br />sex: female","expected_quantiles_lm2:  1.25816156<br />std_resid_lm2:  1.437516422<br />sex: female<br />sex: female","expected_quantiles_lm2: -0.48877641<br />std_resid_lm2: -0.825387176<br />sex: female<br />sex: female","expected_quantiles_lm2:  0.37409541<br />std_resid_lm2:  0.306064623<br />sex: female<br />sex: female","expected_quantiles_lm2:  0.48877641<br />std_resid_lm2:  0.928066921<br />sex: female<br />sex: female","expected_quantiles_lm2: -0.88714656<br />std_resid_lm2: -0.876159249<br />sex: female<br />sex: female"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"female","legendgroup":"female","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.0368341317013874,-0.6102946101863328,0.15731068461017067,-2.0368341317013887,-1.2581615610630965,0.74159404386151651,0.26414697682592347,-1.5341205443525459,-0.05224518037594035,1.5341205443525459,1.0544724517700528,0.052245180375940496],"y":[1.9142780218641546,-0.86559211299437477,-0.16429930069729987,-1.4637574062122991,-1.1101598943215265,1.0965787352293495,-0.067606211069144315,-1.4615864587633849,-0.28695824526136698,1.5803994274854296,1.2671652372182252,-0.19805433812125872],"text":["expected_quantiles_lm2:  2.03683413<br />std_resid_lm2:  1.914278022<br />sex: male<br />sex: male","expected_quantiles_lm2: -0.61029461<br />std_resid_lm2: -0.865592113<br />sex: male<br />sex: male","expected_quantiles_lm2:  0.15731068<br />std_resid_lm2: -0.164299301<br />sex: male<br />sex: male","expected_quantiles_lm2: -2.03683413<br />std_resid_lm2: -1.463757406<br />sex: male<br />sex: male","expected_quantiles_lm2: -1.25816156<br />std_resid_lm2: -1.110159894<br />sex: male<br />sex: male","expected_quantiles_lm2:  0.74159404<br />std_resid_lm2:  1.096578735<br />sex: male<br />sex: male","expected_quantiles_lm2:  0.26414698<br />std_resid_lm2: -0.067606211<br />sex: male<br />sex: male","expected_quantiles_lm2: -1.53412054<br />std_resid_lm2: -1.461586459<br />sex: male<br />sex: male","expected_quantiles_lm2: -0.05224518<br />std_resid_lm2: -0.286958245<br />sex: male<br />sex: male","expected_quantiles_lm2:  1.53412054<br />std_resid_lm2:  1.580399427<br />sex: male<br />sex: male","expected_quantiles_lm2:  1.05447245<br />std_resid_lm2:  1.267165237<br />sex: male<br />sex: male","expected_quantiles_lm2:  0.05224518<br />std_resid_lm2: -0.198054338<br />sex: male<br />sex: male"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"triangle-up","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"male","legendgroup":"male","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.2405175448715275,2.2405175448715262],"y":[-3.0948853323309331,3.2774378809528626],"text":"intercept: 0.091276274<br />slope: 1.422065","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Normal Q-Q","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.2405175448715275,2.2405175448715262],"tickmode":"array","ticktext":["-2","-1","0","1","2"],"tickvals":[-2,-0.99999999999999978,0,1,2.0000000000000004],"categoryorder":"array","categoryarray":["-2","-1","0","1","2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Theoretical Quantiles","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.6326591776161219,2.0831797932679774],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1.0000000000000002,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Standardized residuals","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"11ec876b26618":{"x":{},"y":{},"colour":{},"shape":{},"type":"scatter"},"11ec83a4cee89":{"intercept":{},"slope":{}}},"cur_data":"11ec876b26618","visdat":{"11ec876b26618":["function (y) ","x"],"11ec83a4cee89":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section><section id="conditional-distributions-of-residuals" class="level3" data-number="2.8.4"><h3 data-number="2.8.4" class="anchored" data-anchor-id="conditional-distributions-of-residuals">
<span class="header-section-number">2.8.4</span> Conditional distributions of residuals</h3>
<p>If our Gaussian linear regression model is correct, the residuals <span class="math inline">\(e_i\)</span> and standardized residuals <span class="math inline">\(r_i\)</span> should have:</p>
<ul>
<li>an approximately Gaussian distribution, with:</li>
<li>a mean of 0</li>
<li>a constant variance</li>
</ul>
<p>This should be true <strong>regardless</strong> of the value of <span class="math inline">\(X\)</span>.</p>
<p>But if we didn’t correctly guess the functional form of linear component of the mean, <span class="math display">\[\text{E}[Y|X=x] = \beta_0 + \beta_1 X_1 + ... + \beta_p X_p\]</span></p>
<p>Then the the residuals might have nonzero mean or nonconstant variance for some values of <span class="math inline">\(x\)</span>.</p>
<section id="residuals-versus-fitted-values" class="level4"><h4 class="anchored" data-anchor-id="residuals-versus-fitted-values">Residuals versus fitted values</h4>
<p>To look for these issues, we can plot the residuals <span class="math inline">\(e_i\)</span> against the fitted values <span class="math inline">\(\hat y_i\)</span>:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">bw_lm2</span>, which <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If the model is correct, the blue line should stay flat and close to 0, and the cloud of dots should have the same vertical spread regardless of the fitted value.</p>
<p>If not, we probably need to change the functional form of linear component of the mean, <span class="math display">\[\text{E}[Y|X=x] = \beta_0 + \beta_1 X_1 + ... + \beta_p X_p\]</span></p>
</section><section id="scale-location-plot" class="level4"><h4 class="anchored" data-anchor-id="scale-location-plot">Scale-location plot</h4>
<p>We can also plot the square roots of the absolute values of the standardized residuals against the fitted values:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">bw_lm2</span>, which <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, the blue line doesn’t need to be near 0, but it should be flat. If not, the residual variance <span class="math inline">\(\sigma^2\)</span> might not be constant, and we might need to transform our outcome <span class="math inline">\(Y\)</span> (or use a model that allows non-constant variance).</p>
</section><section id="residuals-versus-leverage" class="level4"><h4 class="anchored" data-anchor-id="residuals-versus-leverage">Residuals versus leverage</h4>
<p>We can also plot our standardized residuals against “leverage”, which roughly speaking is a measure of how unusual each <span class="math inline">\(x_i\)</span> value is. Very unusual <span class="math inline">\(x_i\)</span> values can have extreme effects on the model fit, so we might want ot remove those observations as outliers, particularly if they have large residuals.</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">bw_lm2</span>, which <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The blue line should be relatively flat and close to 0 here.</p>
</section></section><section id="diagnostics-constructed-by-hand" class="level3" data-number="2.8.5"><h3 data-number="2.8.5" class="anchored" data-anchor-id="diagnostics-constructed-by-hand">
<span class="header-section-number">2.8.5</span> Diagnostics constructed by hand</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">=</span> </span>
<span>  <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    predlm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span>,</span>
<span>    residlm2 <span class="op">=</span> <span class="va">weight</span> <span class="op">-</span> <span class="va">predlm2</span>,</span>
<span>    std_resid <span class="op">=</span> <span class="va">residlm2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html">sigma</a></span><span class="op">(</span><span class="va">bw_lm2</span><span class="op">)</span>,</span>
<span>    <span class="co"># std_resid_builtin = rstandard(bw_lm2), # uses leverage</span></span>
<span>    sqrt_abs_std_resid <span class="op">=</span> <span class="va">std_resid</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="residuals-vs-fitted" class="level5"><h5 class="anchored" data-anchor-id="residuals-vs-fitted">Residuals vs fitted</h5>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">resid_vs_fit</span> <span class="op">=</span> <span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">predlm2</span>, y <span class="op">=</span> <span class="va">residlm2</span>, col <span class="op">=</span> <span class="va">sex</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">resid_vs_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="standardized-residuals-vs-fitted" class="level5"><h5 class="anchored" data-anchor-id="standardized-residuals-vs-fitted">Standardized residuals vs fitted</h5>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">predlm2</span>, y <span class="op">=</span> <span class="va">std_resid</span>, col <span class="op">=</span> <span class="va">sex</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="standardized-residuals-vs-gestational-age" class="level5"><h5 class="anchored" data-anchor-id="standardized-residuals-vs-gestational-age">Standardized residuals vs gestational age</h5>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">std_resid</span>, col <span class="op">=</span> <span class="va">sex</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="sqrtabsrstandard-vs-fitted" class="level5"><h5 class="anchored" data-anchor-id="sqrtabsrstandard-vs-fitted">
<code>sqrt(abs(rstandard()))</code> vs fitted</h5>
<p>Compare with <code>autoplot(bw_lm2, 3)</code></p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bw</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">predlm2</span>, y <span class="op">=</span> <span class="va">sqrt_abs_std_resid</span>, col <span class="op">=</span> <span class="va">sex</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Linear-models-overview_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="model-selection" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="model-selection">
<span class="header-section-number">2.9</span> Model selection</h2>
<p>If we have a lot of covariates in our dataset, we might want to choose a small subset to use in our model.</p>
<p>There are a few possible metrics to consider for choosing a “best” model.</p>
<section id="mean-squared-error" class="level3" data-number="2.9.1"><h3 data-number="2.9.1" class="anchored" data-anchor-id="mean-squared-error">
<span class="header-section-number">2.9.1</span> Mean squared error</h3>
<p>We might want to minimize the <strong>mean squared error</strong>, <span class="math inline">\(\text E[(y-\hat y)^2]\)</span>, for new observations that weren’t in our data set when we fit the model.</p>
<p>Unfortunately, <span class="math display">\[\frac{1}{n}\sum_{i=1}^n (y_i-\hat y_i)^2\]</span> gives a biased estimate of <span class="math inline">\(\text E[(y-\hat y)^2]\)</span> for new data. If we want an unbiased estimate, we will have to be clever.</p>
</section><section id="cross-validation" class="level3" data-number="2.9.2"><h3 data-number="2.9.2" class="anchored" data-anchor-id="cross-validation">
<span class="header-section-number">2.9.2</span> Cross-validation</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"carbohydrate"</span>, package <span class="op">=</span> <span class="st">"dobson"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">cvTools</span><span class="op">)</span></span>
<span><span class="va">full.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">carbohydrate</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">carbohydrate</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/cvTools/man/cvFit.html">cvFit</a></span><span class="op">(</span><span class="va">full.model</span>, data <span class="op">=</span> <span class="va">carbohydrate</span>, K <span class="op">=</span> <span class="fl">5</span>, R <span class="op">=</span> <span class="fl">10</span>,</span>
<span>y <span class="op">=</span> <span class="va">carbohydrate</span><span class="op">$</span><span class="va">carbohydrate</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="categorical-covariates-with-more-than-two-levels" class="level2" data-number="2.10"><h2 data-number="2.10" class="anchored" data-anchor-id="categorical-covariates-with-more-than-two-levels">
<span class="header-section-number">2.10</span> Categorical covariates with more than two levels</h2>
<section id="example-birthweight" class="level3" data-number="2.10.1"><h3 data-number="2.10.1" class="anchored" data-anchor-id="example-birthweight">
<span class="header-section-number">2.10.1</span> Example: <code>birthweight</code>
</h3>
<p>In the birthweight example, the variable <code>sex</code> had only two observed values:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bw</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "female" "male"  </code></pre>
</div>
</div>
<p>If there are more than two observed values, we can’t just use a single variable with 0s and 1s.</p>
</section><section id="section-1" class="level3" data-number="2.10.2"><h3 data-number="2.10.2" class="anchored" data-anchor-id="section-1">
<span class="header-section-number">2.10.2</span> </h3>
<p>For example, here’s the (in)famous <code>iris</code> data:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Sepal.Length</th>
<th style="text-align: right;">Sepal.Width</th>
<th style="text-align: right;">Petal.Length</th>
<th style="text-align: right;">Petal.Width</th>
<th style="text-align: left;">Species</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.3</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: left;">setosa</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.2</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: left;">versicolor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.3</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.3</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.9</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.4</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.8</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">5.7</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.7</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.3</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.2</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">5.4</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: left;">virginica</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: left;">virginica</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 19%">
<col style="width: 18%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Sepal.Length</th>
<th style="text-align: left;">Sepal.Width</th>
<th style="text-align: left;">Petal.Length</th>
<th style="text-align: left;">Petal.Width</th>
<th style="text-align: left;">Species</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Min. :4.3000</td>
<td style="text-align: left;">Min. :2.0000</td>
<td style="text-align: left;">Min. :1.000</td>
<td style="text-align: left;">Min. :0.1000</td>
<td style="text-align: left;">setosa :50</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">1st Qu.:5.1000</td>
<td style="text-align: left;">1st Qu.:2.8000</td>
<td style="text-align: left;">1st Qu.:1.600</td>
<td style="text-align: left;">1st Qu.:0.3000</td>
<td style="text-align: left;">versicolor:50</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Median :5.8000</td>
<td style="text-align: left;">Median :3.0000</td>
<td style="text-align: left;">Median :4.350</td>
<td style="text-align: left;">Median :1.3000</td>
<td style="text-align: left;">virginica :50</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean :5.8433</td>
<td style="text-align: left;">Mean :3.0573</td>
<td style="text-align: left;">Mean :3.758</td>
<td style="text-align: left;">Mean :1.1993</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">3rd Qu.:6.4000</td>
<td style="text-align: left;">3rd Qu.:3.3000</td>
<td style="text-align: left;">3rd Qu.:5.100</td>
<td style="text-align: left;">3rd Qu.:1.8000</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Max. :7.9000</td>
<td style="text-align: left;">Max. :4.4000</td>
<td style="text-align: left;">Max. :6.900</td>
<td style="text-align: left;">Max. :2.5000</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="section-2" class="level3" data-number="2.10.3"><h3 data-number="2.10.3" class="anchored" data-anchor-id="section-2">
<span class="header-section-number">2.10.3</span> </h3>
<p>There are three species:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] setosa     versicolor virginica 
Levels: setosa versicolor virginica</code></pre>
</div>
</div>
</section><section id="section-3" class="level3" data-number="2.10.4"><h3 data-number="2.10.4" class="anchored" data-anchor-id="section-3">
<span class="header-section-number">2.10.4</span> </h3>
<p>If we want to model <code>Sepal.Length</code> by species, we could create a variable <span class="math inline">\(X\)</span> that represents “setosa” as <span class="math inline">\(X=1\)</span>, “virginica” as <span class="math inline">\(X=2\)</span>, and “versicolor” as <span class="math inline">\(X=3\)</span>.</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="co"># this step is not always necessary, but ensures you're starting  </span></span>
<span><span class="co"># from the original version of a dataset stored in a loaded package</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op">=</span> </span>
<span>  <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">Species</span> <span class="op">==</span> <span class="st">"setosa"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      <span class="va">Species</span> <span class="op">==</span> <span class="st">"virginica"</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>      <span class="va">Species</span> <span class="op">==</span> <span class="st">"versicolor"</span> <span class="op">~</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">Species</span>, <span class="va">X</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  Species        X
  &lt;fct&gt;      &lt;dbl&gt;
1 setosa         1
2 versicolor     3
3 virginica      2</code></pre>
</div>
</div>
<p>Then we could fit a model like:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_lm1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris_lm1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(148)</th>
<th style="text-align: center;">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">4.91</td>
<td style="text-align: center;">0.16</td>
<td style="text-align: center;">(4.60, 5.23)</td>
<td style="text-align: center;">30.83</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">X</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">(0.32, 0.61)</td>
<td style="text-align: center;">6.30</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="lets-see-how-that-model-looks" class="level3" data-number="2.10.5"><h3 data-number="2.10.5" class="anchored" data-anchor-id="lets-see-how-that-model-looks">
<span class="header-section-number">2.10.5</span> Let’s see how that model looks:</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_plot1</span> <span class="op">=</span> <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">X</span>, </span>
<span>      y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">iris_lm1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>    slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">iris_lm1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">iris_plot1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-452bf4d1c26751390c0a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-452bf4d1c26751390c0a">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"y":[5.0999999999999996,4.9000000000000004,4.7000000000000002,4.5999999999999996,5,5.4000000000000004,4.5999999999999996,5,4.4000000000000004,4.9000000000000004,5.4000000000000004,4.7999999999999998,4.7999999999999998,4.2999999999999998,5.7999999999999998,5.7000000000000002,5.4000000000000004,5.0999999999999996,5.7000000000000002,5.0999999999999996,5.4000000000000004,5.0999999999999996,4.5999999999999996,5.0999999999999996,4.7999999999999998,5,5,5.2000000000000002,5.2000000000000002,4.7000000000000002,4.7999999999999998,5.4000000000000004,5.2000000000000002,5.5,4.9000000000000004,5,5.5,4.9000000000000004,4.4000000000000004,5.0999999999999996,5,4.5,4.4000000000000004,5,5.0999999999999996,4.7999999999999998,5.0999999999999996,4.5999999999999996,5.2999999999999998,5,7,6.4000000000000004,6.9000000000000004,5.5,6.5,5.7000000000000002,6.2999999999999998,4.9000000000000004,6.5999999999999996,5.2000000000000002,5,5.9000000000000004,6,6.0999999999999996,5.5999999999999996,6.7000000000000002,5.5999999999999996,5.7999999999999998,6.2000000000000002,5.5999999999999996,5.9000000000000004,6.0999999999999996,6.2999999999999998,6.0999999999999996,6.4000000000000004,6.5999999999999996,6.7999999999999998,6.7000000000000002,6,5.7000000000000002,5.5,5.5,5.7999999999999998,6,5.4000000000000004,6,6.7000000000000002,6.2999999999999998,5.5999999999999996,5.5,5.5,6.0999999999999996,5.7999999999999998,5,5.5999999999999996,5.7000000000000002,5.7000000000000002,6.2000000000000002,5.0999999999999996,5.7000000000000002,6.2999999999999998,5.7999999999999998,7.0999999999999996,6.2999999999999998,6.5,7.5999999999999996,4.9000000000000004,7.2999999999999998,6.7000000000000002,7.2000000000000002,6.5,6.4000000000000004,6.7999999999999998,5.7000000000000002,5.7999999999999998,6.4000000000000004,6.5,7.7000000000000002,7.7000000000000002,6,6.9000000000000004,5.5999999999999996,7.7000000000000002,6.2999999999999998,6.7000000000000002,7.2000000000000002,6.2000000000000002,6.0999999999999996,6.4000000000000004,7.2000000000000002,7.4000000000000004,7.9000000000000004,6.4000000000000004,6.2999999999999998,6.0999999999999996,7.7000000000000002,6.2999999999999998,6.4000000000000004,6,6.9000000000000004,6.7000000000000002,6.9000000000000004,5.7999999999999998,6.7999999999999998,6.7000000000000002,6.7000000000000002,6.2999999999999998,6.5,6.2000000000000002,5.9000000000000004],"text":["X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 4.7","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 4.4","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 4.3","X: 1<br />Sepal.Length: 5.8","X: 1<br />Sepal.Length: 5.7","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 5.7","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.2","X: 1<br />Sepal.Length: 5.2","X: 1<br />Sepal.Length: 4.7","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 5.2","X: 1<br />Sepal.Length: 5.5","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.5","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 4.4","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 4.5","X: 1<br />Sepal.Length: 4.4","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.3","X: 1<br />Sepal.Length: 5.0","X: 3<br />Sepal.Length: 7.0","X: 3<br />Sepal.Length: 6.4","X: 3<br />Sepal.Length: 6.9","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 6.5","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 6.3","X: 3<br />Sepal.Length: 4.9","X: 3<br />Sepal.Length: 6.6","X: 3<br />Sepal.Length: 5.2","X: 3<br />Sepal.Length: 5.0","X: 3<br />Sepal.Length: 5.9","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 6.7","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.8","X: 3<br />Sepal.Length: 6.2","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.9","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 6.3","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 6.4","X: 3<br />Sepal.Length: 6.6","X: 3<br />Sepal.Length: 6.8","X: 3<br />Sepal.Length: 6.7","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 5.8","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 5.4","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 6.7","X: 3<br />Sepal.Length: 6.3","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 5.8","X: 3<br />Sepal.Length: 5.0","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 6.2","X: 3<br />Sepal.Length: 5.1","X: 3<br />Sepal.Length: 5.7","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 5.8","X: 2<br />Sepal.Length: 7.1","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 7.6","X: 2<br />Sepal.Length: 4.9","X: 2<br />Sepal.Length: 7.3","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 7.2","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.8","X: 2<br />Sepal.Length: 5.7","X: 2<br />Sepal.Length: 5.8","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 6.0","X: 2<br />Sepal.Length: 6.9","X: 2<br />Sepal.Length: 5.6","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 7.2","X: 2<br />Sepal.Length: 6.2","X: 2<br />Sepal.Length: 6.1","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 7.2","X: 2<br />Sepal.Length: 7.4","X: 2<br />Sepal.Length: 7.9","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.1","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.0","X: 2<br />Sepal.Length: 6.9","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 6.9","X: 2<br />Sepal.Length: 5.8","X: 2<br />Sepal.Length: 6.8","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 6.2","X: 2<br />Sepal.Length: 5.9"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.10000000000000001,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.90000000000000002,3.1000000000000001],"y":[5.3318333333333348,6.3548333333333362],"text":"intercept: 4.9133333<br />slope: 0.465","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":32.737235367372357,"r":11.955168119551683,"b":65.753424657534254,"l":51.407222914072236},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":23.910336239103362},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.90000000000000002,3.1000000000000001],"tickmode":"array","ticktext":["1.0","1.5","2.0","2.5","3.0"],"tickvals":[1,1.5,2,2.5,3],"categoryorder":"array","categoryarray":["1.0","1.5","2.0","2.5","3.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":5.9775840597758405,"tickwidth":1.0868334654137897,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":19.128268991282695},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":1.0868334654137897,"zeroline":false,"anchor":"y","title":{"text":"X","font":{"color":"rgba(0,0,0,1)","family":"","size":23.910336239103362}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[4.1200000000000001,8.0800000000000001],"tickmode":"array","ticktext":["5","6","7","8"],"tickvals":[5,6,7,8],"categoryorder":"array","categoryarray":["5","6","7","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":5.9775840597758414,"tickwidth":1.0868334654137897,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":19.128268991282695},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":1.0868334654137897,"zeroline":false,"anchor":"x","title":{"text":"Sepal.Length","font":{"color":"rgba(0,0,0,1)","family":"","size":23.910336239103362}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":1.0868334654137897,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":3.0923407301360055,"font":{"color":"rgba(0,0,0,1)","family":"","size":19.128268991282695}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"11ec825653f62":{"x":{},"y":{},"type":"scatter"},"11ec81a244e1c":{"intercept":{},"slope":{}}},"cur_data":"11ec825653f62","visdat":{"11ec825653f62":["function (y) ","x"],"11ec81a244e1c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We have forced the model to use a straight line for the three estimated means. Maybe not a good idea?</p>
</section><section id="lets-see-what-r-does-with-categorical-variables-by-default" class="level3" data-number="2.10.6"><h3 data-number="2.10.6" class="anchored" data-anchor-id="lets-see-what-r-does-with-categorical-variables-by-default">
<span class="header-section-number">2.10.6</span> Let’s see what R does with categorical variables by default:</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_lm2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris_lm2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(147)</th>
<th style="text-align: center;">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">5.01</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">(4.86, 5.15)</td>
<td style="text-align: center;">68.76</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Species (versicolor)</td>
<td style="text-align: center;">0.93</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">(0.73, 1.13)</td>
<td style="text-align: center;">9.03</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Species (virginica)</td>
<td style="text-align: center;">1.58</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">(1.38, 1.79)</td>
<td style="text-align: center;">15.37</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="re-parametrize-with-no-intercept" class="level3" data-number="2.10.7"><h3 data-number="2.10.7" class="anchored" data-anchor-id="re-parametrize-with-no-intercept">
<span class="header-section-number">2.10.7</span> Re-parametrize with no intercept</h3>
<p>If you don’t want the default and offset option, you can use “-1” like we’ve seen previously:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris.lm2b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Species</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris.lm2b</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://easystats.github.io/insight/reference/display.html">print_md</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Coefficient</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(147)</th>
<th style="text-align: center;">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Species (setosa)</td>
<td style="text-align: center;">5.01</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">(4.86, 5.15)</td>
<td style="text-align: center;">68.76</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">Species (versicolor)</td>
<td style="text-align: center;">5.94</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">(5.79, 6.08)</td>
<td style="text-align: center;">81.54</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Species (virginica)</td>
<td style="text-align: center;">6.59</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">(6.44, 6.73)</td>
<td style="text-align: center;">90.49</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="lets-see-what-these-new-models-look-like" class="level3" data-number="2.10.8"><h3 data-number="2.10.8" class="anchored" data-anchor-id="lets-see-what-these-new-models-look-like">
<span class="header-section-number">2.10.8</span> Let’s see what these new models look like:</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">iris_plot2</span> <span class="op">=</span> </span>
<span>  <span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    predlm2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">iris_lm2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">predlm2</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">iris_lm1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>    slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">iris_lm1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">iris_plot2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-88f520248466a1c2fe6b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-88f520248466a1c2fe6b">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"y":[5.0999999999999996,4.9000000000000004,4.7000000000000002,4.5999999999999996,5,5.4000000000000004,4.5999999999999996,5,4.4000000000000004,4.9000000000000004,5.4000000000000004,4.7999999999999998,4.7999999999999998,4.2999999999999998,5.7999999999999998,5.7000000000000002,5.4000000000000004,5.0999999999999996,5.7000000000000002,5.0999999999999996,5.4000000000000004,5.0999999999999996,4.5999999999999996,5.0999999999999996,4.7999999999999998,5,5,5.2000000000000002,5.2000000000000002,4.7000000000000002,4.7999999999999998,5.4000000000000004,5.2000000000000002,5.5,4.9000000000000004,5,5.5,4.9000000000000004,4.4000000000000004,5.0999999999999996,5,4.5,4.4000000000000004,5,5.0999999999999996,4.7999999999999998,5.0999999999999996,4.5999999999999996,5.2999999999999998,5,6.2999999999999998,5.7999999999999998,7.0999999999999996,6.2999999999999998,6.5,7.5999999999999996,4.9000000000000004,7.2999999999999998,6.7000000000000002,7.2000000000000002,6.5,6.4000000000000004,6.7999999999999998,5.7000000000000002,5.7999999999999998,6.4000000000000004,6.5,7.7000000000000002,7.7000000000000002,6,6.9000000000000004,5.5999999999999996,7.7000000000000002,6.2999999999999998,6.7000000000000002,7.2000000000000002,6.2000000000000002,6.0999999999999996,6.4000000000000004,7.2000000000000002,7.4000000000000004,7.9000000000000004,6.4000000000000004,6.2999999999999998,6.0999999999999996,7.7000000000000002,6.2999999999999998,6.4000000000000004,6,6.9000000000000004,6.7000000000000002,6.9000000000000004,5.7999999999999998,6.7999999999999998,6.7000000000000002,6.7000000000000002,6.2999999999999998,6.5,6.2000000000000002,5.9000000000000004,7,6.4000000000000004,6.9000000000000004,5.5,6.5,5.7000000000000002,6.2999999999999998,4.9000000000000004,6.5999999999999996,5.2000000000000002,5,5.9000000000000004,6,6.0999999999999996,5.5999999999999996,6.7000000000000002,5.5999999999999996,5.7999999999999998,6.2000000000000002,5.5999999999999996,5.9000000000000004,6.0999999999999996,6.2999999999999998,6.0999999999999996,6.4000000000000004,6.5999999999999996,6.7999999999999998,6.7000000000000002,6,5.7000000000000002,5.5,5.5,5.7999999999999998,6,5.4000000000000004,6,6.7000000000000002,6.2999999999999998,5.5999999999999996,5.5,5.5,6.0999999999999996,5.7999999999999998,5,5.5999999999999996,5.7000000000000002,5.7000000000000002,6.2000000000000002,5.0999999999999996,5.7000000000000002],"text":["X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 4.7","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 4.4","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 4.3","X: 1<br />Sepal.Length: 5.8","X: 1<br />Sepal.Length: 5.7","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 5.7","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.2","X: 1<br />Sepal.Length: 5.2","X: 1<br />Sepal.Length: 4.7","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 5.4","X: 1<br />Sepal.Length: 5.2","X: 1<br />Sepal.Length: 5.5","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.5","X: 1<br />Sepal.Length: 4.9","X: 1<br />Sepal.Length: 4.4","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 4.5","X: 1<br />Sepal.Length: 4.4","X: 1<br />Sepal.Length: 5.0","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.8","X: 1<br />Sepal.Length: 5.1","X: 1<br />Sepal.Length: 4.6","X: 1<br />Sepal.Length: 5.3","X: 1<br />Sepal.Length: 5.0","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 5.8","X: 2<br />Sepal.Length: 7.1","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 7.6","X: 2<br />Sepal.Length: 4.9","X: 2<br />Sepal.Length: 7.3","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 7.2","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.8","X: 2<br />Sepal.Length: 5.7","X: 2<br />Sepal.Length: 5.8","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 6.0","X: 2<br />Sepal.Length: 6.9","X: 2<br />Sepal.Length: 5.6","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 7.2","X: 2<br />Sepal.Length: 6.2","X: 2<br />Sepal.Length: 6.1","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 7.2","X: 2<br />Sepal.Length: 7.4","X: 2<br />Sepal.Length: 7.9","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.1","X: 2<br />Sepal.Length: 7.7","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.4","X: 2<br />Sepal.Length: 6.0","X: 2<br />Sepal.Length: 6.9","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 6.9","X: 2<br />Sepal.Length: 5.8","X: 2<br />Sepal.Length: 6.8","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 6.7","X: 2<br />Sepal.Length: 6.3","X: 2<br />Sepal.Length: 6.5","X: 2<br />Sepal.Length: 6.2","X: 2<br />Sepal.Length: 5.9","X: 3<br />Sepal.Length: 7.0","X: 3<br />Sepal.Length: 6.4","X: 3<br />Sepal.Length: 6.9","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 6.5","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 6.3","X: 3<br />Sepal.Length: 4.9","X: 3<br />Sepal.Length: 6.6","X: 3<br />Sepal.Length: 5.2","X: 3<br />Sepal.Length: 5.0","X: 3<br />Sepal.Length: 5.9","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 6.7","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.8","X: 3<br />Sepal.Length: 6.2","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.9","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 6.3","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 6.4","X: 3<br />Sepal.Length: 6.6","X: 3<br />Sepal.Length: 6.8","X: 3<br />Sepal.Length: 6.7","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 5.8","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 5.4","X: 3<br />Sepal.Length: 6.0","X: 3<br />Sepal.Length: 6.7","X: 3<br />Sepal.Length: 6.3","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 5.5","X: 3<br />Sepal.Length: 6.1","X: 3<br />Sepal.Length: 5.8","X: 3<br />Sepal.Length: 5.0","X: 3<br />Sepal.Length: 5.6","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 5.7","X: 3<br />Sepal.Length: 6.2","X: 3<br />Sepal.Length: 5.1","X: 3<br />Sepal.Length: 5.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0.10000000000000001,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"y":[5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,5.0059999999999985,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,6.5879999999999983,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991,5.9359999999999991],"text":["X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 1<br />predlm2: 5.006","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 2<br />predlm2: 6.588","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936","X: 3<br />predlm2: 5.936"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.90000000000000002,3.1000000000000001],"y":[5.3318333333333348,6.3548333333333362],"text":"intercept: 4.9133333<br />slope: 0.465","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":32.737235367372357,"r":11.955168119551683,"b":65.753424657534254,"l":51.407222914072236},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":23.910336239103362},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.90000000000000002,3.1000000000000001],"tickmode":"array","ticktext":["1.0","1.5","2.0","2.5","3.0"],"tickvals":[1,1.5,2,2.5,3],"categoryorder":"array","categoryarray":["1.0","1.5","2.0","2.5","3.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":5.9775840597758405,"tickwidth":1.0868334654137897,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":19.128268991282695},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":1.0868334654137897,"zeroline":false,"anchor":"y","title":{"text":"X","font":{"color":"rgba(0,0,0,1)","family":"","size":23.910336239103362}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[4.1200000000000001,8.0800000000000001],"tickmode":"array","ticktext":["5","6","7","8"],"tickvals":[5,6,7,8],"categoryorder":"array","categoryarray":["5","6","7","8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":5.9775840597758414,"tickwidth":1.0868334654137897,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":19.128268991282695},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":1.0868334654137897,"zeroline":false,"anchor":"x","title":{"text":"Sepal.Length","font":{"color":"rgba(0,0,0,1)","family":"","size":23.910336239103362}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":1.0868334654137897,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":3.0923407301360055,"font":{"color":"rgba(0,0,0,1)","family":"","size":19.128268991282695}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"11ebc4a27d5e8":{"x":{},"y":{},"type":"scatter"},"11ebc7d4c9860":{"x":{},"y":{}},"11ebc2fa806e4":{"intercept":{},"slope":{}}},"cur_data":"11ebc4a27d5e8","visdat":{"11ebc4a27d5e8":["function (y) ","x"],"11ebc7d4c9860":["function (y) ","x"],"11ebc2fa806e4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="lets-see-how-r-did-that" class="level3" data-number="2.10.9"><h3 data-number="2.10.9" class="anchored" data-anchor-id="lets-see-how-r-did-that">
<span class="header-section-number">2.10.9</span> Let’s see how R did that:</h3>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">iris_lm2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length ~ Species</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">iris_lm2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">Speciesversicolor</th>
<th style="text-align: right;">Speciesvirginica</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This is called a “corner point parametrization”.</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">iris.lm2b</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length ~ Species - 1</code></pre>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">iris.lm2b</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">Speciessetosa</th>
<th style="text-align: right;">Speciesversicolor</th>
<th style="text-align: right;">Speciesvirginica</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This can be called a “group point parametrization”.</p>
<p>There are more options; see Dobson &amp; Barnett §6.4.1.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-dobson2018introduction" class="csl-entry" role="listitem">
Dobson, Annette J, and Adrian G Barnett. 2018. <em>An Introduction to Generalized Linear Models</em>. 4th ed. CRC press. <a href="https://doi.org/10.1201/9781315182780">https://doi.org/10.1201/9781315182780</a>.
</div>
<div id="ref-dunn2018generalized" class="csl-entry" role="listitem">
Dunn, Peter K, Gordon K Smyth, et al. 2018. <em>Generalized Linear Models with Examples in r</em>. Vol. 53. Springer. <a href="https://link.springer.com/book/10.1007/978-1-4419-0118-7">https://link.springer.com/book/10.1007/978-1-4419-0118-7</a>.
</div>
<div id="ref-fieller2018basics" class="csl-entry" role="listitem">
Fieller, Nick. 2016. <em>Basics of Matrix Algebra for Statistics with r</em>. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9781315370200">https://doi.org/10.1201/9781315370200</a>.
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>using the definite article “the” would mean there is only one slope.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./glms.html" class="pagination-link" aria-label="Generalized Linear Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Generalized Linear Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./logistic-regression.html" class="pagination-link" aria-label="Models for Binary Outcomes">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models for Binary Outcomes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb139" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear (Gaussian) Models</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>{{&lt; include shared-config.qmd &gt;}}</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>This content is adapted from:</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@dobson2018introduction, Chapters 2-6</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@dunn2018generalized, Chapters 2-3 </span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include = FALSE}</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="in">options('digits' = 4)</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="in">pander::panderOptions("table.emphasize.rownames", FALSE)</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>Functions from these packages will be used throughout this document:</span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: library-calls</span></span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># compiling .qmd files</span></span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander) <span class="co"># format tables for markdown</span></span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># graphics</span></span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeasy) <span class="co"># help with graphics: </span></span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a><span class="co"># - `ggeasy::easy_labs()` applies same logic as `ggplot2::labs()` but uses as default the "label" attribute, if present, as the variable label in the plot."</span></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># manipulate data</span></span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven) <span class="co"># import Stata files</span></span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># Tools to help to create tidy data</span></span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co"># interactive graphics</span></span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dobson) <span class="co"># datasets from Dobson and Barnett 2018</span></span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters) <span class="co"># format model output tables for markdown</span></span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted) <span class="co"># check for conflicting function definitions</span></span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why this course includes linear regression {.smaller}</span></span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a>:::{.fragment .fade-in-then-semi-out}</span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>This course is about *generalized linear models* (for non-Gaussian outcomes)</span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a>:::{.fragment .fade-in-then-semi-out}</span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>UC Davis STA 108 ("Applied Statistical Methods: Regression Analysis") is a prerequisite for this course, so everyone here should have some understanding of linear regression already.</span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a>:::{.fragment .fade-in}</span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>We will review linear regression to:</span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>make sure everyone is caught up</span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>to provide an epidemiological perspective on model intepretation.</span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Chapter overview</span></span>
<span id="cb139-58"><a href="#cb139-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-59"><a href="#cb139-59" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>@sec-understand-LMs: how to interpret linear regression models</span>
<span id="cb139-60"><a href="#cb139-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-61"><a href="#cb139-61" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>@sec-est-LMs: how to estimate linear regression models</span>
<span id="cb139-62"><a href="#cb139-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-63"><a href="#cb139-63" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>@sec-infer-LMs: how to quantify uncertainty about our estimates</span>
<span id="cb139-64"><a href="#cb139-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-65"><a href="#cb139-65" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>@sec-diagnose-LMs: how to tell if your model is insufficiently complex</span>
<span id="cb139-66"><a href="#cb139-66" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb139-67"><a href="#cb139-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-68"><a href="#cb139-68" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding Gaussian Linear Regression Models {#sec-understand-LMs}</span></span>
<span id="cb139-69"><a href="#cb139-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-70"><a href="#cb139-70" aria-hidden="true" tabindex="-1"></a><span class="fu">### Motivating example: birthweights and gestational age {.smaller}</span></span>
<span id="cb139-71"><a href="#cb139-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-72"><a href="#cb139-72" aria-hidden="true" tabindex="-1"></a>Suppose we want to learn about the distributions of birthweights (*outcome* $Y$) for (human) babies born at different gestational ages (*covariate* $X_1$) and with different chromosomal sexes (*covariate* $X_2$) (@dobson2018introduction Example 2.2.2).</span>
<span id="cb139-73"><a href="#cb139-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-74"><a href="#cb139-74" aria-hidden="true" tabindex="-1"></a>::::: {.panel-tabset}</span>
<span id="cb139-75"><a href="#cb139-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-76"><a href="#cb139-76" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data as table</span></span>
<span id="cb139-77"><a href="#cb139-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-80"><a href="#cb139-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-81"><a href="#cb139-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-birthweight-data1</span></span>
<span id="cb139-82"><a href="#cb139-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "`birthweight` data (@dobson2018introduction Example 2.2.2)"</span></span>
<span id="cb139-83"><a href="#cb139-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dobson)</span>
<span id="cb139-84"><a href="#cb139-84" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"birthweight"</span>, <span class="at">package =</span> <span class="st">"dobson"</span>)</span>
<span id="cb139-85"><a href="#cb139-85" aria-hidden="true" tabindex="-1"></a>birthweight <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb139-86"><a href="#cb139-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-87"><a href="#cb139-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-88"><a href="#cb139-88" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Reshape data for graphing</span></span>
<span id="cb139-89"><a href="#cb139-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-92"><a href="#cb139-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-93"><a href="#cb139-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-birthweight-data2</span></span>
<span id="cb139-94"><a href="#cb139-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "`birthweight` data reshaped"</span></span>
<span id="cb139-95"><a href="#cb139-95" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> </span>
<span id="cb139-96"><a href="#cb139-96" aria-hidden="true" tabindex="-1"></a>  birthweight <span class="sc">|&gt;</span> </span>
<span id="cb139-97"><a href="#cb139-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb139-98"><a href="#cb139-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb139-99"><a href="#cb139-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">".value"</span>),</span>
<span id="cb139-100"><a href="#cb139-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"s "</span></span>
<span id="cb139-101"><a href="#cb139-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-102"><a href="#cb139-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> <span class="st">`</span><span class="at">gestational age</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb139-103"><a href="#cb139-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-104"><a href="#cb139-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> sex <span class="sc">|&gt;</span> </span>
<span id="cb139-105"><a href="#cb139-105" aria-hidden="true" tabindex="-1"></a>      <span class="fu">case_match</span>(</span>
<span id="cb139-106"><a href="#cb139-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">"boy"</span> <span class="sc">~</span> <span class="st">"male"</span>,</span>
<span id="cb139-107"><a href="#cb139-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">"girl"</span> <span class="sc">~</span> <span class="st">"female"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb139-108"><a href="#cb139-108" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)))</span>
<span id="cb139-109"><a href="#cb139-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-110"><a href="#cb139-110" aria-hidden="true" tabindex="-1"></a>bw</span>
<span id="cb139-111"><a href="#cb139-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-112"><a href="#cb139-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-113"><a href="#cb139-113" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data as graph</span></span>
<span id="cb139-114"><a href="#cb139-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-117"><a href="#cb139-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-118"><a href="#cb139-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot-birthweight1</span></span>
<span id="cb139-119"><a href="#cb139-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`birthweight` data (@dobson2018introduction Example 2.2.2)"</span></span>
<span id="cb139-120"><a href="#cb139-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb139-121"><a href="#cb139-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb139-122"><a href="#cb139-122" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">=</span> bw <span class="sc">|&gt;</span> </span>
<span id="cb139-123"><a href="#cb139-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb139-124"><a href="#cb139-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> age, </span>
<span id="cb139-125"><a href="#cb139-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> weight,</span>
<span id="cb139-126"><a href="#cb139-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> sex,</span>
<span id="cb139-127"><a href="#cb139-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> sex,</span>
<span id="cb139-128"><a href="#cb139-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> sex))  <span class="sc">+</span></span>
<span id="cb139-129"><a href="#cb139-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb139-130"><a href="#cb139-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Gestational age (weeks)"</span>) <span class="sc">+</span></span>
<span id="cb139-131"><a href="#cb139-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Birthweight (grams)"</span>) <span class="sc">+</span></span>
<span id="cb139-132"><a href="#cb139-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb139-133"><a href="#cb139-133" aria-hidden="true" tabindex="-1"></a>  <span class="co"># expand_limits(y = 0, x = 0) +</span></span>
<span id="cb139-134"><a href="#cb139-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">7</span>)</span>
<span id="cb139-135"><a href="#cb139-135" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot1 <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> sex))</span>
<span id="cb139-136"><a href="#cb139-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-137"><a href="#cb139-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-138"><a href="#cb139-138" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb139-139"><a href="#cb139-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-140"><a href="#cb139-140" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-141"><a href="#cb139-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-142"><a href="#cb139-142" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data notation</span></span>
<span id="cb139-143"><a href="#cb139-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-144"><a href="#cb139-144" aria-hidden="true" tabindex="-1"></a>Let's define some notation to represent this data.</span>
<span id="cb139-145"><a href="#cb139-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-146"><a href="#cb139-146" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$Y$: birthweight (measured in grams)</span>
<span id="cb139-147"><a href="#cb139-147" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$X_1$: chromosomal sex:</span>
<span id="cb139-148"><a href="#cb139-148" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$X_1 = 0$ if female (XX)</span>
<span id="cb139-149"><a href="#cb139-149" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$X_1 = 1$ if male (XY)</span>
<span id="cb139-150"><a href="#cb139-150" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$X_2$: gestational age at birth (measured in weeks).</span>
<span id="cb139-151"><a href="#cb139-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-152"><a href="#cb139-152" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb139-153"><a href="#cb139-153" aria-hidden="true" tabindex="-1"></a>Female is the **reference level** for the categorical variable $X_1$ (chromosomal sex). The choice of a reference level is arbitrary and does not limit what we can do with the resulting model; it only makes it more computationally convenient to make inferences about comparisons involving that reference group.</span>
<span id="cb139-154"><a href="#cb139-154" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-155"><a href="#cb139-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-156"><a href="#cb139-156" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parallel lines regression</span></span>
<span id="cb139-157"><a href="#cb139-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-158"><a href="#cb139-158" aria-hidden="true" tabindex="-1"></a>We don't have enough data to model the distribution of birth weight separately for each combination of gestational age and sex, so let's instead consider a (relatively) simple model for how that distribution varies with gestational age and sex:</span>
<span id="cb139-159"><a href="#cb139-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-160"><a href="#cb139-160" aria-hidden="true" tabindex="-1"></a>$$p(y|x_1,x_2) \iid N(\mu(x_1,x_2), \sigma^2)$$</span>
<span id="cb139-161"><a href="#cb139-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-162"><a href="#cb139-162" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-163"><a href="#cb139-163" aria-hidden="true" tabindex="-1"></a>\ba</span>
<span id="cb139-164"><a href="#cb139-164" aria-hidden="true" tabindex="-1"></a>\mu(x_1,x_2)</span>
<span id="cb139-165"><a href="#cb139-165" aria-hidden="true" tabindex="-1"></a>&amp;\eqdef \Exp{Y|X_1=x_1, X_2=x_2} <span class="sc">\\</span></span>
<span id="cb139-166"><a href="#cb139-166" aria-hidden="true" tabindex="-1"></a>&amp;= \beta_0 + \beta_1 x_1+ \beta_2 x_2</span>
<span id="cb139-167"><a href="#cb139-167" aria-hidden="true" tabindex="-1"></a>\ea</span>
<span id="cb139-168"><a href="#cb139-168" aria-hidden="true" tabindex="-1"></a>$$ {#eq-lm-parallel}</span>
<span id="cb139-169"><a href="#cb139-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-170"><a href="#cb139-170" aria-hidden="true" tabindex="-1"></a>:::{.notes}</span>
<span id="cb139-171"><a href="#cb139-171" aria-hidden="true" tabindex="-1"></a>@tbl-lm-parallel shows the parameter estimates from R.</span>
<span id="cb139-172"><a href="#cb139-172" aria-hidden="true" tabindex="-1"></a>@fig-parallel-fit1 shows the estimated model, superimposed on the data.</span>
<span id="cb139-173"><a href="#cb139-173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-174"><a href="#cb139-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-175"><a href="#cb139-175" aria-hidden="true" tabindex="-1"></a>::: {.column width=40%}</span>
<span id="cb139-176"><a href="#cb139-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-179"><a href="#cb139-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-180"><a href="#cb139-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-lm-parallel</span></span>
<span id="cb139-181"><a href="#cb139-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Estimate of @eq-lm-parallel for `birthweight` data"</span></span>
<span id="cb139-182"><a href="#cb139-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-183"><a href="#cb139-183" aria-hidden="true" tabindex="-1"></a>bw_lm1 <span class="ot">=</span> <span class="fu">lm</span>(</span>
<span id="cb139-184"><a href="#cb139-184" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> weight <span class="sc">~</span> sex <span class="sc">+</span> age, </span>
<span id="cb139-185"><a href="#cb139-185" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> bw)</span>
<span id="cb139-186"><a href="#cb139-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-187"><a href="#cb139-187" aria-hidden="true" tabindex="-1"></a>bw_lm1 <span class="sc">|&gt;</span> </span>
<span id="cb139-188"><a href="#cb139-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span></span>
<span id="cb139-189"><a href="#cb139-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>(</span>
<span id="cb139-190"><a href="#cb139-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">include_reference =</span> <span class="cn">TRUE</span>,</span>
<span id="cb139-191"><a href="#cb139-191" aria-hidden="true" tabindex="-1"></a>    <span class="co"># show_sigma = TRUE,</span></span>
<span id="cb139-192"><a href="#cb139-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="st">"{estimate}"</span>)</span>
<span id="cb139-193"><a href="#cb139-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-194"><a href="#cb139-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-195"><a href="#cb139-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-196"><a href="#cb139-196" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-197"><a href="#cb139-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-198"><a href="#cb139-198" aria-hidden="true" tabindex="-1"></a>:::{.column width=10%}</span>
<span id="cb139-199"><a href="#cb139-199" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-200"><a href="#cb139-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-201"><a href="#cb139-201" aria-hidden="true" tabindex="-1"></a>:::{.column width=50%}</span>
<span id="cb139-202"><a href="#cb139-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-205"><a href="#cb139-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-206"><a href="#cb139-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-parallel-fit1</span></span>
<span id="cb139-207"><a href="#cb139-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Parallel-slopes model of birthweight"</span></span>
<span id="cb139-208"><a href="#cb139-208" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> </span>
<span id="cb139-209"><a href="#cb139-209" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-210"><a href="#cb139-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">E[Y|X=x]</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fitted</span>(bw_lm1)) <span class="sc">|&gt;</span> </span>
<span id="cb139-211"><a href="#cb139-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sex, age)</span>
<span id="cb139-212"><a href="#cb139-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-213"><a href="#cb139-213" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">=</span> </span>
<span id="cb139-214"><a href="#cb139-214" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="sc">%+%</span> bw <span class="sc">+</span></span>
<span id="cb139-215"><a href="#cb139-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">E[Y|X=x]</span><span class="st">`</span>))</span>
<span id="cb139-216"><a href="#cb139-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-217"><a href="#cb139-217" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot2)</span>
<span id="cb139-218"><a href="#cb139-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-219"><a href="#cb139-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-220"><a href="#cb139-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-221"><a href="#cb139-221" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-222"><a href="#cb139-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-223"><a href="#cb139-223" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-224"><a href="#cb139-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-225"><a href="#cb139-225" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model assumptions and predictions</span></span>
<span id="cb139-226"><a href="#cb139-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-227"><a href="#cb139-227" aria-hidden="true" tabindex="-1"></a>To learn what this model is assuming, let's plug in a few values.</span>
<span id="cb139-228"><a href="#cb139-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-229"><a href="#cb139-229" aria-hidden="true" tabindex="-1"></a>:::{#exr-pred-fem-parallel}</span>
<span id="cb139-230"><a href="#cb139-230" aria-hidden="true" tabindex="-1"></a>According to this model, what's the mean birthweight for a female born at 36 weeks?</span>
<span id="cb139-231"><a href="#cb139-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-234"><a href="#cb139-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-235"><a href="#cb139-235" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(bw_lm1)</span>
<span id="cb139-236"><a href="#cb139-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-237"><a href="#cb139-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-238"><a href="#cb139-238" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-239"><a href="#cb139-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-240"><a href="#cb139-240" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-241"><a href="#cb139-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-242"><a href="#cb139-242" aria-hidden="true" tabindex="-1"></a>:::{.solution}</span>
<span id="cb139-245"><a href="#cb139-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-246"><a href="#cb139-246" aria-hidden="true" tabindex="-1"></a>pred_female <span class="ot">=</span> <span class="fu">coef</span>(bw_lm1)[<span class="st">"(Intercept)"</span>] <span class="sc">+</span> <span class="fu">coef</span>(bw_lm1)[<span class="st">"age"</span>]<span class="sc">*</span><span class="dv">36</span></span>
<span id="cb139-247"><a href="#cb139-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-248"><a href="#cb139-248" aria-hidden="true" tabindex="-1"></a><span class="co"># print(pred_female)</span></span>
<span id="cb139-249"><a href="#cb139-249" aria-hidden="true" tabindex="-1"></a><span class="do">### built-in prediction: </span></span>
<span id="cb139-250"><a href="#cb139-250" aria-hidden="true" tabindex="-1"></a><span class="co"># predict(bw_lm1, newdata = tibble(sex = "female", age = 36))</span></span>
<span id="cb139-251"><a href="#cb139-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-252"><a href="#cb139-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-253"><a href="#cb139-253" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-254"><a href="#cb139-254" aria-hidden="true" tabindex="-1"></a>\ba</span>
<span id="cb139-255"><a href="#cb139-255" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">Y|X_1 = 0, X_2 = 36</span><span class="co">]</span> </span>
<span id="cb139-256"><a href="#cb139-256" aria-hidden="true" tabindex="-1"></a>&amp;= \beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36 <span class="sc">\\</span></span>
<span id="cb139-257"><a href="#cb139-257" aria-hidden="true" tabindex="-1"></a>&amp;=  <span class="in">`r pred_female`</span></span>
<span id="cb139-258"><a href="#cb139-258" aria-hidden="true" tabindex="-1"></a>\ea</span>
<span id="cb139-259"><a href="#cb139-259" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-260"><a href="#cb139-260" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-261"><a href="#cb139-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-262"><a href="#cb139-262" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-263"><a href="#cb139-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-264"><a href="#cb139-264" aria-hidden="true" tabindex="-1"></a>:::{#exr-pred-male-parallel}</span>
<span id="cb139-265"><a href="#cb139-265" aria-hidden="true" tabindex="-1"></a>What's the mean birthweight for a male born at 36 weeks?</span>
<span id="cb139-266"><a href="#cb139-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-269"><a href="#cb139-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-270"><a href="#cb139-270" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(bw_lm1)</span>
<span id="cb139-271"><a href="#cb139-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-272"><a href="#cb139-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-273"><a href="#cb139-273" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-274"><a href="#cb139-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-275"><a href="#cb139-275" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-276"><a href="#cb139-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-277"><a href="#cb139-277" aria-hidden="true" tabindex="-1"></a>:::{.solution}</span>
<span id="cb139-278"><a href="#cb139-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-281"><a href="#cb139-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-282"><a href="#cb139-282" aria-hidden="true" tabindex="-1"></a>pred_male <span class="ot">=</span> </span>
<span id="cb139-283"><a href="#cb139-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(bw_lm1)[<span class="st">"(Intercept)"</span>] <span class="sc">+</span> </span>
<span id="cb139-284"><a href="#cb139-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(bw_lm1)[<span class="st">"sexmale"</span>] <span class="sc">+</span> </span>
<span id="cb139-285"><a href="#cb139-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(bw_lm1)[<span class="st">"age"</span>]<span class="sc">*</span><span class="dv">36</span></span>
<span id="cb139-286"><a href="#cb139-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-287"><a href="#cb139-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-288"><a href="#cb139-288" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-289"><a href="#cb139-289" aria-hidden="true" tabindex="-1"></a>\ba</span>
<span id="cb139-290"><a href="#cb139-290" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">Y|X_1 = 1, X_2 = 36</span><span class="co">]</span> </span>
<span id="cb139-291"><a href="#cb139-291" aria-hidden="true" tabindex="-1"></a>&amp;= \beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36 <span class="sc">\\</span></span>
<span id="cb139-292"><a href="#cb139-292" aria-hidden="true" tabindex="-1"></a>&amp;=  <span class="in">`r pred_male`</span></span>
<span id="cb139-293"><a href="#cb139-293" aria-hidden="true" tabindex="-1"></a>\ea</span>
<span id="cb139-294"><a href="#cb139-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-295"><a href="#cb139-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-296"><a href="#cb139-296" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-297"><a href="#cb139-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-298"><a href="#cb139-298" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-299"><a href="#cb139-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-300"><a href="#cb139-300" aria-hidden="true" tabindex="-1"></a>:::{#exr-diff-sex-parallel-1}</span>
<span id="cb139-301"><a href="#cb139-301" aria-hidden="true" tabindex="-1"></a>What's the difference in mean birthweights between males born at 36 weeks and females born at 36 weeks?</span>
<span id="cb139-302"><a href="#cb139-302" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-303"><a href="#cb139-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-306"><a href="#cb139-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-307"><a href="#cb139-307" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(bw_lm1)</span>
<span id="cb139-308"><a href="#cb139-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-309"><a href="#cb139-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-310"><a href="#cb139-310" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-311"><a href="#cb139-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-312"><a href="#cb139-312" aria-hidden="true" tabindex="-1"></a>:::{.solution}</span>
<span id="cb139-313"><a href="#cb139-313" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-314"><a href="#cb139-314" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-315"><a href="#cb139-315" aria-hidden="true" tabindex="-1"></a>&amp; E<span class="co">[</span><span class="ot">Y|X_1 = 1, X_2 = 36</span><span class="co">]</span> - E<span class="co">[</span><span class="ot">Y|X_1 = 0, X_2 = 36</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb139-316"><a href="#cb139-316" aria-hidden="true" tabindex="-1"></a>&amp;= </span>
<span id="cb139-317"><a href="#cb139-317" aria-hidden="true" tabindex="-1"></a><span class="in">`r pred_male`</span> - <span class="in">`r pred_female`</span><span class="sc">\\</span></span>
<span id="cb139-318"><a href="#cb139-318" aria-hidden="true" tabindex="-1"></a>&amp;=</span>
<span id="cb139-319"><a href="#cb139-319" aria-hidden="true" tabindex="-1"></a><span class="in">`r pred_male - pred_female`</span></span>
<span id="cb139-320"><a href="#cb139-320" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-321"><a href="#cb139-321" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-322"><a href="#cb139-322" aria-hidden="true" tabindex="-1"></a>Shortcut:</span>
<span id="cb139-323"><a href="#cb139-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-324"><a href="#cb139-324" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-325"><a href="#cb139-325" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-326"><a href="#cb139-326" aria-hidden="true" tabindex="-1"></a>&amp; E<span class="co">[</span><span class="ot">Y|X_1 = 1, X_2 = 36</span><span class="co">]</span> - </span>
<span id="cb139-327"><a href="#cb139-327" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">Y|X_1 = 0, X_2 = 36</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb139-328"><a href="#cb139-328" aria-hidden="true" tabindex="-1"></a>&amp;= (\beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36) - (\beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36) <span class="sc">\\</span></span>
<span id="cb139-329"><a href="#cb139-329" aria-hidden="true" tabindex="-1"></a>&amp;= \beta_1 <span class="sc">\\</span> </span>
<span id="cb139-330"><a href="#cb139-330" aria-hidden="true" tabindex="-1"></a>&amp;=  <span class="in">`r coef(bw_lm1)["sexmale"]`</span></span>
<span id="cb139-331"><a href="#cb139-331" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-332"><a href="#cb139-332" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-333"><a href="#cb139-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-334"><a href="#cb139-334" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-335"><a href="#cb139-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-336"><a href="#cb139-336" aria-hidden="true" tabindex="-1"></a>:::{.notes}</span>
<span id="cb139-337"><a href="#cb139-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-338"><a href="#cb139-338" aria-hidden="true" tabindex="-1"></a>Note that age doesn't show up in this difference: in other words, according to this model, the difference between females and males with the same gestational age is the same for every age.</span>
<span id="cb139-339"><a href="#cb139-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-340"><a href="#cb139-340" aria-hidden="true" tabindex="-1"></a>That's an assumption of the model; it's built-in to the parametric structure, even before we plug in the estimated values of those parameters.</span>
<span id="cb139-341"><a href="#cb139-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-342"><a href="#cb139-342" aria-hidden="true" tabindex="-1"></a>That's why the lines are parallel.</span>
<span id="cb139-343"><a href="#cb139-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-344"><a href="#cb139-344" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-345"><a href="#cb139-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-346"><a href="#cb139-346" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interactions</span></span>
<span id="cb139-347"><a href="#cb139-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-348"><a href="#cb139-348" aria-hidden="true" tabindex="-1"></a>:::{.notes}</span>
<span id="cb139-349"><a href="#cb139-349" aria-hidden="true" tabindex="-1"></a>What if we don't like that parallel lines assumption?</span>
<span id="cb139-350"><a href="#cb139-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-351"><a href="#cb139-351" aria-hidden="true" tabindex="-1"></a>Then we need to allow an "interaction" between age and sex:</span>
<span id="cb139-352"><a href="#cb139-352" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-353"><a href="#cb139-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-354"><a href="#cb139-354" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-355"><a href="#cb139-355" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">Y|X_1, X_2</span><span class="co">]</span> = \beta_0 + \beta_1 X_1+ \beta_2 X_2 + \beta_3 (X_1 \cdot X_2)</span>
<span id="cb139-356"><a href="#cb139-356" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-357"><a href="#cb139-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-358"><a href="#cb139-358" aria-hidden="true" tabindex="-1"></a>::: {.column width=40%}</span>
<span id="cb139-359"><a href="#cb139-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-362"><a href="#cb139-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-363"><a href="#cb139-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-bw-model-coefs-interact</span></span>
<span id="cb139-364"><a href="#cb139-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Birthweight model with interaction term"</span></span>
<span id="cb139-365"><a href="#cb139-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-366"><a href="#cb139-366" aria-hidden="true" tabindex="-1"></a>bw_lm2 <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> sex <span class="sc">+</span> age <span class="sc">+</span> sex<span class="sc">:</span>age, <span class="at">data =</span> bw)</span>
<span id="cb139-367"><a href="#cb139-367" aria-hidden="true" tabindex="-1"></a>bw_lm2 <span class="sc">|&gt;</span> </span>
<span id="cb139-368"><a href="#cb139-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span></span>
<span id="cb139-369"><a href="#cb139-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>(</span>
<span id="cb139-370"><a href="#cb139-370" aria-hidden="true" tabindex="-1"></a>    <span class="at">include_reference =</span> <span class="cn">TRUE</span>,</span>
<span id="cb139-371"><a href="#cb139-371" aria-hidden="true" tabindex="-1"></a>    <span class="co"># show_sigma = TRUE,</span></span>
<span id="cb139-372"><a href="#cb139-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="st">"{estimate}"</span>)</span>
<span id="cb139-373"><a href="#cb139-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-374"><a href="#cb139-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-375"><a href="#cb139-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-376"><a href="#cb139-376" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-377"><a href="#cb139-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-378"><a href="#cb139-378" aria-hidden="true" tabindex="-1"></a>:::{.column width=10%}</span>
<span id="cb139-379"><a href="#cb139-379" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-380"><a href="#cb139-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-381"><a href="#cb139-381" aria-hidden="true" tabindex="-1"></a>:::{.column width=50%}</span>
<span id="cb139-382"><a href="#cb139-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-385"><a href="#cb139-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-386"><a href="#cb139-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-bw-interaction</span></span>
<span id="cb139-387"><a href="#cb139-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Birthweight model with interaction term"</span></span>
<span id="cb139-388"><a href="#cb139-388" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> </span>
<span id="cb139-389"><a href="#cb139-389" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-390"><a href="#cb139-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-391"><a href="#cb139-391" aria-hidden="true" tabindex="-1"></a>    <span class="at">predlm2 =</span> <span class="fu">predict</span>(bw_lm2)</span>
<span id="cb139-392"><a href="#cb139-392" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-393"><a href="#cb139-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sex, age)</span>
<span id="cb139-394"><a href="#cb139-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-395"><a href="#cb139-395" aria-hidden="true" tabindex="-1"></a>plot1_interact <span class="ot">=</span> </span>
<span id="cb139-396"><a href="#cb139-396" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="sc">%+%</span> bw <span class="sc">+</span></span>
<span id="cb139-397"><a href="#cb139-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predlm2))</span>
<span id="cb139-398"><a href="#cb139-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-399"><a href="#cb139-399" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot1_interact)</span>
<span id="cb139-400"><a href="#cb139-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-401"><a href="#cb139-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-402"><a href="#cb139-402" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-403"><a href="#cb139-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-404"><a href="#cb139-404" aria-hidden="true" tabindex="-1"></a>::: {.notes}</span>
<span id="cb139-405"><a href="#cb139-405" aria-hidden="true" tabindex="-1"></a>Now we can see that the lines aren't parallel.</span>
<span id="cb139-406"><a href="#cb139-406" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-407"><a href="#cb139-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-408"><a href="#cb139-408" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-409"><a href="#cb139-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-410"><a href="#cb139-410" aria-hidden="true" tabindex="-1"></a>Here's another way we could rewrite this model (by collecting terms involving $X_2$):</span>
<span id="cb139-411"><a href="#cb139-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-412"><a href="#cb139-412" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-413"><a href="#cb139-413" aria-hidden="true" tabindex="-1"></a>E<span class="co">[</span><span class="ot">Y|X_1, X_2</span><span class="co">]</span> = \beta_0 + \beta_1 X_1+ (\beta_2 + \beta_3 X_1) X_2</span>
<span id="cb139-414"><a href="#cb139-414" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-415"><a href="#cb139-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-416"><a href="#cb139-416" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb139-417"><a href="#cb139-417" aria-hidden="true" tabindex="-1"></a>If you want to understand a coefficient in a model with interactions, collect terms for the corresponding variable, and you will see what other variables are interacting with the variable you are interested in.</span>
<span id="cb139-418"><a href="#cb139-418" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-419"><a href="#cb139-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-420"><a href="#cb139-420" aria-hidden="true" tabindex="-1"></a>:::{.notes}</span>
<span id="cb139-421"><a href="#cb139-421" aria-hidden="true" tabindex="-1"></a>In this case, the coefficient $X_2$ is interacting with $X_1$. So the slope of $Y$ with respect to $X_2$ depends on the value of $X_2$.</span>
<span id="cb139-422"><a href="#cb139-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-423"><a href="#cb139-423" aria-hidden="true" tabindex="-1"></a>According to this model, there is no such thing as "*the* slope of birthweight with respect to age". There are two slopes, one for each sex.^<span class="co">[</span><span class="ot">using the definite article "the" would mean there is only one slope.</span><span class="co">]</span> We can only talk about "the slope of birthweight with respect to age among males" and "the slope of birthweight with respect to age among females".</span>
<span id="cb139-424"><a href="#cb139-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-425"><a href="#cb139-425" aria-hidden="true" tabindex="-1"></a>Then: that coefficient is the difference in means per unit change in its corresponding coefficient, when the other collected variables are set to 0.</span>
<span id="cb139-426"><a href="#cb139-426" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-427"><a href="#cb139-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-428"><a href="#cb139-428" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-429"><a href="#cb139-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-430"><a href="#cb139-430" aria-hidden="true" tabindex="-1"></a>To learn what this model is assuming, let's plug in a few values.</span>
<span id="cb139-431"><a href="#cb139-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-432"><a href="#cb139-432" aria-hidden="true" tabindex="-1"></a>:::{#exr-pred-fem-interact}</span>
<span id="cb139-433"><a href="#cb139-433" aria-hidden="true" tabindex="-1"></a>According to this model, what's the mean birthweight for a female born at 36 weeks?</span>
<span id="cb139-434"><a href="#cb139-434" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-435"><a href="#cb139-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-436"><a href="#cb139-436" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-437"><a href="#cb139-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-440"><a href="#cb139-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-441"><a href="#cb139-441" aria-hidden="true" tabindex="-1"></a>pred_female <span class="ot">=</span> <span class="fu">coef</span>(bw_lm2)[<span class="st">"(Intercept)"</span>] <span class="sc">+</span> <span class="fu">coef</span>(bw_lm2)[<span class="st">"age"</span>]<span class="sc">*</span><span class="dv">36</span></span>
<span id="cb139-442"><a href="#cb139-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-443"><a href="#cb139-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-444"><a href="#cb139-444" aria-hidden="true" tabindex="-1"></a>$$E<span class="co">[</span><span class="ot">Y|X_1 = 0, X_2 = 36</span><span class="co">]</span> = \beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36 + \beta_3 \cdot (0 * 36) =  <span class="in">`r pred_female`</span>$$ What's the mean birthweight for a male born at 36 weeks?</span>
<span id="cb139-445"><a href="#cb139-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-448"><a href="#cb139-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-449"><a href="#cb139-449" aria-hidden="true" tabindex="-1"></a>pred_male <span class="ot">=</span> </span>
<span id="cb139-450"><a href="#cb139-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(bw_lm2)[<span class="st">"(Intercept)"</span>] <span class="sc">+</span> </span>
<span id="cb139-451"><a href="#cb139-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(bw_lm2)[<span class="st">"sexmale"</span>] <span class="sc">+</span> </span>
<span id="cb139-452"><a href="#cb139-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(bw_lm2)[<span class="st">"age"</span>]<span class="sc">*</span><span class="dv">36</span> <span class="sc">+</span> </span>
<span id="cb139-453"><a href="#cb139-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(bw_lm2)[<span class="st">"sexmale:age"</span>] <span class="sc">*</span> <span class="dv">36</span></span>
<span id="cb139-454"><a href="#cb139-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-455"><a href="#cb139-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-456"><a href="#cb139-456" aria-hidden="true" tabindex="-1"></a>$$E<span class="co">[</span><span class="ot">Y|X_1 = 0, X_2 = 36</span><span class="co">]</span> = \beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36 + \beta_3 \cdot 1 \cdot 36 =  <span class="in">`r pred_male`</span>$$</span>
<span id="cb139-457"><a href="#cb139-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-458"><a href="#cb139-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-459"><a href="#cb139-459" aria-hidden="true" tabindex="-1"></a>:::{#exr-diff-gender-interact}</span>
<span id="cb139-460"><a href="#cb139-460" aria-hidden="true" tabindex="-1"></a>What's the difference in mean birthweights between males born at 36 weeks and females born at 36 weeks?</span>
<span id="cb139-461"><a href="#cb139-461" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-462"><a href="#cb139-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-463"><a href="#cb139-463" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb139-464"><a href="#cb139-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-465"><a href="#cb139-465" aria-hidden="true" tabindex="-1"></a>:::{.solution}</span>
<span id="cb139-466"><a href="#cb139-466" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-467"><a href="#cb139-467" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-468"><a href="#cb139-468" aria-hidden="true" tabindex="-1"></a>&amp; E<span class="co">[</span><span class="ot">Y|X_1 = 1, X_2 = 36</span><span class="co">]</span> - E<span class="co">[</span><span class="ot">Y|X_1 = 0, X_2 = 36</span><span class="co">]</span><span class="sc">\\</span> </span>
<span id="cb139-469"><a href="#cb139-469" aria-hidden="true" tabindex="-1"></a>&amp;= (\beta_0 + \beta_1 \cdot 1+ \beta_2 \cdot 36 + \beta_3 \cdot 1 \cdot 36)<span class="sc">\\</span> </span>
<span id="cb139-470"><a href="#cb139-470" aria-hidden="true" tabindex="-1"></a>&amp;\ \ \ \ \  -(\beta_0 + \beta_1 \cdot 0+ \beta_2 \cdot 36 + \beta_3 \cdot 0 \cdot 36) <span class="sc">\\</span></span>
<span id="cb139-471"><a href="#cb139-471" aria-hidden="true" tabindex="-1"></a>&amp;= \beta_2 + \beta_3\cdot 36<span class="sc">\\</span></span>
<span id="cb139-472"><a href="#cb139-472" aria-hidden="true" tabindex="-1"></a>&amp;=  <span class="in">`r pred_male - pred_female`</span></span>
<span id="cb139-473"><a href="#cb139-473" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-474"><a href="#cb139-474" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-475"><a href="#cb139-475" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-476"><a href="#cb139-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-477"><a href="#cb139-477" aria-hidden="true" tabindex="-1"></a>Note that age now does show up in the difference: in other words, according to this model, the difference in mean birthweights between females and males with the same gestational age can vary by gestational age.</span>
<span id="cb139-478"><a href="#cb139-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-479"><a href="#cb139-479" aria-hidden="true" tabindex="-1"></a>That's how the lines in the graph ended up non-parallel.</span>
<span id="cb139-480"><a href="#cb139-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-481"><a href="#cb139-481" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stratified regression</span></span>
<span id="cb139-482"><a href="#cb139-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-483"><a href="#cb139-483" aria-hidden="true" tabindex="-1"></a>:::{.notes}</span>
<span id="cb139-484"><a href="#cb139-484" aria-hidden="true" tabindex="-1"></a>We could re-write the interaction model as a stratified model, with a slope and intercept for each sex:</span>
<span id="cb139-485"><a href="#cb139-485" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-486"><a href="#cb139-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-487"><a href="#cb139-487" aria-hidden="true" tabindex="-1"></a>::: {.column width=45%}</span>
<span id="cb139-490"><a href="#cb139-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-491"><a href="#cb139-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-bw-model-coefs-interact2</span></span>
<span id="cb139-492"><a href="#cb139-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Birthweight model with interaction term"</span></span>
<span id="cb139-493"><a href="#cb139-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-494"><a href="#cb139-494" aria-hidden="true" tabindex="-1"></a>bw_lm2 <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> sex <span class="sc">+</span> age <span class="sc">+</span> sex<span class="sc">:</span>age, <span class="at">data =</span> bw)</span>
<span id="cb139-495"><a href="#cb139-495" aria-hidden="true" tabindex="-1"></a>bw_lm2 <span class="sc">|&gt;</span> </span>
<span id="cb139-496"><a href="#cb139-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span></span>
<span id="cb139-497"><a href="#cb139-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>(</span>
<span id="cb139-498"><a href="#cb139-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">include_reference =</span> <span class="cn">TRUE</span>,</span>
<span id="cb139-499"><a href="#cb139-499" aria-hidden="true" tabindex="-1"></a>    <span class="co"># show_sigma = TRUE,</span></span>
<span id="cb139-500"><a href="#cb139-500" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="st">"{estimate}"</span>)</span>
<span id="cb139-501"><a href="#cb139-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-502"><a href="#cb139-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-503"><a href="#cb139-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-504"><a href="#cb139-504" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-505"><a href="#cb139-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-506"><a href="#cb139-506" aria-hidden="true" tabindex="-1"></a>:::{.column width=10%}</span>
<span id="cb139-507"><a href="#cb139-507" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-508"><a href="#cb139-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-509"><a href="#cb139-509" aria-hidden="true" tabindex="-1"></a>:::{.column width=45%}</span>
<span id="cb139-510"><a href="#cb139-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-513"><a href="#cb139-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-514"><a href="#cb139-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-bw-model-coefs-strat</span></span>
<span id="cb139-515"><a href="#cb139-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Birthweight model - stratified betas"</span></span>
<span id="cb139-516"><a href="#cb139-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-517"><a href="#cb139-517" aria-hidden="true" tabindex="-1"></a>bw_lm_strat <span class="ot">=</span> </span>
<span id="cb139-518"><a href="#cb139-518" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-519"><a href="#cb139-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb139-520"><a href="#cb139-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> weight <span class="sc">~</span> sex <span class="sc">+</span> sex<span class="sc">:</span>age <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb139-521"><a href="#cb139-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _)</span>
<span id="cb139-522"><a href="#cb139-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-523"><a href="#cb139-523" aria-hidden="true" tabindex="-1"></a>bw_lm_strat <span class="sc">|&gt;</span> </span>
<span id="cb139-524"><a href="#cb139-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span></span>
<span id="cb139-525"><a href="#cb139-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>(</span>
<span id="cb139-526"><a href="#cb139-526" aria-hidden="true" tabindex="-1"></a>    <span class="co"># show_sigma = TRUE,</span></span>
<span id="cb139-527"><a href="#cb139-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">select =</span> <span class="st">"{estimate}"</span>)</span>
<span id="cb139-528"><a href="#cb139-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-529"><a href="#cb139-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-530"><a href="#cb139-530" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-531"><a href="#cb139-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-532"><a href="#cb139-532" aria-hidden="true" tabindex="-1"></a><span class="fu">### Curved-line regression</span></span>
<span id="cb139-533"><a href="#cb139-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-534"><a href="#cb139-534" aria-hidden="true" tabindex="-1"></a>If we transform some of our covariates ($X$s) and plot the resulting model on the original covariate scale, we end up with curved regression lines:</span>
<span id="cb139-535"><a href="#cb139-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-538"><a href="#cb139-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-539"><a href="#cb139-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-penguins-log-x</span></span>
<span id="cb139-540"><a href="#cb139-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "`palmerpenguins` model with bill_length entering on log scale"</span></span>
<span id="cb139-541"><a href="#cb139-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb139-542"><a href="#cb139-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb139-543"><a href="#cb139-543" aria-hidden="true" tabindex="-1"></a>bw_lm3 <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> sex<span class="sc">:</span><span class="fu">log</span>(age) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> bw)</span>
<span id="cb139-544"><a href="#cb139-544" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb139-545"><a href="#cb139-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-546"><a href="#cb139-546" aria-hidden="true" tabindex="-1"></a>ggpenguins <span class="ot">&lt;-</span> </span>
<span id="cb139-547"><a href="#cb139-547" aria-hidden="true" tabindex="-1"></a>  palmerpenguins<span class="sc">::</span>penguins <span class="sc">|&gt;</span> </span>
<span id="cb139-548"><a href="#cb139-548" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb139-549"><a href="#cb139-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb139-550"><a href="#cb139-550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm , <span class="at">y =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb139-551"><a href="#cb139-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb139-552"><a href="#cb139-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Bill length (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb139-553"><a href="#cb139-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Body mass (g)"</span>)</span>
<span id="cb139-554"><a href="#cb139-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-555"><a href="#cb139-555" aria-hidden="true" tabindex="-1"></a>ggpenguins2 <span class="ot">=</span> ggpenguins <span class="sc">+</span></span>
<span id="cb139-556"><a href="#cb139-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb139-557"><a href="#cb139-557" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb139-558"><a href="#cb139-558" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">log</span>(x),</span>
<span id="cb139-559"><a href="#cb139-559" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span></span>
<span id="cb139-560"><a href="#cb139-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Bill length (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb139-561"><a href="#cb139-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Body mass (g)"</span>)</span>
<span id="cb139-562"><a href="#cb139-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-563"><a href="#cb139-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-564"><a href="#cb139-564" aria-hidden="true" tabindex="-1"></a>ggpenguins2 <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-565"><a href="#cb139-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-566"><a href="#cb139-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-567"><a href="#cb139-567" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating Linear Models via Maximum Likelihood {#sec-est-LMs}</span></span>
<span id="cb139-568"><a href="#cb139-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-569"><a href="#cb139-569" aria-hidden="true" tabindex="-1"></a><span class="fu">### Review of one-sample inference</span></span>
<span id="cb139-570"><a href="#cb139-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-571"><a href="#cb139-571" aria-hidden="true" tabindex="-1"></a>Previously, we learned how to fit outcome-only models of the form $p(X=x|\theta)$ to iid data $\mathbf x = (x_1,…,x_n)$ using maximum likelihood estimation:</span>
<span id="cb139-572"><a href="#cb139-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-573"><a href="#cb139-573" aria-hidden="true" tabindex="-1"></a>$$\mathcal L(\mathbf x|\theta) = p(X_1 = x_1, …,X_n =x_n|\theta) = \prod_{i=1}^n p(X=x_i|\theta)$$</span>
<span id="cb139-574"><a href="#cb139-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-575"><a href="#cb139-575" aria-hidden="true" tabindex="-1"></a>$$\ell(x|\theta) = \log{\mathcal L(x|\theta)}$$</span>
<span id="cb139-576"><a href="#cb139-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-577"><a href="#cb139-577" aria-hidden="true" tabindex="-1"></a>$$\hat \theta_{ML} = \arg \max_\theta \ell(x|\theta)$$</span>
<span id="cb139-578"><a href="#cb139-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-579"><a href="#cb139-579" aria-hidden="true" tabindex="-1"></a>We learned how to quantify our uncertainty about these maximum likelihood estimates; with sufficient sample size, $\hat \theta_{ML}$ has the approximate distribution:</span>
<span id="cb139-580"><a href="#cb139-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-581"><a href="#cb139-581" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-582"><a href="#cb139-582" aria-hidden="true" tabindex="-1"></a>\hat\theta_{ML} \dot \sim N(\theta,\mathcal I(\theta)^{-1})</span>
<span id="cb139-583"><a href="#cb139-583" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-584"><a href="#cb139-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-585"><a href="#cb139-585" aria-hidden="true" tabindex="-1"></a>For models in the "exponential family" of distributions, which includes the Gaussian, Poisson, Bernoulli, Binomial, Exponential, and Gamma distributions, $\mathcal I(\theta) = \text -E<span class="co">[</span><span class="ot">\mathcal{l}''(X|\theta)</span><span class="co">]</span>$, so we estimated $\mathcal I(\theta)$ using either $\mathcal I(\theta)|_{\theta = \hat \theta_{ML}}$ or $\mathcal{l}''(\mathbf x |\theta)|_{\theta = \hat \theta_{ML}}$.</span>
<span id="cb139-586"><a href="#cb139-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-587"><a href="#cb139-587" aria-hidden="true" tabindex="-1"></a>Then an asymptotic approximation of a 95% confidence interval for $\theta_k$ is</span>
<span id="cb139-588"><a href="#cb139-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-589"><a href="#cb139-589" aria-hidden="true" tabindex="-1"></a>$$\hat \theta_{ML} \pm z_{0.975} \times \left<span class="co">[</span><span class="ot">\left(\hat{\mathcal I}(\hat \theta_{ML})\right)^{-1}\right</span><span class="co">]</span>_{kk}$$</span>
<span id="cb139-590"><a href="#cb139-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-591"><a href="#cb139-591" aria-hidden="true" tabindex="-1"></a>where $z_\beta$ the $\beta$ quantile of the standard Gaussian distribution.</span>
<span id="cb139-592"><a href="#cb139-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-593"><a href="#cb139-593" aria-hidden="true" tabindex="-1"></a><span class="fu">### MLEs for Linear Regression</span></span>
<span id="cb139-594"><a href="#cb139-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-595"><a href="#cb139-595" aria-hidden="true" tabindex="-1"></a>Let's use maximum likelihood again:</span>
<span id="cb139-596"><a href="#cb139-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-597"><a href="#cb139-597" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-598"><a href="#cb139-598" aria-hidden="true" tabindex="-1"></a>\mathcal L(\mathbf y|\mathbf x,\beta, \sigma^2) = </span>
<span id="cb139-599"><a href="#cb139-599" aria-hidden="true" tabindex="-1"></a>\prod_{i=1}^n (2\pi\sigma^2)^{-1/2} </span>
<span id="cb139-600"><a href="#cb139-600" aria-hidden="true" tabindex="-1"></a>\exp{-\frac{1}{2\sigma^2}(y_i - x_i'\beta)^2}</span>
<span id="cb139-601"><a href="#cb139-601" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-602"><a href="#cb139-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-603"><a href="#cb139-603" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-604"><a href="#cb139-604" aria-hidden="true" tabindex="-1"></a>\ell(\mathbf y|\mathbf x,\beta, \sigma^2) \propto -\frac{n}{2}\log{\sigma^2} - \frac{1}{2\sigma^2}\sum_{i=1}^n (y_i - x_i' \beta)^2</span>
<span id="cb139-605"><a href="#cb139-605" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-606"><a href="#cb139-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-607"><a href="#cb139-607" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-608"><a href="#cb139-608" aria-hidden="true" tabindex="-1"></a>\ell'(\mathbf y|\mathbf x,\beta, \sigma^2) \propto -\frac{n}{2}\log{\sigma^2} - \frac{1}{2\sigma^2}\frac{d}{d\beta}\left(\sum_{i=1}^n (y_i - x_i' \beta)^2\right)</span>
<span id="cb139-609"><a href="#cb139-609" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-610"><a href="#cb139-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-611"><a href="#cb139-611" aria-hidden="true" tabindex="-1"></a>A few tools from linear algebra will make this analysis go easier (see @fieller2018basics, Section 7.2 for details).</span>
<span id="cb139-612"><a href="#cb139-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-613"><a href="#cb139-613" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-614"><a href="#cb139-614" aria-hidden="true" tabindex="-1"></a>f_{\beta}(\mathbf x) = (f_{\beta}(x_1), f_{\beta}(x_2), ..., f_{\beta}(x_n))^\top</span>
<span id="cb139-615"><a href="#cb139-615" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-616"><a href="#cb139-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-617"><a href="#cb139-617" aria-hidden="true" tabindex="-1"></a>Let $\mathbf x$ and $\beta$ be vectors of length $p$, or in other words, matrices of length $p\times 1$:</span>
<span id="cb139-618"><a href="#cb139-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-619"><a href="#cb139-619" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-620"><a href="#cb139-620" aria-hidden="true" tabindex="-1"></a>x = \begin{bmatrix}</span>
<span id="cb139-621"><a href="#cb139-621" aria-hidden="true" tabindex="-1"></a>x_{1} <span class="sc">\\</span></span>
<span id="cb139-622"><a href="#cb139-622" aria-hidden="true" tabindex="-1"></a>x_{2} <span class="sc">\\</span></span>
<span id="cb139-623"><a href="#cb139-623" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb139-624"><a href="#cb139-624" aria-hidden="true" tabindex="-1"></a>x_{p}</span>
<span id="cb139-625"><a href="#cb139-625" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} <span class="sc">\\</span></span>
<span id="cb139-626"><a href="#cb139-626" aria-hidden="true" tabindex="-1"></a>\beta = \begin{bmatrix}</span>
<span id="cb139-627"><a href="#cb139-627" aria-hidden="true" tabindex="-1"></a>\beta_{1} <span class="sc">\\</span></span>
<span id="cb139-628"><a href="#cb139-628" aria-hidden="true" tabindex="-1"></a>\beta_{2} <span class="sc">\\</span></span>
<span id="cb139-629"><a href="#cb139-629" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb139-630"><a href="#cb139-630" aria-hidden="true" tabindex="-1"></a>\beta_{p}</span>
<span id="cb139-631"><a href="#cb139-631" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb139-632"><a href="#cb139-632" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-633"><a href="#cb139-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-634"><a href="#cb139-634" aria-hidden="true" tabindex="-1"></a>Then</span>
<span id="cb139-635"><a href="#cb139-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-636"><a href="#cb139-636" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-637"><a href="#cb139-637" aria-hidden="true" tabindex="-1"></a>x' \equiv x^\top \equiv <span class="co">[</span><span class="ot">x_1, x_2, ..., x_p</span><span class="co">]</span></span>
<span id="cb139-638"><a href="#cb139-638" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-639"><a href="#cb139-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-640"><a href="#cb139-640" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb139-641"><a href="#cb139-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-642"><a href="#cb139-642" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-643"><a href="#cb139-643" aria-hidden="true" tabindex="-1"></a>x'\beta = <span class="co">[</span><span class="ot">x_1, x_2, ..., x_p</span><span class="co">]</span> </span>
<span id="cb139-644"><a href="#cb139-644" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb139-645"><a href="#cb139-645" aria-hidden="true" tabindex="-1"></a>\beta_{1} <span class="sc">\\</span></span>
<span id="cb139-646"><a href="#cb139-646" aria-hidden="true" tabindex="-1"></a>\beta_{2} <span class="sc">\\</span></span>
<span id="cb139-647"><a href="#cb139-647" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb139-648"><a href="#cb139-648" aria-hidden="true" tabindex="-1"></a>\beta_{p}</span>
<span id="cb139-649"><a href="#cb139-649" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} = </span>
<span id="cb139-650"><a href="#cb139-650" aria-hidden="true" tabindex="-1"></a>x_1\beta_1+x_2\beta_2 +...+x_p \beta_p </span>
<span id="cb139-651"><a href="#cb139-651" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-652"><a href="#cb139-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-653"><a href="#cb139-653" aria-hidden="true" tabindex="-1"></a>If $f(\beta)$ is a function that takes $\beta$ as input and outputs a scalar, such as $f(\beta) = x'\beta$, then:</span>
<span id="cb139-654"><a href="#cb139-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-655"><a href="#cb139-655" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-656"><a href="#cb139-656" aria-hidden="true" tabindex="-1"></a>\frac{d}{d \beta} f(\beta)= </span>
<span id="cb139-657"><a href="#cb139-657" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb139-658"><a href="#cb139-658" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta_1}f(\beta) <span class="sc">\\</span></span>
<span id="cb139-659"><a href="#cb139-659" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta_2}f(\beta) <span class="sc">\\</span></span>
<span id="cb139-660"><a href="#cb139-660" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb139-661"><a href="#cb139-661" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta_p}f(\beta)</span>
<span id="cb139-662"><a href="#cb139-662" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb139-663"><a href="#cb139-663" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-664"><a href="#cb139-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-665"><a href="#cb139-665" aria-hidden="true" tabindex="-1"></a>In particular, if $f(\beta) = x'\beta$, then:</span>
<span id="cb139-666"><a href="#cb139-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-667"><a href="#cb139-667" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb139-668"><a href="#cb139-668" aria-hidden="true" tabindex="-1"></a>\frac{d}{d \beta} x'\beta= </span>
<span id="cb139-669"><a href="#cb139-669" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb139-670"><a href="#cb139-670" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta_1}(x_1\beta_1+x_2\beta_2 +...+x_p \beta_p ) <span class="sc">\\</span></span>
<span id="cb139-671"><a href="#cb139-671" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta_2}(x_1\beta_1+x_2\beta_2 +...+x_p \beta_p ) <span class="sc">\\</span></span>
<span id="cb139-672"><a href="#cb139-672" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb139-673"><a href="#cb139-673" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta_p}(x_1\beta_1+x_2\beta_2 +...+x_p \beta_p )</span>
<span id="cb139-674"><a href="#cb139-674" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} </span>
<span id="cb139-675"><a href="#cb139-675" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb139-676"><a href="#cb139-676" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb139-677"><a href="#cb139-677" aria-hidden="true" tabindex="-1"></a>x_{1} <span class="sc">\\</span></span>
<span id="cb139-678"><a href="#cb139-678" aria-hidden="true" tabindex="-1"></a>x_{2} <span class="sc">\\</span></span>
<span id="cb139-679"><a href="#cb139-679" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb139-680"><a href="#cb139-680" aria-hidden="true" tabindex="-1"></a>x_{p}</span>
<span id="cb139-681"><a href="#cb139-681" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb139-682"><a href="#cb139-682" aria-hidden="true" tabindex="-1"></a>= \mathbf x</span>
<span id="cb139-683"><a href="#cb139-683" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-684"><a href="#cb139-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-685"><a href="#cb139-685" aria-hidden="true" tabindex="-1"></a>In general:</span>
<span id="cb139-686"><a href="#cb139-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-687"><a href="#cb139-687" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-688"><a href="#cb139-688" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta} x'\beta = x</span>
<span id="cb139-689"><a href="#cb139-689" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-690"><a href="#cb139-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-691"><a href="#cb139-691" aria-hidden="true" tabindex="-1"></a>This looks a lot like non-vector calculus, except that you have to transpose the coefficient.</span>
<span id="cb139-692"><a href="#cb139-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-693"><a href="#cb139-693" aria-hidden="true" tabindex="-1"></a>Similarly,</span>
<span id="cb139-694"><a href="#cb139-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-695"><a href="#cb139-695" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-696"><a href="#cb139-696" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta} \beta'\beta = 2\beta</span>
<span id="cb139-697"><a href="#cb139-697" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-698"><a href="#cb139-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-699"><a href="#cb139-699" aria-hidden="true" tabindex="-1"></a>This is like taking the derivative of $x^2$.</span>
<span id="cb139-700"><a href="#cb139-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-701"><a href="#cb139-701" aria-hidden="true" tabindex="-1"></a>And finally, if $S$ is a $p\times p$ matrix, then:</span>
<span id="cb139-702"><a href="#cb139-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-703"><a href="#cb139-703" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-704"><a href="#cb139-704" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta} \beta'S\beta = 2S\beta</span>
<span id="cb139-705"><a href="#cb139-705" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-706"><a href="#cb139-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-707"><a href="#cb139-707" aria-hidden="true" tabindex="-1"></a>Again, this is like taking the derivative of $cx^2$ with respect to $c$ in non-vector calculus.</span>
<span id="cb139-708"><a href="#cb139-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-709"><a href="#cb139-709" aria-hidden="true" tabindex="-1"></a>Thus:</span>
<span id="cb139-710"><a href="#cb139-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-711"><a href="#cb139-711" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-712"><a href="#cb139-712" aria-hidden="true" tabindex="-1"></a>\sum_{i=1}^n (y_i - f_\beta(x_i))^2 = (\mathbf y - X\beta)'(\mathbf y - X\beta)</span>
<span id="cb139-713"><a href="#cb139-713" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-714"><a href="#cb139-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-715"><a href="#cb139-715" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-716"><a href="#cb139-716" aria-hidden="true" tabindex="-1"></a>(\mathbf y - X\beta)' = (\mathbf y' - (X\beta)') = (\mathbf y' - \beta'X')</span>
<span id="cb139-717"><a href="#cb139-717" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-718"><a href="#cb139-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-719"><a href="#cb139-719" aria-hidden="true" tabindex="-1"></a>So</span>
<span id="cb139-720"><a href="#cb139-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-721"><a href="#cb139-721" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-722"><a href="#cb139-722" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-723"><a href="#cb139-723" aria-hidden="true" tabindex="-1"></a>(\mathbf y - X\beta)'(\mathbf y - X\beta) &amp;= (\mathbf y' - \beta'X')(\mathbf y - X\beta)<span class="sc">\\</span></span>
<span id="cb139-724"><a href="#cb139-724" aria-hidden="true" tabindex="-1"></a>&amp;= y'y - \beta'X'y - y'X\beta +\beta'X'X\beta<span class="sc">\\</span></span>
<span id="cb139-725"><a href="#cb139-725" aria-hidden="true" tabindex="-1"></a>&amp;= y'y - 2y'X\beta +\beta'X'X\beta</span>
<span id="cb139-726"><a href="#cb139-726" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-727"><a href="#cb139-727" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-728"><a href="#cb139-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-729"><a href="#cb139-729" aria-hidden="true" tabindex="-1"></a>So</span>
<span id="cb139-730"><a href="#cb139-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-731"><a href="#cb139-731" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-732"><a href="#cb139-732" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-733"><a href="#cb139-733" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta}\left(\sum_{i=1}^n (y_i - x_i' \beta)^2\right) &amp;= </span>
<span id="cb139-734"><a href="#cb139-734" aria-hidden="true" tabindex="-1"></a>\frac{d}{d\beta}(\mathbf y - X\beta)'(\mathbf y - X\beta)<span class="sc">\\</span></span>
<span id="cb139-735"><a href="#cb139-735" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{d}{d\beta} (y'y - 2y'X\beta +\beta'X'X\beta)<span class="sc">\\</span></span>
<span id="cb139-736"><a href="#cb139-736" aria-hidden="true" tabindex="-1"></a>&amp;= (- 2X'y +2X'X\beta)</span>
<span id="cb139-737"><a href="#cb139-737" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-738"><a href="#cb139-738" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-739"><a href="#cb139-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-740"><a href="#cb139-740" aria-hidden="true" tabindex="-1"></a>So if $\ell(\beta,\sigma^2) =0$, then</span>
<span id="cb139-741"><a href="#cb139-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-742"><a href="#cb139-742" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-743"><a href="#cb139-743" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-744"><a href="#cb139-744" aria-hidden="true" tabindex="-1"></a>0 &amp;= (- 2X'y +2X'X\beta)<span class="sc">\\</span></span>
<span id="cb139-745"><a href="#cb139-745" aria-hidden="true" tabindex="-1"></a>2X'y &amp;= 2X'X\beta<span class="sc">\\</span></span>
<span id="cb139-746"><a href="#cb139-746" aria-hidden="true" tabindex="-1"></a>X'y &amp;= X'X\beta<span class="sc">\\</span></span>
<span id="cb139-747"><a href="#cb139-747" aria-hidden="true" tabindex="-1"></a>(X'X)^{-1}X'y &amp;= \beta</span>
<span id="cb139-748"><a href="#cb139-748" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-749"><a href="#cb139-749" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-750"><a href="#cb139-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-751"><a href="#cb139-751" aria-hidden="true" tabindex="-1"></a>The second derivative matrix $\ell_{\beta, \beta'} ''(\beta, \sigma^2;\mathbf X,\mathbf y)$ is negative definite at $\beta = (X'X)^{-1}X'y$, so $\hat \beta_{ML} = (X'X)^{-1}X'y$ is the MLE for $\beta$.</span>
<span id="cb139-752"><a href="#cb139-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-753"><a href="#cb139-753" aria-hidden="true" tabindex="-1"></a>Similarly (not shown):</span>
<span id="cb139-754"><a href="#cb139-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-755"><a href="#cb139-755" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-756"><a href="#cb139-756" aria-hidden="true" tabindex="-1"></a>\hat\sigma^2_{ML} = \frac{1}{n} (Y-X\hat\beta)'(Y-X\hat\beta)</span>
<span id="cb139-757"><a href="#cb139-757" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-758"><a href="#cb139-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-759"><a href="#cb139-759" aria-hidden="true" tabindex="-1"></a>And</span>
<span id="cb139-760"><a href="#cb139-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-761"><a href="#cb139-761" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-762"><a href="#cb139-762" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-763"><a href="#cb139-763" aria-hidden="true" tabindex="-1"></a>\mathcal I_{\beta} &amp;= E<span class="co">[</span><span class="ot">-\ell_{\beta, \beta'} ''(Y|X,\beta, \sigma^2)</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb139-764"><a href="#cb139-764" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{\sigma^2}X'X</span>
<span id="cb139-765"><a href="#cb139-765" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-766"><a href="#cb139-766" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-767"><a href="#cb139-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-768"><a href="#cb139-768" aria-hidden="true" tabindex="-1"></a>So:</span>
<span id="cb139-769"><a href="#cb139-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-770"><a href="#cb139-770" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-771"><a href="#cb139-771" aria-hidden="true" tabindex="-1"></a>Var(\hat \beta) \approx (\mathcal I_{\beta})^{-1} = \sigma^2 (X'X)^{-1}</span>
<span id="cb139-772"><a href="#cb139-772" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-773"><a href="#cb139-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-774"><a href="#cb139-774" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb139-775"><a href="#cb139-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-776"><a href="#cb139-776" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-777"><a href="#cb139-777" aria-hidden="true" tabindex="-1"></a>\hat\beta \dot \sim N(\beta, \mathcal I_{\beta}^{-1})</span>
<span id="cb139-778"><a href="#cb139-778" aria-hidden="true" tabindex="-1"></a>$$ These are all results you have hopefully seen before, and in the Gaussian linear regression case they are exact, not just approximate.</span>
<span id="cb139-779"><a href="#cb139-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-780"><a href="#cb139-780" aria-hidden="true" tabindex="-1"></a>In our model 2 above, this matrix is:</span>
<span id="cb139-781"><a href="#cb139-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-784"><a href="#cb139-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-785"><a href="#cb139-785" aria-hidden="true" tabindex="-1"></a>bw_lm2 <span class="sc">|&gt;</span> <span class="fu">vcov</span>()</span>
<span id="cb139-786"><a href="#cb139-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-787"><a href="#cb139-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-788"><a href="#cb139-788" aria-hidden="true" tabindex="-1"></a>Note that if we take the square roots of the diagonals, we get the standard errors listed in the model output:</span>
<span id="cb139-789"><a href="#cb139-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-792"><a href="#cb139-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-793"><a href="#cb139-793" aria-hidden="true" tabindex="-1"></a>bw_lm2 <span class="sc">|&gt;</span> <span class="fu">vcov</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span>
<span id="cb139-794"><a href="#cb139-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-795"><a href="#cb139-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-796"><a href="#cb139-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-799"><a href="#cb139-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-800"><a href="#cb139-800" aria-hidden="true" tabindex="-1"></a>bw_lm2 <span class="sc">|&gt;</span> <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">pander</span>()</span>
<span id="cb139-801"><a href="#cb139-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-802"><a href="#cb139-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-803"><a href="#cb139-803" aria-hidden="true" tabindex="-1"></a>So we can do confidence intervals, hypothesis tests, and p-values exactly as in the one-variable case we looked at previously.</span>
<span id="cb139-804"><a href="#cb139-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-805"><a href="#cb139-805" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inference about Gaussian Linear Regression Models {#sec-infer-LMs}</span></span>
<span id="cb139-806"><a href="#cb139-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-807"><a href="#cb139-807" aria-hidden="true" tabindex="-1"></a>Research question: is there really an interaction between sex and age?</span>
<span id="cb139-808"><a href="#cb139-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-809"><a href="#cb139-809" aria-hidden="true" tabindex="-1"></a>$H_0: \beta_3 = 0$</span>
<span id="cb139-810"><a href="#cb139-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-811"><a href="#cb139-811" aria-hidden="true" tabindex="-1"></a>$H_A: \beta_3 \neq 0$</span>
<span id="cb139-812"><a href="#cb139-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-813"><a href="#cb139-813" aria-hidden="true" tabindex="-1"></a>$P(|\hat\beta_3| &gt; |<span class="in">`r coef(bw_lm2)["sexmale:age"]`</span>| \mid H_0)$ = ?</span>
<span id="cb139-814"><a href="#cb139-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-815"><a href="#cb139-815" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wald tests and CIs</span></span>
<span id="cb139-816"><a href="#cb139-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-817"><a href="#cb139-817" aria-hidden="true" tabindex="-1"></a>R can give you Wald tests for single coefficients and corresponding CIs:</span>
<span id="cb139-818"><a href="#cb139-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-819"><a href="#cb139-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r "wald tests bw_lm2"}</span></span>
<span id="cb139-820"><a href="#cb139-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-821"><a href="#cb139-821" aria-hidden="true" tabindex="-1"></a><span class="in">bw_lm2 |&gt; </span></span>
<span id="cb139-822"><a href="#cb139-822" aria-hidden="true" tabindex="-1"></a><span class="in">  parameters() |&gt;</span></span>
<span id="cb139-823"><a href="#cb139-823" aria-hidden="true" tabindex="-1"></a><span class="in">  print_md(</span></span>
<span id="cb139-824"><a href="#cb139-824" aria-hidden="true" tabindex="-1"></a><span class="in">    include_reference = TRUE,</span></span>
<span id="cb139-825"><a href="#cb139-825" aria-hidden="true" tabindex="-1"></a><span class="in">    # show_sigma = TRUE,</span></span>
<span id="cb139-826"><a href="#cb139-826" aria-hidden="true" tabindex="-1"></a><span class="in">    select = "{estimate}")</span></span>
<span id="cb139-827"><a href="#cb139-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-828"><a href="#cb139-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-829"><a href="#cb139-829" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-parameter inference by hand</span></span>
<span id="cb139-830"><a href="#cb139-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-831"><a href="#cb139-831" aria-hidden="true" tabindex="-1"></a>To understand what's happening, let's replicate these results by hand for the interaction term.</span>
<span id="cb139-832"><a href="#cb139-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-833"><a href="#cb139-833" aria-hidden="true" tabindex="-1"></a><span class="fu">#### P-value</span></span>
<span id="cb139-834"><a href="#cb139-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-837"><a href="#cb139-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-838"><a href="#cb139-838" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="ot">=</span> <span class="fu">coef</span>(<span class="fu">summary</span>(bw_lm2))[<span class="st">"sexmale:age"</span>, <span class="st">"Estimate"</span>]</span>
<span id="cb139-839"><a href="#cb139-839" aria-hidden="true" tabindex="-1"></a>se_hat <span class="ot">=</span> <span class="fu">coef</span>(<span class="fu">summary</span>(bw_lm2))[<span class="st">"sexmale:age"</span>, <span class="st">"Std. Error"</span>]</span>
<span id="cb139-840"><a href="#cb139-840" aria-hidden="true" tabindex="-1"></a>dfresid <span class="ot">=</span> bw_lm2<span class="sc">$</span>df.residual</span>
<span id="cb139-841"><a href="#cb139-841" aria-hidden="true" tabindex="-1"></a>t_stat <span class="ot">=</span> <span class="fu">abs</span>(beta_hat)<span class="sc">/</span>se_hat</span>
<span id="cb139-842"><a href="#cb139-842" aria-hidden="true" tabindex="-1"></a>pval_t <span class="ot">=</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat), <span class="at">df =</span> dfresid, <span class="at">lower =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb139-843"><a href="#cb139-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-844"><a href="#cb139-844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-845"><a href="#cb139-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-846"><a href="#cb139-846" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-847"><a href="#cb139-847" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-848"><a href="#cb139-848" aria-hidden="true" tabindex="-1"></a>&amp;P\left(</span>
<span id="cb139-849"><a href="#cb139-849" aria-hidden="true" tabindex="-1"></a>| \hat \beta_3  | &gt; </span>
<span id="cb139-850"><a href="#cb139-850" aria-hidden="true" tabindex="-1"></a>| <span class="in">`r coef(bw_lm2)["sexmale:age"]`</span>| \middle| H_0</span>
<span id="cb139-851"><a href="#cb139-851" aria-hidden="true" tabindex="-1"></a>\right) </span>
<span id="cb139-852"><a href="#cb139-852" aria-hidden="true" tabindex="-1"></a>&amp;= P\left(</span>
<span id="cb139-853"><a href="#cb139-853" aria-hidden="true" tabindex="-1"></a>\left| \frac{\hat\beta_3}{\hat{SE}(\hat\beta_3)} \right| &gt; </span>
<span id="cb139-854"><a href="#cb139-854" aria-hidden="true" tabindex="-1"></a>\left| \frac{<span class="in">`r beta_hat`</span>}{<span class="in">`r se_hat`</span>} \right| \middle| H_0</span>
<span id="cb139-855"><a href="#cb139-855" aria-hidden="true" tabindex="-1"></a>\right)<span class="sc">\\</span> </span>
<span id="cb139-856"><a href="#cb139-856" aria-hidden="true" tabindex="-1"></a>&amp;= P\left(</span>
<span id="cb139-857"><a href="#cb139-857" aria-hidden="true" tabindex="-1"></a>| T_{<span class="in">`r dfresid`</span>} | &gt;  <span class="in">`r t_stat`</span> \middle| H_0</span>
<span id="cb139-858"><a href="#cb139-858" aria-hidden="true" tabindex="-1"></a>\right)<span class="sc">\\</span></span>
<span id="cb139-859"><a href="#cb139-859" aria-hidden="true" tabindex="-1"></a>&amp;= <span class="in">`r pval_t`</span></span>
<span id="cb139-860"><a href="#cb139-860" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-861"><a href="#cb139-861" aria-hidden="true" tabindex="-1"></a>$$ This matches the result in the table above.</span>
<span id="cb139-862"><a href="#cb139-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-863"><a href="#cb139-863" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Confidence interval</span></span>
<span id="cb139-864"><a href="#cb139-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-867"><a href="#cb139-867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-868"><a href="#cb139-868" aria-hidden="true" tabindex="-1"></a>confint_radius_t <span class="ot">=</span> se_hat <span class="sc">*</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> dfresid, <span class="at">lower =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-869"><a href="#cb139-869" aria-hidden="true" tabindex="-1"></a>confint_t <span class="ot">=</span> beta_hat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> confint_radius_t</span>
<span id="cb139-870"><a href="#cb139-870" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confint_t)</span>
<span id="cb139-871"><a href="#cb139-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-872"><a href="#cb139-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-873"><a href="#cb139-873" aria-hidden="true" tabindex="-1"></a>This also matches.</span>
<span id="cb139-874"><a href="#cb139-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-875"><a href="#cb139-875" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gaussian approximations</span></span>
<span id="cb139-876"><a href="#cb139-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-877"><a href="#cb139-877" aria-hidden="true" tabindex="-1"></a>Here are the asymptotic (Gaussian approximation) equivalents:</span>
<span id="cb139-878"><a href="#cb139-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-879"><a href="#cb139-879" aria-hidden="true" tabindex="-1"></a><span class="fu">#### P-value</span></span>
<span id="cb139-880"><a href="#cb139-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-883"><a href="#cb139-883" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-884"><a href="#cb139-884" aria-hidden="true" tabindex="-1"></a>pval_z <span class="ot">=</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(t_stat), <span class="at">lower =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb139-885"><a href="#cb139-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-886"><a href="#cb139-886" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pval_z)</span>
<span id="cb139-887"><a href="#cb139-887" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-888"><a href="#cb139-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-889"><a href="#cb139-889" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Confidence interval</span></span>
<span id="cb139-890"><a href="#cb139-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-893"><a href="#cb139-893" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-894"><a href="#cb139-894" aria-hidden="true" tabindex="-1"></a>confint_radius_z <span class="ot">=</span> se_hat <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, <span class="at">lower =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-895"><a href="#cb139-895" aria-hidden="true" tabindex="-1"></a>confint_z <span class="ot">=</span> </span>
<span id="cb139-896"><a href="#cb139-896" aria-hidden="true" tabindex="-1"></a>  beta_hat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> confint_radius_z</span>
<span id="cb139-897"><a href="#cb139-897" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confint_z)</span>
<span id="cb139-898"><a href="#cb139-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-899"><a href="#cb139-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-900"><a href="#cb139-900" aria-hidden="true" tabindex="-1"></a><span class="fu">### Likelihood ratio statistics</span></span>
<span id="cb139-901"><a href="#cb139-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-904"><a href="#cb139-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-905"><a href="#cb139-905" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(bw_lm2)</span>
<span id="cb139-906"><a href="#cb139-906" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(bw_lm1)</span>
<span id="cb139-907"><a href="#cb139-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-908"><a href="#cb139-908" aria-hidden="true" tabindex="-1"></a>lLR <span class="ot">=</span> (<span class="fu">logLik</span>(bw_lm2) <span class="sc">-</span> <span class="fu">logLik</span>(bw_lm1)) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb139-909"><a href="#cb139-909" aria-hidden="true" tabindex="-1"></a>delta_df <span class="ot">=</span> (bw_lm1<span class="sc">$</span>df.residual <span class="sc">-</span> <span class="fu">df.residual</span>(bw_lm2))</span>
<span id="cb139-910"><a href="#cb139-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-911"><a href="#cb139-911" aria-hidden="true" tabindex="-1"></a>d_lLR <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">df =</span> delta_df) <span class="fu">dchisq</span>(x, <span class="at">df =</span> df)</span>
<span id="cb139-912"><a href="#cb139-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-913"><a href="#cb139-913" aria-hidden="true" tabindex="-1"></a>x_max <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb139-914"><a href="#cb139-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-915"><a href="#cb139-915" aria-hidden="true" tabindex="-1"></a>chisq_plot <span class="ot">=</span> </span>
<span id="cb139-916"><a href="#cb139-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb139-917"><a href="#cb139-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> d_lLR) <span class="sc">+</span></span>
<span id="cb139-918"><a href="#cb139-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>( <span class="at">fun =</span> d_lLR, <span class="at">xlim =</span> <span class="fu">c</span>(lLR, x_max), <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb139-919"><a href="#cb139-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> lLR, <span class="at">xend =</span> lLR, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fu">d_lLR</span>(lLR)), <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb139-920"><a href="#cb139-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">0.0001</span>,x_max) <span class="sc">+</span> </span>
<span id="cb139-921"><a href="#cb139-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb139-922"><a href="#cb139-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"p(X=x)"</span>) <span class="sc">+</span> </span>
<span id="cb139-923"><a href="#cb139-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"log(likelihood ratio) statistic [x]"</span>) <span class="sc">+</span></span>
<span id="cb139-924"><a href="#cb139-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb139-925"><a href="#cb139-925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-926"><a href="#cb139-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-929"><a href="#cb139-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-930"><a href="#cb139-930" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(</span>
<span id="cb139-931"><a href="#cb139-931" aria-hidden="true" tabindex="-1"></a>  <span class="at">q =</span> <span class="dv">2</span><span class="sc">*</span>lLR, </span>
<span id="cb139-932"><a href="#cb139-932" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> delta_df, </span>
<span id="cb139-933"><a href="#cb139-933" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-934"><a href="#cb139-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-935"><a href="#cb139-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-936"><a href="#cb139-936" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-939"><a href="#cb139-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-940"><a href="#cb139-940" aria-hidden="true" tabindex="-1"></a>chisq_plot <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-941"><a href="#cb139-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-942"><a href="#cb139-942" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-943"><a href="#cb139-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-944"><a href="#cb139-944" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-947"><a href="#cb139-947" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-948"><a href="#cb139-948" aria-hidden="true" tabindex="-1"></a>chisq_plot <span class="sc">|&gt;</span>  <span class="fu">ggplotly</span>()</span>
<span id="cb139-949"><a href="#cb139-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-950"><a href="#cb139-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-951"><a href="#cb139-951" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-952"><a href="#cb139-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-953"><a href="#cb139-953" aria-hidden="true" tabindex="-1"></a>Now we can get the p-value:</span>
<span id="cb139-954"><a href="#cb139-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-957"><a href="#cb139-957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-958"><a href="#cb139-958" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span><span class="sc">*</span>lLR, <span class="at">df =</span> delta_df, <span class="at">lower =</span> <span class="cn">FALSE</span>)</span>
<span id="cb139-959"><a href="#cb139-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-960"><a href="#cb139-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-961"><a href="#cb139-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-962"><a href="#cb139-962" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb139-963"><a href="#cb139-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-964"><a href="#cb139-964" aria-hidden="true" tabindex="-1"></a>In practice you don't have to do this by hand; there are functions to do it for you:</span>
<span id="cb139-965"><a href="#cb139-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-968"><a href="#cb139-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-969"><a href="#cb139-969" aria-hidden="true" tabindex="-1"></a><span class="co"># built in</span></span>
<span id="cb139-970"><a href="#cb139-970" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb139-971"><a href="#cb139-971" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(bw_lm2, bw_lm1)</span>
<span id="cb139-972"><a href="#cb139-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-973"><a href="#cb139-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-974"><a href="#cb139-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-975"><a href="#cb139-975" aria-hidden="true" tabindex="-1"></a><span class="fu">## Goodness of fit</span></span>
<span id="cb139-976"><a href="#cb139-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-977"><a href="#cb139-977" aria-hidden="true" tabindex="-1"></a><span class="fu">### AIC and BIC</span></span>
<span id="cb139-978"><a href="#cb139-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-979"><a href="#cb139-979" aria-hidden="true" tabindex="-1"></a>When we use likelihood ratio tests, we are comparing how well different models fit the data.</span>
<span id="cb139-980"><a href="#cb139-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-981"><a href="#cb139-981" aria-hidden="true" tabindex="-1"></a>Likelihood ratio tests require "nested" models: one must be a special case of the other.</span>
<span id="cb139-982"><a href="#cb139-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-983"><a href="#cb139-983" aria-hidden="true" tabindex="-1"></a>If we have non-nested models, we can instead use the Akaike Information Criterion (AIC) or Bayesian Information Criterion (BIC):</span>
<span id="cb139-984"><a href="#cb139-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-985"><a href="#cb139-985" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>AIC = $-2 * \ell(\hat\theta) + 2 * p$</span>
<span id="cb139-986"><a href="#cb139-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-987"><a href="#cb139-987" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>BIC = $-2 * \ell(\hat\theta) + p * \text{log}(n)$</span>
<span id="cb139-988"><a href="#cb139-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-989"><a href="#cb139-989" aria-hidden="true" tabindex="-1"></a>where $\ell$ is the log-likelihood of the data evaluated using the parameter estimates $\hat\theta$, $p$ is the number of estimated parameters in the model (including $\hat\sigma^2$), and $n$ is the number of observations.</span>
<span id="cb139-990"><a href="#cb139-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-991"><a href="#cb139-991" aria-hidden="true" tabindex="-1"></a>You can calculate these criteria using the <span class="in">`logLik()`</span> function, or use the built-in R functions:</span>
<span id="cb139-992"><a href="#cb139-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-993"><a href="#cb139-993" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AIC in R</span></span>
<span id="cb139-994"><a href="#cb139-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-997"><a href="#cb139-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-998"><a href="#cb139-998" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">logLik</span>(bw_lm2) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>() <span class="sc">+</span> </span>
<span id="cb139-999"><a href="#cb139-999" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span>(<span class="fu">length</span>(<span class="fu">coef</span>(bw_lm2))<span class="sc">+</span><span class="dv">1</span>) <span class="co"># sigma counts as a parameter here</span></span>
<span id="cb139-1000"><a href="#cb139-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1001"><a href="#cb139-1001" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(bw_lm2)</span>
<span id="cb139-1002"><a href="#cb139-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1003"><a href="#cb139-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1004"><a href="#cb139-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1005"><a href="#cb139-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BIC in R</span></span>
<span id="cb139-1006"><a href="#cb139-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1009"><a href="#cb139-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1010"><a href="#cb139-1010" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">logLik</span>(bw_lm2) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>() <span class="sc">+</span> </span>
<span id="cb139-1011"><a href="#cb139-1011" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">length</span>(<span class="fu">coef</span>(bw_lm2))<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">nobs</span>(bw_lm2))</span>
<span id="cb139-1012"><a href="#cb139-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1013"><a href="#cb139-1013" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(bw_lm2)</span>
<span id="cb139-1014"><a href="#cb139-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1015"><a href="#cb139-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1016"><a href="#cb139-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1017"><a href="#cb139-1017" aria-hidden="true" tabindex="-1"></a>Large values of AIC and BIC are worse than small values. There are no hypothesis tests or p-values associated with these criteria.</span>
<span id="cb139-1018"><a href="#cb139-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1019"><a href="#cb139-1019" aria-hidden="true" tabindex="-1"></a><span class="fu">### (Residual) Deviance</span></span>
<span id="cb139-1020"><a href="#cb139-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1021"><a href="#cb139-1021" aria-hidden="true" tabindex="-1"></a>Let $q$ be the number of distinct covariate combinations in a data set.</span>
<span id="cb139-1022"><a href="#cb139-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1025"><a href="#cb139-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1026"><a href="#cb139-1026" aria-hidden="true" tabindex="-1"></a>bw.X.unique <span class="ot">=</span> </span>
<span id="cb139-1027"><a href="#cb139-1027" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1028"><a href="#cb139-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sex, age)</span>
<span id="cb139-1029"><a href="#cb139-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1030"><a href="#cb139-1030" aria-hidden="true" tabindex="-1"></a>n_unique.bw  <span class="ot">=</span> <span class="fu">nrow</span>(bw.X.unique)</span>
<span id="cb139-1031"><a href="#cb139-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1032"><a href="#cb139-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1033"><a href="#cb139-1033" aria-hidden="true" tabindex="-1"></a>For example, in the <span class="in">`birthweight`</span> data, there are $q = <span class="in">`r n_unique.bw`</span>$ unique patterns:</span>
<span id="cb139-1034"><a href="#cb139-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1037"><a href="#cb139-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1038"><a href="#cb139-1038" aria-hidden="true" tabindex="-1"></a>bw.X.unique <span class="sc">|&gt;</span> </span>
<span id="cb139-1039"><a href="#cb139-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pander</span>(</span>
<span id="cb139-1040"><a href="#cb139-1040" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="fu">rownames</span>(bw.X.unique))</span>
<span id="cb139-1041"><a href="#cb139-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1042"><a href="#cb139-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1043"><a href="#cb139-1043" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb139-1044"><a href="#cb139-1044" aria-hidden="true" tabindex="-1"></a>If a given covariate pattern has more than one observation in a dataset, those observations are called **replicates**.</span>
<span id="cb139-1045"><a href="#cb139-1045" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1046"><a href="#cb139-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1047"><a href="#cb139-1047" aria-hidden="true" tabindex="-1"></a>Then the most complicated model we could fit would have one parameter (a mean) for each of these combinations, plus a variance parameter:</span>
<span id="cb139-1048"><a href="#cb139-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1051"><a href="#cb139-1051" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1052"><a href="#cb139-1052" aria-hidden="true" tabindex="-1"></a>lm_max <span class="ot">=</span> </span>
<span id="cb139-1053"><a href="#cb139-1053" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1054"><a href="#cb139-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">factor</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb139-1055"><a href="#cb139-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb139-1056"><a href="#cb139-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> weight <span class="sc">~</span> sex<span class="sc">:</span>age <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb139-1057"><a href="#cb139-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _)</span>
<span id="cb139-1058"><a href="#cb139-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1059"><a href="#cb139-1059" aria-hidden="true" tabindex="-1"></a>lm_max <span class="sc">|&gt;</span> </span>
<span id="cb139-1060"><a href="#cb139-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb139-1061"><a href="#cb139-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print_md</span>()</span>
<span id="cb139-1062"><a href="#cb139-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1063"><a href="#cb139-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1064"><a href="#cb139-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1065"><a href="#cb139-1065" aria-hidden="true" tabindex="-1"></a>We call this model the **full**, **maximal**, or **saturated** model for this dataset.</span>
<span id="cb139-1066"><a href="#cb139-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1067"><a href="#cb139-1067" aria-hidden="true" tabindex="-1"></a>We can calculate the log-likelihood of this model as usual:</span>
<span id="cb139-1068"><a href="#cb139-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1071"><a href="#cb139-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1072"><a href="#cb139-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(lm_max)</span>
<span id="cb139-1073"><a href="#cb139-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1074"><a href="#cb139-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1075"><a href="#cb139-1075" aria-hidden="true" tabindex="-1"></a>We can compare this model to our other models using chi-square tests, as usual:</span>
<span id="cb139-1076"><a href="#cb139-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1079"><a href="#cb139-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1080"><a href="#cb139-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(lm_max, bw_lm2)</span>
<span id="cb139-1081"><a href="#cb139-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1082"><a href="#cb139-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1083"><a href="#cb139-1083" aria-hidden="true" tabindex="-1"></a>The likelihood ratio statistic for this test is $$\lambda = 2 * (\ell_{\text{full}} - \ell) = <span class="in">`r 2 * (logLik(lm_max) - logLik(bw_lm2))`</span>$$ where:</span>
<span id="cb139-1084"><a href="#cb139-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1085"><a href="#cb139-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\ell_{\text{max}}$ is the log-likelihood of the full model: <span class="in">`r logLik(lm_max)`</span></span>
<span id="cb139-1086"><a href="#cb139-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\ell$ is the log-likelihood of our comparison model (two slopes, two intercepts): <span class="in">`r logLik(bw_lm2)`</span></span>
<span id="cb139-1087"><a href="#cb139-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1088"><a href="#cb139-1088" aria-hidden="true" tabindex="-1"></a>This statistic is called the **deviance** or **residual deviance** for our two-slopes and two-intercepts model; it tells us how much the likelihood of that model deviates from the likelihood of the maximal model.</span>
<span id="cb139-1089"><a href="#cb139-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1090"><a href="#cb139-1090" aria-hidden="true" tabindex="-1"></a>The corresponding p-value tells us whether there we have enough evidence to detect that our two-slopes, two-intercepts model is a worse fit for the data than the maximal model; in other words, it tells us if there's evidence that we missed any important patterns. (Remember, a nonsignificant p-value could mean that we didn't miss anything and a more complicated model is unnecessary, or it could mean we just don't have enough data to tell the difference between these models.)</span>
<span id="cb139-1091"><a href="#cb139-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1092"><a href="#cb139-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">### Null Deviance</span></span>
<span id="cb139-1093"><a href="#cb139-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1094"><a href="#cb139-1094" aria-hidden="true" tabindex="-1"></a>Similarly, the *least* complicated model we could fit would have only one mean parameter, an intercept:</span>
<span id="cb139-1095"><a href="#cb139-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1096"><a href="#cb139-1096" aria-hidden="true" tabindex="-1"></a>$$\text E<span class="co">[</span><span class="ot">Y|X=x</span><span class="co">]</span> = \beta_0$$ We can fit this model in R like so:</span>
<span id="cb139-1097"><a href="#cb139-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1100"><a href="#cb139-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1101"><a href="#cb139-1101" aria-hidden="true" tabindex="-1"></a>lm0 <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> bw)</span>
<span id="cb139-1102"><a href="#cb139-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1103"><a href="#cb139-1103" aria-hidden="true" tabindex="-1"></a>lm0 <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb139-1104"><a href="#cb139-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1105"><a href="#cb139-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1106"><a href="#cb139-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1107"><a href="#cb139-1107" aria-hidden="true" tabindex="-1"></a>This model also has a likelihood:</span>
<span id="cb139-1108"><a href="#cb139-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1111"><a href="#cb139-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1112"><a href="#cb139-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(lm0)</span>
<span id="cb139-1113"><a href="#cb139-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1114"><a href="#cb139-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1115"><a href="#cb139-1115" aria-hidden="true" tabindex="-1"></a>And we can compare it to more complicated models using a likelihood ratio test:</span>
<span id="cb139-1116"><a href="#cb139-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1119"><a href="#cb139-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1120"><a href="#cb139-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(bw_lm2, lm0)</span>
<span id="cb139-1121"><a href="#cb139-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1122"><a href="#cb139-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1123"><a href="#cb139-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1124"><a href="#cb139-1124" aria-hidden="true" tabindex="-1"></a>The likelihood ratio statistic for the test comparing the null model to the maximal model is $$\lambda = 2 * (\ell_{\text{full}} - \ell_{0}) = <span class="in">`r 2 * (logLik(lm_max) - logLik(lm0))`</span>$$ where:</span>
<span id="cb139-1125"><a href="#cb139-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1126"><a href="#cb139-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\ell_{\text{0}}$ is the log-likelihood of the null model: <span class="in">`r logLik(lm0)`</span></span>
<span id="cb139-1127"><a href="#cb139-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\ell_{\text{full}}$ is the log-likelihood of the maximal model: <span class="in">`r logLik(lm_max)`</span></span>
<span id="cb139-1128"><a href="#cb139-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1129"><a href="#cb139-1129" aria-hidden="true" tabindex="-1"></a>In R, this test is:</span>
<span id="cb139-1130"><a href="#cb139-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1133"><a href="#cb139-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1134"><a href="#cb139-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(lm_max, lm0)</span>
<span id="cb139-1135"><a href="#cb139-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1136"><a href="#cb139-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1137"><a href="#cb139-1137" aria-hidden="true" tabindex="-1"></a>This log-likelihood ratio statistic is called the **null deviance**. It tells us whether we have enough data to detect a difference between the null and full models.</span>
<span id="cb139-1138"><a href="#cb139-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1139"><a href="#cb139-1139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rescaling</span></span>
<span id="cb139-1140"><a href="#cb139-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1141"><a href="#cb139-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rescale age {.smaller}</span></span>
<span id="cb139-1142"><a href="#cb139-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1145"><a href="#cb139-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1146"><a href="#cb139-1146" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> </span>
<span id="cb139-1147"><a href="#cb139-1147" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span></span>
<span id="cb139-1148"><a href="#cb139-1148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-1149"><a href="#cb139-1149" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age - mean</span><span class="st">`</span> <span class="ot">=</span> age <span class="sc">-</span> <span class="fu">mean</span>(age),</span>
<span id="cb139-1150"><a href="#cb139-1150" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age - 36wks</span><span class="st">`</span> <span class="ot">=</span> age <span class="sc">-</span> <span class="dv">36</span></span>
<span id="cb139-1151"><a href="#cb139-1151" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-1152"><a href="#cb139-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1153"><a href="#cb139-1153" aria-hidden="true" tabindex="-1"></a>lm1c <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> sex <span class="sc">+</span> <span class="st">`</span><span class="at">age - 36wks</span><span class="st">`</span>, <span class="at">data =</span> bw)</span>
<span id="cb139-1154"><a href="#cb139-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1155"><a href="#cb139-1155" aria-hidden="true" tabindex="-1"></a>lm2c <span class="ot">=</span> <span class="fu">lm</span>(weight <span class="sc">~</span> sex <span class="sc">+</span> <span class="st">`</span><span class="at">age - 36wks</span><span class="st">`</span> <span class="sc">+</span> sex<span class="sc">:</span><span class="st">`</span><span class="at">age - 36wks</span><span class="st">`</span>, <span class="at">data =</span> bw)</span>
<span id="cb139-1156"><a href="#cb139-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1157"><a href="#cb139-1157" aria-hidden="true" tabindex="-1"></a><span class="fu">parameters</span>(lm2c, <span class="at">ci_method =</span> <span class="st">"wald"</span>) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb139-1158"><a href="#cb139-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1159"><a href="#cb139-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1160"><a href="#cb139-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1161"><a href="#cb139-1161" aria-hidden="true" tabindex="-1"></a>Compare with what we got without rescaling:</span>
<span id="cb139-1162"><a href="#cb139-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1165"><a href="#cb139-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1166"><a href="#cb139-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">parameters</span>(bw_lm2, <span class="at">ci_method =</span> <span class="st">"wald"</span>) <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb139-1167"><a href="#cb139-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1168"><a href="#cb139-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1169"><a href="#cb139-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction</span></span>
<span id="cb139-1170"><a href="#cb139-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1171"><a href="#cb139-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prediction for linear models</span></span>
<span id="cb139-1172"><a href="#cb139-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1173"><a href="#cb139-1173" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-1174"><a href="#cb139-1174" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb139-1175"><a href="#cb139-1175" aria-hidden="true" tabindex="-1"></a>\hat Y &amp;= \hat E<span class="co">[</span><span class="ot">Y|X=x</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb139-1176"><a href="#cb139-1176" aria-hidden="true" tabindex="-1"></a>&amp;= x'\hat\beta <span class="sc">\\</span></span>
<span id="cb139-1177"><a href="#cb139-1177" aria-hidden="true" tabindex="-1"></a>&amp;= \hat\beta_0\cdot 1 + \hat\beta_1 x_1 + ... + \hat\beta_p x_p</span>
<span id="cb139-1178"><a href="#cb139-1178" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb139-1179"><a href="#cb139-1179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-1180"><a href="#cb139-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1181"><a href="#cb139-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">### prediction in R</span></span>
<span id="cb139-1182"><a href="#cb139-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1185"><a href="#cb139-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1186"><a href="#cb139-1186" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">model.matrix</span>(bw_lm1)</span>
<span id="cb139-1187"><a href="#cb139-1187" aria-hidden="true" tabindex="-1"></a>X <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-1188"><a href="#cb139-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1189"><a href="#cb139-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X[<span class="dv">1</span>,])</span>
<span id="cb139-1190"><a href="#cb139-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(bw_lm1))</span>
<span id="cb139-1191"><a href="#cb139-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(X[<span class="dv">1</span>,] <span class="sc">*</span> <span class="fu">coef</span>(bw_lm1))</span>
<span id="cb139-1192"><a href="#cb139-1192" aria-hidden="true" tabindex="-1"></a>{X[<span class="dv">1</span>,] <span class="sc">*</span> <span class="fu">coef</span>(bw_lm1)} <span class="sc">|&gt;</span> <span class="fu">sum</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-1193"><a href="#cb139-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1194"><a href="#cb139-1194" aria-hidden="true" tabindex="-1"></a>X <span class="sc">%*%</span> <span class="fu">coef</span>(bw_lm1) <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb139-1195"><a href="#cb139-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1196"><a href="#cb139-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bw_lm1)</span>
<span id="cb139-1197"><a href="#cb139-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1198"><a href="#cb139-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bw_lm1, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-1199"><a href="#cb139-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1200"><a href="#cb139-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bw_lm1, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>fit</span>
<span id="cb139-1201"><a href="#cb139-1201" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bw_lm1, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>se.fit</span>
<span id="cb139-1202"><a href="#cb139-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1203"><a href="#cb139-1203" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bw_lm1, <span class="at">se.fit =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="st">"confidence"</span>)<span class="sc">$</span>fit <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb139-1204"><a href="#cb139-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1205"><a href="#cb139-1205" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bw_lm1, <span class="at">se.fit =</span> <span class="cn">TRUE</span>, <span class="at">interval =</span> <span class="st">"predict"</span>)<span class="sc">$</span>fit <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb139-1206"><a href="#cb139-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1207"><a href="#cb139-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1208"><a href="#cb139-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1209"><a href="#cb139-1209" aria-hidden="true" tabindex="-1"></a>The warning from the last command is: "predictions on current data refer to *future* responses" (since you already know what happened to the current data, and thus don't need to predict it). You could also supply <span class="in">`newdata`</span> to get predictions for new combinations of predictors that you didn't see in your original dataset. See <span class="in">`?predict.lm`</span> for more.</span>
<span id="cb139-1210"><a href="#cb139-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1211"><a href="#cb139-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnostics {#sec-diagnose-LMs}</span></span>
<span id="cb139-1212"><a href="#cb139-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1213"><a href="#cb139-1213" aria-hidden="true" tabindex="-1"></a><span class="fu">### Residuals</span></span>
<span id="cb139-1214"><a href="#cb139-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1215"><a href="#cb139-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Definitions of residuals</span></span>
<span id="cb139-1216"><a href="#cb139-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1217"><a href="#cb139-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Residuals: $$e_i = y_i - \hat E<span class="co">[</span><span class="ot">Y|X=x</span><span class="co">]</span>$$</span>
<span id="cb139-1218"><a href="#cb139-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1219"><a href="#cb139-1219" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For Gaussian models, $e_i$ can be seen as an estimate of $$\epsilon_i = Y_i - \text{E}<span class="co">[</span><span class="ot">Y|X=x_i</span><span class="co">]</span>$$</span>
<span id="cb139-1220"><a href="#cb139-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1221"><a href="#cb139-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Standardized residuals: $$r_i = \frac{e_i}{\hat{SD}(e_i)}$$</span>
<span id="cb139-1222"><a href="#cb139-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1223"><a href="#cb139-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For Gaussian models: $$\hat{SD}(e_i) \approx \frac{e_i}{\hat{\sigma}}$$</span>
<span id="cb139-1224"><a href="#cb139-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1225"><a href="#cb139-1225" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Characteristics of residuals</span></span>
<span id="cb139-1226"><a href="#cb139-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1227"><a href="#cb139-1227" aria-hidden="true" tabindex="-1"></a>With enough data and a correct model, the residuals will be approximately Guassian distributed, with variance $\sigma^2$, which we can estimate using $\hat\sigma^2$: that is:</span>
<span id="cb139-1228"><a href="#cb139-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1229"><a href="#cb139-1229" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-1230"><a href="#cb139-1230" aria-hidden="true" tabindex="-1"></a>e_i\ \dot \sim_{iid}\ N(0, \hat\sigma^2)</span>
<span id="cb139-1231"><a href="#cb139-1231" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-1232"><a href="#cb139-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1233"><a href="#cb139-1233" aria-hidden="true" tabindex="-1"></a>Hence, with enough data and a correct model, the standardized residuals will be approximately standard Gaussian; that is,</span>
<span id="cb139-1234"><a href="#cb139-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1235"><a href="#cb139-1235" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-1236"><a href="#cb139-1236" aria-hidden="true" tabindex="-1"></a>r_i\ \dot \sim_{iid}\ N(0,1)</span>
<span id="cb139-1237"><a href="#cb139-1237" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb139-1238"><a href="#cb139-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1239"><a href="#cb139-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">### Marginal distributions of residuals</span></span>
<span id="cb139-1240"><a href="#cb139-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1241"><a href="#cb139-1241" aria-hidden="true" tabindex="-1"></a>To look for problems with our model, we can check whether the residuals $e_i$ and standardized residuals $r_i$ look like they have the distributions that they are supposed to have, according to the model.</span>
<span id="cb139-1242"><a href="#cb139-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1243"><a href="#cb139-1243" aria-hidden="true" tabindex="-1"></a>First, we need to compute the residuals. R makes this easy:</span>
<span id="cb139-1244"><a href="#cb139-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1245"><a href="#cb139-1245" aria-hidden="true" tabindex="-1"></a><span class="fu">#### (non-standardized) residuals in R</span></span>
<span id="cb139-1246"><a href="#cb139-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1249"><a href="#cb139-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1250"><a href="#cb139-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(bw_lm2)</span>
<span id="cb139-1251"><a href="#cb139-1251" aria-hidden="true" tabindex="-1"></a><span class="co"># check by hand</span></span>
<span id="cb139-1252"><a href="#cb139-1252" aria-hidden="true" tabindex="-1"></a>bw<span class="sc">$</span>weight <span class="sc">-</span> <span class="fu">fitted</span>(bw_lm2)</span>
<span id="cb139-1253"><a href="#cb139-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1254"><a href="#cb139-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1255"><a href="#cb139-1255" aria-hidden="true" tabindex="-1"></a>Success!</span>
<span id="cb139-1256"><a href="#cb139-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1257"><a href="#cb139-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Standardized residuals in R</span></span>
<span id="cb139-1258"><a href="#cb139-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1261"><a href="#cb139-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1262"><a href="#cb139-1262" aria-hidden="true" tabindex="-1"></a><span class="fu">rstandard</span>(bw_lm2)</span>
<span id="cb139-1263"><a href="#cb139-1263" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(bw_lm2)<span class="sc">/</span><span class="fu">sigma</span>(bw_lm2)</span>
<span id="cb139-1264"><a href="#cb139-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1265"><a href="#cb139-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1266"><a href="#cb139-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1267"><a href="#cb139-1267" aria-hidden="true" tabindex="-1"></a>These are not quite the same, because R is doing something more complicated and precise to get the standard errors. Let's not worry about those details for now; the difference is pretty small in this case:</span>
<span id="cb139-1268"><a href="#cb139-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1271"><a href="#cb139-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1272"><a href="#cb139-1272" aria-hidden="true" tabindex="-1"></a>rstandard_compare_plot <span class="ot">=</span> </span>
<span id="cb139-1273"><a href="#cb139-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb139-1274"><a href="#cb139-1274" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">resid</span>(bw_lm2)<span class="sc">/</span><span class="fu">sigma</span>(bw_lm2), </span>
<span id="cb139-1275"><a href="#cb139-1275" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">rstandard</span>(bw_lm2)) <span class="sc">|&gt;</span> </span>
<span id="cb139-1276"><a href="#cb139-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb139-1277"><a href="#cb139-1277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb139-1278"><a href="#cb139-1278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb139-1279"><a href="#cb139-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span> </span>
<span id="cb139-1280"><a href="#cb139-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"resid(bw_lm2)/sigma(bw_lm2)"</span>) <span class="sc">+</span></span>
<span id="cb139-1281"><a href="#cb139-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"rstandard(bw_lm2)"</span>) <span class="sc">+</span></span>
<span id="cb139-1282"><a href="#cb139-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb139-1283"><a href="#cb139-1283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb139-1284"><a href="#cb139-1284" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb139-1285"><a href="#cb139-1285" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb139-1286"><a href="#cb139-1286" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"x=y"</span>)) <span class="sc">+</span></span>
<span id="cb139-1287"><a href="#cb139-1287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb139-1288"><a href="#cb139-1288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="st">"red"</span>)</span>
<span id="cb139-1289"><a href="#cb139-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1290"><a href="#cb139-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1291"><a href="#cb139-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1292"><a href="#cb139-1292" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1295"><a href="#cb139-1295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1296"><a href="#cb139-1296" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(rstandard_compare_plot)</span>
<span id="cb139-1297"><a href="#cb139-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1298"><a href="#cb139-1298" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1299"><a href="#cb139-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1300"><a href="#cb139-1300" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1303"><a href="#cb139-1303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1304"><a href="#cb139-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rstandard_compare_plot)</span>
<span id="cb139-1305"><a href="#cb139-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1306"><a href="#cb139-1306" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1307"><a href="#cb139-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1308"><a href="#cb139-1308" aria-hidden="true" tabindex="-1"></a>Let's add these residuals to the <span class="in">`tibble`</span> of our dataset:</span>
<span id="cb139-1309"><a href="#cb139-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1312"><a href="#cb139-1312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1313"><a href="#cb139-1313" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> </span>
<span id="cb139-1314"><a href="#cb139-1314" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1315"><a href="#cb139-1315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-1316"><a href="#cb139-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_lm2 =</span> <span class="fu">fitted</span>(bw_lm2),</span>
<span id="cb139-1317"><a href="#cb139-1317" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-1318"><a href="#cb139-1318" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_lm2 =</span> <span class="fu">resid</span>(bw_lm2),</span>
<span id="cb139-1319"><a href="#cb139-1319" aria-hidden="true" tabindex="-1"></a>    <span class="co"># resid_lm2 = weight - fitted_lm2,</span></span>
<span id="cb139-1320"><a href="#cb139-1320" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-1321"><a href="#cb139-1321" aria-hidden="true" tabindex="-1"></a>    <span class="at">std_resid_lm2 =</span> <span class="fu">rstandard</span>(bw_lm2),</span>
<span id="cb139-1322"><a href="#cb139-1322" aria-hidden="true" tabindex="-1"></a>    <span class="co"># std_resid_lm2 = resid_lm2 / sigma(bw_lm2)</span></span>
<span id="cb139-1323"><a href="#cb139-1323" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-1324"><a href="#cb139-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1325"><a href="#cb139-1325" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1326"><a href="#cb139-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb139-1327"><a href="#cb139-1327" aria-hidden="true" tabindex="-1"></a>    sex,</span>
<span id="cb139-1328"><a href="#cb139-1328" aria-hidden="true" tabindex="-1"></a>    age,</span>
<span id="cb139-1329"><a href="#cb139-1329" aria-hidden="true" tabindex="-1"></a>    weight,</span>
<span id="cb139-1330"><a href="#cb139-1330" aria-hidden="true" tabindex="-1"></a>    fitted_lm2,</span>
<span id="cb139-1331"><a href="#cb139-1331" aria-hidden="true" tabindex="-1"></a>    resid_lm2,</span>
<span id="cb139-1332"><a href="#cb139-1332" aria-hidden="true" tabindex="-1"></a>    std_resid_lm2</span>
<span id="cb139-1333"><a href="#cb139-1333" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-1334"><a href="#cb139-1334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1335"><a href="#cb139-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1336"><a href="#cb139-1336" aria-hidden="true" tabindex="-1"></a>Now let's build histograms:</span>
<span id="cb139-1337"><a href="#cb139-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1338"><a href="#cb139-1338" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Marginal distribution of (nonstandardized) residuals</span></span>
<span id="cb139-1339"><a href="#cb139-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1342"><a href="#cb139-1342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1343"><a href="#cb139-1343" aria-hidden="true" tabindex="-1"></a>resid_marginal_hist <span class="ot">=</span> </span>
<span id="cb139-1344"><a href="#cb139-1344" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1345"><a href="#cb139-1345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> resid_lm2)) <span class="sc">+</span></span>
<span id="cb139-1346"><a href="#cb139-1346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb139-1347"><a href="#cb139-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1348"><a href="#cb139-1348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1349"><a href="#cb139-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1350"><a href="#cb139-1350" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1353"><a href="#cb139-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1354"><a href="#cb139-1354" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(resid_marginal_hist)</span>
<span id="cb139-1355"><a href="#cb139-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1356"><a href="#cb139-1356" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1357"><a href="#cb139-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1358"><a href="#cb139-1358" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1361"><a href="#cb139-1361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1362"><a href="#cb139-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resid_marginal_hist)</span>
<span id="cb139-1363"><a href="#cb139-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1364"><a href="#cb139-1364" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1365"><a href="#cb139-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1366"><a href="#cb139-1366" aria-hidden="true" tabindex="-1"></a>Hard to tell with this small amount of data, but I'm a bit concerned that the histogram doesn't show a bell-curve shape.</span>
<span id="cb139-1367"><a href="#cb139-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1368"><a href="#cb139-1368" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Marginal distribution of standardized residuals</span></span>
<span id="cb139-1369"><a href="#cb139-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1372"><a href="#cb139-1372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1373"><a href="#cb139-1373" aria-hidden="true" tabindex="-1"></a>std_resid_marginal_hist <span class="ot">=</span> </span>
<span id="cb139-1374"><a href="#cb139-1374" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1375"><a href="#cb139-1375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> std_resid_lm2)) <span class="sc">+</span></span>
<span id="cb139-1376"><a href="#cb139-1376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb139-1377"><a href="#cb139-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1378"><a href="#cb139-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1379"><a href="#cb139-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1380"><a href="#cb139-1380" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1383"><a href="#cb139-1383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1384"><a href="#cb139-1384" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(std_resid_marginal_hist)</span>
<span id="cb139-1385"><a href="#cb139-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1386"><a href="#cb139-1386" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1387"><a href="#cb139-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1388"><a href="#cb139-1388" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1391"><a href="#cb139-1391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1392"><a href="#cb139-1392" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(std_resid_marginal_hist)</span>
<span id="cb139-1393"><a href="#cb139-1393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1394"><a href="#cb139-1394" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1395"><a href="#cb139-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1396"><a href="#cb139-1396" aria-hidden="true" tabindex="-1"></a>This looks similar, although the scale of the x-axis got narrower, because we divided by $\hat\sigma$ (roughly speaking).</span>
<span id="cb139-1397"><a href="#cb139-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1398"><a href="#cb139-1398" aria-hidden="true" tabindex="-1"></a>Still hard to tell if the distribution is Gaussian.</span>
<span id="cb139-1399"><a href="#cb139-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1400"><a href="#cb139-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">### QQ plot of standardized residuals</span></span>
<span id="cb139-1401"><a href="#cb139-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1402"><a href="#cb139-1402" aria-hidden="true" tabindex="-1"></a>Another way to assess normality is the QQ plot of the standardized residuals versus normal quantiles:</span>
<span id="cb139-1403"><a href="#cb139-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1406"><a href="#cb139-1406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1407"><a href="#cb139-1407" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify) </span>
<span id="cb139-1408"><a href="#cb139-1408" aria-hidden="true" tabindex="-1"></a><span class="co"># needed to make ggplot2::autoplot() work for `lm` objects</span></span>
<span id="cb139-1409"><a href="#cb139-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1410"><a href="#cb139-1410" aria-hidden="true" tabindex="-1"></a>qqplot_lm2_auto <span class="ot">=</span> </span>
<span id="cb139-1411"><a href="#cb139-1411" aria-hidden="true" tabindex="-1"></a>  bw_lm2 <span class="sc">|&gt;</span> </span>
<span id="cb139-1412"><a href="#cb139-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(</span>
<span id="cb139-1413"><a href="#cb139-1413" aria-hidden="true" tabindex="-1"></a>    <span class="at">which =</span> <span class="dv">2</span>, <span class="co"># options are 1:6; can do multiple at once</span></span>
<span id="cb139-1414"><a href="#cb139-1414" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb139-1415"><a href="#cb139-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb139-1416"><a href="#cb139-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1417"><a href="#cb139-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1418"><a href="#cb139-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1419"><a href="#cb139-1419" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1422"><a href="#cb139-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1423"><a href="#cb139-1423" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(qqplot_lm2_auto)</span>
<span id="cb139-1424"><a href="#cb139-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1425"><a href="#cb139-1425" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1426"><a href="#cb139-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1427"><a href="#cb139-1427" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1430"><a href="#cb139-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1431"><a href="#cb139-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(qqplot_lm2_auto)</span>
<span id="cb139-1432"><a href="#cb139-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1433"><a href="#cb139-1433" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1434"><a href="#cb139-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1435"><a href="#cb139-1435" aria-hidden="true" tabindex="-1"></a>If the Gaussian model were correct, these points should follow the dotted line.</span>
<span id="cb139-1436"><a href="#cb139-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1437"><a href="#cb139-1437" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb139-1438"><a href="#cb139-1438" aria-hidden="true" tabindex="-1"></a>Fig 2.4 panel (c) in Dobson is a little different; they didn't specify how they produced it, but other statistical analysis systems do things differently from R.</span>
<span id="cb139-1439"><a href="#cb139-1439" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1440"><a href="#cb139-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1441"><a href="#cb139-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">#### QQ plot - how it's built</span></span>
<span id="cb139-1442"><a href="#cb139-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1443"><a href="#cb139-1443" aria-hidden="true" tabindex="-1"></a>Let's construct it by hand:</span>
<span id="cb139-1444"><a href="#cb139-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1447"><a href="#cb139-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1448"><a href="#cb139-1448" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1449"><a href="#cb139-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-1450"><a href="#cb139-1450" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> (<span class="fu">rank</span>(std_resid_lm2) <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">n</span>(), <span class="co"># "Blom's method"</span></span>
<span id="cb139-1451"><a href="#cb139-1451" aria-hidden="true" tabindex="-1"></a>    <span class="at">expected_quantiles_lm2 =</span> <span class="fu">qnorm</span>(p)</span>
<span id="cb139-1452"><a href="#cb139-1452" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-1453"><a href="#cb139-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1454"><a href="#cb139-1454" aria-hidden="true" tabindex="-1"></a>qqplot_lm2 <span class="ot">=</span> </span>
<span id="cb139-1455"><a href="#cb139-1455" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1456"><a href="#cb139-1456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb139-1457"><a href="#cb139-1457" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb139-1458"><a href="#cb139-1458" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> expected_quantiles_lm2, </span>
<span id="cb139-1459"><a href="#cb139-1459" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> std_resid_lm2, </span>
<span id="cb139-1460"><a href="#cb139-1460" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> sex, </span>
<span id="cb139-1461"><a href="#cb139-1461" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> sex)</span>
<span id="cb139-1462"><a href="#cb139-1462" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb139-1463"><a href="#cb139-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb139-1464"><a href="#cb139-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb139-1465"><a href="#cb139-1465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>) <span class="sc">+</span> <span class="co"># removing the plot legend</span></span>
<span id="cb139-1466"><a href="#cb139-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Normal Q-Q"</span>) <span class="sc">+</span></span>
<span id="cb139-1467"><a href="#cb139-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Theoretical Quantiles"</span>) <span class="sc">+</span> </span>
<span id="cb139-1468"><a href="#cb139-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Standardized residuals"</span>)</span>
<span id="cb139-1469"><a href="#cb139-1469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1470"><a href="#cb139-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1471"><a href="#cb139-1471" aria-hidden="true" tabindex="-1"></a>We find the expected line like so:</span>
<span id="cb139-1472"><a href="#cb139-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1475"><a href="#cb139-1475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1476"><a href="#cb139-1476" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>)                  <span class="co"># reference probabilities</span></span>
<span id="cb139-1477"><a href="#cb139-1477" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">rstandard</span>(bw_lm2), ps)  <span class="co"># empirical quantiles</span></span>
<span id="cb139-1478"><a href="#cb139-1478" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(ps)                     <span class="co"># theoretical quantiles</span></span>
<span id="cb139-1479"><a href="#cb139-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1480"><a href="#cb139-1480" aria-hidden="true" tabindex="-1"></a>qq_slope <span class="ot">=</span> <span class="fu">diff</span>(a)<span class="sc">/</span><span class="fu">diff</span>(b)</span>
<span id="cb139-1481"><a href="#cb139-1481" aria-hidden="true" tabindex="-1"></a>qq_intcpt <span class="ot">=</span> a[<span class="dv">1</span>] <span class="sc">-</span> b[<span class="dv">1</span>] <span class="sc">*</span> qq_slope</span>
<span id="cb139-1482"><a href="#cb139-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1483"><a href="#cb139-1483" aria-hidden="true" tabindex="-1"></a>qqplot_lm2 <span class="ot">=</span> </span>
<span id="cb139-1484"><a href="#cb139-1484" aria-hidden="true" tabindex="-1"></a>  qqplot_lm2 <span class="sc">+</span></span>
<span id="cb139-1485"><a href="#cb139-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> qq_slope, <span class="at">intercept =</span> qq_intcpt)</span>
<span id="cb139-1486"><a href="#cb139-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1487"><a href="#cb139-1487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1488"><a href="#cb139-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1489"><a href="#cb139-1489" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1492"><a href="#cb139-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1493"><a href="#cb139-1493" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(qqplot_lm2)</span>
<span id="cb139-1494"><a href="#cb139-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1495"><a href="#cb139-1495" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1496"><a href="#cb139-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1497"><a href="#cb139-1497" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1500"><a href="#cb139-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1501"><a href="#cb139-1501" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(qqplot_lm2)</span>
<span id="cb139-1502"><a href="#cb139-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1503"><a href="#cb139-1503" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1504"><a href="#cb139-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1505"><a href="#cb139-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional distributions of residuals</span></span>
<span id="cb139-1506"><a href="#cb139-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1507"><a href="#cb139-1507" aria-hidden="true" tabindex="-1"></a>If our Gaussian linear regression model is correct, the residuals $e_i$ and standardized residuals $r_i$ should have:</span>
<span id="cb139-1508"><a href="#cb139-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1509"><a href="#cb139-1509" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>an approximately Gaussian distribution, with:</span>
<span id="cb139-1510"><a href="#cb139-1510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>a mean of 0</span>
<span id="cb139-1511"><a href="#cb139-1511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>a constant variance</span>
<span id="cb139-1512"><a href="#cb139-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1513"><a href="#cb139-1513" aria-hidden="true" tabindex="-1"></a>This should be true **regardless** of the value of $X$.</span>
<span id="cb139-1514"><a href="#cb139-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1515"><a href="#cb139-1515" aria-hidden="true" tabindex="-1"></a>But if we didn't correctly guess the functional form of linear component of the mean, $$\text{E}<span class="co">[</span><span class="ot">Y|X=x</span><span class="co">]</span> = \beta_0 + \beta_1 X_1 + ... + \beta_p X_p$$</span>
<span id="cb139-1516"><a href="#cb139-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1517"><a href="#cb139-1517" aria-hidden="true" tabindex="-1"></a>Then the the residuals might have nonzero mean or nonconstant variance for some values of $x$.</span>
<span id="cb139-1518"><a href="#cb139-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1519"><a href="#cb139-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Residuals versus fitted values</span></span>
<span id="cb139-1520"><a href="#cb139-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1521"><a href="#cb139-1521" aria-hidden="true" tabindex="-1"></a>To look for these issues, we can plot the residuals $e_i$ against the fitted values $\hat y_i$:</span>
<span id="cb139-1522"><a href="#cb139-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1525"><a href="#cb139-1525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1526"><a href="#cb139-1526" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(bw_lm2, <span class="at">which =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-1527"><a href="#cb139-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1528"><a href="#cb139-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1529"><a href="#cb139-1529" aria-hidden="true" tabindex="-1"></a>If the model is correct, the blue line should stay flat and close to 0, and the cloud of dots should have the same vertical spread regardless of the fitted value.</span>
<span id="cb139-1530"><a href="#cb139-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1531"><a href="#cb139-1531" aria-hidden="true" tabindex="-1"></a>If not, we probably need to change the functional form of linear component of the mean, $$\text{E}<span class="co">[</span><span class="ot">Y|X=x</span><span class="co">]</span> = \beta_0 + \beta_1 X_1 + ... + \beta_p X_p$$</span>
<span id="cb139-1532"><a href="#cb139-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1533"><a href="#cb139-1533" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Scale-location plot</span></span>
<span id="cb139-1534"><a href="#cb139-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1535"><a href="#cb139-1535" aria-hidden="true" tabindex="-1"></a>We can also plot the square roots of the absolute values of the standardized residuals against the fitted values:</span>
<span id="cb139-1536"><a href="#cb139-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1537"><a href="#cb139-1537" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1540"><a href="#cb139-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1541"><a href="#cb139-1541" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(bw_lm2, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-1542"><a href="#cb139-1542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1543"><a href="#cb139-1543" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1544"><a href="#cb139-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1545"><a href="#cb139-1545" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1548"><a href="#cb139-1548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1549"><a href="#cb139-1549" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(bw_lm2, <span class="at">which =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-1550"><a href="#cb139-1550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1551"><a href="#cb139-1551" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1552"><a href="#cb139-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1553"><a href="#cb139-1553" aria-hidden="true" tabindex="-1"></a>Here, the blue line doesn't need to be near 0, but it should be flat. If not, the residual variance $\sigma^2$ might not be constant, and we might need to transform our outcome $Y$ (or use a model that allows non-constant variance).</span>
<span id="cb139-1554"><a href="#cb139-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1555"><a href="#cb139-1555" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Residuals versus leverage</span></span>
<span id="cb139-1556"><a href="#cb139-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1557"><a href="#cb139-1557" aria-hidden="true" tabindex="-1"></a>We can also plot our standardized residuals against "leverage", which roughly speaking is a measure of how unusual each $x_i$ value is. Very unusual $x_i$ values can have extreme effects on the model fit, so we might want ot remove those observations as outliers, particularly if they have large residuals.</span>
<span id="cb139-1558"><a href="#cb139-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1559"><a href="#cb139-1559" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1562"><a href="#cb139-1562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1563"><a href="#cb139-1563" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(bw_lm2, <span class="at">which =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-1564"><a href="#cb139-1564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1565"><a href="#cb139-1565" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1566"><a href="#cb139-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1567"><a href="#cb139-1567" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1570"><a href="#cb139-1570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1571"><a href="#cb139-1571" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(bw_lm2, <span class="at">which =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb139-1572"><a href="#cb139-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1573"><a href="#cb139-1573" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1574"><a href="#cb139-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1575"><a href="#cb139-1575" aria-hidden="true" tabindex="-1"></a>The blue line should be relatively flat and close to 0 here.</span>
<span id="cb139-1576"><a href="#cb139-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1577"><a href="#cb139-1577" aria-hidden="true" tabindex="-1"></a><span class="fu">### Diagnostics constructed by hand</span></span>
<span id="cb139-1578"><a href="#cb139-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1581"><a href="#cb139-1581" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1582"><a href="#cb139-1582" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">=</span> </span>
<span id="cb139-1583"><a href="#cb139-1583" aria-hidden="true" tabindex="-1"></a>  bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1584"><a href="#cb139-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-1585"><a href="#cb139-1585" aria-hidden="true" tabindex="-1"></a>    <span class="at">predlm2 =</span> <span class="fu">predict</span>(bw_lm2),</span>
<span id="cb139-1586"><a href="#cb139-1586" aria-hidden="true" tabindex="-1"></a>    <span class="at">residlm2 =</span> weight <span class="sc">-</span> predlm2,</span>
<span id="cb139-1587"><a href="#cb139-1587" aria-hidden="true" tabindex="-1"></a>    <span class="at">std_resid =</span> residlm2 <span class="sc">/</span> <span class="fu">sigma</span>(bw_lm2),</span>
<span id="cb139-1588"><a href="#cb139-1588" aria-hidden="true" tabindex="-1"></a>    <span class="co"># std_resid_builtin = rstandard(bw_lm2), # uses leverage</span></span>
<span id="cb139-1589"><a href="#cb139-1589" aria-hidden="true" tabindex="-1"></a>    <span class="at">sqrt_abs_std_resid =</span> std_resid <span class="sc">|&gt;</span> <span class="fu">abs</span>() <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span>
<span id="cb139-1590"><a href="#cb139-1590" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-1591"><a href="#cb139-1591" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-1592"><a href="#cb139-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1593"><a href="#cb139-1593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1594"><a href="#cb139-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1595"><a href="#cb139-1595" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Residuals vs fitted</span></span>
<span id="cb139-1596"><a href="#cb139-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1599"><a href="#cb139-1599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1600"><a href="#cb139-1600" aria-hidden="true" tabindex="-1"></a>resid_vs_fit <span class="ot">=</span> bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1601"><a href="#cb139-1601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb139-1602"><a href="#cb139-1602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> predlm2, <span class="at">y =</span> residlm2, <span class="at">col =</span> sex, <span class="at">shape =</span> sex)</span>
<span id="cb139-1603"><a href="#cb139-1603" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb139-1604"><a href="#cb139-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb139-1605"><a href="#cb139-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb139-1606"><a href="#cb139-1606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span>
<span id="cb139-1607"><a href="#cb139-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1608"><a href="#cb139-1608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1609"><a href="#cb139-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1610"><a href="#cb139-1610" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1613"><a href="#cb139-1613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1614"><a href="#cb139-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resid_vs_fit)</span>
<span id="cb139-1615"><a href="#cb139-1615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1616"><a href="#cb139-1616" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1617"><a href="#cb139-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1618"><a href="#cb139-1618" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1621"><a href="#cb139-1621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1622"><a href="#cb139-1622" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resid_vs_fit)</span>
<span id="cb139-1623"><a href="#cb139-1623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1624"><a href="#cb139-1624" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1625"><a href="#cb139-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1626"><a href="#cb139-1626" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Standardized residuals vs fitted</span></span>
<span id="cb139-1627"><a href="#cb139-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1630"><a href="#cb139-1630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1631"><a href="#cb139-1631" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1632"><a href="#cb139-1632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb139-1633"><a href="#cb139-1633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> predlm2, <span class="at">y =</span> std_resid, <span class="at">col =</span> sex, <span class="at">shape =</span> sex)</span>
<span id="cb139-1634"><a href="#cb139-1634" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb139-1635"><a href="#cb139-1635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb139-1636"><a href="#cb139-1636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb139-1637"><a href="#cb139-1637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span>
<span id="cb139-1638"><a href="#cb139-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1639"><a href="#cb139-1639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1640"><a href="#cb139-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1641"><a href="#cb139-1641" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Standardized residuals vs gestational age</span></span>
<span id="cb139-1642"><a href="#cb139-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1645"><a href="#cb139-1645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1646"><a href="#cb139-1646" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1647"><a href="#cb139-1647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb139-1648"><a href="#cb139-1648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> std_resid, <span class="at">col =</span> sex, <span class="at">shape =</span> sex)</span>
<span id="cb139-1649"><a href="#cb139-1649" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb139-1650"><a href="#cb139-1650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb139-1651"><a href="#cb139-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb139-1652"><a href="#cb139-1652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span>
<span id="cb139-1653"><a href="#cb139-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1654"><a href="#cb139-1654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1655"><a href="#cb139-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1656"><a href="#cb139-1656" aria-hidden="true" tabindex="-1"></a><span class="fu">##### `sqrt(abs(rstandard()))` vs fitted</span></span>
<span id="cb139-1657"><a href="#cb139-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1658"><a href="#cb139-1658" aria-hidden="true" tabindex="-1"></a>Compare with <span class="in">`autoplot(bw_lm2, 3)`</span></span>
<span id="cb139-1659"><a href="#cb139-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1662"><a href="#cb139-1662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1663"><a href="#cb139-1663" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">|&gt;</span> </span>
<span id="cb139-1664"><a href="#cb139-1664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb139-1665"><a href="#cb139-1665" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> predlm2, <span class="at">y =</span> sqrt_abs_std_resid, <span class="at">col =</span> sex, <span class="at">shape =</span> sex)</span>
<span id="cb139-1666"><a href="#cb139-1666" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb139-1667"><a href="#cb139-1667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb139-1668"><a href="#cb139-1668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb139-1669"><a href="#cb139-1669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span>
<span id="cb139-1670"><a href="#cb139-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1671"><a href="#cb139-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1672"><a href="#cb139-1672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1673"><a href="#cb139-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1674"><a href="#cb139-1674" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model selection</span></span>
<span id="cb139-1675"><a href="#cb139-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1676"><a href="#cb139-1676" aria-hidden="true" tabindex="-1"></a>If we have a lot of covariates in our dataset, we might want to choose a small subset to use in our model.</span>
<span id="cb139-1677"><a href="#cb139-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1678"><a href="#cb139-1678" aria-hidden="true" tabindex="-1"></a>There are a few possible metrics to consider for choosing a "best" model.</span>
<span id="cb139-1679"><a href="#cb139-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1680"><a href="#cb139-1680" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mean squared error</span></span>
<span id="cb139-1681"><a href="#cb139-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1682"><a href="#cb139-1682" aria-hidden="true" tabindex="-1"></a>We might want to minimize the **mean squared error**, $\text E<span class="co">[</span><span class="ot">(y-\hat y)^2</span><span class="co">]</span>$, for new observations that weren't in our data set when we fit the model.</span>
<span id="cb139-1683"><a href="#cb139-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1684"><a href="#cb139-1684" aria-hidden="true" tabindex="-1"></a>Unfortunately, $$\frac{1}{n}\sum_{i=1}^n (y_i-\hat y_i)^2$$ gives a biased estimate of $\text E<span class="co">[</span><span class="ot">(y-\hat y)^2</span><span class="co">]</span>$ for new data. If we want an unbiased estimate, we will have to be clever.</span>
<span id="cb139-1685"><a href="#cb139-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1686"><a href="#cb139-1686" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cross-validation</span></span>
<span id="cb139-1687"><a href="#cb139-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1690"><a href="#cb139-1690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1691"><a href="#cb139-1691" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"carbohydrate"</span>, <span class="at">package =</span> <span class="st">"dobson"</span>)</span>
<span id="cb139-1692"><a href="#cb139-1692" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cvTools)</span>
<span id="cb139-1693"><a href="#cb139-1693" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(carbohydrate <span class="sc">~</span> ., <span class="at">data =</span> carbohydrate)</span>
<span id="cb139-1694"><a href="#cb139-1694" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">=</span> </span>
<span id="cb139-1695"><a href="#cb139-1695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cvFit</span>(full.model, <span class="at">data =</span> carbohydrate, <span class="at">K =</span> <span class="dv">5</span>, <span class="at">R =</span> <span class="dv">10</span>,</span>
<span id="cb139-1696"><a href="#cb139-1696" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> carbohydrate<span class="sc">$</span>carbohydrate)</span>
<span id="cb139-1697"><a href="#cb139-1697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1698"><a href="#cb139-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1699"><a href="#cb139-1699" aria-hidden="true" tabindex="-1"></a><span class="fu">## Categorical covariates with more than two levels</span></span>
<span id="cb139-1700"><a href="#cb139-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1701"><a href="#cb139-1701" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: `birthweight`</span></span>
<span id="cb139-1702"><a href="#cb139-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1703"><a href="#cb139-1703" aria-hidden="true" tabindex="-1"></a>In the birthweight example, the variable <span class="in">`sex`</span> had only two observed values:</span>
<span id="cb139-1704"><a href="#cb139-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1707"><a href="#cb139-1707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1708"><a href="#cb139-1708" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(bw<span class="sc">$</span>sex)</span>
<span id="cb139-1709"><a href="#cb139-1709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1710"><a href="#cb139-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1711"><a href="#cb139-1711" aria-hidden="true" tabindex="-1"></a>If there are more than two observed values, we can't just use a single variable with 0s and 1s.</span>
<span id="cb139-1712"><a href="#cb139-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1713"><a href="#cb139-1713" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb139-1714"><a href="#cb139-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1715"><a href="#cb139-1715" aria-hidden="true" tabindex="-1"></a>For example, here's the (in)famous <span class="in">`iris`</span> data:</span>
<span id="cb139-1716"><a href="#cb139-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1719"><a href="#cb139-1719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1720"><a href="#cb139-1720" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">tibble</span>()</span>
<span id="cb139-1721"><a href="#cb139-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1722"><a href="#cb139-1722" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span>
<span id="cb139-1723"><a href="#cb139-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1724"><a href="#cb139-1724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1725"><a href="#cb139-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1726"><a href="#cb139-1726" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb139-1727"><a href="#cb139-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1728"><a href="#cb139-1728" aria-hidden="true" tabindex="-1"></a>There are three species:</span>
<span id="cb139-1729"><a href="#cb139-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1732"><a href="#cb139-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1733"><a href="#cb139-1733" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb139-1734"><a href="#cb139-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1735"><a href="#cb139-1735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1736"><a href="#cb139-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1737"><a href="#cb139-1737" aria-hidden="true" tabindex="-1"></a><span class="fu">### </span></span>
<span id="cb139-1738"><a href="#cb139-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1739"><a href="#cb139-1739" aria-hidden="true" tabindex="-1"></a>If we want to model <span class="in">`Sepal.Length`</span> by species, we could create a variable $X$ that represents "setosa" as $X=1$, "virginica" as $X=2$, and "versicolor" as $X=3$.</span>
<span id="cb139-1740"><a href="#cb139-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1743"><a href="#cb139-1743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1744"><a href="#cb139-1744" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris) <span class="co"># this step is not always necessary, but ensures you're starting  </span></span>
<span id="cb139-1745"><a href="#cb139-1745" aria-hidden="true" tabindex="-1"></a><span class="co"># from the original version of a dataset stored in a loaded package</span></span>
<span id="cb139-1746"><a href="#cb139-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1747"><a href="#cb139-1747" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">=</span> </span>
<span id="cb139-1748"><a href="#cb139-1748" aria-hidden="true" tabindex="-1"></a>  iris <span class="sc">|&gt;</span> </span>
<span id="cb139-1749"><a href="#cb139-1749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb139-1750"><a href="#cb139-1750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-1751"><a href="#cb139-1751" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> <span class="fu">case_when</span>(</span>
<span id="cb139-1752"><a href="#cb139-1752" aria-hidden="true" tabindex="-1"></a>      Species <span class="sc">==</span> <span class="st">"setosa"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb139-1753"><a href="#cb139-1753" aria-hidden="true" tabindex="-1"></a>      Species <span class="sc">==</span> <span class="st">"virginica"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb139-1754"><a href="#cb139-1754" aria-hidden="true" tabindex="-1"></a>      Species <span class="sc">==</span> <span class="st">"versicolor"</span> <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb139-1755"><a href="#cb139-1755" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb139-1756"><a href="#cb139-1756" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-1757"><a href="#cb139-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1758"><a href="#cb139-1758" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb139-1759"><a href="#cb139-1759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Species, X) <span class="sc">|&gt;</span> </span>
<span id="cb139-1760"><a href="#cb139-1760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb139-1761"><a href="#cb139-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1762"><a href="#cb139-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1763"><a href="#cb139-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1764"><a href="#cb139-1764" aria-hidden="true" tabindex="-1"></a>Then we could fit a model like:</span>
<span id="cb139-1765"><a href="#cb139-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1768"><a href="#cb139-1768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1769"><a href="#cb139-1769" aria-hidden="true" tabindex="-1"></a>iris_lm1 <span class="ot">=</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> X, <span class="at">data =</span> iris)</span>
<span id="cb139-1770"><a href="#cb139-1770" aria-hidden="true" tabindex="-1"></a>iris_lm1 <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb139-1771"><a href="#cb139-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1772"><a href="#cb139-1772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1773"><a href="#cb139-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1774"><a href="#cb139-1774" aria-hidden="true" tabindex="-1"></a><span class="fu">### Let's see how that model looks:</span></span>
<span id="cb139-1775"><a href="#cb139-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1778"><a href="#cb139-1778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1779"><a href="#cb139-1779" aria-hidden="true" tabindex="-1"></a>iris_plot1 <span class="ot">=</span> iris <span class="sc">|&gt;</span> </span>
<span id="cb139-1780"><a href="#cb139-1780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb139-1781"><a href="#cb139-1781" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb139-1782"><a href="#cb139-1782" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> X, </span>
<span id="cb139-1783"><a href="#cb139-1783" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> Sepal.Length)</span>
<span id="cb139-1784"><a href="#cb139-1784" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb139-1785"><a href="#cb139-1785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb139-1786"><a href="#cb139-1786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb139-1787"><a href="#cb139-1787" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">coef</span>(iris_lm1)[<span class="dv">1</span>], </span>
<span id="cb139-1788"><a href="#cb139-1788" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">coef</span>(iris_lm1)[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb139-1789"><a href="#cb139-1789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span>
<span id="cb139-1790"><a href="#cb139-1790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1791"><a href="#cb139-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1792"><a href="#cb139-1792" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1795"><a href="#cb139-1795" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1796"><a href="#cb139-1796" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iris_plot1)</span>
<span id="cb139-1797"><a href="#cb139-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1798"><a href="#cb139-1798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1799"><a href="#cb139-1799" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1800"><a href="#cb139-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1801"><a href="#cb139-1801" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1804"><a href="#cb139-1804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1805"><a href="#cb139-1805" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(iris_plot1)</span>
<span id="cb139-1806"><a href="#cb139-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1807"><a href="#cb139-1807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1808"><a href="#cb139-1808" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1809"><a href="#cb139-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1810"><a href="#cb139-1810" aria-hidden="true" tabindex="-1"></a>We have forced the model to use a straight line for the three estimated means. Maybe not a good idea?</span>
<span id="cb139-1811"><a href="#cb139-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1812"><a href="#cb139-1812" aria-hidden="true" tabindex="-1"></a><span class="fu">### Let's see what R does with categorical variables by default:</span></span>
<span id="cb139-1813"><a href="#cb139-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1816"><a href="#cb139-1816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1817"><a href="#cb139-1817" aria-hidden="true" tabindex="-1"></a>iris_lm2 <span class="ot">=</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb139-1818"><a href="#cb139-1818" aria-hidden="true" tabindex="-1"></a>iris_lm2 <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb139-1819"><a href="#cb139-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1820"><a href="#cb139-1820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1821"><a href="#cb139-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1822"><a href="#cb139-1822" aria-hidden="true" tabindex="-1"></a><span class="fu">### Re-parametrize with no intercept</span></span>
<span id="cb139-1823"><a href="#cb139-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1824"><a href="#cb139-1824" aria-hidden="true" tabindex="-1"></a>If you don't want the default and offset option, you can use "-1" like we've seen previously:</span>
<span id="cb139-1825"><a href="#cb139-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1828"><a href="#cb139-1828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1829"><a href="#cb139-1829" aria-hidden="true" tabindex="-1"></a>iris.lm2b <span class="ot">=</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Species <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> iris)</span>
<span id="cb139-1830"><a href="#cb139-1830" aria-hidden="true" tabindex="-1"></a>iris.lm2b <span class="sc">|&gt;</span> <span class="fu">parameters</span>() <span class="sc">|&gt;</span> <span class="fu">print_md</span>()</span>
<span id="cb139-1831"><a href="#cb139-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1832"><a href="#cb139-1832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1833"><a href="#cb139-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1834"><a href="#cb139-1834" aria-hidden="true" tabindex="-1"></a><span class="fu">### Let's see what these new models look like:</span></span>
<span id="cb139-1835"><a href="#cb139-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1838"><a href="#cb139-1838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1839"><a href="#cb139-1839" aria-hidden="true" tabindex="-1"></a>iris_plot2 <span class="ot">=</span> </span>
<span id="cb139-1840"><a href="#cb139-1840" aria-hidden="true" tabindex="-1"></a>  iris <span class="sc">|&gt;</span> </span>
<span id="cb139-1841"><a href="#cb139-1841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-1842"><a href="#cb139-1842" aria-hidden="true" tabindex="-1"></a>    <span class="at">predlm2 =</span> <span class="fu">predict</span>(iris_lm2)) <span class="sc">|&gt;</span> </span>
<span id="cb139-1843"><a href="#cb139-1843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(X) <span class="sc">|&gt;</span> </span>
<span id="cb139-1844"><a href="#cb139-1844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb139-1845"><a href="#cb139-1845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb139-1846"><a href="#cb139-1846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predlm2), <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb139-1847"><a href="#cb139-1847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb139-1848"><a href="#cb139-1848" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">coef</span>(iris_lm1)[<span class="dv">1</span>], </span>
<span id="cb139-1849"><a href="#cb139-1849" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">coef</span>(iris_lm1)[<span class="dv">2</span>]) <span class="sc">+</span> </span>
<span id="cb139-1850"><a href="#cb139-1850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span>
<span id="cb139-1851"><a href="#cb139-1851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1852"><a href="#cb139-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1853"><a href="#cb139-1853" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb139-1856"><a href="#cb139-1856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1857"><a href="#cb139-1857" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iris_plot2)</span>
<span id="cb139-1858"><a href="#cb139-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1859"><a href="#cb139-1859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1860"><a href="#cb139-1860" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1861"><a href="#cb139-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1862"><a href="#cb139-1862" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb139-1865"><a href="#cb139-1865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1866"><a href="#cb139-1866" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(iris_plot2)</span>
<span id="cb139-1867"><a href="#cb139-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1868"><a href="#cb139-1868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1869"><a href="#cb139-1869" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb139-1870"><a href="#cb139-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1871"><a href="#cb139-1871" aria-hidden="true" tabindex="-1"></a><span class="fu">### Let's see how R did that:</span></span>
<span id="cb139-1872"><a href="#cb139-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1875"><a href="#cb139-1875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1876"><a href="#cb139-1876" aria-hidden="true" tabindex="-1"></a><span class="fu">formula</span>(iris_lm2)</span>
<span id="cb139-1877"><a href="#cb139-1877" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(iris_lm2) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb139-1878"><a href="#cb139-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1879"><a href="#cb139-1879" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1880"><a href="#cb139-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1881"><a href="#cb139-1881" aria-hidden="true" tabindex="-1"></a>This is called a "corner point parametrization".</span>
<span id="cb139-1882"><a href="#cb139-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1885"><a href="#cb139-1885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb139-1886"><a href="#cb139-1886" aria-hidden="true" tabindex="-1"></a><span class="fu">formula</span>(iris.lm2b)</span>
<span id="cb139-1887"><a href="#cb139-1887" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(iris.lm2b) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb139-1888"><a href="#cb139-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1889"><a href="#cb139-1889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb139-1890"><a href="#cb139-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1891"><a href="#cb139-1891" aria-hidden="true" tabindex="-1"></a>This can be called a "group point parametrization".</span>
<span id="cb139-1892"><a href="#cb139-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-1893"><a href="#cb139-1893" aria-hidden="true" tabindex="-1"></a>There are more options; see Dobson &amp; Barnett §6.4.1.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 Copyright 2023, Douglas Ezra Morrison
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/d-morrison/rme/edit/main/Linear-models-overview.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/d-morrison/rme/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>